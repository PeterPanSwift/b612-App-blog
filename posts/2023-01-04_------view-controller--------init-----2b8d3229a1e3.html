<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>從程式生成 view controller 時搭配自訂的 init 傳資料</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">從程式生成 view controller 時搭配自訂的 init 傳資料</h1>
</header>
<section data-field="subtitle" class="p-summary">
從程式生成 view controller ，然後再進入 controller 的畫面時，我們時常需要傳資料給 controller。
</section>
<section data-field="body" class="e-content">
<section name="cc7f" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1bf4" id="1bf4" class="graf graf--h3 graf--leading graf--title">從程式生成 view controller 時搭配自訂的 init 傳資料</h3><figure name="8ed4" id="8ed4" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*Q-otd47HrLGzI48NqIuPTQ.png" data-width="1870" data-height="1034" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Q-otd47HrLGzI48NqIuPTQ.png"></figure><p name="c2f9" id="c2f9" class="graf graf--p graf-after--figure">從程式生成 view controller ，然後再進入 controller 的畫面時，我們時常需要傳資料給 controller。</p><p name="f8a6" id="f8a6" class="graf graf--p graf-after--p">此時我們有以下兩種方法將資料傳給 controller。</p><ul class="postList"><li name="b559" id="b559" class="graf graf--li graf-after--p">生成 controller 後將資料存入 controller 的 property。</li></ul><p name="e3db" id="e3db" class="graf graf--p graf-after--li">範例</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b4ed" id="b4ed" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br /><span class="hljs-keyword">let</span> bookViewController <span class="hljs-operator">=</span> <span class="hljs-type">BookViewController</span>()<br />bookViewController.book <span class="hljs-operator">=</span> book </span></pre><ul class="postList"><li name="2a99" id="2a99" class="graf graf--li graf-after--pre">生成 controller 時傳入資料，搭配自訂的 init。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="f30d" id="f30d" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br /><span class="hljs-keyword">let</span> bookViewController <span class="hljs-operator">=</span> <span class="hljs-type">BookViewController</span>(book: book)</span></pre><p name="1718" id="1718" class="graf graf--p graf-after--pre">第二種方法較為簡短，但需在 controller 裡自訂包含資料參數的 init。以下我們將介紹如何在生成 controller 時傳入資料，依據 controller 畫面的設計方法分成三種 case 討論。</p><ul class="postList"><li name="10fb" id="10fb" class="graf graf--li graf-after--p">controller 的畫面從 storyboard 設計。</li><li name="e870" id="e870" class="graf graf--li graf-after--li">controller 的畫面從 xib 設計。</li><li name="3f20" id="3f20" class="graf graf--li graf-after--li">controller 的畫面從程式設計。</li></ul><h3 name="ee28" id="ee28" class="graf graf--h3 graf-after--li">目標功能</h3><p name="3157" id="3157" class="graf graf--p graf-after--h3">將書籍資料<strong class="markup--strong markup--p-strong">為什麼要戀愛</strong>傳到顯示書本資訊的 view controller。</p><figure name="c245" id="c245" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HiqZJn3pHdlzCxZ2NcFPrQ.png" data-width="1339" data-height="2716" src="https://cdn-images-1.medium.com/max/800/1*HiqZJn3pHdlzCxZ2NcFPrQ.png"></figure><h3 name="57e7" id="57e7" class="graf graf--h3 graf-after--figure">定義資料型別 Book</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="rust" name="43f5" id="43f5" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Book</span> {<br />    <span class="hljs-keyword">let</span> <span class="hljs-variable">name</span>: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> <span class="hljs-variable">cover</span>: <span class="hljs-type">String</span><br />}</span></pre><h3 name="76e8" id="76e8" class="graf graf--h3 graf-after--pre">asset 的圖片</h3><figure name="c1b1" id="c1b1" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*eBnVUccpJ5Ox7bCaxpuvHg.png" data-width="1020" data-height="434" src="https://cdn-images-1.medium.com/max/800/1*eBnVUccpJ5Ox7bCaxpuvHg.png"></figure><h3 name="dbff" id="dbff" class="graf graf--h3 graf-after--figure">在 controller 定義 init?(coder:)</h3><p name="8c52" id="8c52" class="graf graf--p graf-after--h3">為了在 controller 裡自訂包含資料參數的 init，我們必須加入 <code class="markup--code markup--p-code">init?(coder:)</code>，因為 <code class="markup--code markup--p-code">init?(coder:)</code> 是 required initializer。到時 controller 生成時將透過我們另外定義的 init，因此不用擔心觸發以下的 init 造成閃退。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="18da" id="18da" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />    <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />}</span></pre><p name="7a13" id="7a13" class="graf graf--p graf-after--pre">ps: 對required initializer 不熟的朋友可參考以下連結。</p><div name="09d7" id="09d7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%98%B2%E6%AD%A2%E7%B5%95%E6%8A%80%E5%A4%B1%E5%82%B3%E7%9A%84-required-initializer-d3ff78f72e45" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%98%B2%E6%AD%A2%E7%B5%95%E6%8A%80%E5%A4%B1%E5%82%B3%E7%9A%84-required-initializer-d3ff78f72e45" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%98%B2%E6%AD%A2%E7%B5%95%E6%8A%80%E5%A4%B1%E5%82%B3%E7%9A%84-required-initializer-d3ff78f72e45"><strong class="markup--strong markup--mixtapeEmbed-strong">防止絕技失傳的 required initializer</strong><br><em class="markup--em markup--mixtapeEmbed-em">定義 Swift 類別時，子類別預設並不會繼承父類別的 initializer，除非滿足某些特殊的條件。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%98%B2%E6%AD%A2%E7%B5%95%E6%8A%80%E5%A4%B1%E5%82%B3%E7%9A%84-required-initializer-d3ff78f72e45" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d8d1499728b4a7192aacc34d7dd35fe7" data-thumbnail-img-id="1*-M0nb20W0Qreak-FV3YHAA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*-M0nb20W0Qreak-FV3YHAA.jpeg);"></a></div><p name="7d93" id="7d93" class="graf graf--p graf-after--mixtapeEmbed">接下來我們依據 controller 畫面的設計方法分成三種 case 討論。</p><h3 name="33a2" id="33a2" class="graf graf--h3 graf-after--p">1. controller 的畫面從 storyboard 設計</h3><figure name="3e67" id="3e67" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*_sx1BOhl11jt2vB3GbBFfQ.png" data-width="1166" data-height="1074" src="https://cdn-images-1.medium.com/max/800/1*_sx1BOhl11jt2vB3GbBFfQ.png"></figure><ul class="postList"><li name="5da8" id="5da8" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">定義 BookViewController。</strong></li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="4e48" id="4e48" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BookViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> titleLabel: <span class="hljs-type">UILabel</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> coverImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">let</span> book: <span class="hljs-type">Book</span><br />    <br />    <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>, <span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />        <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(coder: coder)<br />    }<br />    <br />    <span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />    }<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br /><br />        titleLabel.text <span class="hljs-operator">=</span> book.name<br />        coverImageView.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: book.cover)<br />    }</span></pre><p name="dd2e" id="dd2e" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="35d0" id="35d0" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>, <span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />    <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(coder: coder)<br />}</span></pre><p name="4686" id="4686" class="graf graf--p graf-after--pre">建立 storyboard 設計的 controller 畫面時，必須傳入型別 NSCoder 的參數，因為它包含了 storyboard 裡設計的畫面資訊。</p><p name="3e7b" id="3e7b" class="graf graf--p graf-after--p">因此自訂 init 時，搭配了兩個參數，參數 coder 代表 storyboard 裡設計的畫面，參數 book 是 controller 要顯示的資料。</p><ul class="postList"><li name="7807" id="7807" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">生成並顯示 view controller。</strong></li></ul><p name="cc22" id="cc22" class="graf graf--p graf-after--li">在第一個畫面的按鈕點選時顯示 BookViewController。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="5a8b" id="5a8b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">showBook</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />    <span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br />    <span class="hljs-keyword">let</span> bookViewController <span class="hljs-operator">=</span> storyboard<span class="hljs-operator">?</span>.instantiateViewController(identifier: <span class="hljs-string">&quot;BookViewController&quot;</span>, creator: { coder <span class="hljs-keyword">in</span><br />        <span class="hljs-type">BookViewController</span>(coder: coder, book: book)<br />    })<br />    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> bookViewController {<br />        present(bookViewController, animated: <span class="hljs-literal">true</span>)<br />    }<br />}</span></pre><p name="0d80" id="0d80" class="graf graf--p graf-after--pre">生成 BookViewController 時使用 instantiateViewController(identifier:creator:)，相關說明可參考以下連結。</p><div name="8ade" id="8ade" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-instantiateviewcontroller-%E5%82%B3%E8%B3%87%E6%96%99-ios-13-%E6%96%B0%E5%8A%9F%E8%83%BD-f6897ae3f7f2" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-instantiateviewcontroller-%E5%82%B3%E8%B3%87%E6%96%99-ios-13-%E6%96%B0%E5%8A%9F%E8%83%BD-f6897ae3f7f2" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-instantiateviewcontroller-%E5%82%B3%E8%B3%87%E6%96%99-ios-13-%E6%96%B0%E5%8A%9F%E8%83%BD-f6897ae3f7f2"><strong class="markup--strong markup--mixtapeEmbed-strong">在 instantiateViewController 傳資料 — iOS 13 新功能</strong><br><em class="markup--em markup--mixtapeEmbed-em">除了透過 segue 實現 iOS App 的頁面切換，我們也可以拋棄 segue，直接用 UIStoryboard 的 function instantiateViewController 從程式建立 storyboard 設計的…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-instantiateviewcontroller-%E5%82%B3%E8%B3%87%E6%96%99-ios-13-%E6%96%B0%E5%8A%9F%E8%83%BD-f6897ae3f7f2" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0ab8ee69e3cd62c5cc5404db2662a069" data-thumbnail-img-id="1*oETxoF-hWIH8oN57yjC94A.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*oETxoF-hWIH8oN57yjC94A.jpeg);"></a></div><h3 name="2a7e" id="2a7e" class="graf graf--h3 graf-after--mixtapeEmbed">2. controller 的畫面從 xib 設計</h3><figure name="29d4" id="29d4" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*d-GMQxuoi50ZYU2qIXVz5Q.png" data-width="2090" data-height="1174" src="https://cdn-images-1.medium.com/max/800/1*d-GMQxuoi50ZYU2qIXVz5Q.png"></figure><ul class="postList"><li name="428e" id="428e" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">定義 BookViewController。</strong></li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="7ef3" id="7ef3" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BookViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> titleLabel: <span class="hljs-type">UILabel</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> coverImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">let</span> book: <span class="hljs-type">Book</span><br />    <br />    <span class="hljs-keyword">init</span>(<span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />        <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(nibName: <span class="hljs-literal">nil</span>, bundle: <span class="hljs-literal">nil</span>)<br />    }<br />    <br />    <span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />    }<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />        titleLabel.text <span class="hljs-operator">=</span> book.name<br />        coverImageView.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: book.cover)<br />    }</span></pre><p name="8b6c" id="8b6c" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b555" id="b555" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init</span>(<span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />    <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(nibName: <span class="hljs-literal">nil</span>, bundle: <span class="hljs-literal">nil</span>)<br />}</span></pre><p name="3461" id="3461" class="graf graf--p graf-after--pre">建立 xib 設計的 controller 畫面時，必須在自訂的 init 裡呼叫 super.init(nibName:bundle:)。nibName &amp; bundle 傳入 nil，Swift 會依型別名 BookViewController 聰明地找到 BookViewController.xib。</p><div name="2d52" id="2d52" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/nibname" data-href="https://developer.apple.com/documentation/uikit/uiviewcontroller/nibname" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uiviewcontroller/nibname"><strong class="markup--strong markup--mixtapeEmbed-strong">nibName | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">The name of the view controller&#39;s nib file, if one was specified.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uiviewcontroller/nibname" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4102e1ebf50418bd5fa775ca372a8574" data-thumbnail-img-id="0*FtyMBi6389LA7GpS" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*FtyMBi6389LA7GpS);"></a></div><ul class="postList"><li name="c332" id="c332" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">生成並顯示 view controller。</strong></li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="12fd" id="12fd" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">showBook</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />    <span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br />    <span class="hljs-keyword">let</span> bookViewController <span class="hljs-operator">=</span> <span class="hljs-type">BookViewController</span>(book: book)<br />    present(bookViewController, animated: <span class="hljs-literal">true</span>) <br />}</span></pre><h3 name="7695" id="7695" class="graf graf--h3 graf-after--pre">3. controller 的畫面從程式設計</h3><ul class="postList"><li name="5666" id="5666" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">定義 BookViewController。</strong></li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="c82a" id="c82a" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BookViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">let</span> book: <span class="hljs-type">Book</span><br />    <span class="hljs-keyword">let</span> coverImageView <span class="hljs-operator">=</span> {<br />        <span class="hljs-keyword">let</span> imageView <span class="hljs-operator">=</span> <span class="hljs-type">UIImageView</span>()<br />        imageView.translatesAutoresizingMaskIntoConstraints <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br />        imageView.contentMode <span class="hljs-operator">=</span> .scaleAspectFit<br />        <span class="hljs-keyword">return</span> imageView<br />    }()<br />    <span class="hljs-keyword">let</span> titleLabel <span class="hljs-operator">=</span> {<br />        <span class="hljs-keyword">let</span> label <span class="hljs-operator">=</span> <span class="hljs-type">UILabel</span>()<br />        label.translatesAutoresizingMaskIntoConstraints <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br />        label.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">20</span>)<br />        <span class="hljs-keyword">return</span> label<br />    }()<br />        <br />    <span class="hljs-keyword">init</span>(<span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />        <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(nibName: <span class="hljs-literal">nil</span>, bundle: <span class="hljs-literal">nil</span>)<br />    }<br />    <br />    <span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />    }<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />        view.backgroundColor <span class="hljs-operator">=</span> .white<br />        view.addSubview(coverImageView)<br />        view.addSubview(titleLabel)<br />        configureConstraints()<br />        coverImageView.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: book.cover)<br />        titleLabel.text <span class="hljs-operator">=</span> book.name<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">configureConstraints</span>() {<br />        <span class="hljs-type">NSLayoutConstraint</span>.activate([<br />            coverImageView.leadingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.leadingAnchor),<br />            coverImageView.trailingAnchor.constraint(equalTo: view.safeAreaLayoutGuide.trailingAnchor),<br />            coverImageView.topAnchor.constraint(equalTo: view.safeAreaLayoutGuide.topAnchor),<br />            coverImageView.widthAnchor.constraint(equalTo: coverImageView.heightAnchor),<br />            <br />            titleLabel.centerXAnchor.constraint(equalTo: view.safeAreaLayoutGuide.centerXAnchor),<br />            titleLabel.topAnchor.constraint(equalTo: coverImageView.bottomAnchor, constant: <span class="hljs-number">10</span>)<br />        ])<br />    }<br />}</span></pre><p name="5b76" id="5b76" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b47c" id="b47c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init</span>(<span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />    <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />    <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(nibName: <span class="hljs-literal">nil</span>, bundle: <span class="hljs-literal">nil</span>)<br />}</span></pre><p name="93b7" id="93b7" class="graf graf--p graf-after--pre">建立由程式設計的 controller 畫面時，必須在自訂的 init 裡呼叫 super.init(nibName:bundle:)。nibName &amp; bundle 傳入 nil，此時 Swift 找不到對應的 xib，因此畫面將完全從 controller 定義裡的程式產生。</p><ul class="postList"><li name="cde3" id="cde3" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">生成並顯示 view controller。</strong></li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b64c" id="b64c" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">showBook</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />    <span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br />    <span class="hljs-keyword">let</span> bookViewController <span class="hljs-operator">=</span> <span class="hljs-type">BookViewController</span>(book: book)<br />    present(bookViewController, animated: <span class="hljs-literal">true</span>)<br />        <br />}</span></pre><ul class="postList"><li name="093a" id="093a" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">當 controller 繼承 UITableViewController。</strong></li></ul><p name="686f" id="686f" class="graf graf--p graf-after--li">自訂的 init 通常會再加上型別 UITableView.Style 的參數，方便生成 controller 時指定表格的樣式。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="8b7d" id="8b7d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BookTableViewController</span>: <span class="hljs-title class_">UITableViewController</span> {<br />    <span class="hljs-keyword">let</span> book: <span class="hljs-type">Book</span><br />    <br />    <span class="hljs-keyword">init</span>(<span class="hljs-params">style</span>: <span class="hljs-type">UITableView</span>.<span class="hljs-type">Style</span>, <span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />        <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(style: style)<br />    }<br />    <br />    <span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />    }</span></pre><p name="e80e" id="e80e" class="graf graf--p graf-after--pre">以下例子我們在生成 bookTableViewController 時指定表格的樣式為 insetGrouped。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="8bdf" id="8bdf" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, cover: <span class="hljs-string">&quot;love&quot;</span>)<br /><span class="hljs-keyword">let</span> bookTableViewController <span class="hljs-operator">=</span> <span class="hljs-type">BookTableViewController</span>(style: .insetGrouped, book: book)</span></pre><ul class="postList"><li name="5106" id="5106" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">當 controller 繼承 UICollectionViewController。</strong></li></ul><p name="e514" id="e514" class="graf graf--p graf-after--li">自訂的 init 通常會再加上型別 UICollectionViewLayout 的參數，方便生成 controller 時指定畫面如何排版。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="86ea" id="86ea" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">BookCollectionViewController</span>: <span class="hljs-title class_">UICollectionViewController</span> {<br />    <span class="hljs-keyword">let</span> book: <span class="hljs-type">Book</span><br />    <br />    <span class="hljs-keyword">init</span>(<span class="hljs-params">collectionViewLayout</span>: <span class="hljs-type">UICollectionViewLayout</span>, <span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) {<br />        <span class="hljs-keyword">self</span>.book <span class="hljs-operator">=</span> book<br />        <span class="hljs-keyword">super</span>.<span class="hljs-keyword">init</span>(collectionViewLayout: collectionViewLayout)<br />    }<br />    <br />    <span class="hljs-keyword">required</span> <span class="hljs-keyword">init?</span>(<span class="hljs-params">coder</span>: <span class="hljs-type">NSCoder</span>) {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;init(coder:) has not been implemented&quot;</span>)<br />    }<br />}</span></pre><p name="8ef8" id="8ef8" class="graf graf--p graf-after--pre">以下例子我們在生成 bookCollectionViewController 時指定利用 flow layout 排版。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="32a4" id="32a4" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content">let book = <span class="hljs-title function_ invoke__">Book</span>(<span class="hljs-attr">name</span>: <span class="hljs-string">&quot;為什麼要戀愛&quot;</span>, <span class="hljs-attr">cover</span>: <span class="hljs-string">&quot;love&quot;</span>)<br />let layout = <span class="hljs-title function_ invoke__">UICollectionViewFlowLayout</span>()<br />let bookCollectionViewController = <span class="hljs-title function_ invoke__">BookCollectionViewController</span>(<span class="hljs-attr">collectionViewLayout</span>: layout, <span class="hljs-attr">book</span>: book)</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/2b8d3229a1e3"><time class="dt-published" datetime="2023-01-04T07:59:04.646Z">January 4, 2023</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%BE%9E%E7%A8%8B%E5%BC%8F%E7%94%9F%E6%88%90-view-controller-%E6%99%82%E6%90%AD%E9%85%8D%E8%87%AA%E8%A8%82%E7%9A%84-init-%E5%82%B3%E8%B3%87%E6%96%99-2b8d3229a1e3" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>