<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>模仿 Apple 官方範例串接 REST API 的 5 種寫法</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">模仿 Apple 官方範例串接 REST API 的 5 種寫法</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們時常需要串接 REST API 抓取網路上的資料。當串接的 API 一多時，採用好的寫法才能讓程式容易維護和修改。
</section>
<section data-field="body" class="e-content">
<section name="e29b" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="265b" id="265b" class="graf graf--h3 graf--leading graf--title">模仿 Apple 官方範例串接 REST API 的 5 種寫法</h3><p name="b290" id="b290" class="graf graf--p graf-after--h3">開發 iOS App 時，我們時常需要串接 REST API 抓取網路上的資料。當串接的 API 一多時，採用好的寫法才能讓程式容易維護和修改。</p><p name="e55c" id="e55c" class="graf graf--p graf-after--p">以下我們將模仿 Apple 官方範例，示範串接 REST API 的 5 種寫法。</p><ul class="postList"><li name="e6af" id="e6af" class="graf graf--li graf-after--p">方法1: 定義串接 API 的物件， 搭配 async function。</li></ul><p name="c547" id="c547" class="graf graf--p graf-after--li">ex: 在 class CatApiClient 裡定義 <code class="markup--code markup--p-code">func fetchFavorites() async throws -&gt; [Favorite]</code></p><div name="2232" id="2232" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E4%BD%BF%E7%94%A8-async-await-46c819579c83" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E4%BD%BF%E7%94%A8-async-await-46c819579c83" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E4%BD%BF%E7%94%A8-async-await-46c819579c83"><strong class="markup--strong markup--mixtapeEmbed-strong">模仿 Apple 官方範例串接 JSON API，使用 async &amp; await</strong><br><em class="markup--em markup--mixtapeEmbed-em">Apple 的 Develop in Swift Data Collections 第二章 Guided Project: Restaurant 介紹適合初學者參考的 JSON API 串接寫法，接下來就讓我們一步步介紹如何模仿抄襲…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E4%BD%BF%E7%94%A8-async-await-46c819579c83" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="cfd0200d1cdbb8560dd0c3b3552b8c86" data-thumbnail-img-id="1*5HeCnveD9NPyVxbJQO32dg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*5HeCnveD9NPyVxbJQO32dg.png);"></a></div><ul class="postList"><li name="a788" id="a788" class="graf graf--li graf-after--mixtapeEmbed">方法2: 定義串接 API 的物件，串接 API 的 function 裡定義 function 型別的 completion 參數 &amp; 使用 Result type</li></ul><p name="f9c2" id="f9c2" class="graf graf--p graf-after--li">若是時間有限，建議先研究此方法，因此它較易學習，而且也算初學者常採用的方法。若想支援舊版可採用此寫法</p><p name="a3f3" id="a3f3" class="graf graf--p graf-after--p">ex: 在 class CatApiClient 裡定義<code class="markup--code markup--p-code u-paddingRight0 u-marginRight0"> fetchFavorites(completion: <a href="http://twitter.com/escaping" data-href="http://twitter.com/escaping" class="markup--anchor markup--p-anchor" title="Twitter profile for @escaping" rel="noopener" target="_blank">@escaping</a> (Result&lt;[Favorite], Error&gt;) -&gt; Void)</code></p><div name="e361" id="e361" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E5%AE%9A%E7%BE%A9-function-%E5%9E%8B%E5%88%A5%E7%9A%84-completion-%E5%8F%83%E6%95%B8-%E4%BD%BF%E7%94%A8-result-type-9b058c77df5d" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E5%AE%9A%E7%BE%A9-function-%E5%9E%8B%E5%88%A5%E7%9A%84-completion-%E5%8F%83%E6%95%B8-%E4%BD%BF%E7%94%A8-result-type-9b058c77df5d" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E5%AE%9A%E7%BE%A9-function-%E5%9E%8B%E5%88%A5%E7%9A%84-completion-%E5%8F%83%E6%95%B8-%E4%BD%BF%E7%94%A8-result-type-9b058c77df5d"><strong class="markup--strong markup--mixtapeEmbed-strong">模仿 Apple 官方範例串接 JSON API，定義 function 型別的 completion 參數 &amp; 使用 Result type</strong><br><em class="markup--em markup--mixtapeEmbed-em">Apple 的 Develop in Swift Data Collections 第二章 Guided Project: Restaurant 介紹適合初學者參考的 JSON API 串接寫法，接下來就讓我們一步步介紹如何模仿抄襲…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-%E5%AE%9A%E7%BE%A9-function-%E5%9E%8B%E5%88%A5%E7%9A%84-completion-%E5%8F%83%E6%95%B8-%E4%BD%BF%E7%94%A8-result-type-9b058c77df5d" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4402a63fe7c2782581dca6659ebbd8dd" data-thumbnail-img-id="1*qxVQW2O7aMXcjSs5mE9iHg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*qxVQW2O7aMXcjSs5mE9iHg.png);"></a></div><ul class="postList"><li name="1501" id="1501" class="graf graf--li graf-after--mixtapeEmbed">方法3: 定義串接 API 的物件，串接 API 的 function 裡定義 function 型別的 completion 參數</li></ul><p name="bdaa" id="bdaa" class="graf graf--p graf-after--li">在 Result type 發明之前常用的方法。</p><p name="52cf" id="52cf" class="graf graf--p graf-after--p">ex: 在 class CatApiClient 裡定義 <code class="markup--code markup--p-code u-paddingRight0 u-marginRight0">func fetchFavorites(completion: <a href="http://twitter.com/escaping" data-href="http://twitter.com/escaping" class="markup--anchor markup--p-anchor" title="Twitter profile for @escaping" rel="noopener" target="_blank">@escaping</a> ([Favorite]?) -&gt; Void)</code></p><div name="f71e" id="f71e" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-84139d10a7c9" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-84139d10a7c9" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-84139d10a7c9"><strong class="markup--strong markup--mixtapeEmbed-strong">模仿 Apple 官方範例串接 JSON API，定義 function 型別的 completion 參數</strong><br><em class="markup--em markup--mixtapeEmbed-em">Apple 的 App Development with Swift 第五章 Guided Project: Restaurant Menu 介紹了適合初學者參考的 JSON API 串接寫法，接下來就讓我們一步步介紹如何模仿抄襲…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-json-api-84139d10a7c9" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d37b05819581f02280107734d1bd23f4" data-thumbnail-img-id="1*QnlDhz8phaDG3yjDfdOS7A.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*QnlDhz8phaDG3yjDfdOS7A.jpeg);"></a></div><ul class="postList"><li name="f09f" id="f09f" class="graf graf--li graf-after--mixtapeEmbed">方法4: 使用 generic，protocol &amp; associatedtype 定義 APIRequest &amp; APIService，搭配 async &amp; await</li></ul><p name="a529" id="a529" class="graf graf--p graf-after--li">較佳的寫法，許多程式可重覆利用，之後新增 API 時要撰寫的程式較少。</p><p name="40c3" id="40c3" class="graf graf--p graf-after--p">ex: 每個 API 定義對應的 request。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5e18" id="5e18" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">UpdateVoteRequest</span>: <span class="hljs-title class_">APIRequest</span> {<br />    <span class="hljs-keyword">var</span> path <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/votes&quot;</span><br />    <span class="hljs-keyword">let</span> updateVoteBody: <span class="hljs-type">UpdateVoteBody</span><br />    <span class="hljs-keyword">var</span> method: <span class="hljs-type">HTTPMethod</span> { .post }<br />    <span class="hljs-keyword">typealias</span> <span class="hljs-type">Response</span> <span class="hljs-operator">=</span> <span class="hljs-type">UpdateVote</span><br />    <span class="hljs-keyword">var</span> data: <span class="hljs-type">Data</span>? {<br />        <span class="hljs-keyword">let</span> encoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONEncoder</span>()<br />        encoder.keyEncodingStrategy <span class="hljs-operator">=</span> .convertToSnakeCase<br />        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try?</span> encoder.encode(updateVoteBody)<br />    }<br />}</span></pre><p name="9df6" id="9df6" class="graf graf--p graf-after--pre">參考 Apple 的 Develop in Swift Data Collections 第三章 Guided Project: Habits。</p><div name="92c2" id="92c2" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://books.apple.com/tw/book/develop-in-swift-data-collections/id6468968766?l=en-GB" data-href="https://books.apple.com/tw/book/develop-in-swift-data-collections/id6468968766?l=en-GB" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://books.apple.com/tw/book/develop-in-swift-data-collections/id6468968766?l=en-GB"><strong class="markup--strong markup--mixtapeEmbed-strong">‎Develop in Swift Data Collections</strong><br><em class="markup--em markup--mixtapeEmbed-em">Download and read the ebook version of Develop in Swift Data Collections by Apple Education on Apple Books. Students…</em>books.apple.com</a><a href="https://books.apple.com/tw/book/develop-in-swift-data-collections/id6468968766?l=en-GB" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="78d885ca96cb34318cb082ba9b854d8f" data-thumbnail-img-id="0*pu_lUPqD66QUASDa" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*pu_lUPqD66QUASDa);"></a></div><ul class="postList"><li name="d1ec" id="d1ec" class="graf graf--li graf-after--mixtapeEmbed">方法5: 使用 generic，protocol &amp; associatedtype 定義 APIRequest &amp; APIService，搭配 Result type</li></ul><p name="7de0" id="7de0" class="graf graf--p graf-after--li">較佳的寫法，許多程式可重覆利用，之後新增 API 時要撰寫的程式較少。若想支援舊版可採用此寫法。</p><p name="ca6f" id="ca6f" class="graf graf--p graf-after--p">ex: 每個 API 定義對應的 request。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7a3b" id="7a3b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">UpdateVoteRequest</span>: <span class="hljs-title class_">APIRequest</span> {<br />    <span class="hljs-keyword">var</span> path <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/votes&quot;</span><br />    <span class="hljs-keyword">let</span> updateVoteBody: <span class="hljs-type">UpdateVoteBody</span><br />    <span class="hljs-keyword">var</span> method: <span class="hljs-type">HTTPMethod</span> { .post }<br />    <span class="hljs-keyword">typealias</span> <span class="hljs-type">Response</span> <span class="hljs-operator">=</span> <span class="hljs-type">UpdateVote</span><br />    <span class="hljs-keyword">var</span> data: <span class="hljs-type">Data</span>? {<br />        <span class="hljs-keyword">let</span> encoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONEncoder</span>()<br />        encoder.keyEncodingStrategy <span class="hljs-operator">=</span> .convertToSnakeCase<br />        <span class="hljs-keyword">return</span> <span class="hljs-keyword">try?</span> encoder.encode(updateVoteBody)<br />    }<br />}</span></pre><div name="d3dc" id="d3dc" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-api-%E4%BD%BF%E7%94%A8-generic-protocol-associatedtype-%E5%AE%9A%E7%BE%A9-apirequest-apiservice-f010cd5ce7ac" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-api-%E4%BD%BF%E7%94%A8-generic-protocol-associatedtype-%E5%AE%9A%E7%BE%A9-apirequest-apiservice-f010cd5ce7ac" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-api-%E4%BD%BF%E7%94%A8-generic-protocol-associatedtype-%E5%AE%9A%E7%BE%A9-apirequest-apiservice-f010cd5ce7ac"><strong class="markup--strong markup--mixtapeEmbed-strong">模仿 Apple 官方範例串接 API，使用 generic，protocol &amp; associatedtype 定義 APIRequest &amp; APIService</strong><br><em class="markup--em markup--mixtapeEmbed-em">Apple 官方的教科書由淺入深地介紹了三種網路 API 串接的寫法，依序是</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-api-%E4%BD%BF%E7%94%A8-generic-protocol-associatedtype-%E5%AE%9A%E7%BE%A9-apirequest-apiservice-f010cd5ce7ac" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="37237d2c90439aadf69fe28a46f0770a" data-thumbnail-img-id="1*MxAZlgm7rBPl93hBeDLCrg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*MxAZlgm7rBPl93hBeDLCrg.png);"></a></div><h3 name="84c9" id="84c9" class="graf graf--h3 graf-after--mixtapeEmbed">請 AI 依據範例和 API 文件開發串接 API 的 Swift 程式</h3><div name="ab08" id="ab08" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E4%BE%9D%E6%93%9A%E7%AF%84%E4%BE%8B%E5%92%8C-api-%E6%96%87%E4%BB%B6%E9%96%8B%E7%99%BC%E4%B8%B2%E6%8E%A5-api-%E7%9A%84-swift-%E7%A8%8B%E5%BC%8F-1b5609628feb" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E4%BE%9D%E6%93%9A%E7%AF%84%E4%BE%8B%E5%92%8C-api-%E6%96%87%E4%BB%B6%E9%96%8B%E7%99%BC%E4%B8%B2%E6%8E%A5-api-%E7%9A%84-swift-%E7%A8%8B%E5%BC%8F-1b5609628feb" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E4%BE%9D%E6%93%9A%E7%AF%84%E4%BE%8B%E5%92%8C-api-%E6%96%87%E4%BB%B6%E9%96%8B%E7%99%BC%E4%B8%B2%E6%8E%A5-api-%E7%9A%84-swift-%E7%A8%8B%E5%BC%8F-1b5609628feb"><strong class="markup--strong markup--mixtapeEmbed-strong">請 AI 依據範例和 API 文件開發串接 API 的 Swift 程式</strong><br><em class="markup--em markup--mixtapeEmbed-em">開發 iOS App 時，我們時常要花時間研究 API 文件跟實作串接 API 的程式。最近彼得潘玩了一下聰明的 GPT 4，發現他果然是我們寫程式的得力助手。只要跟他描述 API…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E4%BE%9D%E6%93%9A%E7%AF%84%E4%BE%8B%E5%92%8C-api-%E6%96%87%E4%BB%B6%E9%96%8B%E7%99%BC%E4%B8%B2%E6%8E%A5-api-%E7%9A%84-swift-%E7%A8%8B%E5%BC%8F-1b5609628feb" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="70bdb222e8a095abac4485ad1ffe306a" data-thumbnail-img-id="1*oUy6wyJ7nhxl43Gzqq1e-w.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*oUy6wyJ7nhxl43Gzqq1e-w.png);"></a></div><h3 name="a24d" id="a24d" class="graf graf--h3 graf-after--mixtapeEmbed">串接的 API 範例</h3><p name="ee0a" id="ee0a" class="graf graf--p graf-after--h3">以可愛喵喵的 The CAT API 為例。</p><div name="36e6" id="36e6" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://thecatapi.com" data-href="https://thecatapi.com" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://thecatapi.com"><strong class="markup--strong markup--mixtapeEmbed-strong">The Cat API - Cats as a Service.</strong><br><em class="markup--em markup--mixtapeEmbed-em">A public service API all about Cats, free to use when making your fancy new App, Website or Service.</em>thecatapi.com</a><a href="https://thecatapi.com" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="563aceb9c21d7657b7c8587935813dde" data-thumbnail-img-id="0*U_kb6MeUStmXxEiT" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*U_kb6MeUStmXxEiT);"></a></div><p name="2e62" id="2e62" class="graf graf--p graf-after--mixtapeEmbed">我們將示範以下 3 個 API。</p><ul class="postList"><li name="2812" id="2812" class="graf graf--li graf-after--p">抓取使用者的最愛喵喵清單(favorite, GET)。</li><li name="00d9" id="00d9" class="graf graf--li graf-after--li">幫喵喵圖片的可愛分數增加一分。(vote up, POST JSON)</li><li name="0b73" id="0b73" class="graf graf--li graf-after--li">上傳喵喵圖片。(POST multipart/form-data)</li></ul><p name="0c8d" id="0c8d" class="graf graf--p graf-after--li">由於以上三個功能都需要 API key，因此請參考以下連結申請 API key，或是使用 Demo 的 API key <code class="markup--code markup--p-code">DEMO-API-KEY</code>。</p><div name="5b3f" id="5b3f" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%8F%96%E5%BE%97-the-cat-api-%E7%9A%84-api-key-fe133ae4746b" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%8F%96%E5%BE%97-the-cat-api-%E7%9A%84-api-key-fe133ae4746b" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%8F%96%E5%BE%97-the-cat-api-%E7%9A%84-api-key-fe133ae4746b"><strong class="markup--strong markup--mixtapeEmbed-strong">取得 The Cat API 的 API Key</strong><br><em class="markup--em markup--mixtapeEmbed-em">透過 The Cat API 我們可以取得有趣的貓咪資料，不過有些特別的功能必須搭配 API 才能使用，比方上傳照片跟收藏可愛的貓咪。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%8F%96%E5%BE%97-the-cat-api-%E7%9A%84-api-key-fe133ae4746b" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="b9c34c96d560e608cae1c205f2b3af06" data-thumbnail-img-id="1*U9sVFPzf7TmfA5l_zCXGpw.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*U9sVFPzf7TmfA5l_zCXGpw.png);"></a></div><h3 name="e2c2" id="e2c2" class="graf graf--h3 graf-after--mixtapeEmbed">App 畫面</h3><p name="9172" id="9172" class="graf graf--p graf-after--h3">從第一頁的 table 選擇串接 API 的方法，第二頁將抓取最愛喵喵清單顯示在 table 上，點選右上的 + 會幫喵喵圖片的可愛分數增加一分，點選右上的照片按鈕會上傳圖片。</p><figure name="4c68" id="4c68" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FXUyeMMpRP0dgyeCXgEPZA.png" data-width="1186" data-height="1168" src="https://cdn-images-1.medium.com/max/800/1*FXUyeMMpRP0dgyeCXgEPZA.png"></figure><h3 name="842e" id="842e" class="graf graf--h3 graf-after--figure">範例專案連結</h3><div name="f669" id="f669" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://github.com/AppPeterPan/DemoApiUIKit" data-href="https://github.com/AppPeterPan/DemoApiUIKit" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/AppPeterPan/DemoApiUIKit"><strong class="markup--strong markup--mixtapeEmbed-strong">GitHub - AppPeterPan/DemoApiUIKit</strong><br><em class="markup--em markup--mixtapeEmbed-em">You can&#39;t perform that action at this time. You signed in with another tab or window. You signed out in another tab or…</em>github.com</a><a href="https://github.com/AppPeterPan/DemoApiUIKit" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3c8c25b9d5960dc9e7d9850c2dadd861" data-thumbnail-img-id="0*tVuUg1UvpO-_Bnnl" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*tVuUg1UvpO-_Bnnl);"></a></div><h3 name="4efa" id="4efa" class="graf graf--h3 graf-after--mixtapeEmbed">storyboard 畫面</h3><figure name="37be" id="37be" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*-2fmz3kn9x2U2-ddOBd-HQ.png" data-width="786" data-height="1190" src="https://cdn-images-1.medium.com/max/800/1*-2fmz3kn9x2U2-ddOBd-HQ.png"></figure><h3 name="bd95" id="bd95" class="graf graf--h3 graf-after--figure">專案架構 &amp; 說明</h3><ul class="postList"><li name="f725" id="f725" class="graf graf--li graf-after--h3">5 種方法的畫面依序對應 5 個 view controller。</li></ul><figure name="04d7" id="04d7" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*NGaLt8sFxsJH_lMT1vpjKw.png" data-width="774" data-height="332" src="https://cdn-images-1.medium.com/max/800/1*NGaLt8sFxsJH_lMT1vpjKw.png"></figure><ul class="postList"><li name="b7eb" id="b7eb" class="graf graf--li graf-after--figure">假設登入的使用者 id 是 123。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="8f6e" id="8f6e" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">User</span> {<br />    <span class="hljs-keyword">let</span> id: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> current: <span class="hljs-type">User</span>? <span class="hljs-operator">=</span> <span class="hljs-type">User</span>(id: <span class="hljs-string">&quot;123&quot;</span>)<br />}</span></pre><ul class="postList"><li name="72ff" id="72ff" class="graf graf--li graf-after--pre">串接 API 的程式定義在 service 下。</li></ul><p name="6588" id="6588" class="graf graf--p graf-after--li">以 method1 ~ 5 區分不同的方法。</p><figure name="2d16" id="2d16" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*IlVTrwt87z5v0gWMNFo-fA.png" data-width="608" data-height="642" src="https://cdn-images-1.medium.com/max/800/1*IlVTrwt87z5v0gWMNFo-fA.png"></figure><p name="8f6a" id="8f6a" class="graf graf--p graf-after--figure">method 4 &amp; 5 的差別在 APIRequest 的 send function。method 4 定義 <code class="markup--code markup--p-code">func send() async throws -&gt; Response</code>，method 5 定義 <code class="markup--code markup--p-code">func send(completion: @escaping (Result&lt;Response, Error&gt;) -&gt; Void)</code>。</p><ul class="postList"><li name="1218" id="1218" class="graf graf--li graf-after--p">API 失敗時也會回傳 JSON，對應的資料型別如下。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c115" id="c115" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ApiErrorResponse</span>: <span class="hljs-title class_">Decodable</span>, <span class="hljs-title class_">Error</span> {<br />    <span class="hljs-keyword">let</span> message: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> status: <span class="hljs-type">Int</span><br />}</span></pre><ul class="postList"><li name="65ac" id="65ac" class="graf graf--li graf-after--pre">上傳的圖片只能是貓咪。The CAT API 會檢查圖片是否是貓咪，若是上傳小狗的圖片會失敗。</li></ul><figure name="c4d4" id="c4d4" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*4UnUW6zrDrfqloERPUm3lA.png" data-width="1658" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*4UnUW6zrDrfqloERPUm3lA.png"></figure><ul class="postList"><li name="1bac" id="1bac" class="graf graf--li graf-after--figure">採用方法 4 &amp; 5 時，利用 multipartDic 判斷是否是要上傳 multipart/form-data 格式。如果不是，而且 http method 是 post 或 put 時，則將 Content-Type 設成 application/json。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="07c3" id="07c3" class="graf graf--pre graf-after--li graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> multipartDic <span class="hljs-operator">=</span> multipartDic {<br />    request.createMultipartFormData(parameters: multipartDic)<br />} <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> method <span class="hljs-operator">==</span> .post <span class="hljs-operator">||</span> method <span class="hljs-operator">==</span> .put {<br />    request.setValue(<span class="hljs-string">&quot;application/json&quot;</span>, forHTTPHeaderField: <span class="hljs-string">&quot;Content-Type&quot;</span>)<br />}</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/a4d5c04397e7"><time class="dt-published" datetime="2022-04-19T10:19:30.043Z">April 19, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E6%A8%A1%E4%BB%BF-apple-%E5%AE%98%E6%96%B9%E7%AF%84%E4%BE%8B%E4%B8%B2%E6%8E%A5-rest-api-%E7%9A%84-5-%E7%A8%AE%E5%AF%AB%E6%B3%95-a4d5c04397e7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>