<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>使用 SwiftUI 的 SignInWithAppleButton 實現 Apple 登入</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">使用 SwiftUI 的 SignInWithAppleButton 實現 Apple 登入</h1>
</header>
<section data-field="subtitle" class="p-summary">
SwiftUI 提供了方便的 SignInWithAppleButton，只要幾行程式就能實現 Apple 登入的功能。接下來就讓我們親自實驗看看吧。
</section>
<section data-field="body" class="e-content">
<section name="af2a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="ea71" id="ea71" class="graf graf--h3 graf--leading graf--title">使用 SwiftUI 的 SignInWithAppleButton 實現 Apple 登入</h3><p name="930c" id="930c" class="graf graf--p graf-after--h3">SwiftUI 提供了方便的 SignInWithAppleButton，只要幾行程式就能實現 Apple 登入的功能。接下來就讓我們親自實驗看看吧。</p><h3 name="a73b" id="a73b" class="graf graf--h3 graf-after--p">App 的 Team 欄位設為付費的 Apple 開發帳號</h3><p name="0d1e" id="0d1e" class="graf graf--p graf-after--h3">付費的 Apple 開發帳號才能開發 Apple 登入功能，因此請切換到 App 的 Signing &amp; Capabilities 分頁，將 Team 欄位設為付費的 Apple 開發帳號。</p><figure name="3986" id="3986" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aNTS3tnP2qWVn7aPiueSmw.png" data-width="2174" data-height="532" src="https://cdn-images-1.medium.com/max/800/1*aNTS3tnP2qWVn7aPiueSmw.png"></figure><h3 name="4096" id="4096" class="graf graf--h3 graf-after--figure">打開 App 的 Sign in with Apple 功能</h3><p name="de9f" id="de9f" class="graf graf--p graf-after--h3">點選 + Capability 新增功能。</p><figure name="0457" id="0457" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_4_RCl40eJ15DZ6SIdP6tA.png" data-width="1394" data-height="512" src="https://cdn-images-1.medium.com/max/800/1*_4_RCl40eJ15DZ6SIdP6tA.png"></figure><p name="1f61" id="1f61" class="graf graf--p graf-after--figure">點選 Sign in with Apple。</p><figure name="ff9b" id="ff9b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TDBisyM2KXYDQwZbZ8RnjQ.png" data-width="1502" data-height="934" src="https://cdn-images-1.medium.com/max/800/1*TDBisyM2KXYDQwZbZ8RnjQ.png"></figure><p name="3e25" id="3e25" class="graf graf--p graf-after--figure">下方生出 Sign in with Apple。</p><figure name="fdd1" id="fdd1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pIaEGI7BBOng3-pD4eTiSg.png" data-width="1766" data-height="744" src="https://cdn-images-1.medium.com/max/800/1*pIaEGI7BBOng3-pD4eTiSg.png"></figure><p name="80fa" id="80fa" class="graf graf--p graf-after--figure">Project navigator 裡多了 Sign in with Apple 需要的 entitlements 檔。</p><figure name="53ce" id="53ce" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*PcbOIB8B3rnGbJRnqbQrqQ.png" data-width="1612" data-height="402" src="https://cdn-images-1.medium.com/max/800/1*PcbOIB8B3rnGbJRnqbQrqQ.png"></figure><h3 name="1d85" id="1d85" class="graf graf--h3 graf-after--figure">加入 Sign In With Apple Button</h3><p name="8193" id="8193" class="graf graf--p graf-after--h3">必須先 import AuthenticationServices 才能使用 SignInWithAppleButton。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="89dc" id="89dc" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> AuthenticationServices<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">SignInWithAppleButton</span> { request <span class="hljs-keyword">in</span><br />            <br />        } onCompletion: { result <span class="hljs-keyword">in</span><br />            <br />        }<br />        .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">80</span>)<br />    }<br />}</span></pre><figure name="7c9f" id="7c9f" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*M2M7ifyKD52gxMKzQkqdjQ.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*M2M7ifyKD52gxMKzQkqdjQ.png"></figure><h3 name="7f53" id="7f53" class="graf graf--h3 graf-after--figure">設定想取得的使用者資料和判斷登入的結果</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="4b66" id="4b66" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> AuthenticationServices<br /><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">SignInWithAppleButton</span> { request <span class="hljs-keyword">in</span><br />            request.requestedScopes <span class="hljs-operator">=</span> [.fullName, .email]<br />        } onCompletion: { result <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">switch</span> result {<br />            <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> authorization):<br />                <span class="hljs-keyword">switch</span> authorization.credential {<br />                <span class="hljs-keyword">case</span> <span class="hljs-keyword">let</span> appleIDCredential <span class="hljs-keyword">as</span> <span class="hljs-type">ASAuthorizationAppleIDCredential</span>:<br />                    <span class="hljs-built_in">print</span>(<br />                        appleIDCredential.fullName,<br />                        appleIDCredential.email,<br />                        appleIDCredential.user<br />                    )<br />                <span class="hljs-keyword">case</span> <span class="hljs-keyword">let</span> passwordCredential <span class="hljs-keyword">as</span> <span class="hljs-type">ASPasswordCredential</span>:<br />                    <span class="hljs-built_in">print</span>(passwordCredential.user, passwordCredential.password)<br />                <span class="hljs-keyword">default</span>:<br />                    <span class="hljs-keyword">break</span><br />                }<br />            <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">let</span> error):<br />                <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;failure&quot;</span>, error)<br />            }<br />        }<br />        .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">80</span>)<br />    }<br />}</span></pre><p name="d148" id="d148" class="graf graf--p graf-after--pre">說明</p><ul class="postList"><li name="9237" id="9237" class="graf graf--li graf-after--p">設定想取得使用者的名字和 email。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3462" id="3462" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content">request.requestedScopes <span class="hljs-operator">=</span> [.fullName, .email]</span></pre><ul class="postList"><li name="4816" id="4816" class="graf graf--li graf-after--pre">判斷登入的結果。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="dd86" id="dd86" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content">} onCompletion: { result <span class="hljs-keyword">in</span><br />    <span class="hljs-keyword">switch</span> result {<br />    <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> authorization):<br />        <span class="hljs-keyword">switch</span> authorization.credential {</span></pre><p name="84fc" id="84fc" class="graf graf--p graf-after--pre">result 的型別是 Result&lt;ASAuthorization, Error&gt;，成功時的 result 為 success，失敗時則是 failure。成功時由 authorization.credential 判斷是用 Apple ID 登入還是利用存在 iCloud Keychain 的帳密登入。</p><p name="1f8d" id="1f8d" class="graf graf--p graf-after--p">當 authorization.credential 的型別是 ASAuthorizationAppleIDCredential 時，表示使用者使用 Apple ID 登入，我們可讀取 fullName，email &amp; user。當 authorization.credential 的型別是 ASPasswordCredential 時，表示使用者使用 iCloud Keychain 的帳密登入。</p><h3 name="1df8" id="1df8" class="graf graf--h3 graf-after--p">從實機或模擬器測試 App</h3><p name="a1e0" id="a1e0" class="graf graf--p graf-after--h3">若要從實機或模擬器測試 App，記得先從設定 App 登入 Apple 帳號。</p><figure name="7fa0" id="7fa0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XZrx2JbVqsXQcTbZgZfxHw.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*XZrx2JbVqsXQcTbZgZfxHw.png"></figure><p name="27aa" id="27aa" class="graf graf--p graf-after--figure">點選 Sign in Manually。</p><figure name="81ec" id="81ec" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*cFXuIB7UNjiyTUiIfNDe6A.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*cFXuIB7UNjiyTUiIfNDe6A.png"></figure><p name="7f06" id="7f06" class="graf graf--p graf-after--figure">輸入 Apple ID 和密碼後點選 Continue。</p><figure name="9dbc" id="9dbc" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AxxVipquHnY532b8Tp1Beg.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*AxxVipquHnY532b8Tp1Beg.png"></figure><p name="6ab5" id="6ab5" class="graf graf--p graf-after--figure">測試 App，點選 Sign in with Apple。</p><figure name="bd45" id="bd45" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xdPB-ocw5rNveTkt5Fum5g.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*xdPB-ocw5rNveTkt5Fum5g.png"></figure><p name="6838" id="6838" class="graf graf--p graf-after--figure">使用者可選擇是否分享 email，並搭配方便的 Face ID 登入。</p><figure name="a3b1" id="a3b1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FddyuangRajMTGypXlJwtw.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*FddyuangRajMTGypXlJwtw.png"></figure><p name="fed2" id="fed2" class="graf graf--p graf-after--figure">從模擬器操作時必須再次輸入密碼，從實機操作時則可用 Face ID 登入。</p><figure name="a792" id="a792" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*G-ALOBwztqTJ746NN5yJCQ.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*G-ALOBwztqTJ746NN5yJCQ.png"></figure><p name="ca56" id="ca56" class="graf graf--p graf-after--figure">登入成功後，從列印的結果可發現 ASAuthorizationAppleIDCredential 的 user 是一串特別的 ID，<code class="markup--code markup--p-code">000590.b8d6248649aa4fab9479658bd6905aaa.1234</code>。通常我們會將此 ID 存起來並傳到後台，用此 ID 辦識使用者。未來使用者用同一個 Apple ID 登入時， ASAuthorizationAppleIDCredential 的 user 都會是一樣的。</p><pre name="cccb" id="cccb" class="graf graf--pre graf-after--p">Optional(givenName: SHIH-YING familyName: PAN ) Optional(&quot;apppeterpan@gmail.com&quot;) 000590.b8d6248649aa4fab9479658bd6905aaa.1234</pre><h3 name="bcd5" id="bcd5" class="graf graf--h3 graf-after--pre">值得注意的，只有第一次登入時能取得名字跟 email，之後重新登入時App 不會再顯示名字 &amp; email 的畫面，也無法取得名字跟 email。因此若想儲存名字跟 email，記得要在第一次取得時上傳到後台。</h3><pre name="fc98" id="fc98" class="graf graf--pre graf-after--h3">Optional() nil 000590.b8d6248649aa4fab9479658bd6905aaa.1234</pre><p name="f0ef" id="f0ef" class="graf graf--p graf-after--pre">通常跟後台 API 串接時，我們會有 register &amp; login API。當 Apple 登入時有拿到 email，我們應該要呼叫 register API，讓後台儲存使用者的名字，email &amp; user id。若是沒有拿到 email，表示已經在後台有帳號了，這時要呼叫的是 login API，所以 login API 可以只有 user id，沒有 email &amp; 名字。</p><figure name="f643" id="f643" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Lpqfga5NljTf1ROEf6J1yg.jpeg" data-width="1540" data-height="870" src="https://cdn-images-1.medium.com/max/800/1*Lpqfga5NljTf1ROEf6J1yg.jpeg"></figure><figure name="1a60" id="1a60" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*_wBEbojQmy4AhqyB23Ol5A.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*_wBEbojQmy4AhqyB23Ol5A.png"></figure><h3 name="f183" id="f183" class="graf graf--h3 graf-after--figure">調整 button 樣式</h3><p name="a144" id="a144" class="graf graf--p graf-after--h3">利用 modifier signInWithAppleButtonStyle 可調整 Apple 登入 button 的樣式，有 black，white &amp; whiteOutline 三種樣式可選擇。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="169e" id="169e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">SignInWithAppleButton</span> { request <span class="hljs-keyword">in</span><br />                <br />            } onCompletion: { result <span class="hljs-keyword">in</span><br />                <br />            }<br />            .signInWithAppleButtonStyle(.black)<br />            .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">80</span>)<br />            <br />            <span class="hljs-type">SignInWithAppleButton</span> { request <span class="hljs-keyword">in</span><br />                <br />            } onCompletion: { result <span class="hljs-keyword">in</span><br />                <br />            }<br />            .signInWithAppleButtonStyle(.white)<br />            .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">80</span>)<br />            <br />            <span class="hljs-type">SignInWithAppleButton</span> { request <span class="hljs-keyword">in</span><br />                <br />            } onCompletion: { result <span class="hljs-keyword">in</span><br />                <br />            }<br />            .signInWithAppleButtonStyle(.whiteOutline)<br />            .frame(width: <span class="hljs-number">200</span>, height: <span class="hljs-number">80</span>)<br />        }<br />    }<br />}</span></pre><figure name="8f2b" id="8f2b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*U3-iCbUVUFdQ5mxMakO0yA.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*U3-iCbUVUFdQ5mxMakO0yA.png"></figure><h3 name="1b23" id="1b23" class="graf graf--h3 graf-after--figure">檢查是否已用 Apple ID 登入 App</h3><p name="7037" id="7037" class="graf graf--p graf-after--h3">想在 App 啟動時檢查是否之前已用 Apple ID 登入 App，可用 ASAuthorizationAppleIDProvider 物件呼叫 getCredentialState，傳入當初登入成功儲存的 user ID，若 credentialState 為 authorized 表示已登入。</p><p name="ba25" id="ba25" class="graf graf--p graf-after--p">ps: 此功能必須從實機操作才能檢查到已登入的狀態。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c389" id="c389" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> appleIDProvider <span class="hljs-operator">=</span> <span class="hljs-type">ASAuthorizationAppleIDProvider</span>()<br />appleIDProvider.getCredentialState(forUserID: <span class="hljs-string">&quot;000590.b8d6248649aa4fab9479658bd6905aaa.1234&quot;</span>) { credentialState, error <span class="hljs-keyword">in</span><br />   <span class="hljs-keyword">switch</span> credentialState {<br />   <span class="hljs-keyword">case</span> .authorized:<br />       <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;已登入&quot;</span>)<br />   <span class="hljs-keyword">case</span> .notFound, .revoked:<br />       <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;須重新登入&quot;</span>)<br />   <span class="hljs-keyword">default</span>:<br />       <span class="hljs-keyword">break</span><br />   }<br />}</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/1568fe2bcb0b"><time class="dt-published" datetime="2020-07-21T07:58:01.468Z">July 21, 2020</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E4%BD%BF%E7%94%A8-swiftui-%E7%9A%84-signinwithapplebutton-%E5%AF%A6%E7%8F%BE-apple-%E7%99%BB%E5%85%A5-1568fe2bcb0b" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>