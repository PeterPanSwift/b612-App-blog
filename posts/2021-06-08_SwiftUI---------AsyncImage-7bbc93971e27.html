<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>SwiftUI 顯示網路圖片的 AsyncImage</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">SwiftUI 顯示網路圖片的 AsyncImage</h1>
</header>
<section data-field="subtitle" class="p-summary">
從 iOS 15 開始，SwiftUI 終於推出顯示網路圖片的元件了，AsyncImage。
</section>
<section data-field="body" class="e-content">
<section name="56ec" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="fd68" id="fd68" class="graf graf--h3 graf--leading graf--title">SwiftUI 顯示網路圖片的 AsyncImage</h3><p name="c45b" id="c45b" class="graf graf--p graf-after--h3">從 iOS 15 開始，SwiftUI 終於推出顯示網路圖片的元件了，AsyncImage。</p><h3 name="f79a" id="f79a" class="graf graf--h3 graf-after--p">顯示網路上的圖片</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="06f7" id="06f7" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>))<br />    }<br />}</span></pre><div name="ee91" id="ee91" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/swiftui/asyncimage" data-href="https://developer.apple.com/documentation/swiftui/asyncimage" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swiftui/asyncimage"><strong class="markup--strong markup--mixtapeEmbed-strong">AsyncImage | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">A view that asynchronously loads and displays an image.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swiftui/asyncimage" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f2e6cc0c3507dd4379b23497d31cbe5e" data-thumbnail-img-id="0*1_rsQSXPSAMs_kVd" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*1_rsQSXPSAMs_kVd);"></a></div><p name="f45d" id="f45d" class="graf graf--p graf-after--mixtapeEmbed">生成 AsyncImage 時，我們可以傳入圖片的 url，它將自動幫我們抓取網路上的圖片顯示。</p><p name="2016" id="2016" class="graf graf--p graf-after--p">由於網路抓圖需要時間，所以 AsyncImage 還沒抓到圖時將顯示灰色， 抓到圖時再顯示抓到的圖片。</p><figure name="9ba7" id="9ba7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UyCFidqyvkDESWBvU0qv0A.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*UyCFidqyvkDESWBvU0qv0A.png"></figure><h3 name="0458" id="0458" class="graf graf--h3 graf-after--figure">調整圖片的大小</h3><p name="925b" id="925b" class="graf graf--p graf-after--h3">不過以上寫法圖片將顯示原圖的大小，比較難調整大小，因為 AsyncImage 不像 Image 有改變大小的 modifier resizable。若想調整大小，可改成以下寫法。</p><figure name="0ac4" id="0ac4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4Re2Pvfo93YaGXh-MwiwWQ.png" data-width="1048" data-height="114" src="https://cdn-images-1.medium.com/max/800/1*4Re2Pvfo93YaGXh-MwiwWQ.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="8e94" id="8e94" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>)) { image <span class="hljs-keyword">in</span><br />            image<br />               .resizable()<br />        } placeholder: {<br />            <span class="hljs-type">ProgressView</span>()<br />        }<br />        .scaledToFill()<br />        .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />        .clipShape(.circle)<br />    }<br />}</span></pre><p name="89f6" id="89f6" class="graf graf--p graf-after--pre">生成 AsyncImage 時使用以下的 init。成功抓到圖時，從參數 content 可得到 Image，因此我們可顯示 Image，並呼叫 resizable 改變大小，還沒抓到圖時則會顯示參數 placeholder 的內容，在此我們顯示 ProgressView。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="4899" id="4899" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init</span>&lt;<span class="hljs-type">I</span>, <span class="hljs-type">P</span>&gt;(<span class="hljs-params">url</span>: <span class="hljs-type">URL</span>?, <span class="hljs-params">scale</span>: <span class="hljs-type">CGFloat</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, <span class="hljs-params">content</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">Image</span>) -&gt; <span class="hljs-type">I</span>, <span class="hljs-params">placeholder</span>: <span class="hljs-keyword">@escaping</span> () -&gt; <span class="hljs-type">P</span>) <span class="hljs-keyword">where</span> <span class="hljs-type">Content</span> <span class="hljs-operator">==</span> _ConditionalContent<span class="hljs-operator">&lt;</span><span class="hljs-type">I</span>, <span class="hljs-type">P</span><span class="hljs-operator">&gt;</span>, <span class="hljs-type">I</span> : <span class="hljs-type">View</span>, <span class="hljs-type">P</span> : <span class="hljs-type">View</span></span></pre><div name="5d23" id="5d23" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/swiftui/asyncimage/init%28url:scale:content:placeholder:%29" data-href="https://developer.apple.com/documentation/swiftui/asyncimage/init(url:scale:content:placeholder:)" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swiftui/asyncimage/init(url:scale:content:placeholder:)"><strong class="markup--strong markup--mixtapeEmbed-strong">init(url:scale:content:placeholder:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Loads and displays a modifiable image from the specified URL using a custom placeholder until the image loads.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swiftui/asyncimage/init%28url:scale:content:placeholder:%29" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="735d757ee0a27d79af1fb775dffc8e7b" data-thumbnail-img-id="0*UljAJVgLnEJJUR9W" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*UljAJVgLnEJJUR9W);"></a></div><figure name="a8e1" id="a8e1" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*u0ncVbUTSYWytQkL4FOjkg.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*u0ncVbUTSYWytQkL4FOjkg.png"><figcaption class="imageCaption">正在抓圖時顯示 ProgressView</figcaption></figure><figure name="e8be" id="e8be" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*oKlZeHzpOnp19UShYy_ANQ.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*oKlZeHzpOnp19UShYy_ANQ.png"><figcaption class="imageCaption">顯示抓到的圖片</figcaption></figure><h3 name="cf7e" id="cf7e" class="graf graf--h3 graf-after--figure">依據下載結果顯示不同的內容</h3><p name="7370" id="7370" class="graf graf--p graf-after--h3">我們也可以依據下載結果顯示不同的內容。以下程式利用參數 phase 判斷下載結果，下載失敗時顯示問號圖片。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e642" id="e642" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>)) { phase <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> phase.image {<br />                image<br />                    .resizable()<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> phase.error <span class="hljs-operator">!=</span> <span class="hljs-literal">nil</span> {<br />                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;questionmark.circle.fill&quot;</span>)<br />                    .resizable()<br />            } <span class="hljs-keyword">else</span> {<br />                <span class="hljs-type">Color</span>.gray<br />            }<br />        }<br />        .scaledToFill()<br />        .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />        .clipShape(.circle)<br />    }<br />}</span></pre><p name="e4fa" id="e4fa" class="graf graf--p graf-after--pre">生成 AsyncImage 時使用以下的 init，從型別 AsyncImagePhase 的參數可得知下載的狀態。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b006" id="b006" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init</span>(<span class="hljs-params">url</span>: <span class="hljs-type">URL</span>?, <span class="hljs-params">scale</span>: <span class="hljs-type">CGFloat</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>, <span class="hljs-params">transaction</span>: <span class="hljs-type">Transaction</span> <span class="hljs-operator">=</span> <span class="hljs-type">Transaction</span>(), <span class="hljs-params">content</span>: <span class="hljs-keyword">@escaping</span> (<span class="hljs-type">AsyncImagePhase</span>) -&gt; <span class="hljs-type">Content</span>)</span></pre><div name="cd5d" id="cd5d" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/swiftui/asyncimage/init%28url:scale:transaction:content:%29" data-href="https://developer.apple.com/documentation/swiftui/asyncimage/init(url:scale:transaction:content:)" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swiftui/asyncimage/init(url:scale:transaction:content:)"><strong class="markup--strong markup--mixtapeEmbed-strong">init(url:scale:transaction:content:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Loads and displays a modifiable image from the specified URL in phases.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swiftui/asyncimage/init%28url:scale:transaction:content:%29" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d24b1ad728b3b6c1b34e8cd187e9fe5b" data-thumbnail-img-id="0*-3rL70KkrvDXVa5b" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*-3rL70KkrvDXVa5b);"></a></div><p name="008c" id="008c" class="graf graf--p graf-after--mixtapeEmbed">將網路關掉，下載失敗時將顯示問號圖片。</p><figure name="bd5f" id="bd5f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*btEOVp0S6itOoVWkTuEvUA.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*btEOVp0S6itOoVWkTuEvUA.png"></figure><p name="add4" id="add4" class="graf graf--p graf-after--figure">型別 AsyncImagePhase 是 enum，所以剛剛的程式也可以用另一個寫法，使用 switch 判斷圖片下載的狀態。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3835" id="3835" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>)) { phase <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">switch</span> phase {<br />            <span class="hljs-keyword">case</span> .empty:<br />                <span class="hljs-type">Color</span>.gray<br />            <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> image):<br />                image<br />                    .resizable()<br />            <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">_</span>):<br />                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;questionmark.circle.fill&quot;</span>)<br />                    .resizable()<br />            <span class="hljs-keyword">@unknown</span> <span class="hljs-keyword">default</span>:<br />                <span class="hljs-type">Color</span>.gray<br />            }<br />        }<br />        .scaledToFill()<br />        .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />        .clipShape(.circle)<br />        <br />    }<br />}</span></pre><h3 name="0c4a" id="0c4a" class="graf graf--h3 graf-after--pre">動畫顯示圖片</h3><p name="db7d" id="db7d" class="graf graf--p graf-after--h3">生成 AsyncImage 時，我們還可以傳入參數 transaction 設定動畫的速度，預設圖片將以淡入動畫呈現。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="11c2" id="11c2" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>), transaction: <span class="hljs-type">Transaction</span>(animation: .easeInOut(duration: <span class="hljs-number">3</span>))) { phase <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">switch</span> phase {<br />            <span class="hljs-keyword">case</span> .empty:<br />                <span class="hljs-type">Color</span>.gray<br />            <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> image):<br />                image<br />                    .resizable()<br />            <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">_</span>):<br />                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;questionmark.circle.fill&quot;</span>)<br />                    .resizable()<br />            <span class="hljs-keyword">@unknown</span> <span class="hljs-keyword">default</span>:<br />                <span class="hljs-type">Color</span>.gray<br />            }<br />        }<br />        .scaledToFill()<br />        .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />        .clipShape(.circle)<br />    }<br />}</span></pre><p name="1a31" id="1a31" class="graf graf--p graf-after--pre">我們也可以在不同的 phase 呼叫 transition 設定顯示時的動畫效果，比方以下例子<code class="markup--code markup--p-code"> .transition(.scale) </code>將產生縮放的動畫， <code class="markup--code markup--p-code">.transition(.move(edge: .bottom))</code> 將產生往下移動的動畫。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9b9e" id="9b9e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <br />        <span class="hljs-type">AsyncImage</span>(url: <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://images-na.ssl-images-amazon.com/images/I/61+JNEBd6HL.jpg&quot;</span>), transaction: <span class="hljs-type">Transaction</span>(animation: .easeInOut(duration: <span class="hljs-number">3</span>))) { phase <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">switch</span> phase {<br />            <span class="hljs-keyword">case</span> .empty:<br />                <span class="hljs-type">Color</span>.gray<br />                    .transition(.move(edge: .bottom))<br />            <span class="hljs-keyword">case</span> .success(<span class="hljs-keyword">let</span> image):<br />                image<br />                    .resizable()<br />                    .transition(.scale)<br />            <span class="hljs-keyword">case</span> .failure(<span class="hljs-keyword">_</span>):<br />                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;questionmark.circle.fill&quot;</span>)<br />                    .resizable()<br />            <span class="hljs-keyword">@unknown</span> <span class="hljs-keyword">default</span>:<br />                <span class="hljs-type">Color</span>.gray<br />            }<br />        }<br />        .scaledToFill()<br />        .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />        .clipShape(.circle)<br />    }<br />}</span></pre><h3 name="dbf5" id="dbf5" class="graf graf--h3 graf-after--pre">參考連結</h3><p name="09e1" id="09e1" class="graf graf--p graf-after--h3"><strong class="markup--strong markup--p-strong">WWDC: What’s new in SwiftUI</strong></p><div name="3457" id="3457" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://developer.apple.com/videos/play/wwdc2021/10018/" data-href="https://developer.apple.com/videos/play/wwdc2021/10018/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/videos/play/wwdc2021/10018/"><strong class="markup--strong markup--mixtapeEmbed-strong">What&#39;s new in SwiftUI - WWDC 2021 - Videos - Apple Developer</strong><br><em class="markup--em markup--mixtapeEmbed-em">There&#39;s never been a better time to develop your apps with SwiftUI. Discover the latest updates to the UI framework …</em>developer.apple.com</a><a href="https://developer.apple.com/videos/play/wwdc2021/10018/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d19ac0a7b713377b64b30eaf33e1879a" data-thumbnail-img-id="0*qsEBASxx2kxzmxUH" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*qsEBASxx2kxzmxUH);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/7bbc93971e27"><time class="dt-published" datetime="2021-06-08T08:08:57.769Z">June 8, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swiftui-%E9%A1%AF%E7%A4%BA%E7%B6%B2%E8%B7%AF%E5%9C%96%E7%89%87%E7%9A%84-asyncimage-7bbc93971e27" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>