<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>設定 collection view section header / footer(supplementary view)的各種方法</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">設定 collection view section header / footer(supplementary view)的各種方法</h1>
</header>
<section data-field="subtitle" class="p-summary">
使用 collection view 呈現畫面時，除了用一個個 cell 顯示資料，我們也可以添加 section header / footer(supplementary view)，將畫面做一些分類。如下圖所示，第一個 Section 顯示角色清單，section…
</section>
<section data-field="body" class="e-content">
<section name="5a93" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="a12a" id="a12a" class="graf graf--h3 graf--leading graf--title">設定 collection view section header / footer(supplementary view)的各種方法</h3><p name="5b19" id="5b19" class="graf graf--p graf-after--h3">使用 collection view 呈現畫面時，除了用一個個 cell 顯示資料，我們也可以添加 section header / footer(supplementary view)，將畫面做一些分類。如下圖所示，第一個 Section 顯示角色清單，section header 顯示 Characters。第二個 Section 顯示項目清單，section header 顯示 Items。</p><figure name="06fa" id="06fa" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_AjqvvVc86cRKD1neUYM9A.png" data-width="1544" data-height="908" src="https://cdn-images-1.medium.com/max/800/1*_AjqvvVc86cRKD1neUYM9A.png"></figure><div name="cdd1" id="cdd1" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://developer.apple.com/documentation/uikit/uicollectionview" data-href="https://developer.apple.com/documentation/uikit/uicollectionview" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uicollectionview"><strong class="markup--strong markup--mixtapeEmbed-strong">Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uicollectionview" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="95fbf21a95233a17226e2d349c28e48c"></a></div><p name="f09a" id="f09a" class="graf graf--p graf-after--mixtapeEmbed">接下來我們將學習如何在 collection view 加入 section header / footer，包含以下幾點的比較:</p><p name="3ada" id="3ada" class="graf graf--p graf-after--p">1. 從 storyboard，xib 或程式設計 header。</p><p name="84e8" id="84e8" class="graf graf--p graf-after--p">2. compositional layout &amp; flow layout。</p><p name="3549" id="3549" class="graf graf--p graf-after--p">3. UICollectionViewDiffableDataSource。</p><h3 name="0eac" id="0eac" class="graf graf--h3 graf-after--p">設計 header / footer 畫面</h3><h4 name="4ed9" id="4ed9" class="graf graf--h4 graf-after--h3">方法 1: 從 storyboard 設計</h4><p name="f873" id="f873" class="graf graf--p graf-after--h4">點選 collection view，勾選 Accessories 的 Section Header / Section Footer。值得注意的，此方法只能設計一個 header，若有多個 section，需要搭配不同的 header，則須使用其它兩個方法。</p><figure name="9552" id="9552" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*92KThyCI9xu6IJe7n2_fRQ.png" data-width="524" data-height="342" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*92KThyCI9xu6IJe7n2_fRQ.png"></figure><p name="8140" id="8140" class="graf graf--p graf-after--figure">勾選 Section Header 後，collection view 下長出 Collection Reusable View。</p><figure name="b5f6" id="b5f6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Mn-oBgw2Jv89qj7ekQPneg.png" data-width="1278" data-height="1296" src="https://cdn-images-1.medium.com/max/800/1*Mn-oBgw2Jv89qj7ekQPneg.png"></figure><p name="cd1b" id="cd1b" class="graf graf--p graf-after--figure">此時我們可以開始設計 header，比方調整它的高度和顏色，加入顯示文字的 label。</p><figure name="cc8c" id="cc8c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*anWUBojyRYo2xL4SjEkKJw.png" data-width="1116" data-height="412" src="https://cdn-images-1.medium.com/max/800/1*anWUBojyRYo2xL4SjEkKJw.png"></figure><p name="3d41" id="3d41" class="graf graf--p graf-after--figure">設定 Collection Reusable View 的 Reuse Identifier，在此我們輸入 Header。</p><figure name="c163" id="c163" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*zbiHoW2qRdykUqrzpQQteA.png" data-width="530" data-height="204" src="https://cdn-images-1.medium.com/max/800/1*zbiHoW2qRdykUqrzpQQteA.png"></figure><p name="9fdf" id="9fdf" class="graf graf--p graf-after--figure">新增繼承 UICollectionReusableView 的類別 HeaderView，將 Collection Reusable View 的 Class 設為 HeaderView，然後連結 label 的 outlet。</p><figure name="1cbd" id="1cbd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*uPSEf5rwXmYVEpZs20dYVg.png" data-width="522" data-height="254" src="https://cdn-images-1.medium.com/max/800/1*uPSEf5rwXmYVEpZs20dYVg.png"></figure><figure name="112f" id="112f" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*fXIfDpemJwJCIN7FxEne4g.png" data-width="522" data-height="270" src="https://cdn-images-1.medium.com/max/800/1*fXIfDpemJwJCIN7FxEne4g.png"></figure><pre name="11f9" id="11f9" class="graf graf--pre graf-after--figure">import UIKit</pre><pre name="71f4" id="71f4" class="graf graf--pre graf-after--pre">class HeaderView: UICollectionReusableView {<br>        <br>    <a href="http://twitter.com/IBOutlet" data-href="http://twitter.com/IBOutlet" class="markup--anchor markup--pre-anchor" title="Twitter profile for @IBOutlet" rel="noopener" target="_blank">@IBOutlet</a> weak var label: UILabel!<br>}</pre><h4 name="57c6" id="57c6" class="graf graf--h4 graf-after--pre">方法 2: 從 xib 設計</h4><p name="ccfa" id="ccfa" class="graf graf--p graf-after--h4">從 HeaderView.xib 設計 header 畫面，搭配繼承 UICollectionReusableView 的類別 HeaderView。</p><figure name="5c36" id="5c36" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hkT6nJ8ZoxC61tu1qxT3TA.png" data-width="2796" data-height="924" src="https://cdn-images-1.medium.com/max/800/1*hkT6nJ8ZoxC61tu1qxT3TA.png"></figure><p name="0cd3" id="0cd3" class="graf graf--p graf-after--figure">從 collection view 呼叫 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">register(_:forSupplementaryViewOfKind:withReuseIdentifier:)</strong></code> 註冊 header 的 id，指定 id 為 Header，到時候 collection view 將透過 id Header 產生 HeaderView。</p><pre name="08da" id="08da" class="graf graf--pre graf-after--p">override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br><strong class="markup--strong markup--pre-strong">        collectionView.register(UINib(nibName: &quot;HeaderView&quot;, bundle: nil), forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader, withReuseIdentifier: &quot;Header&quot;)</strong></pre><h4 name="1424" id="1424" class="graf graf--h4 graf-after--pre">方法 3: 從程式設計</h4><p name="cb2f" id="cb2f" class="graf graf--p graf-after--h4">新增繼承 UICollectionReusableView 的類別 HeaderView，在類別裡設計畫面。</p><pre name="ebb8" id="ebb8" class="graf graf--pre graf-after--p">class HeaderView: UICollectionReusableView {<br>        <br>    let label: UILabel = {<br>        let label = UILabel()<br>        label.translatesAutoresizingMaskIntoConstraints = false<br>        label.font = .systemFont(ofSize: 23)<br>        label.textAlignment = .center<br>        label.backgroundColor = .systemYellow<br>        return label<br>    }()<br>    <br>    override init(frame: CGRect) {<br>        super.init(frame: frame)<br>        <br>        backgroundColor = .systemTeal<br>        addSubview(label)<br>        NSLayoutConstraint.activate([<br>            label.leadingAnchor.constraint(equalTo: leadingAnchor, constant: 10),<br>            label.trailingAnchor.constraint(equalTo: trailingAnchor, constant: -10),<br>            label.topAnchor.constraint(equalTo: topAnchor, constant: 10),<br>            label.bottomAnchor.constraint(equalTo: bottomAnchor, constant: -10),<br>        ])<br>    }<br>    <br>    required init?(coder: NSCoder) {<br>        fatalError(&quot;init(coder:) has not been implemented&quot;)<br>    }<br>}</pre><p name="fb2f" id="fb2f" class="graf graf--p graf-after--pre">從程式設定 auto layout 還有其它的寫法，有興趣的朋友也可以參考以下連結。</p><p name="5c75" id="5c75" class="graf graf--p graf-after--p"><a href="https://cutt.ly/1WyHhIr" data-href="https://cutt.ly/1WyHhIr" class="markup--anchor markup--p-anchor" rel="nofollow noopener noopener noopener" target="_blank">https://cutt.ly/1WyHhIr</a></p><p name="bb37" id="bb37" class="graf graf--p graf-after--p">從 collection view 呼叫 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">register(_:forSupplementaryViewOfKind:withReuseIdentifier:) </strong></code>註冊 header 的 id，指定 id 為 Header，到時候 collection view 將透過 id Header 產生 HeaderView。</p><pre name="93c1" id="93c1" class="graf graf--pre graf-after--p graf--trailing">override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br><strong class="markup--strong markup--pre-strong">        collectionView.register(HeaderView.self, forSupplementaryViewOfKind: UICollectionView.elementKindSectionHeader, withReuseIdentifier: &quot;Header&quot;)</strong></pre></div></div></section><section name="a788" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c40a" id="c40a" class="graf graf--h3 graf--leading">定義 UICollectionViewDataSource 回傳 header / footer 的 function</h3><p name="6d8c" id="6d8c" class="graf graf--p graf-after--h3">定義 collectionView(_:viewForSupplementaryElementOfKind:at:)，在 function 裡產生 header view 回傳。</p><pre name="2f23" id="2f23" class="graf graf--pre graf-after--p graf--trailing">override func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -&gt; UICollectionReusableView {<br>        let headerView = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: &quot;Header&quot;, for: indexPath) as! HeaderView<br>        headerView.label.text = &quot;可愛的小王子\(indexPath.section)&quot;<br>        return headerView<br>}</pre></div></div></section><section name="c0e3" class="section section--body"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7b6a" id="7b6a" class="graf graf--h3 graf--leading">設定 header / footer 的 size</h3><p name="cce5" id="cce5" class="graf graf--p graf-after--h3">依據 layout 採用 compositional layout 或 flow layout，有兩種不同的做法。</p><h4 name="6bac" id="6bac" class="graf graf--h4 graf-after--p">compositional layout</h4><p name="f582" id="f582" class="graf graf--p graf-after--h4">生成 NSCollectionLayoutBoundarySupplementaryItem 時指定 header 的 size &amp; 位置，然後設定 section 的 boundarySupplementaryItems。</p><pre name="c2cf" id="c2cf" class="graf graf--pre graf-after--p">func generateLayout() -&gt; UICollectionViewLayout {<br>        let fraction: CGFloat = 1 / 3<br>        let itemSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(fraction), heightDimension: .fractionalHeight(1))<br>        let item = NSCollectionLayoutItem(layoutSize: itemSize)<br>        let groupSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .fractionalWidth(fraction))<br>        let group = NSCollectionLayoutGroup.horizontal(layoutSize: groupSize, subitems: [item])<br>        <br>        let section = NSCollectionLayoutSection(group: group)<br>        <strong class="markup--strong markup--pre-strong">let headerSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .absolute(100))<br>        let header = NSCollectionLayoutBoundarySupplementaryItem(layoutSize: headerSize, elementKind: UICollectionView.elementKindSectionHeader, alignment: .top)<br>        section.boundarySupplementaryItems = [header]</strong><br>        let layout = UICollectionViewCompositionalLayout(section: section)<br>        return layout<br>}</pre><h4 name="cb42" id="cb42" class="graf graf--h4 graf-after--pre">flow layout</h4><p name="1e1b" id="1e1b" class="graf graf--p graf-after--h4">若是從 storyboard 設計 header，collection view 的 Header Size 即為它的高度。</p><figure name="617b" id="617b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Rk1iHBEV4QomEUHWjQ1Y-Q.png" data-width="532" data-height="334" src="https://cdn-images-1.medium.com/max/800/1*Rk1iHBEV4QomEUHWjQ1Y-Q.png"></figure><p name="433d" id="433d" class="graf graf--p graf-after--figure">若是從 xib 或程式設計 header，則須透過 UICollectionViewFlowLayout 的 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">headerReferenceSize</strong></code> 設定高度。在此 header 寬度將等於 collection view 的寬度，所以 width 可以傳 0。</p><pre name="5276" id="5276" class="graf graf--pre graf-after--p graf--trailing">func configureCellSize() {<br>        let itemSpace: CGFloat = 3<br>        let columnCount: CGFloat = 3<br>        <br>        let flowLayout = collectionViewLayout as? UICollectionViewFlowLayout<br>        let width = floor((collectionView.bounds.width - itemSpace * (columnCount-1)) / columnCount)<br>        flowLayout?.itemSize = CGSize(width: width, height: width)<br>        flowLayout?.estimatedItemSize = .zero<br>        flowLayout?.minimumInteritemSpacing = itemSpace<br>        flowLayout?.minimumLineSpacing = itemSpace<br><strong class="markup--strong markup--pre-strong">        flowLayout?.headerReferenceSize = CGSize(width: 0, height: 100)<br></strong>}</pre></div></div></section><section name="cfc0" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6bc9" id="6bc9" class="graf graf--h3 graf--leading">view controller 的完整程式</h3><h3 name="eb42" id="eb42" class="graf graf--h3 graf-after--h3">compositional layout</h3><pre name="cfd8" id="cfd8" class="graf graf--pre graf-after--h3">import UIKit</pre><pre name="6712" id="6712" class="graf graf--pre graf-after--pre">class PrinceCollectionViewController: UICollectionViewController {<br>    <br>    <br>    func generateLayout() -&gt; UICollectionViewLayout {<br>        let fraction: CGFloat = 1 / 3<br>        let itemSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(fraction), heightDimension: .fractionalHeight(1))<br>        let item = NSCollectionLayoutItem(layoutSize: itemSize)<br>        let groupSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .fractionalWidth(fraction))<br>        let group = NSCollectionLayoutGroup.horizontal(layoutSize: groupSize, subitems: [item])<br>        <br>        let section = NSCollectionLayoutSection(group: group)<br>        let headerSize = NSCollectionLayoutSize(widthDimension: .fractionalWidth(1), heightDimension: .absolute(100))<br>        let header = NSCollectionLayoutBoundarySupplementaryItem(layoutSize: headerSize, elementKind: UICollectionView.elementKindSectionHeader, alignment: .top)<br>        section.boundarySupplementaryItems = [header]<br>        let layout = UICollectionViewCompositionalLayout(section: section)<br>        return layout<br>    }</pre><pre name="4fcf" id="4fcf" class="graf graf--pre graf-after--pre">    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br>        collectionView.collectionViewLayout = generateLayout()</pre><pre name="b1ba" id="b1ba" class="graf graf--pre graf-after--pre">　　　　　// 若 header 是從程式或 xib 設計，記得呼叫 collection view 的 register 註冊 header 的 id<br>    <br>    }<br>    <br>    <br>    // MARK: UICollectionViewDataSource<br>        <br>    override func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -&gt; UICollectionReusableView {<br>        let headerView = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: &quot;Header&quot;, for: indexPath) as! HeaderView<br>        headerView.label.text = &quot;可愛的小王子\(indexPath.section)&quot;<br>        return headerView<br>    }<br>    <br>    override func numberOfSections(in collectionView: UICollectionView) -&gt; Int {<br>        return 4<br>    }<br>    <br>    <br>    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {<br>        return 5<br>    }<br>    <br>    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell {<br>        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: &quot;\(PrinceCollectionViewCell.self)&quot;, for: indexPath) as! PrinceCollectionViewCell<br>        <br>        let index = indexPath.section * 5 + indexPath.item<br>        cell.imageView.image = UIImage(named: &quot;pic\(index)&quot;)<br>        return cell<br>    }<br>    <br>}</pre><figure name="5785" id="5785" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*pcE5SsBAxZKh3IJ3A10cFQ.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*pcE5SsBAxZKh3IJ3A10cFQ.png"></figure><h3 name="b5bb" id="b5bb" class="graf graf--h3 graf-after--figure">flow layout</h3><pre name="e895" id="e895" class="graf graf--pre graf-after--h3">import UIKit</pre><pre name="f351" id="f351" class="graf graf--pre graf-after--pre">class PrinceCollectionViewController: UICollectionViewController {<br>    <br>    func configureCellSize() {<br>        let itemSpace: CGFloat = 3<br>        let columnCount: CGFloat = 3<br>        <br>        let flowLayout = collectionViewLayout as? UICollectionViewFlowLayout<br>        let width = floor((collectionView.bounds.width - itemSpace * (columnCount-1)) / columnCount)<br>        flowLayout?.itemSize = CGSize(width: width, height: width)<br>        flowLayout?.estimatedItemSize = .zero<br>        flowLayout?.minimumInteritemSpacing = itemSpace<br>        flowLayout?.minimumLineSpacing = itemSpace<br>        flowLayout?.headerReferenceSize = CGSize(width: 0, height: 100)</pre><pre name="5736" id="5736" class="graf graf--pre graf-after--pre">　　　　　// 若是從 xib 或程式設計 header，則須透過 UICollectionViewFlowLayout 的 headerReferenceSize 設定高度</pre><pre name="bf57" id="bf57" class="graf graf--pre graf-after--pre">   }<br>    <br>    <br>    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br>        configureCellSize()<br>        // 若是從 xib 或程式設計 header，則須呼叫 collection view 的 register 註冊 header id<br>      <br>    }<br>    <br>    // MARK: UICollectionViewDataSource<br>    <br>    override func collectionView(_ collectionView: UICollectionView, viewForSupplementaryElementOfKind kind: String, at indexPath: IndexPath) -&gt; UICollectionReusableView {<br>        let headerView = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: &quot;Header&quot;, for: indexPath) as! HeaderView<br>        headerView.label.text = &quot;可愛的小王子\(indexPath.section)&quot;<br>        return headerView<br>    }<br>    <br>    override func numberOfSections(in collectionView: UICollectionView) -&gt; Int {<br>        return 4<br>    }<br>    <br>    <br>    override func collectionView(_ collectionView: UICollectionView, numberOfItemsInSection section: Int) -&gt; Int {<br>        return 5<br>    }<br>    <br>    override func collectionView(_ collectionView: UICollectionView, cellForItemAt indexPath: IndexPath) -&gt; UICollectionViewCell {<br>        let cell = collectionView.dequeueReusableCell(withReuseIdentifier: &quot;\(PrinceCollectionViewCell.self)&quot;, for: indexPath) as! PrinceCollectionViewCell<br>        <br>        let index = indexPath.section * 5 + indexPath.item<br>        cell.imageView.image = UIImage(named: &quot;pic\(index)&quot;)<br>        return cell<br>    }    <br>}</pre><figure name="f22e" id="f22e" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*Sdu6vZWcCiiQFCXZqzibhQ.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*Sdu6vZWcCiiQFCXZqzibhQ.png"></figure><h3 name="25ad" id="25ad" class="graf graf--h3 graf-after--figure">One more thing，UICollectionViewDiffableDataSource</h3><p name="c110" id="c110" class="graf graf--p graf-after--h3">若是使用 UICollectionViewDiffableDataSource 當 collection view 的 data source，則要透過 supplementaryViewProvider 設定 section header / footer，比方以下例子。</p><pre name="aefa" id="aefa" class="graf graf--pre graf-after--p">import UIKit</pre><pre name="0ce9" id="0ce9" class="graf graf--pre graf-after--pre">class PrinceCollectionViewController: UICollectionViewController {<br>    <br>    func configureCellSize() {<br>        let itemSpace: CGFloat = 3<br>        let columnCount: CGFloat = 3<br>        <br>        let flowLayout = collectionViewLayout as? UICollectionViewFlowLayout<br>        let width = floor((collectionView.bounds.width - itemSpace * (columnCount-1)) / columnCount)<br>        flowLayout?.itemSize = CGSize(width: width, height: width)<br>        flowLayout?.estimatedItemSize = .zero<br>        flowLayout?.minimumInteritemSpacing = itemSpace<br>        flowLayout?.minimumLineSpacing = itemSpace<br>        <br>        // 若是從 xib 或程式設計 header，則須透過 UICollectionViewFlowLayout 的 headerReferenceSize 設定高度<br>    }<br>    <br>    <br>    var dataSource: UICollectionViewDiffableDataSource&lt;Int, Int&gt;!<br>    <br>    func createDataSource() {<br>        dataSource = UICollectionViewDiffableDataSource&lt;Int, Int&gt;(collectionView: collectionView, cellProvider: { collectionView, indexPath, itemIdentifier in<br>            let cell = collectionView.dequeueReusableCell(withReuseIdentifier: &quot;\(PrinceCollectionViewCell.self)&quot;, for: indexPath) as! PrinceCollectionViewCell<br>            let index = indexPath.section * 5 + indexPath.item<br>            cell.imageView.image = UIImage(named: &quot;pic\(index)&quot;)<br>            return cell<br>        })<br>        <br>       <strong class="markup--strong markup--pre-strong"> dataSource.supplementaryViewProvider = { collectionView, kind, indexPath in<br>            let headerView = collectionView.dequeueReusableSupplementaryView(ofKind: kind, withReuseIdentifier: &quot;Header&quot;, for: indexPath) as! HeaderView<br>            headerView.label.text = &quot;可愛的小王子\(indexPath.section)&quot;<br>            return headerView<br>        }</strong><br>        <br>        <br>    }<br>    <br>    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br>        configureCellSize()<br>        // 若是從 xib 或程式設計 header，則須呼叫 collection view 的 register 註冊 header id</pre><pre name="6e95" id="6e95" class="graf graf--pre graf-after--pre graf--trailing">        createDataSource()<br>        var snapshot = NSDiffableDataSourceSnapshot&lt;Int, Int&gt;()<br>        for i in 0...3 {<br>            snapshot.appendSections([i])<br>            let number = 5 * i<br>            snapshot.appendItems(Array(number...number+4))<br>        }<br>        dataSource.apply(snapshot, animatingDifferences: false)<br>        <br>    }<br>    <br>}</pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/f4437caf173b"><time class="dt-published" datetime="2021-08-18T09:52:09.218Z">August 18, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E8%A8%AD%E5%AE%9A-collection-view-section-header-footer-supplementary-view-%E7%9A%84%E5%90%84%E7%A8%AE%E6%96%B9%E6%B3%95-f4437caf173b" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>