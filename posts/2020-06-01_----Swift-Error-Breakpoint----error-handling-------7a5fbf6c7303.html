<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用  Swift Error Breakpoint 檢查 error handling 丟出的錯誤</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用  Swift Error Breakpoint 檢查 error handling 丟出的錯誤</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們有時會遇到一些丟出錯誤的程式。當我們使用 do catch 或 try! 時，可以馬上看到錯誤的相關資訊，比方以下程式 JSONDecoder 因解析 JSON 失敗丟出錯誤。
</section>
<section data-field="body" class="e-content">
<section name="b6e1" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="f586" id="f586" class="graf graf--h3 graf--leading graf--title">利用 Swift Error Breakpoint 檢查 error handling 丟出的錯誤</h3><p name="7d33" id="7d33" class="graf graf--p graf-after--h3">開發 iOS App 時，我們有時會遇到一些丟出錯誤的程式。當我們使用 do catch 或 try! 時，可以馬上看到錯誤的相關資訊，比方以下程式 JSONDecoder 因解析 JSON 失敗丟出錯誤。</p><pre name="b3d3" id="b3d3" class="graf graf--pre graf-after--p">if let urlString = &quot;<a href="https://itunes.apple.com/search?term=" data-href="https://itunes.apple.com/search?term=" class="markup--anchor markup--pre-anchor" rel="nofollow noopener noopener" target="_blank">https://itunes.apple.com/search?term=</a>愛情的模樣&amp;media=music&amp;country=TW&quot;.addingPercentEncoding(withAllowedCharacters: .urlQueryAllowed), <br>　　let url = URL(string: urlString) {<br>            <br>           <br>            URLSession.shared.dataTask(with: url) { data, response, error in<br>                let decoder = JSONDecoder()<br>                decoder.dateDecodingStrategy = .iso8601<br>                <br>                if let data = data {<br>                    do {<br>                        let songResults = try decoder.decode(SongResults.self, from: data)<br>                    } catch {<br>                        print(error)<br>                    }<br>                }<br>                <br>            }.resume()<br>}</pre><p name="522a" id="522a" class="graf graf--p graf-after--pre">從印出的錯誤訊息我們得知 JSON 裡 resultCount 的型別是 Int，但是我們卻宣告成 String，因此解析失敗。</p><pre name="30d4" id="30d4" class="graf graf--pre graf-after--p">typeMismatch(Swift.String, Swift.DecodingError.Context(codingPath: [CodingKeys(stringValue: &quot;<strong class="markup--strong markup--pre-strong">resultCount</strong>&quot;, intValue: nil)], debugDescription: &quot;<strong class="markup--strong markup--pre-strong">Expected to decode String but found a number instead</strong>.&quot;, underlyingError: nil))</pre><p name="16cb" id="16cb" class="graf graf--p graf-after--pre">但如果我們使用的是不會產生錯誤的<code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong"> try?</strong></code> 呢 ?</p><pre name="99b1" id="99b1" class="graf graf--pre graf-after--p">if let data = data, let songResults = try? decoder.decode(SongResults.self, from: data) {<br>                    <br>}</pre><p name="2872" id="2872" class="graf graf--p graf-after--pre">很遺憾的，此時我們將無法用 print 印出錯誤，App 也不會像 try! 一樣閃退顯示錯誤資訊。但是別難過，我們可以透過 Swift Error Breakpoint 找出錯誤。</p><h3 name="5d9c" id="5d9c" class="graf graf--h3 graf-after--p">切換到 Breakpoint navigator 分頁</h3><figure name="fab6" id="fab6" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*W_TQN0bGCN3DfcT9QFc5Cg.jpeg" data-width="626" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*W_TQN0bGCN3DfcT9QFc5Cg.jpeg"></figure><h3 name="06c7" id="06c7" class="graf graf--h3 graf-after--figure">點選左下的 + 新增 breakpoint，選擇 Swift Error Breakpoint</h3><p name="608b" id="608b" class="graf graf--p graf-after--h3">當 Swift 程式丟出錯誤時，Swift Error Breakpoint 將讓 App 中斷執行，因此使用 try? 的程式也會被中斷。</p><figure name="9cbe" id="9cbe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ql6vZYil7C-mDGKyPBhWVg.jpeg" data-width="500" data-height="320" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Ql6vZYil7C-mDGKyPBhWVg.jpeg"></figure><figure name="c5eb" id="c5eb" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*Bw9EYUYeS8qC09hI7_phGg.jpeg" data-width="476" data-height="172" src="https://cdn-images-1.medium.com/max/800/1*Bw9EYUYeS8qC09hI7_phGg.jpeg"></figure><h3 name="5475" id="5475" class="graf graf--h3 graf-after--figure">執行 App， App 在錯誤丟出時中斷執行</h3><p name="28f3" id="28f3" class="graf graf--p graf-after--h3">JSONDecoder 的 decode 丟出錯誤，因此 App 被中斷了。</p><figure name="ed3f" id="ed3f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*v4bIAKMaCh-TWXQhFYtv9Q.jpeg" data-width="1450" data-height="376" src="https://cdn-images-1.medium.com/max/800/1*v4bIAKMaCh-TWXQhFYtv9Q.jpeg"></figure><h3 name="9a0c" id="9a0c" class="graf graf--h3 graf-after--figure">輸入 lldb 的指令顯示錯誤資訊</h3><p name="fe97" id="fe97" class="graf graf--p graf-after--h3">我們可在右下角的 console 輸入 lldb 的指令查詢錯誤資訊。由於產生錯誤的程式是 decoder.decode(SongResults.self, from: data)，因此我們輸入</p><pre name="4793" id="4793" class="graf graf--pre graf-after--p">po decoder.decode(SongResults.self, from: data)</pre><p name="ee14" id="ee14" class="graf graf--p graf-after--pre">po 指令將印出 decoder.decode(SongResults.self, from: data) 丟出的錯誤。(ps: 可以不用加上 try ）</p><figure name="e2bb" id="e2bb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dxRfWwO7EvdwvcyzNUPOqA.jpeg" data-width="1390" data-height="392" src="https://cdn-images-1.medium.com/max/800/1*dxRfWwO7EvdwvcyzNUPOqA.jpeg"></figure><p name="4c55" id="4c55" class="graf graf--p graf-after--figure">Cool，即使是 try?，我們也可以找到錯誤的原因了。</p><figure name="9114" id="9114" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*DfQ8S1Xw9PC84XnSuxsSaQ.jpeg" data-width="1382" data-height="1090" src="https://cdn-images-1.medium.com/max/800/1*DfQ8S1Xw9PC84XnSuxsSaQ.jpeg"></figure><h3 name="98c5" id="98c5" class="graf graf--h3 graf-after--figure">印出 JSON 內容，將 data 變成 string</h3><p name="1ee4" id="1ee4" class="graf graf--p graf-after--h3">若是想先確認是否正確抓到 JSON 資料，我們也可以將 data 變成 string 印出，方法如下:</p><figure name="6d19" id="6d19" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9-J5_vOPSjgzedM2crvUEA.jpeg" data-width="2206" data-height="776" src="https://cdn-images-1.medium.com/max/800/1*9-J5_vOPSjgzedM2crvUEA.jpeg"></figure><pre name="598f" id="598f" class="graf graf--pre graf-after--figure">(lldb) po String(data: data, encoding: .utf8)</pre><figure name="10c0" id="10c0" class="graf graf--figure graf-after--pre graf--trailing"><img class="graf-image" data-image-id="1*GXm8njdtiLROjFDNOu8T6w.jpeg" data-width="1412" data-height="714" src="https://cdn-images-1.medium.com/max/800/1*GXm8njdtiLROjFDNOu8T6w.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/7a5fbf6c7303"><time class="dt-published" datetime="2020-06-01T15:53:46.818Z">June 1, 2020</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-swift-error-breakpoint-%E6%AA%A2%E6%9F%A5-error-handling-%E4%B8%9F%E5%87%BA%E7%9A%84%E9%8C%AF%E8%AA%A4-7a5fbf6c7303" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>