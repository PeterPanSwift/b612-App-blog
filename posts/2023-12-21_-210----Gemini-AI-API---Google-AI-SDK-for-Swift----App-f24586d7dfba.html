<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>#210 串接 Gemini AI API 和 Google AI SDK for Swift 開發 App</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">#210 串接 Gemini AI API 和 Google AI SDK for Swift 開發 App</h1>
</header>
<section data-field="subtitle" class="p-summary">
最近 Google 推出更強大的 Gemini AI，提供 REST API 和各種程式語言的 SDK，方便開發者串接 API 實現各種有趣的應用。
</section>
<section data-field="body" class="e-content">
<section name="35b2" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1abf" id="1abf" class="graf graf--h3 graf--leading graf--title">#210 串接 Gemini AI API 和 Google AI SDK for Swift 開發 App</h3><p name="5835" id="5835" class="graf graf--p graf-after--h3">最近 Google 推出更強大的 Gemini AI，提供 REST API 和各種程式語言的 SDK，方便開發者串接 API 實現各種有趣的應用。</p><p name="b224" id="b224" class="graf graf--p graf-after--p">以下彼得潘將實驗三種使用 Gemini AI 的方式。</p><ul class="postList"><li name="3061" id="3061" class="graf graf--li graf-after--p">串接 Gemini REST API。</li><li name="a048" id="a048" class="graf graf--li graf-after--li">使用 Google AI SDK for Swift 開發 iOS App。</li><li name="b059" id="b059" class="graf graf--li graf-after--li">執行 Google AI SDK 的範例程式。</li></ul><h3 name="c812" id="c812" class="graf graf--h3 graf-after--li">串接 Gemini REST API</h3><ul class="postList"><li name="7f1d" id="7f1d" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">建立 API key。</strong></li></ul><p name="54c5" id="54c5" class="graf graf--p graf-after--li">為了串接 API，我們必須先建立 API key。</p><p name="8a24" id="8a24" class="graf graf--p graf-after--p">請連到以下連結，同意 Google AI 相關的 Terms of Service。</p><p name="598d" id="598d" class="graf graf--p graf-after--p"><a href="https://makersuite.google.com/app/apikey" data-href="https://makersuite.google.com/app/apikey" class="markup--anchor markup--p-anchor" rel="nofollow noopener" target="_blank">https://makersuite.google.com/app/apikey</a></p><figure name="0882" id="0882" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*uGSNCKplFluqKkIDwak7KA.png" data-width="1446" data-height="1126" src="https://cdn-images-1.medium.com/max/800/1*uGSNCKplFluqKkIDwak7KA.png"></figure><p name="3fdf" id="3fdf" class="graf graf--p graf-after--figure">點選 Create API key in new project。</p><figure name="a8c9" id="a8c9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TP-2_z70QMHYH81dnk3OXg.png" data-width="2752" data-height="964" src="https://cdn-images-1.medium.com/max/800/1*TP-2_z70QMHYH81dnk3OXg.png"></figure><p name="c7b8" id="c7b8" class="graf graf--p graf-after--figure">點選 Copy 複製 API key。</p><figure name="052a" id="052a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*VE7gOLgD0geYiBg-j_u5Qg.png" data-width="1452" data-height="384" src="https://cdn-images-1.medium.com/max/800/1*VE7gOLgD0geYiBg-j_u5Qg.png"></figure><p name="d775" id="d775" class="graf graf--p graf-after--figure">從網頁上的 API Keys 清單可查詢曾建立的 API key。</p><figure name="c102" id="c102" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*MfJlSHGTKRjKjHblmyfVdw.png" data-width="1544" data-height="768" src="https://cdn-images-1.medium.com/max/800/1*MfJlSHGTKRjKjHblmyfVdw.png"></figure><ul class="postList"><li name="2fa1" id="2fa1" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">測試 API。</strong></li></ul><p name="c687" id="c687" class="graf graf--p graf-after--li">網頁下方提到快速測試 API 的 curl 指令，將 YOUR_API_KEY 換成剛剛複製的 API key 即可測試。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="bash" name="921a" id="921a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">curl \<br />  -H <span class="hljs-string">&#x27;Content-Type: application/json&#x27;</span> \<br />  -d <span class="hljs-string">&#x27;{&quot;contents&quot;:[{&quot;parts&quot;:[{&quot;text&quot;:&quot;Write a story about a magic backpack&quot;}]}]}&#x27;</span> \<br />  -X POST https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent?key=YOUR_API_KEY</span></pre><p name="e555" id="e555" class="graf graf--p graf-after--pre">從 JSON 的 parts 參數可填入詢問 AI 的 prompt，彼得潘將 parts 的內容改成 <code class="markup--code markup--p-code">&#39;[{&quot;text&quot;:&quot;寫一個聖誕老公公教彼得潘成為 iOS App 工程師的故事&quot;}]&#39;</code>，AI 回傳的 JSON 如下。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="9773" id="9773" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">{<br />  <span class="hljs-string">&quot;candidates&quot;</span>: [<br />    {<br />      <span class="hljs-string">&quot;content&quot;</span>: {<br />        <span class="hljs-string">&quot;parts&quot;</span>: [<br />          {<br />            <span class="hljs-string">&quot;text&quot;</span>: <span class="hljs-string">&quot;很久很久以前，聖誕老公公決定教彼得潘成為 iOS App 工程師。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>聖誕老公公首先給彼得潘介紹了 iOS App 開發的基本知識，包括 Xcode 工具、Swift 語言、Cocoa Touch 框架等。彼得潘是一個非常聰明的孩子，他很快就掌握了這些知識。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>然後，聖誕老公公讓彼得潘開始練習開發一些簡單的 iOS 應用。彼得潘非常有天賦，他很快就開發出了一些非常實用的應用，比如一個可以幫助人們管理聖誕願望的應用、一個可以幫助人們找到聖誕樹的應用，還有一個可以幫助人們製作聖誕賀卡的應用。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>聖誕老公公看到彼得潘的進步非常快，他決定讓彼得潘開始開發一些更複雜的 iOS 應用。彼得潘也很好地完成了這些任務，他開發出了一些非常受歡迎的應用，比如一個可以幫助人們在聖誕節期間跟踪聖誕老人的位置的應用、一個可以幫助人們用聖誕老人風格裝飾家園的應用，還有一個可以幫助人們製作聖誕大餐的應用。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>彼得潘的 iOS App 開發技術越來越好，他成為了業內知名的 iOS App 工程師。他開發的應用受到了很多人的喜愛，他也因此賺了很多錢。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>彼得潘非常感激聖誕老公公的教導，他決定把自己的部分收入捐給慈善機構，以幫助更多的人。<span class="hljs-subst">\n</span><span class="hljs-subst">\n</span>聖誕老公公看到彼得潘取得了這麼大的成就，他非常高興。他知道彼得潘會成為一個非常出色的 iOS App 工程師，他為彼得潘感到驕傲。&quot;</span><br />          }<br />        ],<br />        <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;model&quot;</span><br />      },<br />      <span class="hljs-string">&quot;finishReason&quot;</span>: <span class="hljs-string">&quot;STOP&quot;</span>,<br />      <span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-number">0</span>,<br />      <span class="hljs-string">&quot;safetyRatings&quot;</span>: [<br />        {<br />          <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_SEXUALLY_EXPLICIT&quot;</span>,<br />          <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />        },<br />        {<br />          <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_HATE_SPEECH&quot;</span>,<br />          <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />        },<br />        {<br />          <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_HARASSMENT&quot;</span>,<br />          <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />        },<br />        {<br />          <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_DANGEROUS_CONTENT&quot;</span>,<br />          <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />        }<br />      ]<br />    }<br />  ],<br />  <span class="hljs-string">&quot;promptFeedback&quot;</span>: {<br />    <span class="hljs-string">&quot;safetyRatings&quot;</span>: [<br />      {<br />        <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_SEXUALLY_EXPLICIT&quot;</span>,<br />        <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />      },<br />      {<br />        <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_HATE_SPEECH&quot;</span>,<br />        <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />      },<br />      {<br />        <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_HARASSMENT&quot;</span>,<br />        <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />      },<br />      {<br />        <span class="hljs-string">&quot;category&quot;</span>: <span class="hljs-string">&quot;HARM_CATEGORY_DANGEROUS_CONTENT&quot;</span>,<br />        <span class="hljs-string">&quot;probability&quot;</span>: <span class="hljs-string">&quot;NEGLIGIBLE&quot;</span><br />      }<br />    ]<br />  }<br />}</span></pre><p name="5bc9" id="5bc9" class="graf graf--p graf-after--pre">AI 的回答在 JSON 的 text 下，是個滿不錯的聖誕故事。</p><blockquote name="0e58" id="0e58" class="graf graf--blockquote graf-after--p">很久很久以前，聖誕老公公決定教彼得潘成為 iOS App 工程師。\n\n聖誕老公公首先給彼得潘介紹了 iOS App 開發的基本知識，包括 Xcode 工具、Swift 語言、Cocoa Touch 框架等。彼得潘是一個非常聰明的孩子，他很快就掌握了這些知識。\n\n然後，聖誕老公公讓彼得潘開始練習開發一些簡單的 iOS 應用。彼得潘非常有天賦，他很快就開發出了一些非常實用的應用，比如一個可以幫助人們管理聖誕願望的應用、一個可以幫助人們找到聖誕樹的應用，還有一個可以幫助人們製作聖誕賀卡的應用。\n\n聖誕老公公看到彼得潘的進步非常快，他決定讓彼得潘開始開發一些更複雜的 iOS 應用。彼得潘也很好地完成了這些任務，他開發出了一些非常受歡迎的應用，比如一個可以幫助人們在聖誕節期間跟踪聖誕老人的位置的應用、一個可以幫助人們用聖誕老人風格裝飾家園的應用，還有一個可以幫助人們製作聖誕大餐的應用。\n\n彼得潘的 iOS App 開發技術越來越好，他成為了業內知名的 iOS App 工程師。他開發的應用受到了很多人的喜愛，他也因此賺了很多錢。\n\n彼得潘非常感激聖誕老公公的教導，他決定把自己的部分收入捐給慈善機構，以幫助更多的人。\n\n聖誕老公公看到彼得潘取得了這麼大的成就，他非常高興。他知道彼得潘會成為一個非常出色的 iOS App 工程師，他為彼得潘感到驕傲。</blockquote><ul class="postList"><li name="0034" id="0034" class="graf graf--li graf-after--blockquote"><strong class="markup--strong markup--li-strong">REST API。</strong></li></ul><p name="5c7c" id="5c7c" class="graf graf--p graf-after--li">Gemini 的能力不單單是一次性的問答，它還可以針對上傳的圖片回答問題，也能進行多輪的對話。有興趣的朋友可進一步查詢它的 REST API 和閱讀網頁上的其它資訊。</p><div name="ba68" id="ba68" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://ai.google.dev/tutorials/rest_quickstart" data-href="https://ai.google.dev/tutorials/rest_quickstart" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://ai.google.dev/tutorials/rest_quickstart"><strong class="markup--strong markup--mixtapeEmbed-strong">Quickstart: Get started with Gemini using the REST API | Google AI for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">If you want to quickly try out the Gemini API, you can use curl commands to call the methods in the REST API. The…</em>ai.google.dev</a><a href="https://ai.google.dev/tutorials/rest_quickstart" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="53aa92ef95e74de41acfd1735b40c041" data-thumbnail-img-id="0*-N-f9JB6gka4cH1c" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*-N-f9JB6gka4cH1c);"></a></div><h3 name="5fde" id="5fde" class="graf graf--h3 graf-after--mixtapeEmbed">使用 Google AI SDK for Swift 開發 iOS App</h3><p name="03ff" id="03ff" class="graf graf--p graf-after--h3">我們也可以用 Google AI SDK for Swift 更方便地串接 API，接下來我們將開發一個有趣的 App，請 AI 講個有趣的 Xmas 故事。</p><div name="d6b8" id="d6b8" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://ai.google.dev/tutorials/swift_quickstart" data-href="https://ai.google.dev/tutorials/swift_quickstart" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://ai.google.dev/tutorials/swift_quickstart"><strong class="markup--strong markup--mixtapeEmbed-strong">Quickstart: Get started with the Gemini API in Swift apps | Google AI for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">Learn how to use the Gemini API in a Swift app to generate text from both image and text prompts and to build a chat…</em>ai.google.dev</a><a href="https://ai.google.dev/tutorials/swift_quickstart" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="e610b9c83668e03a1b3ddbfc14cd335f"></a></div><ul class="postList"><li name="acdf" id="acdf" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">從 Xcode 用 SPM 加入 Google AI SDK for Swift。</strong></li></ul><div name="e2a0" id="e2a0" class="graf graf--mixtapeEmbed graf-after--li"><a href="https://github.com/google/generative-ai-swift" data-href="https://github.com/google/generative-ai-swift" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/google/generative-ai-swift"><strong class="markup--strong markup--mixtapeEmbed-strong">GitHub - google/generative-ai-swift: Google AI SDK for Swift</strong><br><em class="markup--em markup--mixtapeEmbed-em">Google AI SDK for Swift. Contribute to google/generative-ai-swift development by creating an account on GitHub.</em>github.com</a><a href="https://github.com/google/generative-ai-swift" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a969ce3f3dce73fa3de9fe37593fa52f" data-thumbnail-img-id="0*mAkd6jIr0G4nwh08" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*mAkd6jIr0G4nwh08);"></a></div><figure name="512d" id="512d" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*tBBdapa9ZpT7-JuQP3YXgg.png" data-width="2172" data-height="1204" src="https://cdn-images-1.medium.com/max/800/1*tBBdapa9ZpT7-JuQP3YXgg.png"></figure><figure name="8996" id="8996" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*YjjbqX_inZ_wFOcGx9EvnQ.png" data-width="1294" data-height="602" src="https://cdn-images-1.medium.com/max/800/1*YjjbqX_inZ_wFOcGx9EvnQ.png"></figure><figure name="dc31" id="dc31" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*N6CbT-qoviAhwA0_BU1vEA.png" data-width="528" data-height="484" src="https://cdn-images-1.medium.com/max/800/1*N6CbT-qoviAhwA0_BU1vEA.png"></figure><ul class="postList"><li name="c68d" id="c68d" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">新增 Group APIKey，在 APIKey 下新增 GenerativeAI-Info.plist。</strong></li></ul><p name="3fbc" id="3fbc" class="graf graf--p graf-after--li">新增檔案時選擇 Property List。</p><figure name="ce91" id="ce91" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QMWX4V-ZpUspOsAPjzkaGQ.png" data-width="1430" data-height="1034" src="https://cdn-images-1.medium.com/max/800/1*QMWX4V-ZpUspOsAPjzkaGQ.png"></figure><figure name="8479" id="8479" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*IYngzohiqQwcHSdGmkQ22Q.png" data-width="540" data-height="394" src="https://cdn-images-1.medium.com/max/800/1*IYngzohiqQwcHSdGmkQ22Q.png"></figure><ul class="postList"><li name="456a" id="456a" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">在 GenerativeAI-Info.plist 裡新增 key API_KEY，value 填入剛剛複製的 API key。</strong></li></ul><figure name="1e7c" id="1e7c" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*b6cVyjyj3pmCjhQxChK3Yg.png" data-width="1944" data-height="320" src="https://cdn-images-1.medium.com/max/800/1*b6cVyjyj3pmCjhQxChK3Yg.png"></figure><ul class="postList"><li name="abd1" id="abd1" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">加入讀取 API key 的程式。</strong></li></ul><p name="c83c" id="c83c" class="graf graf--p graf-after--li">Google 的文件和範例程式已經幫我們寫好讀取 API key 的程式，因此我們新增 APIKey.swift，複製貼下以下 enum APIKey 的程式。</p><figure name="e301" id="e301" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*YFVNmsueeest-xX9d7Dohg.png" data-width="506" data-height="244" src="https://cdn-images-1.medium.com/max/800/1*YFVNmsueeest-xX9d7Dohg.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="80ee" id="80ee" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> Foundation<br /><br /><span class="hljs-keyword">enum</span> <span class="hljs-title class_">APIKey</span> {<br />  <span class="hljs-comment">/// Fetch the API key from `GenerativeAI-Info.plist`</span><br />  <span class="hljs-comment">/// This is just *one* way how you can retrieve the API key for your app.</span><br />  <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> `default`: <span class="hljs-type">String</span> {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> filePath <span class="hljs-operator">=</span> <span class="hljs-type">Bundle</span>.main.path(forResource: <span class="hljs-string">&quot;GenerativeAI-Info&quot;</span>, ofType: <span class="hljs-string">&quot;plist&quot;</span>)<br />    <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;Couldn&#x27;t find file &#x27;GenerativeAI-Info.plist&#x27;.&quot;</span>)<br />    }<br />    <span class="hljs-keyword">let</span> plist <span class="hljs-operator">=</span> <span class="hljs-type">NSDictionary</span>(contentsOfFile: filePath)<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> plist<span class="hljs-operator">?</span>.object(forKey: <span class="hljs-string">&quot;API_KEY&quot;</span>) <span class="hljs-keyword">as?</span> <span class="hljs-type">String</span> <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;Couldn&#x27;t find key &#x27;API_KEY&#x27; in &#x27;GenerativeAI-Info.plist&#x27;.&quot;</span>)<br />    }<br />    <span class="hljs-keyword">if</span> value.starts(with: <span class="hljs-string">&quot;_&quot;</span>) <span class="hljs-operator">||</span> value.isEmpty {<br />      <span class="hljs-built_in">fatalError</span>(<br />        <span class="hljs-string">&quot;Follow the instructions at https://ai.google.dev/tutorials/setup to get an API key.&quot;</span><br />      )<br />    }<br />    <span class="hljs-keyword">return</span> value<br />  }<br />}</span></pre><ul class="postList"><li name="1288" id="1288" class="graf graf--li graf-after--pre">撰寫串接 AI 的程式。</li></ul><p name="f670" id="f670" class="graf graf--p graf-after--li">建立 GenerativeModel，呼叫 generateContent 取得 AI 生成的回答。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="24e3" id="24e3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> GoogleGenerativeAI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> model <span class="hljs-operator">=</span> <span class="hljs-type">GenerativeModel</span>(name: <span class="hljs-string">&quot;gemini-pro&quot;</span>, apiKey: <span class="hljs-type">APIKey</span>.default)<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> story <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;</span><br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Image</span>(.xmas)<br />                .resizable()<br />                .scaledToFit()<br />            <span class="hljs-type">Button</span>(<span class="hljs-string">&quot;XMAS story&quot;</span>) {<br />                <span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">&quot;寫一個聖誕老公公教彼得潘成為 iOS App 工程師的故事&quot;</span><br />                <span class="hljs-type">Task</span> {<br />                    <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> model.generateContent(prompt)<br />                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> text <span class="hljs-operator">=</span> response.text {<br />                        story <span class="hljs-operator">=</span> text<br />                    }<br />                }<br />            }<br />            .buttonStyle(.borderedProminent)<br />            <span class="hljs-type">ScrollView</span> {<br />                <span class="hljs-type">Text</span>(story)<br />            }<br />        }<br />    }<br />}<br /><br /></span></pre><p name="2329" id="2329" class="graf graf--p graf-after--pre">點選按鈕 Xmas story，AI 成功生出彼得潘千里迢迢跟聖誕老公公學程式的故事。</p><figure name="ac53" id="ac53" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*0lVBsXEaKMY3up7tFOP1OA.png" data-width="870" data-height="1388" src="https://cdn-images-1.medium.com/max/800/1*0lVBsXEaKMY3up7tFOP1OA.png"></figure><h3 name="a43b" id="a43b" class="graf graf--h3 graf-after--figure">請 AI 回傳指定的 JSON 格式，然後解析成 Codable 型別</h3><p name="3297" id="3297" class="graf graf--p graf-after--h3">比方 prompt 如下時，AI 將回傳指定的 JSON 格式，方便我們轉換成 Codable 型別。</p><pre data-code-block-mode="0" spellcheck="false" name="58a1" id="58a1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">請介紹常見的流星雨清單，JSON 格式是 [ {&quot;name&quot;:&quot;寶瓶τ流星雨&quot;, &quot;time&quot;: &quot;27 Jun – 6 Jul&quot; } ]，不要有 ```json 跟 ```</span></pre><p name="5743" id="5743" class="graf graf--p graf-after--pre">AI 回傳的內容。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="json" name="f840" id="f840" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-punctuation">[</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;寶瓶τ流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;27 Jun – 6 Jul&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;寶瓶δ流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;16 Jul – 26 Aug&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;英仙座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;16 Jul – 24 Aug&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;英仙座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;16 Jul – 24 Aug&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;象限儀座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;2 Jan – 5 Jan&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;獅子座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;6 Nov – 30 Nov&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;雙子座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;7 Dec – 17 Dec&quot;</span><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />  <span class="hljs-punctuation">{</span><span class="hljs-attr">&quot;name&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;北金牛座流星雨&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;time&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;28 Oct – 21 Nov&quot;</span><span class="hljs-punctuation">}</span><br /><span class="hljs-punctuation">]</span></span></pre><p name="1ce6" id="1ce6" class="graf graf--p graf-after--pre">記得 prompt 要加上<code class="markup--code markup--p-code">不要有 ```json 跟 ```</code>，不然回傳的 JSON 可能會出現 <code class="markup--code markup--p-code">```json 跟 ```</code>。</p><p name="3849" id="3849" class="graf graf--p graf-after--p">以下是解析的 Swift 程式範例。</p><ul class="postList"><li name="6d0f" id="6d0f" class="graf graf--li graf-after--p">Codable 型別。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="859f" id="859f" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">MeteorShower</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> time: <span class="hljs-type">String</span><br />}</span></pre><ul class="postList"><li name="d562" id="d562" class="graf graf--li graf-after--pre">JSONDecoder 解碼的程式。</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="824d" id="824d" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> prompt <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;&quot;<br />請介紹常見的流星雨清單，JSON 格式是 [ {&quot;name&quot;:&quot;寶瓶τ流星雨&quot;, &quot;time&quot;: &quot;27 Jun – 6 Jul&quot; } ]，不要有 ```json 跟 ```<br />&quot;&quot;&quot;</span><br /><span class="hljs-type">Task</span> {<br />    <span class="hljs-keyword">let</span> response <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> model<span class="hljs-operator">?</span>.generateContent(prompt)<br />    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> response<span class="hljs-operator">?</span>.text<span class="hljs-operator">?</span>.data(using: .utf8),<br />       <span class="hljs-keyword">let</span> meteorShowers <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">JSONDecoder</span>().decode([<span class="hljs-type">MeteorShower</span>].<span class="hljs-keyword">self</span>, from: data) {<br />        <span class="hljs-built_in">print</span>(meteorShowers)<br />    }<br />}</span></pre><h3 name="f01d" id="f01d" class="graf graf--h3 graf-after--pre">執行 Google AI SDK 的範例程式</h3><p name="6d02" id="6d02" class="graf graf--p graf-after--h3">Google AI SDK 也提供了豐富的範例程式，執行的方法如下。</p><p name="4d18" id="4d18" class="graf graf--p graf-after--p">clone Google AI SDK，在 terminal 輸入以下指令。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="bash" name="a936" id="a936" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">git <span class="hljs-built_in">clone</span> https://github.com/google/generative-ai-swift</span></pre><p name="14e2" id="14e2" class="graf graf--p graf-after--pre">雙擊 <code class="markup--code markup--p-code">generative-ai-swift/Examples/GenerativeAISample/GenerativeAISample.xcodeproj</code>。</p><figure name="d496" id="d496" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mIEdPmutpKbf64A4iBTLUQ.png" data-width="1986" data-height="606" src="https://cdn-images-1.medium.com/max/800/1*mIEdPmutpKbf64A4iBTLUQ.png"></figure><p name="5300" id="5300" class="graf graf--p graf-after--figure">先 build 一次，生成 APIKey 下的 GenerativeAI-Info-Sample.plist。</p><figure name="6035" id="6035" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EiVO1hIm32oUUh7RHknQaw.png" data-width="1686" data-height="454" src="https://cdn-images-1.medium.com/max/800/1*EiVO1hIm32oUUh7RHknQaw.png"></figure><p name="a11e" id="a11e" class="graf graf--p graf-after--figure">在 API_KEY 設定自己的 API key。</p><figure name="8a4e" id="8a4e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ulESsiGrJCdp40oifYfEvg.png" data-width="1094" data-height="314" src="https://cdn-images-1.medium.com/max/800/1*ulESsiGrJCdp40oifYfEvg.png"></figure><p name="5f38" id="5f38" class="graf graf--p graf-after--figure">在 scheme 選擇 GenerativeAISample 後執行 App。</p><figure name="6012" id="6012" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*56XrNS9Q38XRUTzKVA6gZw.png" data-width="530" data-height="624" src="https://cdn-images-1.medium.com/max/800/1*56XrNS9Q38XRUTzKVA6gZw.png"></figure><p name="214b" id="214b" class="graf graf--p graf-after--figure">範例示範了三種功能，包含 Text、Multi-modal 和 Chat。</p><figure name="ac3f" id="ac3f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dW6V9AFoAj-DicY_9_DJzg.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*dW6V9AFoAj-DicY_9_DJzg.png"></figure><figure name="a893" id="a893" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*T-QJfURHCI1ULvKXyS0BWQ.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*T-QJfURHCI1ULvKXyS0BWQ.png"></figure><h3 name="2b40" id="2b40" class="graf graf--h3 graf-after--figure">研究 SDK 的程式</h3><p name="7552" id="7552" class="graf graf--p graf-after--h3">有興趣的朋友可進一步研究 Google SDK 如何實作 REST API 的程式。</p><figure name="a306" id="a306" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*TAcI4RnTy1zYeiPkksEIgQ.png" data-width="2516" data-height="1384" src="https://cdn-images-1.medium.com/max/800/1*TAcI4RnTy1zYeiPkksEIgQ.png"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/f24586d7dfba"><time class="dt-published" datetime="2023-12-21T14:45:40.322Z">December 21, 2023</time></a>.</p><p><a href="https://medium.com/@apppeterpan/210-%E4%B8%B2%E6%8E%A5-gemini-ai-api-%E5%92%8C-google-ai-sdk-for-swift-%E9%96%8B%E7%99%BC-app-f24586d7dfba" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>