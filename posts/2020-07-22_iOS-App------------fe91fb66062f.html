<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>iOS App 讓元件繞圓移動的方法</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">iOS App 讓元件繞圓移動的方法</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，想讓元件直線移動很簡單，但是想要繞圓移動就需要稍微想一想了。以下三種方法在 SwiftUI &amp; UIKit 都能實現繞圓移動的效果。
</section>
<section data-field="body" class="e-content">
<section name="0bd8" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6e17" id="6e17" class="graf graf--h3 graf--leading graf--title">iOS App 讓元件繞圓移動的方法</h3><p name="d45a" id="d45a" class="graf graf--p graf-after--h3">開發 iOS App 時，想讓元件直線移動很簡單，想要繞圓移動就需稍微想一想了。以下三種方法在 SwiftUI &amp; UIKit 都能實現繞圓移動的效果。</p><ul class="postList"><li name="8a28" id="8a28" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">方法1: 調整元件的 y 座標和旋轉的角度。</strong></li><li name="9799" id="9799" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法2: 利用畫圓弧的 path 找出元件的座標。</strong></li><li name="3b4e" id="3b4e" class="graf graf--li graf-after--li">方法3: 利用三角函數計算元件的座標。</li></ul><p name="391b" id="391b" class="graf graf--p graf-after--li">接下來我們將只示範前兩種方法，麻煩的三角函數就留給對數學有興趣的朋友研究了。一開始我們先實現以 slider 控制繞圓移動，接著再實現自動繞圓的動畫效果。</p><figure name="ca45" id="ca45" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TMvAAfr74-ovY2ic9qfEkQ.jpeg" data-width="1290" data-height="816" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*TMvAAfr74-ovY2ic9qfEkQ.jpeg"></figure><h3 name="4cd6" id="4cd6" class="graf graf--h3 graf-after--figure">方法1: 調整元件的 y 座標和旋轉的角度</h3><h3 name="7c27" id="7c27" class="graf graf--h3 graf-after--h3">SwiftUI</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="423c" id="423c" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> degrees: <span class="hljs-type">Double</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">ZStack</span> {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;heart.circle&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />                .overlay(<br />                    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;only the young can run&quot;</span>)<br />                        .font(.title)<br />                        .offset(y: <span class="hljs-operator">-</span><span class="hljs-number">100</span>)<br />                    , alignment: .top)<br />                .overlay(<br />                    <span class="hljs-type">VStack</span> {<br />                        <span class="hljs-type">Slider</span>(value: <span class="hljs-variable">$degrees</span>, in: <span class="hljs-number">0</span><span class="hljs-operator">...</span><span class="hljs-number">360</span>)<br />                        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(Int(degrees))</span>&quot;</span>)<br />                    }<br />                    .offset(y: <span class="hljs-number">100</span>)<br />                    .font(.title),<br />                    alignment: .bottom<br />                )<br />            <br />            <span class="hljs-type">Image</span>(<span class="hljs-string">&quot;peter&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .offset(y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)<br />                .rotationEffect(.degrees(degrees))<br />            <br />        }<br />        <br />        <br />    }<br />}</span></pre><p name="0592" id="0592" class="graf graf--p graf-after--pre">關鍵在以下兩行程式</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c8b2" id="c8b2" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">.offset(y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)<br />.rotationEffect(.degrees(degrees))</span></pre><p name="97f7" id="97f7" class="graf graf--p graf-after--pre">原本 peter 在愛心圓的中心，<code class="markup--code markup--p-code">offset(y: -150)</code> 將讓它移動到愛心圓的上方。(150 是愛心圓的半徑)</p><figure name="e8d6" id="e8d6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*n2M1Q_d1q4dEOG5LQGtCKw.jpeg" data-width="410" data-height="464" src="https://cdn-images-1.medium.com/max/800/1*n2M1Q_d1q4dEOG5LQGtCKw.jpeg"></figure><p name="6a62" id="6a62" class="graf graf--p graf-after--figure">接著 <code class="markup--code markup--p-code">rotationEffect(.degrees(degrees))</code> 讓 Peter 繞著愛心圓旋轉，比方以下是 90 度的位置。</p><figure name="3757" id="3757" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Nv1VMNkIPWcfQgK-5VfS7g.jpeg" data-width="496" data-height="542" src="https://cdn-images-1.medium.com/max/800/1*Nv1VMNkIPWcfQgK-5VfS7g.jpeg"></figure><p name="67d9" id="67d9" class="graf graf--p graf-after--figure">不過 modifier 的順序很重要，要先 offset 再 rotate，若是先 rotate 再 offset，Peter 將變成在原地旋轉。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1aef" id="1aef" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">.rotationEffect(.degrees(degrees))<br />.offset(y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)</span></pre><figure name="8df6" id="8df6" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*fxw6ifso2sI9UBCiMyxc8Q.jpeg" data-width="818" data-height="1496" src="https://cdn-images-1.medium.com/max/800/1*fxw6ifso2sI9UBCiMyxc8Q.jpeg"></figure><h3 name="c563" id="c563" class="graf graf--h3 graf-after--figure">UIKit &amp; storyboard</h3><p name="0eaf" id="0eaf" class="graf graf--p graf-after--h3">假設 storyboard 的設計如下，Peter 一開始在圓心的位置。</p><figure name="1633" id="1633" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*LSdmYMFgQ7VBNfdY7QtY4w.jpeg" data-width="428" data-height="832" src="https://cdn-images-1.medium.com/max/800/1*LSdmYMFgQ7VBNfdY7QtY4w.jpeg"></figure><figure name="b922" id="b922" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*D0RPBL3U5IFwgevW-abFKQ.png" data-width="530" data-height="270" src="https://cdn-images-1.medium.com/max/800/1*D0RPBL3U5IFwgevW-abFKQ.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9a80" id="9a80" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> circleImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> peterImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> label: <span class="hljs-type">UILabel</span>!<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateLocation</span>(<span class="hljs-params">degrees</span>: <span class="hljs-type">CGFloat</span>) {<br />        <br />        peterImageView.transform <span class="hljs-operator">=</span> <span class="hljs-type">CGAffineTransform</span>.identity.rotated(by: <span class="hljs-type">CGFloat</span>.pi <span class="hljs-operator">/</span> <span class="hljs-number">180</span> <span class="hljs-operator">*</span> degrees).translatedBy(x: <span class="hljs-number">0</span>, y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)<br />        label.text <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(Int(degrees))</span>&quot;</span><br />    }<br />    <br />    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">sliderChange</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-type">UISlider</span>) {<br />        updateLocation(degrees: <span class="hljs-type">CGFloat</span>(sender.value))<br />    }<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        updateLocation(degrees: <span class="hljs-number">0</span>)<br />    }    <br />}</span></pre><p name="bde4" id="bde4" class="graf graf--p graf-after--pre">說明</p><p name="e881" id="e881" class="graf graf--p graf-after--p">在 function updateLocation 調整 peterImageView 的 transform，先用 rotated 旋轉再用 translatedBy 讓 y 位移。原本 peter 在愛心圓的中心，<code class="markup--code markup--p-code">translatedBy(x: 0, y: -150)</code>將讓它移動到愛心圓的上方。(150 是愛心圓的半徑)，<code class="markup--code markup--p-code">rotated(by: CGFloat.pi / 180 * degrees) </code>則讓 Peter 繞著愛心圓旋轉，比方以下是 90 度的位置。</p><figure name="e1ce" id="e1ce" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Li977cSGhiJxgw6KapFsrg.jpeg" data-width="526" data-height="602" src="https://cdn-images-1.medium.com/max/800/1*Li977cSGhiJxgw6KapFsrg.jpeg"></figure><p name="ce30" id="ce30" class="graf graf--p graf-after--figure">值得注意的，transform 調整的順序很重要，要先 rotated 再 translatedBy，若是先 translatedBy 再 rotated，Peter 將變成在原地旋轉。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3108" id="3108" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">peterImageView.transform <span class="hljs-operator">=</span> <span class="hljs-type">CGAffineTransform</span>.identity.translatedBy(x: <span class="hljs-number">0</span>, y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>).rotated(by: <span class="hljs-type">CGFloat</span>.pi <span class="hljs-operator">/</span> <span class="hljs-number">180</span> <span class="hljs-operator">*</span> degrees)</span></pre><figure name="945b" id="945b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*2VaWivoW_KbnSGjXNdR6qQ.jpeg" data-width="384" data-height="410" src="https://cdn-images-1.medium.com/max/800/1*2VaWivoW_KbnSGjXNdR6qQ.jpeg"></figure><div name="d453" id="d453" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/83-%E5%88%A9%E7%94%A8-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB%E5%92%8C%E6%97%8B%E8%BD%89-e061df9ed672" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/83-%E5%88%A9%E7%94%A8-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB%E5%92%8C%E6%97%8B%E8%BD%89-e061df9ed672" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/83-%E5%88%A9%E7%94%A8-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB%E5%92%8C%E6%97%8B%E8%BD%89-e061df9ed672"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 CGAffineTransform 縮放，位移，旋轉和鏡像翻轉</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 CGAffineTransform 我們可以像魔法師般對 view 下魔法，控制 view 的 transform property，要它聽話地縮放，位移和旋轉。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/83-%E5%88%A9%E7%94%A8-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB%E5%92%8C%E6%97%8B%E8%BD%89-e061df9ed672" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="84afc72997046cd12c0071b91481648b" data-thumbnail-img-id="1*d4R4tw8rbcVNzUa4aRyiYw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*d4R4tw8rbcVNzUa4aRyiYw.jpeg);"></a></div><h3 name="551f" id="551f" class="graf graf--h3 graf-after--mixtapeEmbed">自動繞圓移動的動畫效果</h3><p name="4429" id="4429" class="graf graf--p graf-after--h3">設定每 0.05 秒觸發的 timer，每次觸發時將度數加 1。</p><h3 name="36ad" id="36ad" class="graf graf--h3 graf-after--p">SwiftUI</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="30c3" id="30c3" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> degrees: <span class="hljs-type">Double</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-keyword">let</span> timer <span class="hljs-operator">=</span> <span class="hljs-type">Timer</span>.publish(every: <span class="hljs-number">0.05</span>, on: .main, in: .common).autoconnect()<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">ZStack</span> {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;heart.circle&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />                .overlay(<br />                    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;only the young can run&quot;</span>)<br />                        .font(.title)<br />                        .offset(y: <span class="hljs-operator">-</span><span class="hljs-number">100</span>)<br />                    , alignment: .top)<br />                .overlay(<br />                    <span class="hljs-type">VStack</span> {<br />                        <span class="hljs-type">Slider</span>(value: <span class="hljs-variable">$degrees</span>, in: <span class="hljs-number">0</span><span class="hljs-operator">...</span><span class="hljs-number">360</span>)<br />                        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(Int(degrees))</span>&quot;</span>)<br />                    }<br />                    .offset(y: <span class="hljs-number">100</span>)<br />                    .font(.title),<br />                    alignment: .bottom<br />                )<br />            <br />            <span class="hljs-type">Image</span>(<span class="hljs-string">&quot;peter&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .offset(y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)<br />                .rotationEffect(.degrees(degrees))<br />            <br />        }<br />        .onReceive(timer, perform: { (<span class="hljs-keyword">_</span>) <span class="hljs-keyword">in</span><br />            degrees <span class="hljs-operator">+=</span> <span class="hljs-number">1</span><br />            <span class="hljs-keyword">if</span> degrees <span class="hljs-operator">==</span> <span class="hljs-number">360</span> {<br />                degrees <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />            }<br />        })<br />        <br />    }<br />}</span></pre><h3 name="523a" id="523a" class="graf graf--h3 graf-after--pre">UIKit</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="4a4d" id="4a4d" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> circleImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> peterImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> label: <span class="hljs-type">UILabel</span>!<br />    <span class="hljs-keyword">var</span> cancellable: <span class="hljs-type">AnyCancellable</span>?<br />    <span class="hljs-keyword">var</span> degrees: <span class="hljs-type">Float</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>    <br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> slider: <span class="hljs-type">UISlider</span>!<br /><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateLocation</span>() {<br />        slider.value <span class="hljs-operator">=</span> degrees<br />        peterImageView.transform <span class="hljs-operator">=</span> <span class="hljs-type">CGAffineTransform</span>.identity.rotated(by: <span class="hljs-type">CGFloat</span>.pi <span class="hljs-operator">/</span> <span class="hljs-number">180</span> <span class="hljs-operator">*</span> <span class="hljs-type">CGFloat</span>(degrees)).translatedBy(x: <span class="hljs-number">0</span>, y: <span class="hljs-operator">-</span><span class="hljs-number">150</span>)<br />        label.text <span class="hljs-operator">=</span> <span class="hljs-string">&quot;<span class="hljs-subst">\(Int(degrees))</span>&quot;</span><br />    }<br />    <br />    <br />    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">sliderChange</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-type">UISlider</span>) {<br />        degrees <span class="hljs-operator">=</span> sender.value<br />        updateLocation()<br />    }<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />        cancellable <span class="hljs-operator">=</span> <span class="hljs-type">Timer</span>.publish(every: <span class="hljs-number">0.05</span>, on: .main, in: .common)<br />            .autoconnect()<br />            .sink {[<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] (<span class="hljs-keyword">_</span>) <span class="hljs-keyword">in</span><br />                <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span> <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />                <span class="hljs-keyword">self</span>.degrees <span class="hljs-operator">+=</span> <span class="hljs-number">1</span><br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">self</span>.degrees <span class="hljs-operator">==</span> <span class="hljs-number">360</span> {<br />                    <span class="hljs-keyword">self</span>.degrees <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />                }<br />                <span class="hljs-keyword">self</span>.updateLocation()<br />            }<br />        <br />    }<br />       <br />}</span></pre><h3 name="b0de" id="b0de" class="graf graf--h3 graf-after--pre">方法2: 利用畫圓弧的 path 找出元件的中心點座標</h3><h3 name="38ca" id="38ca" class="graf graf--h3 graf-after--h3">SwiftUI</h3><p name="f8e2" id="f8e2" class="graf graf--p graf-after--h3">利用 Path 畫圓弧，它的 currentPoint 即為 Peter 的中心點座標。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9ee7" id="9ee7" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> peterDegres: <span class="hljs-type">Double</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">getPeterPosition</span>(<span class="hljs-params">size</span>: <span class="hljs-type">CGSize</span>) -&gt; <span class="hljs-type">CGPoint</span> {<br />        <span class="hljs-keyword">let</span> center <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: size.width<span class="hljs-operator">/</span><span class="hljs-number">2</span>, y: size.height<span class="hljs-operator">/</span><span class="hljs-number">2</span>)<br />        <span class="hljs-keyword">var</span> path <span class="hljs-operator">=</span> <span class="hljs-type">Path</span>()<br />        path.addArc(center: center, radius: <span class="hljs-number">150</span>, startAngle: .degrees(<span class="hljs-number">0</span>), endAngle: .degrees(peterDegres), clockwise: <span class="hljs-literal">false</span>)<br />        <span class="hljs-keyword">return</span> path.currentPoint <span class="hljs-operator">??</span> .zero<br />    }<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">GeometryReader</span> { (geometry) <span class="hljs-keyword">in</span><br />            <span class="hljs-type">ZStack</span> {<br />                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;heart.circle&quot;</span>)<br />                    .resizable()<br />                    .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />                    .overlay(<br />                        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;only the young can run&quot;</span>)<br />                            .font(.title)<br />                            .offset(y: <span class="hljs-operator">-</span><span class="hljs-number">50</span>)<br />                        , alignment: .top)<br />                    .overlay(<br />                        <span class="hljs-type">VStack</span> {<br />                            <span class="hljs-type">Slider</span>(value: <span class="hljs-variable">$peterDegres</span>, in: <span class="hljs-number">0</span><span class="hljs-operator">...</span><span class="hljs-number">360</span>)<br />                            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(Int(peterDegres))</span>&quot;</span>)<br />                        }<br />                        .offset(y: <span class="hljs-number">100</span>)<br />                        .font(.title),<br />                        alignment: .bottom<br />                )<br />                <br />                <span class="hljs-type">Image</span>(<span class="hljs-string">&quot;peter&quot;</span>)<br />                    .resizable()<br />                    .scaledToFit()<br />                    .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                    .position(getPeterPosition(size: geometry.size))<br />                <br />            }<br />        }<br />        <br />        <br />    }<br />}</span></pre><p name="d1a3" id="d1a3" class="graf graf--p graf-after--pre">此做法的繞圓效果跟前個做法有小小的差異。如下圖所示，Peter 將繞圓移動，但 Peter 本身不會旋轉，一直都像男子漢般筆直站著。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"><figure name="4a16" id="4a16" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 33.066%;"><img class="graf-image" data-image-id="1*5hWSTRbI2UMOwQWzH9L1sw.jpeg" data-width="510" data-height="952" src="https://cdn-images-1.medium.com/max/400/1*5hWSTRbI2UMOwQWzH9L1sw.jpeg"></figure><figure name="f72c" id="f72c" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 34.053%;"><img class="graf-image" data-image-id="1*lBBfSrwUbdaPITaaBD0Q1w.jpeg" data-width="534" data-height="968" src="https://cdn-images-1.medium.com/max/600/1*lBBfSrwUbdaPITaaBD0Q1w.jpeg"></figure><figure name="a591" id="a591" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 32.881%;"><img class="graf-image" data-image-id="1*Anfg4n6FWGm9r15hniCVhQ.jpeg" data-width="516" data-height="968" src="https://cdn-images-1.medium.com/max/400/1*Anfg4n6FWGm9r15hniCVhQ.jpeg"></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="0509" id="0509" class="graf graf--h3 graf-after--figure">UIKit</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="dc61" id="dc61" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content">`<span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> circleImageView: <span class="hljs-type">UIImageView</span>!<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> peterImageView: <span class="hljs-type">UIImageView</span>!<br />    <br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">updateLocation</span>(<span class="hljs-params">degrees</span>: <span class="hljs-type">CGFloat</span>) {<br />        <span class="hljs-keyword">let</span> path <span class="hljs-operator">=</span> <span class="hljs-type">UIBezierPath</span>()<br />        <span class="hljs-keyword">let</span> oneDegree <span class="hljs-operator">=</span> <span class="hljs-type">CGFloat</span>.pi <span class="hljs-operator">/</span> <span class="hljs-number">180</span><br />        <span class="hljs-keyword">let</span> endAngle <span class="hljs-operator">=</span> oneDegree <span class="hljs-operator">*</span> degrees<br />        path.addArc(withCenter: circleImageView.center, radius: <span class="hljs-number">150</span>, startAngle: <span class="hljs-number">0</span>, endAngle: endAngle, clockwise: <span class="hljs-literal">true</span>)<br />        peterImageView.center <span class="hljs-operator">=</span> path.currentPoint<br />    }<br />    <br />    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">sliderChange</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-type">UISlider</span>) {<br />        updateLocation(degrees: <span class="hljs-type">CGFloat</span>(sender.value))<br />    }<br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLayoutSubviews</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLayoutSubviews()<br />        updateLocation(degrees: <span class="hljs-number">0</span>)<br />    }    <br />}</span></pre><p name="5c3c" id="5c3c" class="graf graf--p graf-after--pre">我們在 viewDidLayoutSubviews 裡呼叫 updateLocation(degrees: 0)，讓 Peter 圖片一開始在角度 0 的位置。使用 viewDidLayoutSubviews 的原因是考慮 auto layout，可參考以下連結的說明。</p><div name="e807" id="e807" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/viewdidload-viewdidlayoutsubviews-%E6%99%82%E5%85%83%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A4%A7%E5%B0%8F-d3e3c1c3290d" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/viewdidload-viewdidlayoutsubviews-%E6%99%82%E5%85%83%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A4%A7%E5%B0%8F-d3e3c1c3290d" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/viewdidload-viewdidlayoutsubviews-%E6%99%82%E5%85%83%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A4%A7%E5%B0%8F-d3e3c1c3290d"><strong class="markup--strong markup--mixtapeEmbed-strong">viewDidLoad &amp; viewDidLayoutSubviews 時元件的位置大小</strong><br><em class="markup--em markup--mixtapeEmbed-em">開發 iOS App 時，我們時常在 view controller 的 viewDidLoad 做事，比方抓取網路資料或設定畫面的內容。不過當使用 auto layout 設計畫面時，元件要等到…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/viewdidload-viewdidlayoutsubviews-%E6%99%82%E5%85%83%E4%BB%B6%E7%9A%84%E4%BD%8D%E7%BD%AE%E5%A4%A7%E5%B0%8F-d3e3c1c3290d" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6d2bccc00f3b2459616cb3a776e2d6bf" data-thumbnail-img-id="1*e6indlf9PM1mHZriDZumBw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*e6indlf9PM1mHZriDZumBw.jpeg);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/fe91fb66062f"><time class="dt-published" datetime="2020-07-22T10:11:24.043Z">July 22, 2020</time></a>.</p><p><a href="https://medium.com/@apppeterpan/ios-app-%E8%AE%93%E5%85%83%E4%BB%B6%E7%B9%9E%E5%9C%93%E7%A7%BB%E5%8B%95%E7%9A%84%E6%96%B9%E6%B3%95-fe91fb66062f" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>