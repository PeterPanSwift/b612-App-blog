<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>使用 Xcode Instruments 的 Network 偵測 iOS App 的網路封包</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">使用 Xcode Instruments 的 Network 偵測 iOS App 的網路封包</h1>
</header>
<section data-field="subtitle" class="p-summary">
透過 Xcode Instruments 的 Network 工具我們可以方便地偵測 iOS App 的網路封包，快速查出 App 裡串接的 API 網址，header 和 body 的詳細內容。
</section>
<section data-field="body" class="e-content">
<section name="73e4" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d900" id="d900" class="graf graf--h3 graf--leading graf--title">使用 Xcode Instruments 的 Network 偵測 iOS App 的網路封包</h3><p name="a5ab" id="a5ab" class="graf graf--p graf-after--h3">透過 Xcode Instruments 的 Network 工具我們可以方便地偵測 iOS App 的網路封包，快速查出 App 裡串接的 API 網址，header 和 body 的詳細內容。</p><p name="ed10" id="ed10" class="graf graf--p graf-after--p">以下我們利用串接 Reqres API 的小程式介紹 Network 工具的使用。</p><div name="b50e" id="b50e" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://reqres.in/" data-href="https://reqres.in/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://reqres.in/"><strong class="markup--strong markup--mixtapeEmbed-strong">Reqres - <em class="markup--em markup--mixtapeEmbed-em">A hosted REST-API ready to respond to your AJAX requests</em></strong><br>A hosted REST-API ready to respond to your AJAX requestsreqres.in</a><a href="https://reqres.in/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3f830c9f1477420fe7b4f550a9255a95" data-thumbnail-img-id="0*IaE0Ty4NHS76FI0X" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*IaE0Ty4NHS76FI0X);"></a></div><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1cdd" id="1cdd" class="graf graf--pre graf-after--mixtapeEmbed graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">LoginBody</span>: <span class="hljs-title class_">Encodable</span> {<br />    <span class="hljs-keyword">let</span> email: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> password: <span class="hljs-type">String</span><br />}<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Button</span>(<span class="hljs-string">&quot;fetch user&quot;</span>) {<br />                <span class="hljs-type">Task</span> {<br />                    <span class="hljs-keyword">do</span> {<br />                        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchUsers()<br />                    } <span class="hljs-keyword">catch</span> {<br />                    }<br />                }<br />            }<br />            <span class="hljs-type">Button</span>(<span class="hljs-string">&quot;login&quot;</span>) {<br />                <span class="hljs-type">Task</span> {<br />                    <span class="hljs-keyword">do</span> {<br />                        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> login()<br />                    } <span class="hljs-keyword">catch</span> {<br />                    }<br />                }<br />            }<br />        }<br />    }<br /><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchUsers</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {<br />        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://reqres.in/api/users?page=1&quot;</span>)<span class="hljs-operator">!</span><br />        <span class="hljs-keyword">var</span> request <span class="hljs-operator">=</span> <span class="hljs-type">URLRequest</span>(url: url)<br />        request.setValue(<span class="hljs-string">&quot;reqres-free-v1&quot;</span>, forHTTPHeaderField: <span class="hljs-string">&quot;x-api-key&quot;</span>)<br />        <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(for: request)<br />    }<br /><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">login</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {<br />        <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://reqres.in/api/login&quot;</span>)<span class="hljs-operator">!</span><br />        <span class="hljs-keyword">var</span> request <span class="hljs-operator">=</span> <span class="hljs-type">URLRequest</span>(url: url)<br />        request.httpMethod <span class="hljs-operator">=</span> <span class="hljs-string">&quot;post&quot;</span><br />        request.setValue(<span class="hljs-string">&quot;reqres-free-v1&quot;</span>, forHTTPHeaderField: <span class="hljs-string">&quot;x-api-key&quot;</span>)<br />        request.setValue(<br />            <span class="hljs-string">&quot;application/json&quot;</span>,<br />            forHTTPHeaderField: <span class="hljs-string">&quot;Content-Type&quot;</span><br />        )<br />        <span class="hljs-keyword">let</span> loginBody <span class="hljs-operator">=</span> <span class="hljs-type">LoginBody</span>(<br />            email: <span class="hljs-string">&quot;eve.holt@reqres.in&quot;</span>,<br />            password: <span class="hljs-string">&quot;cityslicka&quot;</span><br />        )<br />        request.httpBody <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">JSONEncoder</span>().encode(loginBody)<br />        <span class="hljs-keyword">_</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(for: request)<br />    }<br />}</span></pre><p name="56ae" id="56ae" class="graf graf--p graf-after--pre">點擊 fetch user 會串接 HTTP Get API，點擊 login 會串接 HTTP Post API。</p><figure name="ccae" id="ccae" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*k_h-_QS9So2OxF2Nv-MUxg.png" data-width="1206" data-height="2622" src="https://cdn-images-1.medium.com/max/800/1*k_h-_QS9So2OxF2Nv-MUxg.png"></figure><p name="8054" id="8054" class="graf graf--p graf-after--figure">從 Xcode 啟動 App 到實機( ps: 目前 Network 工具無法偵測模擬器的網路封包)，然後從 Quick Actions 點選 Profile 叫出 Instruments 的樣板選擇視窗。</p><figure name="4539" id="4539" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4EOoAjcV48IuK7zFEUiadg.png" data-width="1148" data-height="238" src="https://cdn-images-1.medium.com/max/800/1*4EOoAjcV48IuK7zFEUiadg.png"></figure><p name="ed20" id="ed20" class="graf graf--p graf-after--figure">選擇 Network。</p><figure name="6efe" id="6efe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8R80mFF49X0_JUqwH25EWA.png" data-width="1580" data-height="1014" src="https://cdn-images-1.medium.com/max/800/1*8R80mFF49X0_JUqwH25EWA.png"></figure><p name="3700" id="3700" class="graf graf--p graf-after--figure">Network 視窗的 Target 欄位選擇 Attach to，App 選擇剛剛從實機啟動的 App。</p><figure name="f7f2" id="f7f2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*NeDvD_NZ7S3ozXF90vr3gg.png" data-width="3068" data-height="502" src="https://cdn-images-1.medium.com/max/800/1*NeDvD_NZ7S3ozXF90vr3gg.png"></figure><p name="c10c" id="c10c" class="graf graf--p graf-after--figure">點擊上方的圓形按鈕開始偵測。</p><figure name="45c7" id="45c7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*edxGT2irz7lU0S7H1tlQig.png" data-width="504" data-height="108" src="https://cdn-images-1.medium.com/max/800/1*edxGT2irz7lU0S7H1tlQig.png"></figure><p name="13df" id="13df" class="graf graf--p graf-after--figure">點選 Record Anyway。</p><figure name="fa65" id="fa65" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9sTl9--mGvbfuhBpvhG__Q.png" data-width="1080" data-height="642" src="https://cdn-images-1.medium.com/max/800/1*9sTl9--mGvbfuhBpvhG__Q.png"></figure><p name="5317" id="5317" class="graf graf--p graf-after--figure">Instruments 視窗開始偵測 App 的網路封包。</p><figure name="2716" id="2716" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*km2L7XeMKwF3gy5xMmKkmw.png" data-width="1964" data-height="650" src="https://cdn-images-1.medium.com/max/800/1*km2L7XeMKwF3gy5xMmKkmw.png"></figure><p name="c240" id="c240" class="graf graf--p graf-after--figure">點擊 App 的 fetch user 和 login 按鈕，從下圖的藍色長條和 count 欄位可看出 App 發送了兩個 HTTP request。</p><figure name="c255" id="c255" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*I09pfbQvZWWJg9QO-0m4WA.png" data-width="2456" data-height="1356" src="https://cdn-images-1.medium.com/max/800/1*I09pfbQvZWWJg9QO-0m4WA.png"></figure><p name="6451" id="6451" class="graf graf--p graf-after--figure">從左下的選單選擇 List: HTTP Transactions。</p><figure name="3c25" id="3c25" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jGkAzxbsfU4xn3s_KVe0UQ.png" data-width="1450" data-height="246" src="https://cdn-images-1.medium.com/max/800/1*jGkAzxbsfU4xn3s_KVe0UQ.png"></figure><p name="f108" id="f108" class="graf graf--p graf-after--figure">從列表可看到 HTTP transaction 的網址和 method。</p><figure name="f853" id="f853" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*htU72X1MRZgETQivMFfHVg.png" data-width="2988" data-height="254" src="https://cdn-images-1.medium.com/max/800/1*htU72X1MRZgETQivMFfHVg.png"></figure><p name="89d9" id="89d9" class="graf graf--p graf-after--figure">點選 transaction 可在右側看到 request 和 response 的詳細內容。</p><figure name="e393" id="e393" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ynen0S-jpVTaryNC4uz4yQ.png" data-width="3294" data-height="514" src="https://cdn-images-1.medium.com/max/800/1*Ynen0S-jpVTaryNC4uz4yQ.png"></figure><p name="e146" id="e146" class="graf graf--p graf-after--figure">從下圖可看到 request 的 HTTP header x-api-key，value 為 reqres-free-v1。</p><figure name="ab82" id="ab82" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HhkG-9OvscaoikknVd1Lmg.png" data-width="776" data-height="426" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*HhkG-9OvscaoikknVd1Lmg.png"></figure><p name="8c7e" id="8c7e" class="graf graf--p graf-after--figure">從 Response Body 可看到 API 回傳的 JSON。</p><figure name="89fd" id="89fd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*v5T092PvazmyyWWLOIUeoQ.png" data-width="926" data-height="1120" src="https://cdn-images-1.medium.com/max/800/1*v5T092PvazmyyWWLOIUeoQ.png"></figure><p name="af1e" id="af1e" class="graf graf--p graf-after--figure">點選 Show Full Content 可查看完整的 JSON 內容。</p><figure name="718b" id="718b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*D3gIGhE2rReG9ZFGaJtkNw.png" data-width="1734" data-height="956" src="https://cdn-images-1.medium.com/max/800/1*D3gIGhE2rReG9ZFGaJtkNw.png"></figure><p name="5f05" id="5f05" class="graf graf--p graf-after--figure">登入的 API 是 HTTP post，從下圖可看到 Request body 的 JSON 內容。</p><figure name="ef1b" id="ef1b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yzG5o5KnZYw9ektkhBrzDg.png" data-width="788" data-height="644" src="https://cdn-images-1.medium.com/max/800/1*yzG5o5KnZYw9ektkhBrzDg.png"></figure><p name="9017" id="9017" class="graf graf--p graf-after--figure">切換到 List: URLSession Tasks 可查詢 URLSession task 的相關程式。</p><figure name="f3c5" id="f3c5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JNPxLITC9Mgm9dXz6v50XA.png" data-width="540" data-height="220" src="https://cdn-images-1.medium.com/max/800/1*JNPxLITC9Mgm9dXz6v50XA.png"></figure><p name="01e6" id="01e6" class="graf graf--p graf-after--figure">點選 task 後，從右側可看到 App 裡產生 task 的相關程式，比方 ContentView 的 fetchUsers。</p><figure name="0de9" id="0de9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*kfsR4fsSFesyTB3GCiPlWQ.png" data-width="3348" data-height="596" src="https://cdn-images-1.medium.com/max/800/1*kfsR4fsSFesyTB3GCiPlWQ.png"></figure><h3 name="ae98" id="ae98" class="graf graf--h3 graf-after--figure">相關連結</h3><div name="f4f6" id="f4f6" class="graf graf--mixtapeEmbed graf-after--h3 graf--trailing"><a href="https://developer.apple.com/documentation/foundation/analyzing-http-traffic-with-instruments" data-href="https://developer.apple.com/documentation/foundation/analyzing-http-traffic-with-instruments" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/analyzing-http-traffic-with-instruments"><strong class="markup--strong markup--mixtapeEmbed-strong">Analyzing HTTP traffic with Instruments | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Measure HTTP-based network performance and usage of your apps.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/analyzing-http-traffic-with-instruments" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="59a50ff2e044913f03c33239ee314192" data-thumbnail-img-id="0*TnQzi9_kxYvv_SY6" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*TnQzi9_kxYvv_SY6);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/ba036277987d"><time class="dt-published" datetime="2025-06-17T12:40:58.673Z">June 17, 2025</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E4%BD%BF%E7%94%A8-xcode-instruments-%E7%9A%84-network-%E5%81%B5%E6%B8%AC-ios-app-%E7%9A%84%E7%B6%B2%E8%B7%AF%E5%B0%81%E5%8C%85-ba036277987d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>