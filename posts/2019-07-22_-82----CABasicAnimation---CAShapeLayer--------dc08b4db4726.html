<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>#82 利用 CABasicAnimation &amp; CAShapeLayer 繪製線條動畫</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">#82 利用 CABasicAnimation &amp; CAShapeLayer 繪製線條動畫</h1>
</header>
<section data-field="subtitle" class="p-summary">
利用 CAShapeLayer &amp; UIBezierPath 我們可以繪製線條，不過不僅於此，當我們結合 CABasicAnimation 時，我們可以讓它變成小畫家，以生動的動畫一筆一劃繪製線條呢。
</section>
<section data-field="body" class="e-content">
<section name="5892" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="4171" id="4171" class="graf graf--h3 graf--leading graf--title">#82 利用 CABasicAnimation &amp; CAShapeLayer 繪製線條動畫</h3><p name="ee20" id="ee20" class="graf graf--p graf-after--h3">利用 CAShapeLayer &amp; UIBezierPath 我們可以繪製線條，不過不僅於此，當我們結合 CABasicAnimation 時，我們還能讓它變成小畫家，以生動的動畫一筆一劃繪製線條呢。</p><p name="b2e4" id="b2e4" class="graf graf--p graf-after--p">比方我們可參考以下連結 Ting 同學繪製的 Apple，一筆一劃畫出美味的蘋果咬一口。</p><div name="ccf7" id="ccf7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/43-%E5%BE%9E%E7%A8%8B%E5%BC%8F%E8%A3%BD%E4%BD%9C%E5%9C%8B%E6%97%97%E5%9C%96%E6%A1%88-fc3ebed11bbe" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/43-%E5%BE%9E%E7%A8%8B%E5%BC%8F%E8%A3%BD%E4%BD%9C%E5%9C%8B%E6%97%97%E5%9C%96%E6%A1%88-fc3ebed11bbe" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/43-%E5%BE%9E%E7%A8%8B%E5%BC%8F%E8%A3%BD%E4%BD%9C%E5%9C%8B%E6%97%97%E5%9C%96%E6%A1%88-fc3ebed11bbe"><strong class="markup--strong markup--mixtapeEmbed-strong">#43 從程式製作國旗圖案</strong><br><em class="markup--em markup--mixtapeEmbed-em">想說練習畫國旗是因為要練習圖層堆疊和合併<br>那不用畫國旗應該也可以</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/43-%E5%BE%9E%E7%A8%8B%E5%BC%8F%E8%A3%BD%E4%BD%9C%E5%9C%8B%E6%97%97%E5%9C%96%E6%A1%88-fc3ebed11bbe" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="51ff0ce8f018b2832a9a5beaa9411ca2" data-thumbnail-img-id="1*B0IrprOu0UenXXr7AYh0iQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*B0IrprOu0UenXXr7AYh0iQ.png);"></a></div><figure name="0277" id="0277" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*DuEZ8DZkHq8S7xJnTgrIwQ.gif" data-width="334" data-height="675" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*DuEZ8DZkHq8S7xJnTgrIwQ.gif"></figure><p name="60d2" id="60d2" class="graf graf--p graf-after--figure">接下來就讓我們示範如何利用 CABasicAnimation 繪製帥氣的勾勾吧。</p><h3 name="2392" id="2392" class="graf graf--h3 graf-after--p">以 CAShapeLayer 繪製帥氣的勾勾</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6d78" id="6d78" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />   <span class="hljs-keyword">super</span>.viewDidLoad()<br />   <span class="hljs-keyword">let</span> path <span class="hljs-operator">=</span> <span class="hljs-type">UIBezierPath</span>()<br />   <span class="hljs-keyword">var</span> point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">10</span>, y: <span class="hljs-number">260</span>)<br />   path.move(to: point)<br />   point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">60</span>, y: <span class="hljs-number">300</span>)<br />   path.addLine(to: point)<br />   point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">140</span>, y: <span class="hljs-number">160</span>)<br />   path.addLine(to: point)<br />   <span class="hljs-keyword">let</span> checkmarkLayer <span class="hljs-operator">=</span> <span class="hljs-type">CAShapeLayer</span>()<br />   checkmarkLayer.path <span class="hljs-operator">=</span> path.cgPath<br />   checkmarkLayer.lineWidth <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />   checkmarkLayer.strokeColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.red.cgColor<br />   checkmarkLayer.fillColor <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span><br />   view.layer.addSublayer(checkmarkLayer)<br />}</span></pre><figure name="94ed" id="94ed" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*ItXK6rBtOYSD0Nu4VyPYbw.jpeg" data-width="920" data-height="1604" src="https://cdn-images-1.medium.com/max/800/1*ItXK6rBtOYSD0Nu4VyPYbw.jpeg"></figure><p name="c35a" id="c35a" class="graf graf--p graf-after--figure">關於如何利用 CAShapeLayer &amp; UIBezierPath 繪製線條，相關說明可參考以下連結的方法 2，addSublayer。</p><div name="586b" id="586b" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87-view-%E8%AE%8A%E6%88%90%E4%BB%BB%E6%84%8F%E5%BD%A2%E7%8B%80%E7%9A%84%E4%B8%89%E7%A8%AE%E6%96%B9%E6%B3%95-d43e6e4b8fb5" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87-view-%E8%AE%8A%E6%88%90%E4%BB%BB%E6%84%8F%E5%BD%A2%E7%8B%80%E7%9A%84%E4%B8%89%E7%A8%AE%E6%96%B9%E6%B3%95-d43e6e4b8fb5" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87-view-%E8%AE%8A%E6%88%90%E4%BB%BB%E6%84%8F%E5%BD%A2%E7%8B%80%E7%9A%84%E4%B8%89%E7%A8%AE%E6%96%B9%E6%B3%95-d43e6e4b8fb5"><strong class="markup--strong markup--mixtapeEmbed-strong">將 view 變成任意形狀的三種方法</strong><br><em class="markup--em markup--mixtapeEmbed-em">iOS 的 App 畫面因為有著各式各樣的元件而變得美麗，然而不管是 view，label，image view 還是 button，它們預設都是長方形的形狀。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87-view-%E8%AE%8A%E6%88%90%E4%BB%BB%E6%84%8F%E5%BD%A2%E7%8B%80%E7%9A%84%E4%B8%89%E7%A8%AE%E6%96%B9%E6%B3%95-d43e6e4b8fb5" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c6e52d7fd25ec852f1aa11190ca01900" data-thumbnail-img-id="1*28tgIgI6QpP5SiO61zqQZA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*28tgIgI6QpP5SiO61zqQZA.jpeg);"></a></div><p name="ca89" id="ca89" class="graf graf--p graf-after--mixtapeEmbed">若想查詢線條的座標位置，可將圖片上傳到網站 iview，參考以下連結的教學。</p><div name="3fa6" id="3fa6" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D%E7%B6%B2%E7%AB%99%E6%9F%A5%E8%A9%A2%E5%9C%96%E7%89%87%E7%9A%84%E5%BA%A7%E6%A8%99%E7%95%AB%E5%9C%96-f257743264a5" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D%E7%B6%B2%E7%AB%99%E6%9F%A5%E8%A9%A2%E5%9C%96%E7%89%87%E7%9A%84%E5%BA%A7%E6%A8%99%E7%95%AB%E5%9C%96-f257743264a5" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D%E7%B6%B2%E7%AB%99%E6%9F%A5%E8%A9%A2%E5%9C%96%E7%89%87%E7%9A%84%E5%BA%A7%E6%A8%99%E7%95%AB%E5%9C%96-f257743264a5"><strong class="markup--strong markup--mixtapeEmbed-strong">搭配網站查詢圖片的座標畫圖</strong><br><em class="markup--em markup--mixtapeEmbed-em">1 連到網站 iview</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D%E7%B6%B2%E7%AB%99%E6%9F%A5%E8%A9%A2%E5%9C%96%E7%89%87%E7%9A%84%E5%BA%A7%E6%A8%99%E7%95%AB%E5%9C%96-f257743264a5" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="e67804266f3199940c1702907f7bab22" data-thumbnail-img-id="1*HieS8fi71-5n1Jc9dSX2qA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*HieS8fi71-5n1Jc9dSX2qA.jpeg);"></a></div><h3 name="4d3f" id="4d3f" class="graf graf--h3 graf-after--mixtapeEmbed">使用 CABasicAnimation 設定動畫</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="0e27" id="0e27" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> animation <span class="hljs-operator">=</span> <span class="hljs-type">CABasicAnimation</span>(keyPath: <span class="hljs-string">&quot;strokeEnd&quot;</span>)<br />animation.fromValue <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />animation.toValue <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br />animation.duration <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />checkmarkLayer.add(animation, forKey: <span class="hljs-literal">nil</span>)</span></pre><p name="2674" id="2674" class="graf graf--p graf-after--pre">結果</p><figure name="c559" id="c559" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HqSEomlrzY_OLpH14tRQnQ.gif" data-width="334" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*HqSEomlrzY_OLpH14tRQnQ.gif"></figure><p name="e25b" id="e25b" class="graf graf--p graf-after--figure">說明:</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="4ef1" id="4ef1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> animation <span class="hljs-operator">=</span> <span class="hljs-type">CABasicAnimation</span>(keyPath: <span class="hljs-string">&quot;strokeEnd&quot;</span>)</span></pre><p name="7a08" id="7a08" class="graf graf--p graf-after--pre">CABasicAnimation 可以實現許多動畫效果，比方透明度的變化，位置大小的變化等，而動畫的效果則由我們生成 CABasicAnimation 時傳入的 keyPath 決定。此處我們傳入 strokeEnd，實現從 CABasicAnimation 路徑的起點畫線到終點的動畫效果。</p><div name="9ce7" id="9ce7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/quartzcore/cabasicanimation" data-href="https://developer.apple.com/documentation/quartzcore/cabasicanimation" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quartzcore/cabasicanimation"><strong class="markup--strong markup--mixtapeEmbed-strong">CABasicAnimation | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">An object that provides basic, single-keyframe animation capabilities for a layer property.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quartzcore/cabasicanimation" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6208694a5365ff4aef0f3d69ba79a895" data-thumbnail-img-id="0*U6V6t5AJCTq54wi9" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*U6V6t5AJCTq54wi9);"></a></div><div name="6c3e" id="6c3e" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developer.apple.com/documentation/quartzcore/capropertyanimation/1412534-init" data-href="https://developer.apple.com/documentation/quartzcore/capropertyanimation/1412534-init" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quartzcore/capropertyanimation/1412534-init"><strong class="markup--strong markup--mixtapeEmbed-strong">init(keyPath:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Creates and returns an instance for the specified key path.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quartzcore/capropertyanimation/1412534-init" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="1a450c312f48bd09f2696fcc906a4368" data-thumbnail-img-id="0*SnEqEzTxjIauqEn6" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SnEqEzTxjIauqEn6);"></a></div><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5556" id="5556" class="graf graf--pre graf-after--mixtapeEmbed graf--preV2"><span class="pre--content">animation.fromValue <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />animation.toValue <span class="hljs-operator">=</span> <span class="hljs-number">1</span></span></pre><p name="c07b" id="c07b" class="graf graf--p graf-after--pre">控制動畫從哪裡開始跟結束。我們的動畫將作用於 CAShapeLayer，fromValue 設為 0 表示它將從 CAShapeLayer 路徑的起點開始，toValue 設為 1 表示動畫將在畫到路徑終點時結束。</p><p name="6c65" id="6c65" class="graf graf--p graf-after--p">讓我們調整一下數值，進一步了解它的作用。比方我們將 fromValue 設為 0.2， toValue 設為 0.8，此時將如下圖，動畫在線條已經畫了一部分時才開始，在還沒畫到終點時動畫就被狠心地終止了。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b3d1" id="b3d1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">animation.fromValue <span class="hljs-operator">=</span> <span class="hljs-number">0.2</span><br />animation.toValue <span class="hljs-operator">=</span> <span class="hljs-number">0.8</span></span></pre><figure name="fa80" id="fa80" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*AyhIIafFuyrc6_SWpFNnyA.gif" data-width="334" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*AyhIIafFuyrc6_SWpFNnyA.gif"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="de4b" id="de4b" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content">animation.duration <span class="hljs-operator">=</span> <span class="hljs-number">5</span></span></pre><p name="f5cf" id="f5cf" class="graf graf--p graf-after--pre">設定動畫的時間，以秒為單位。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5891" id="5891" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">checkmarkLayer.add(animation, forKey: <span class="hljs-literal">nil</span>)</span></pre><p name="78dd" id="78dd" class="graf graf--p graf-after--pre">將動畫加到 CAShapeLayer 上，實現繪製 CAShapeLayer 線條的動畫效果。</p><div name="93e7" id="93e7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/quartzcore/calayer/1410848-add" data-href="https://developer.apple.com/documentation/quartzcore/calayer/1410848-add" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quartzcore/calayer/1410848-add"><strong class="markup--strong markup--mixtapeEmbed-strong">add(_:forKey:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Add the specified animation object to the layer&#39;s render tree.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quartzcore/calayer/1410848-add" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="10b79d399b6f70b42e682fe26b26a2ac" data-thumbnail-img-id="0*px1UgkMqqKubRanN" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*px1UgkMqqKubRanN);"></a></div><p name="b3e8" id="b3e8" class="graf graf--p graf-after--mixtapeEmbed">了解基本的動畫繪製方法後，接下來我們改用一開始 Ting 同學繪製的 Apple 為例，進一步說明其它進階的效果。</p><h3 name="5a92" id="5a92" class="graf graf--h3 graf-after--p">動畫的速度</h3><p name="528f" id="528f" class="graf graf--p graf-after--h3">設定 timingFunction 調整動畫的速度，比方 easeInEaseOut 表示一開始比較慢，過程中逐漸加速，接近結尾時再放慢速度。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="379e" id="379e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">animation.timingFunction <span class="hljs-operator">=</span> <span class="hljs-type">CAMediaTimingFunction</span>(name: .easeInEaseOut)</span></pre><figure name="90e0" id="90e0" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*kMyo2gqhhzv3ahkxDkUFkA.gif" data-width="334" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*kMyo2gqhhzv3ahkxDkUFkA.gif"></figure><p name="c654" id="c654" class="graf graf--p graf-after--figure">關於其它可設定的速度名字，可參考以下連結。</p><div name="2472" id="2472" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/quartzcore/camediatimingfunctionname" data-href="https://developer.apple.com/documentation/quartzcore/camediatimingfunctionname" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quartzcore/camediatimingfunctionname"><strong class="markup--strong markup--mixtapeEmbed-strong">CAMediaTimingFunctionName | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">There&#39;s never been a better time to develop for Apple platforms.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quartzcore/camediatimingfunctionname" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6d9682e99950c7361347d4ed96787294" data-thumbnail-img-id="0*kY-2WX6apbZbxiOZ" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*kY-2WX6apbZbxiOZ);"></a></div><h3 name="16c5" id="16c5" class="graf graf--h3 graf-after--mixtapeEmbed">橡皮擦清除線條的動畫效果</h3><p name="6dea" id="6dea" class="graf graf--p graf-after--h3">生成 CABasicAnimation 時傳入 strokeStart 將實現橡皮擦清除線條的動畫效果。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3018" id="3018" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> animation <span class="hljs-operator">=</span> <span class="hljs-type">CABasicAnimation</span>(keyPath: <span class="hljs-string">&quot;strokeStart&quot;</span>)</span></pre><p name="4982" id="4982" class="graf graf--p graf-after--pre">如下圖所示，一開始 Apple 會先完整呈現，然後再照著當初繪製路徑的順序消除。</p><figure name="9f6f" id="9f6f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JFPEoUwhabig9RIBNR3lag.gif" data-width="334" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*JFPEoUwhabig9RIBNR3lag.gif"></figure><h3 name="4f11" id="4f11" class="graf graf--h3 graf-after--figure">重覆的動畫</h3><p name="6230" id="6230" class="graf graf--p graf-after--h3">CABasicAnimation 的 repeatCount 可以控制動畫重覆的次數，比方 2 表示動畫將重覆兩次。那如果希望動畫永遠不要停，一直到世界末日呢 ?</p><p name="4abd" id="4abd" class="graf graf--p graf-after--p">沒問題，只要設定 Float.greatestFiniteMagnitude 即可 !</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1458" id="1458" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">animation.repeatCount <span class="hljs-operator">=</span> .greatestFiniteMagnitude</span></pre><p name="f956" id="f956" class="graf graf--p graf-after--pre">比方以下為永不結束的畫圓(ring)動畫，半夜睡不著時可以看著它幫助入眠。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="d7b0" id="d7b0" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> circlePath <span class="hljs-operator">=</span> <span class="hljs-type">UIBezierPath</span>(roundedRect: <span class="hljs-type">CGRect</span>(x: <span class="hljs-number">50</span>, y: <span class="hljs-number">100</span>, width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>), cornerRadius: <span class="hljs-number">50</span>)<br /><span class="hljs-keyword">let</span> circleLayer <span class="hljs-operator">=</span> <span class="hljs-type">CAShapeLayer</span>()<br />circleLayer.path <span class="hljs-operator">=</span> circlePath.cgPath<br />circleLayer.lineWidth <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />circleLayer.strokeColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.red.cgColor<br />circleLayer.fillColor <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span><br />view.layer.addSublayer(circleLayer)<br /><span class="hljs-keyword">let</span> animation <span class="hljs-operator">=</span> <span class="hljs-type">CABasicAnimation</span>(keyPath: <span class="hljs-string">&quot;strokeEnd&quot;</span>)<br />animation.fromValue <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />animation.toValue <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br />animation.duration <span class="hljs-operator">=</span> <span class="hljs-number">1.5</span><br />animation.repeatCount <span class="hljs-operator">=</span> .greatestFiniteMagnitude<br />circleLayer.add(animation, forKey: <span class="hljs-literal">nil</span>)</span></pre><figure name="1e4c" id="1e4c" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*iLrzyfnOkZ1-uM1vjfqv8A.gif" data-width="334" data-height="675" src="https://cdn-images-1.medium.com/max/800/1*iLrzyfnOkZ1-uM1vjfqv8A.gif"></figure><h3 name="9057" id="9057" class="graf graf--h3 graf-after--figure">動畫結束時執行的程式</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7572" id="7572" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <span class="hljs-comment">// Do any additional setup after loading the view.</span><br />        <br />        <span class="hljs-keyword">let</span> path <span class="hljs-operator">=</span> <span class="hljs-type">UIBezierPath</span>()<br />        <span class="hljs-keyword">var</span> point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">10</span>, y: <span class="hljs-number">260</span>)<br />        path.move(to: point)<br />        point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">60</span>, y: <span class="hljs-number">300</span>)<br />        path.addLine(to: point)<br />        point <span class="hljs-operator">=</span> <span class="hljs-type">CGPoint</span>(x: <span class="hljs-number">140</span>, y: <span class="hljs-number">160</span>)<br />        path.addLine(to: point)<br />        path.close()<br />        <span class="hljs-keyword">let</span> checkmarkLayer <span class="hljs-operator">=</span> <span class="hljs-type">CAShapeLayer</span>()<br />        checkmarkLayer.path <span class="hljs-operator">=</span> path.cgPath<br />        checkmarkLayer.lineWidth <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />        checkmarkLayer.strokeColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.red.cgColor<br />        checkmarkLayer.fillColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.clear.cgColor<br />        view.layer.addSublayer(checkmarkLayer)<br />        <br />        <span class="hljs-type">CATransaction</span>.begin()<br />        <span class="hljs-type">CATransaction</span>.setCompletionBlock {<br />            checkmarkLayer.fillColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.blue.cgColor<br />        }<br />        <span class="hljs-keyword">let</span> animation <span class="hljs-operator">=</span> <span class="hljs-type">CABasicAnimation</span>(keyPath: <span class="hljs-string">&quot;strokeEnd&quot;</span>)<br />        animation.fromValue <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />        animation.toValue <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br />        animation.duration <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />        checkmarkLayer.add(animation, forKey: <span class="hljs-literal">nil</span>)<br />        <span class="hljs-type">CATransaction</span>.commit()<br />}</span></pre><p name="29ba" id="29ba" class="graf graf--p graf-after--pre">利用 CATransaction.setCompletionBlock 設定動畫結束時執行的程式，在將整個動畫的程式包在 CATransaction.begin() &amp; CATransaction.commit() 之間。</p><figure name="5c21" id="5c21" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Kd7GJYDHOiias5djMus88g.png" data-width="1064" data-height="734" src="https://cdn-images-1.medium.com/max/800/1*Kd7GJYDHOiias5djMus88g.png"></figure><h3 name="5da8" id="5da8" class="graf graf--h3 graf-after--figure">文字動畫</h3><p name="bb8c" id="bb8c" class="graf graf--p graf-after--h3">參考 Yuki 同學繪製的文字動畫。</p><figure name="f0af" id="f0af" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GhUcbddlvTJlXl-I4GsbNg.gif" data-width="296" data-height="640" src="https://cdn-images-1.medium.com/max/800/1*GhUcbddlvTJlXl-I4GsbNg.gif"></figure><div name="5aa1" id="5aa1" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/37-%E7%94%A8-cabasicanimation-%E5%92%8Ccashapelayer-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-c328458021c7" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/37-%E7%94%A8-cabasicanimation-%E5%92%8Ccashapelayer-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-c328458021c7" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/37-%E7%94%A8-cabasicanimation-%E5%92%8Ccashapelayer-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-c328458021c7"><strong class="markup--strong markup--mixtapeEmbed-strong">#37 用 CABasicAnimation 和CAShapeLayer 繪製動畫</strong><br><em class="markup--em markup--mixtapeEmbed-em">以 UIBezierPath 、 CAShapeLayer 繪製字母，再用 CABasicAnimation 設定動畫。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/37-%E7%94%A8-cabasicanimation-%E5%92%8Ccashapelayer-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-c328458021c7" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3d28a0b29558b023a3ae174408c396ed" data-thumbnail-img-id="1*hv3GhDaR0crGBThWxZnVtA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*hv3GhDaR0crGBThWxZnVtA.png);"></a></div><h3 name="d7ee" id="d7ee" class="graf graf--h3 graf-after--mixtapeEmbed">作品集</h3><div name="3ad9" id="3ad9" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E5%88%A9%E7%94%A8-cabasicanimation-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB-%E6%97%8B%E8%BD%89-8ccd9dbc6c6f" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E5%88%A9%E7%94%A8-cabasicanimation-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB-%E6%97%8B%E8%BD%89-8ccd9dbc6c6f" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E5%88%A9%E7%94%A8-cabasicanimation-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB-%E6%97%8B%E8%BD%89-8ccd9dbc6c6f"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 CABasicAnimation 繪製動畫, CGAffineTransform 縮放，位移，旋轉</strong><br><em class="markup--em markup--mixtapeEmbed-em">此範例使用 : CGAffineTransform ,CABasicAnimation , IBOutlet 方法來完成</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E5%88%A9%E7%94%A8-cabasicanimation-%E7%B9%AA%E8%A3%BD%E5%8B%95%E7%95%AB-cgaffinetransform-%E7%B8%AE%E6%94%BE-%E4%BD%8D%E7%A7%BB-%E6%97%8B%E8%BD%89-8ccd9dbc6c6f" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="cee34337291f5e285798b936f65b0e1e" data-thumbnail-img-id="1*XXtO7jt_CDAtykZRQ0uhIA.gif" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*XXtO7jt_CDAtykZRQ0uhIA.gif);"></a></div><div name="dbfb" id="dbfb" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/jason%E7%9A%84uibezierpath%E4%BD%9C%E6%A5%AD-584e40084c6e" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/jason%E7%9A%84uibezierpath%E4%BD%9C%E6%A5%AD-584e40084c6e" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/jason%E7%9A%84uibezierpath%E4%BD%9C%E6%A5%AD-584e40084c6e"><strong class="markup--strong markup--mixtapeEmbed-strong">Jason的UIBezierPath作業</strong><br><em class="markup--em markup--mixtapeEmbed-em">GitHub＝https://github.com/lakersbest/jason_UIBezierPath</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/jason%E7%9A%84uibezierpath%E4%BD%9C%E6%A5%AD-584e40084c6e" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="6e92623de3c914acbc3eef493c8d52a0" data-thumbnail-img-id="1*-0MGDt3TQjNy0h21NZH3uA.gif" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*-0MGDt3TQjNy0h21NZH3uA.gif);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/dc08b4db4726"><time class="dt-published" datetime="2019-07-22T06:24:53.402Z">July 22, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-cabasicanimation-cashapelayer-%E7%B9%AA%E8%A3%BD%E7%B7%9A%E6%A2%9D%E5%8B%95%E7%95%AB-dc08b4db4726" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>