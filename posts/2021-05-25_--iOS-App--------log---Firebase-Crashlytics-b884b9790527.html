<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>在 iOS App 加入收集閃退 log 的 Firebase Crashlytics</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">在 iOS App 加入收集閃退 log 的 Firebase Crashlytics</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App，不管是新手還是老手，難免會寫出一些讓 App 閃退的程式 bug，所以找個好方法收集使用者遇到的閃退問題還滿重要的。
</section>
<section data-field="body" class="e-content">
<section name="9841" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c84e" id="c84e" class="graf graf--h3 graf--leading graf--title">在 iOS App 加入收集閃退 log 的 Firebase Crashlytics</h3><p name="ce57" id="ce57" class="graf graf--p graf-after--h3">開發 iOS App，不管是新手還是老手，難免會寫出一些讓 App 閃退的程式 bug，所以找個好方法收集使用者遇到的閃退問題還滿重要的。</p><p name="e498" id="e498" class="graf graf--p graf-after--p">如果使用者曾經同意上傳閃退 log 給 apple，我們可從 Xcode 的 Organizer &gt; Crashes 看到曾經發生的 crash。</p><figure name="f871" id="f871" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WvkfWFBbb6P13GVI-shmSg.png" data-width="2618" data-height="1330" src="https://cdn-images-1.medium.com/max/800/1*WvkfWFBbb6P13GVI-shmSg.png"></figure><p name="45c3" id="45c3" class="graf graf--p graf-after--figure">但可惜不是每個使用者都會同意上傳閃退 log，所以為了增加閃退 log 的收集率，很多開發者會採用一些第三方的工具，比方 Firebase Crashlytics。</p><p name="317f" id="317f" class="graf graf--p graf-after--p">接下來我們將說明如何在 iOS App 加入 Firebase Crashlytics。</p><h3 name="e033" id="e033" class="graf graf--h3 graf-after--p">事前準備動作</h3><p name="5a21" id="5a21" class="graf graf--p graf-after--h3">已在 Firebase 網站建立專案，並在 Xcode 專案裡完成 Firebase 的相關設定，在 AppDelegate 的 application(_:didFinishLaunchingWithOptions:) 裡呼叫 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">FirebaseApp.configure()</strong></code>。</p><div name="b121" id="b121" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%96%8B%E7%99%BC-firebase-cloud-firestore-%E7%9A%84-ios-app-fe38d6ad70a7" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%96%8B%E7%99%BC-firebase-cloud-firestore-%E7%9A%84-ios-app-fe38d6ad70a7" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%96%8B%E7%99%BC-firebase-cloud-firestore-%E7%9A%84-ios-app-fe38d6ad70a7"><strong class="markup--strong markup--mixtapeEmbed-strong">開發 Firebase Cloud Firestore 的 iOS App</strong><br><em class="markup--em markup--mixtapeEmbed-em">1 建立 Firebase 專案</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E9%96%8B%E7%99%BC-firebase-cloud-firestore-%E7%9A%84-ios-app-fe38d6ad70a7" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="db471a01438cb37b00e8adb305e33fe5" data-thumbnail-img-id="1*hrshfFcSmgWzBihwX2UYQA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*hrshfFcSmgWzBihwX2UYQA.jpeg);"></a></div><p name="2fe7" id="2fe7" class="graf graf--p graf-after--mixtapeEmbed">在 Firebase 網站開啟 Google Analytics &amp; Crashlytics 功能。</p><figure name="62ba" id="62ba" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*G-m1bex8Bh8USaZQynx7eg.png" data-width="2292" data-height="904" src="https://cdn-images-1.medium.com/max/800/1*G-m1bex8Bh8USaZQynx7eg.png"></figure><figure name="0d28" id="0d28" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*JzRRWwqemCTfEVegQKx6zw.png" data-width="1556" data-height="848" src="https://cdn-images-1.medium.com/max/800/1*JzRRWwqemCTfEVegQKx6zw.png"></figure><figure name="8b9d" id="8b9d" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*pY-CrWbTHY1_ltafZMpfzw.png" data-width="1188" data-height="642" src="https://cdn-images-1.medium.com/max/800/1*pY-CrWbTHY1_ltafZMpfzw.png"></figure><h3 name="8c12" id="8c12" class="graf graf--h3 graf-after--figure">在 Xcode 專案加入 FirebaseCrashlytics &amp; FirebaseAnalyticsSwift-Beta</h3><figure name="8be6" id="8be6" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*gYDkEUz7wGEB8NSzibqZbg.png" data-width="1436" data-height="842" src="https://cdn-images-1.medium.com/max/800/1*gYDkEUz7wGEB8NSzibqZbg.png"></figure><h3 name="469d" id="469d" class="graf graf--h3 graf-after--figure">設定 Run Script</h3><p name="e95a" id="e95a" class="graf graf--p graf-after--h3">切換到 App 的 Build Phases 頁面。</p><figure name="ddfd" id="ddfd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1aTTSBtA0YSaU697XCZJvA.png" data-width="1910" data-height="588" src="https://cdn-images-1.medium.com/max/800/1*1aTTSBtA0YSaU697XCZJvA.png"></figure><p name="4dbe" id="4dbe" class="graf graf--p graf-after--figure">點選 +，從選單點選 New Run Script Phase。</p><figure name="f410" id="f410" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*f50VAbO5isGMkC97vI0hoQ.png" data-width="598" data-height="440" src="https://cdn-images-1.medium.com/max/800/1*f50VAbO5isGMkC97vI0hoQ.png"></figure><figure name="07a2" id="07a2" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*ZkJmmMvF8XpEAjgzI1wwCw.png" data-width="1388" data-height="572" src="https://cdn-images-1.medium.com/max/800/1*ZkJmmMvF8XpEAjgzI1wwCw.png"></figure><p name="9b84" id="9b84" class="graf graf--p graf-after--figure">在 Run Script 的 Shell 下的框框輸入 script，讓 Xcode 能在 App 閃退時上傳 dSYM 檔。dSYM 的全名是 Debug Symbol file，有了 dSYM 檔 Crashlytics 才能解析閃退 log，分析造成閃退的相關程式。</p><p name="00dc" id="00dc" class="graf graf--p graf-after--p">若是採用 SPM 安裝 Firebase 套件，請輸入以下 script。</p><pre name="621a" id="621a" class="graf graf--pre graf-after--p">&quot;${BUILD_DIR%Build/*}SourcePackages/checkouts/firebase-ios-sdk/Crashlytics/run&quot;</pre><figure name="ac7a" id="ac7a" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*vQv4symJ7N_PI9-k40iILA.png" data-width="1368" data-height="548" src="https://cdn-images-1.medium.com/max/800/1*vQv4symJ7N_PI9-k40iILA.png"></figure><p name="69ec" id="69ec" class="graf graf--p graf-after--figure">若是採用 CocoaPods 安裝，請輸入以下 script。</p><pre name="189f" id="189f" class="graf graf--pre graf-after--p">&quot;${PODS_ROOT}/FirebaseCrashlytics/run&quot;</pre><h3 name="8dd7" id="8dd7" class="graf graf--h3 graf-after--pre">設定 Input Files</h3><p name="77b9" id="77b9" class="graf graf--p graf-after--h3">在 Run Script 的 Input Files 加入</p><pre name="c8f1" id="c8f1" class="graf graf--pre graf-after--p">${DWARF_DSYM_FOLDER_PATH}/${DWARF_DSYM_FILE_NAME}/Contents/Resources/DWARF/${TARGET_NAME}</pre><p name="af0e" id="af0e" class="graf graf--p graf-after--pre">和</p><pre name="d572" id="d572" class="graf graf--pre graf-after--p">$(SRCROOT)/$(BUILT_PRODUCTS_DIR)/$(INFOPLIST_PATH)</pre><figure name="b8f9" id="b8f9" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*1RFca4qzW527LYbma8BhMQ.png" data-width="1064" data-height="232" src="https://cdn-images-1.medium.com/max/800/1*1RFca4qzW527LYbma8BhMQ.png"></figure><h3 name="11d6" id="11d6" class="graf graf--h3 graf-after--figure">調整 Debug Information Format</h3><p name="e10f" id="e10f" class="graf graf--p graf-after--h3">我們從 Xcode 裝到模擬器或手機的 App 將搭配 Debug configuration，而非一般上架 App 的 Release configuration。為了讓它也能包含解析閃退 log 所需的 dSYM File，我們必須切換到 App 的 Build Settings 頁面，將 Debug Information Format 下Debug 內容改成 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">DWARF with dSYM File</strong></code>，</p><figure name="6e9f" id="6e9f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*PkHCgznzzvQHn21QDeTvIg.png" data-width="1822" data-height="500" src="https://cdn-images-1.medium.com/max/800/1*PkHCgznzzvQHn21QDeTvIg.png"></figure><h4 name="043c" id="043c" class="graf graf--h4 graf-after--figure">故意撰寫閃退的程式</h4><p name="2128" id="2128" class="graf graf--p graf-after--h4">為了測試 Crashlytics 是否能收到閃退 log，我們故意撰寫閃退程式，在 button 按下時觸發閃退。</p><pre name="9997" id="9997" class="graf graf--pre graf-after--p">import SwiftUI</pre><pre name="5b80" id="5b80" class="graf graf--pre graf-after--pre">struct ContentView: View {<br>    func buttonTap() {<br><strong class="markup--strong markup--pre-strong">        fatalError()<br></strong>    }<br>    var body: some View {<br>        Button(action: buttonTap, label: {<br>            Text(&quot;Crash 吧，App&quot;)<br>                .font(.system(size: 50))<br>        })<br>    }<br>}</pre><h3 name="4573" id="4573" class="graf graf--h3 graf-after--pre">測試 App</h3><blockquote name="614d" id="614d" class="graf graf--pullquote graf-after--h3">從 Xcode 將 App 裝到模擬器或實機後，請先按下正方形 button 結束 App，因為必須直接從桌面點選 App icon 啟動的 App 才會上傳閃退 log。</blockquote><p name="6c4d" id="6c4d" class="graf graf--p graf-after--pullquote">點選 App icon 啟動 App 後，按下 button <code class="markup--code markup--p-code">&quot;Crash 吧，App&quot;</code>，觸發 App 閃退。此時 App 已經死掉，所以閃退 log 尚未上傳。我們必須再次點選 App icon 啟動 App，此時它才會開始上傳之前閃退的 log。</p><figure name="be56" id="be56" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*MXBcdm8aZiBEpXOFLSuQKA.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*MXBcdm8aZiBEpXOFLSuQKA.png"></figure><h3 name="b4d6" id="b4d6" class="graf graf--h3 graf-after--figure">從 Firebase Crashlytics 網頁查看閃退 log</h3><p name="90f1" id="90f1" class="graf graf--p graf-after--h3">回到 Firebase Crashlytics 網頁，很快地我們就能看到剛剛 App 閃退上傳的 log。</p><figure name="811f" id="811f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hdgH0oLgkRQ-yVt4admeQg.png" data-width="2206" data-height="1212" src="https://cdn-images-1.medium.com/max/800/1*hdgH0oLgkRQ-yVt4admeQg.png"></figure><p name="e919" id="e919" class="graf graf--p graf-after--figure">點選閃退的 issue 查看明細，從它顯示的 Stack trace，我們看到 App 在執行 function buttonTap 裡的程式時發生閃退。</p><figure name="4ae7" id="4ae7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ls7-JaS_wL2JysuwpBtqYw.png" data-width="1496" data-height="1134" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*ls7-JaS_wL2JysuwpBtqYw.png"></figure><h3 name="8d23" id="8d23" class="graf graf--h3 graf-after--figure">參考連結</h3><ul class="postList"><li name="7c92" id="7c92" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">Get started with Firebase Crashlytics</strong></li></ul><div name="ec29" id="ec29" class="graf graf--mixtapeEmbed graf-after--li"><a href="https://firebase.google.com/docs/crashlytics/get-started" data-href="https://firebase.google.com/docs/crashlytics/get-started" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://firebase.google.com/docs/crashlytics/get-started"><strong class="markup--strong markup--mixtapeEmbed-strong">Get started with Firebase Crashlytics</strong><br><em class="markup--em markup--mixtapeEmbed-em">&quot;type&quot;: &quot;thumb-down&quot;, &quot;id&quot;: &quot;missingTheInformationINeed&quot;, &quot;label&quot;:&quot;Missing the information I need&quot; },{ &quot;type&quot;…</em>firebase.google.com</a><a href="https://firebase.google.com/docs/crashlytics/get-started" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="bd2ad6b169de352245c6503ed2f7769d"></a></div><ul class="postList"><li name="f05c" id="f05c" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">Building Your App to Include Debugging Information</strong></li></ul><div name="26ef" id="26ef" class="graf graf--mixtapeEmbed graf-after--li graf--trailing"><a href="https://developer.apple.com/documentation/xcode/building-your-app-to-include-debugging-information" data-href="https://developer.apple.com/documentation/xcode/building-your-app-to-include-debugging-information" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/xcode/building-your-app-to-include-debugging-information"><strong class="markup--strong markup--mixtapeEmbed-strong">Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/xcode/building-your-app-to-include-debugging-information" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="258c98c1a458b0b13f86c7c7592323de"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/b884b9790527"><time class="dt-published" datetime="2021-05-25T14:58:36.692Z">May 25, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%9C%A8-ios-app-%E5%8A%A0%E5%85%A5%E6%94%B6%E9%9B%86%E9%96%83%E9%80%80-log-%E7%9A%84-firebase-crashlytics-b884b9790527" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>