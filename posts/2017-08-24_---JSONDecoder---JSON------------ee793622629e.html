<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 JSONDecoder 把 JSON 轉換成自訂型別的資料</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 JSONDecoder 把 JSON 轉換成自訂型別的資料</h1>
</header>
<section data-field="subtitle" class="p-summary">
抓取網路上的 JSON 資料並不是太困難的事，但是如果想要解析它，或是把它變成方便 App 使用的自訂型別，要如何實現呢 ?
</section>
<section data-field="body" class="e-content">
<section name="4f6a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="810e" id="810e" class="graf graf--h3 graf--leading graf--title">利用 JSONDecoder 把 JSON 轉換成自訂型別的資料</h3><p name="59d5" id="59d5" class="graf graf--p graf-after--h3">抓取網路上的 JSON 資料並不是太困難的事，但是如果想要解析它，或是把它變成方便 App 使用的自訂型別，要如何實現呢 ?</p><p name="ffa7" id="ffa7" class="graf graf--p graf-after--p">以下我們將介紹如何利用 JSONDecoder 把 JSON 轉換成自訂型別的資料。</p><div name="b1cc" id="b1cc" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/foundation/jsondecoder" data-href="https://developer.apple.com/documentation/foundation/jsondecoder" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/jsondecoder"><strong class="markup--strong markup--mixtapeEmbed-strong">JSONDecoder | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">An object that decodes instances of a data type from JSON objects.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/jsondecoder" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="2621f14238576fa5e17aa1e42811f17d" data-thumbnail-img-id="0*L2OdoQKmV_yp320Y" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*L2OdoQKmV_yp320Y);"></a></div><p name="1d9f" id="1d9f" class="graf graf--p graf-after--mixtapeEmbed">接下來讓我們串接一些有趣的 API 試試 JSONDecoder 的威力吧。</p><h3 name="7462" id="7462" class="graf graf--h3 graf-after--p">歌詞 API</h3><p name="541f" id="541f" class="graf graf--p graf-after--h3">API 的網址如下，title = 後接歌曲的名字。</p><pre data-code-block-mode="0" spellcheck="false" name="881c" id="881c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://some-random-api.com/others/lyrics?title=how long will i love you</span></pre><p name="c659" id="c659" class="graf graf--p graf-after--pre">ps: 目前歌詞 API 已無法連線，請改用以下網址抓 how long will i love you 的歌詞。</p><pre data-code-block-mode="0" spellcheck="false" name="c529" id="c529" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://raw.githubusercontent.com/PeterPanSwift/JSON_API/refs/heads/main/lyrics.json</span></pre><p name="2712" id="2712" class="graf graf--p graf-after--pre">後台回傳的資料如下</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="json" name="4174" id="4174" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-punctuation">{</span><br /><span class="hljs-attr">&quot;title&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;How Long Will I Love You&quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-attr">&quot;author&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;Ellie Goulding&quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-attr">&quot;lyrics&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;How long will I love you? As long as stars are above you And longer if I can How long will I need you? As long as the seasons need to Follow their plan How long will I be with you? As long as the sea is bound to Wash up on the sand How long will I want you? As long as you want me to And longer by far How long will I hold you? As long as your father told you As long as you can How long will I give to you? As long as I live through you However long you say How long will I love you? As long as stars are above you And longer if I may How long will I love you? &quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-attr">&quot;thumbnail&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><br /><span class="hljs-attr">&quot;genius&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;https://images.genius.com/498d1108967abafb01a799f6555d0344.300x300x1.png&quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br /><span class="hljs-attr">&quot;links&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">{</span><br /><span class="hljs-attr">&quot;genius&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;https://genius.com/Ellie-goulding-how-long-will-i-love-you-lyrics&quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br /><span class="hljs-attr">&quot;disclaimer&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-string">&quot;What the API returns is not guaranteed to return the right lyrics or have a matching title and author.&quot;</span><span class="hljs-punctuation">,</span><br /><span class="hljs-punctuation">}</span></span></pre><p name="46dc" id="46dc" class="graf graf--p graf-after--pre">利用網站 JSON Editor Online 顯示後截圖如下。</p><div name="c867" id="c867" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://jsoneditoronline.org" data-href="https://jsoneditoronline.org" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://jsoneditoronline.org"><strong class="markup--strong markup--mixtapeEmbed-strong">JSON Editor Online - view, edit and format JSON online</strong><br><em class="markup--em markup--mixtapeEmbed-em">JSON Editor Online is a web-based tool to view, edit, and format JSON. It shows your data side by side in a clear…</em>jsoneditoronline.org</a><a href="https://jsoneditoronline.org" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="025f17f21483572ab8346760575dde58"></a></div><figure name="ceee" id="ceee" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*RwBUvPJNcOkA2jLW76R28g.png" data-width="1012" data-height="1078" src="https://cdn-images-1.medium.com/max/800/1*RwBUvPJNcOkA2jLW76R28g.png"></figure><h4 name="a8e7" id="a8e7" class="graf graf--h4 graf-after--figure"><strong class="markup--strong markup--h4-strong">定義型別 Song</strong></h4><p name="9950" id="9950" class="graf graf--p graf-after--h4">利用 JSONDecoder，我們可以將網路上抓下來的 JSON 資料從 Data 型別變成自訂型別 Song。至於 Song 是如何定義的，接下來讓我們一步步示範說明吧。</p><p name="ff1a" id="ff1a" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(1) 將 JSON 裡以 { } 描述的 object 變成自訂型別，可以用 class，也可以用 struct 定義，型別名字可自取。</strong></p><p name="df23" id="df23" class="graf graf--p graf-after--p">因此我們將下圖第一層 { } 的 object 變成型別 Song。</p><figure name="4b8f" id="4b8f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RwBUvPJNcOkA2jLW76R28g.png" data-width="1012" data-height="1078" src="https://cdn-images-1.medium.com/max/800/1*RwBUvPJNcOkA2jLW76R28g.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="24a2" id="24a2" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span> {<br /><br />}</span></pre><p name="d916" id="d916" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">(2) 讓自訂型別遵從 protocol Decodable 或 Codable。</strong></p><p name="af45" id="af45" class="graf graf--p graf-after--p">JSONDecoder 可以將資料從 Data 型別變成遵從 protocol Decodable 或 Codable 的自訂型別，Decodable 表示可解碼，Codable 表示可解碼跟編碼。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="d29b" id="d29b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br /><br />}</span></pre><p name="913f" id="913f" class="graf graf--p graf-after--pre">遵從 protocol Codable 後，Song 將有解碼跟編碼的功能。若是 Song 裡的 property 也是遵從 Codable 的型別，Swift 將自動幫我們定義解碼跟編碼的相關 function。</p><p name="b23e" id="b23e" class="graf graf--p graf-after--p">以下常見的基本型別都遵從 Codable，因此大部份的時候我們都不用自己撰寫解碼編碼的程式。</p><figure name="bda5" id="bda5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pAN6TVlFnVyGgZvodF4lBA.png" data-width="938" data-height="686" src="https://cdn-images-1.medium.com/max/800/1*pAN6TVlFnVyGgZvodF4lBA.png"></figure><p name="1063" id="1063" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">(3) JSON 裡 object 的 key 將成為自訂型別的 property 名字， 而 property 的型別則由 key 對應的 value 型別決定。</strong></p><p name="aae0" id="aae0" class="graf graf--p graf-after--p">property 可宣告為變數，也可宣告為常數，可依據以下幾點規則決定 property 的型別：</p><ul class="postList"><li name="58ce" id="58ce" class="graf graf--li graf-after--p">value 是網址 ➪ URL。(ps: 如果網址包含 ASCII 以外的文字，請將型別宣告為 String，之後再另外轉成 URL)</li><li name="66c2" id="66c2" class="graf graf--li graf-after--li">value 是時間 ➪ Date。</li><li name="d980" id="d980" class="graf graf--li graf-after--li">value 是整數 ➪ Int</li><li name="d3dd" id="d3dd" class="graf graf--li graf-after--li">value 是浮點數 ➪ Float 或 Double</li><li name="6fce" id="6fce" class="graf graf--li graf-after--li">value 是字串 ➪ String</li><li name="87e6" id="87e6" class="graf graf--li graf-after--li">value 是 true 或 false ➪ Bool</li><li name="df68" id="df68" class="graf graf--li graf-after--li">value 是陣列 ➪ Array</li><li name="30e3" id="30e3" class="graf graf--li graf-after--li">value 是 object ➪ 遵從 protocol Decodable 或 Codable 的自訂型別。</li><li name="0162" id="0162" class="graf graf--li graf-after--li">key 不一定會出現或 key 的 value 可能為 null 時 ➪ 型別要宣告為 optional。</li></ul><p name="7bb3" id="7bb3" class="graf graf--p graf-after--li">ps: 依據以上規則，我們將能處理大部分的 JSON 資料，只有少數 case 要特別處理(比方包含中文的網址)。</p><p name="9e31" id="9e31" class="graf graf--p graf-after--p">因此下圖第一層 { } object 的 key 將成為 Song 的 property。</p><figure name="42a0" id="42a0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RwBUvPJNcOkA2jLW76R28g.png" data-width="1012" data-height="1078" src="https://cdn-images-1.medium.com/max/800/1*RwBUvPJNcOkA2jLW76R28g.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5787" id="5787" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">String</span><br />}</span></pre><p name="f0fd" id="f0fd" class="graf graf--p graf-after--pre">習慣用 extension 遵從 protocol 的朋友，也可以改用以下寫法。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="78bc" id="78bc" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">String</span><br />}<br /><br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> { }</span></pre><p name="d6bd" id="d6bd" class="graf graf--p graf-after--pre">值得注意的，property 的名稱和型別不對都會造成轉換失敗。</p><ul class="postList"><li name="cf4f" id="cf4f" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">property 名稱和 JSON 裡 object 的 key 名字要一樣。</strong></li></ul><p name="5114" id="5114" class="graf graf--p graf-after--li">比方 lyrics 寫成 lyric 會有問題。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="bc83" id="bc83" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyric: <span class="hljs-type">String</span><br />}</span></pre><p name="4ff7" id="4ff7" class="graf graf--p graf-after--pre">不過需要的話，我們也有方法讓 property 名稱和 JSON 裡 object 的 key 名字不一樣。等下我們會再介紹。</p><figure name="5406" id="5406" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bNP3Gwz6HQONHquZeysV_Q.png" data-width="1854" data-height="1194" src="https://cdn-images-1.medium.com/max/800/1*bNP3Gwz6HQONHquZeysV_Q.png"></figure><ul class="postList"><li name="dfe0" id="dfe0" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">property 型別錯誤將轉換失敗。</strong></li></ul><p name="c69e" id="c69e" class="graf graf--p graf-after--li">property 型別錯誤將轉換失敗，比方 lyrics 是字串，但你卻將型別宣告為 Int。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7a9e" id="7a9e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">Int</span><br />}</span></pre><p name="236a" id="236a" class="graf graf--p graf-after--pre">值得注意的，只要型別不對就會失敗，就算加問號也一樣，因此 let lyrics: Int? 也會轉換失敗。</p><p name="98dd" id="98dd" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">(4) 只要定義 App 需要的欄位就好，因此自訂型別的 property 可以少訂，不用將 JSON object 的每個 key 都寫成 property。</strong></p><p name="addb" id="addb" class="graf graf--p graf-after--p">比方以下 JSON 第一層的 object 有 6 個 key，title，author，lyrics，thumbnail，links &amp; disclaimer，不過我們的 App 只需要其中的部分資訊，所以我們在 Song 裡只宣告 3 個 property。</p><figure name="754f" id="754f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RwBUvPJNcOkA2jLW76R28g.png" data-width="1012" data-height="1078" src="https://cdn-images-1.medium.com/max/800/1*RwBUvPJNcOkA2jLW76R28g.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="34fa" id="34fa" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">String</span><br />}</span></pre><p name="3bd3" id="3bd3" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">(5) 以下兩種情況 property 要宣告為 optional。</strong></p><p name="d8df" id="d8df" class="graf graf--p graf-after--p">(a) JSON object 不一定有的 key 。</p><p name="6935" id="6935" class="graf graf--p graf-after--p">(b) JSON object 某個 key 對應的 value 有可能是 null。</p><div name="ca58" id="ca58" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%A7%A3%E6%9E%90-json-%E6%99%82-decodable-%E5%9E%8B%E5%88%A5%E5%8A%A0-%E7%9A%84%E6%83%85%E6%B3%81-774883500ca5" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%A7%A3%E6%9E%90-json-%E6%99%82-decodable-%E5%9E%8B%E5%88%A5%E5%8A%A0-%E7%9A%84%E6%83%85%E6%B3%81-774883500ca5" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%A7%A3%E6%9E%90-json-%E6%99%82-decodable-%E5%9E%8B%E5%88%A5%E5%8A%A0-%E7%9A%84%E6%83%85%E6%B3%81-774883500ca5"><strong class="markup--strong markup--mixtapeEmbed-strong">解析 JSON 時，Decodable 型別加 ? 的情況</strong><br><em class="markup--em markup--mixtapeEmbed-em">當我們利用 JSONDecoder 將 JSON 資料變成自訂的 Decodable 型別時，property 在以下兩種情況必須加上問號，宣告為 optional，因為有可能找不到對應的 value。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%A7%A3%E6%9E%90-json-%E6%99%82-decodable-%E5%9E%8B%E5%88%A5%E5%8A%A0-%E7%9A%84%E6%83%85%E6%B3%81-774883500ca5" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="1e25b3c62e9a5531ca5c3cdc45d658c4" data-thumbnail-img-id="1*uWtKgGTkh3lQvZB_lo-QMg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*uWtKgGTkh3lQvZB_lo-QMg.png);"></a></div><p name="71da" id="71da" class="graf graf--p graf-after--mixtapeEmbed">如果沒有設為 optional，當 JSON 資料裡找不到跟 property 一樣名字的 key 時，將成造轉換失敗。</p><h4 name="5850" id="5850" class="graf graf--h4 graf-after--p">測試 JSON 解碼</h4><p name="9515" id="9515" class="graf graf--p graf-after--h4">利用 JSONDecoder 的 function decode 將 Data 型別的 JSON 資料變成遵從型別 Decodable 的資料，若成功將順利印出資料的內容。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="680d" id="680d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> song <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode(<span class="hljs-type">Song</span>.<span class="hljs-keyword">self</span>, from: data)</span></pre><div name="28ea" id="28ea" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/foundation/jsondecoder/2895189-decode" data-href="https://developer.apple.com/documentation/foundation/jsondecoder/2895189-decode" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/jsondecoder/2895189-decode"><strong class="markup--strong markup--mixtapeEmbed-strong">decode(_:from:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns a value of the type you specify, decoded from a JSON object.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/jsondecoder/2895189-decode" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f6332d35ee22828b5fc5db382ca73059" data-thumbnail-img-id="0*bjpZAIbasmcq3kCS" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*bjpZAIbasmcq3kCS);"></a></div><figure name="c89e" id="c89e" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*eK65lVH73D-0_bLVt1AvWQ.jpeg" data-width="1536" data-height="1024" src="https://cdn-images-1.medium.com/max/800/1*eK65lVH73D-0_bLVt1AvWQ.jpeg"></figure><ul class="postList"><li name="e62f" id="e62f" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">方法 1: 使用 async &amp; await</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="36ca" id="36ca" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://raw.githubusercontent.com/PeterPanSwift/JSON_API/refs/heads/main/lyrics.json&quot;</span>) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />    <span class="hljs-keyword">let</span> (data, <span class="hljs-keyword">_</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(from: url)<br />    <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />    <span class="hljs-keyword">let</span> song <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode(<span class="hljs-type">Song</span>.<span class="hljs-keyword">self</span>, from: data)<br />    <span class="hljs-built_in">print</span>(song)<br />}<br /><br /><span class="hljs-type">Task</span> {<br />    <span class="hljs-keyword">do</span> {<br />        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchData()<br />    } <span class="hljs-keyword">catch</span> {<br />        <span class="hljs-built_in">print</span>(error)<br />    }   <br />}</span></pre><ul class="postList"><li name="b5db" id="b5db" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">方法 2: 使用 completion handler</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="bd56" id="bd56" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() {<br />    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://raw.githubusercontent.com/PeterPanSwift/JSON_API/refs/heads/main/lyrics.json&quot;</span>) {<br />        <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response , error <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />                <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />                <span class="hljs-keyword">do</span> {<br />                    <span class="hljs-keyword">let</span> song <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode(<span class="hljs-type">Song</span>.<span class="hljs-keyword">self</span>, from: data)<br />                    <span class="hljs-built_in">print</span>(song)<br />                } <span class="hljs-keyword">catch</span> {<br />                    <span class="hljs-built_in">print</span>(error)<br />                }<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error {<br />                <span class="hljs-built_in">print</span>(error)<br />            }<br />        }.resume()<br />    }<br />}<br /><br />fetchData()</span></pre><p name="84cb" id="84cb" class="graf graf--p graf-after--pre">ps: iOS 17 的 URL 可以自動對網址進行 URL Encoding，舊版則須手動對網址進行 URL Encoding。</p><div name="5584" id="5584" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-16-%E7%9A%84-urlcomponents-%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8B%95%E5%B0%8D%E7%B6%B2%E5%9D%80%E9%80%B2%E8%A1%8C-url-encoding-68df08be6a25" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-16-%E7%9A%84-urlcomponents-%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8B%95%E5%B0%8D%E7%B6%B2%E5%9D%80%E9%80%B2%E8%A1%8C-url-encoding-68df08be6a25" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-16-%E7%9A%84-urlcomponents-%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8B%95%E5%B0%8D%E7%B6%B2%E5%9D%80%E9%80%B2%E8%A1%8C-url-encoding-68df08be6a25"><strong class="markup--strong markup--mixtapeEmbed-strong">iOS 17 的 URL 和 16 的 URLComponents 可以自動對網址進行 URL Encoding</strong><br><em class="markup--em markup--mixtapeEmbed-em">網址只能包含 ASCII character-set 裡的文字，因此當我們將網址的字串變成 URL 時，若是網址包含 ASCII character-set 以外的字元，比方中文，則須對網址進行 URL…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-16-%E7%9A%84-urlcomponents-%E5%8F%AF%E4%BB%A5%E8%87%AA%E5%8B%95%E5%B0%8D%E7%B6%B2%E5%9D%80%E9%80%B2%E8%A1%8C-url-encoding-68df08be6a25" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0fa1114aa7d82a51891005420ea22602" data-thumbnail-img-id="1*1qeqxGbAWj0qWTYHYW7IXg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*1qeqxGbAWj0qWTYHYW7IXg.png);"></a></div><h4 name="cb87" id="cb87" class="graf graf--h4 graf-after--mixtapeEmbed">解析 JSON 第二層的 object</h4><p name="6630" id="6630" class="graf graf--p graf-after--h4">JSON 裡可能有不只一層的 object，若想要解析它的內容，記得要為 object 定義對應的 Decodable 型別。換句話說，若 JSON 裡有愈多層的 { }，我們可能就要定義愈多的 Decodable 型別。</p><p name="b32e" id="b32e" class="graf graf--p graf-after--p">歌詞 API 回傳的 JSON 裡，thumbnail &amp; links 的內容都是 key 為 genius 的物件，因此我們可為它定義對應的型別 Genius。</p><figure name="789a" id="789a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RwBUvPJNcOkA2jLW76R28g.png" data-width="1012" data-height="1078" src="https://cdn-images-1.medium.com/max/800/1*RwBUvPJNcOkA2jLW76R28g.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="bfa8" id="bfa8" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> thumbnail: <span class="hljs-type">Genius</span><br />    <span class="hljs-keyword">let</span> links: <span class="hljs-type">Genius</span><br />}<br /> <br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Genius</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> genius: <span class="hljs-type">URL</span><br />}</span></pre><p name="b6f5" id="b6f5" class="graf graf--p graf-after--pre">我們可以分開定義 Song &amp; Genius，也可以在 Song 裡定義 Genius。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="920d" id="920d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Song</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> author: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> lyrics: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> thumbnail: <span class="hljs-type">Genius</span><br />    <span class="hljs-keyword">let</span> links: <span class="hljs-type">Genius</span><br />    <br />    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">Genius</span>: <span class="hljs-title class_">Codable</span> {<br />        <span class="hljs-keyword">let</span> genius: <span class="hljs-type">URL</span><br />    }<br />}</span></pre><h3 name="1239" id="1239" class="graf graf--h3 graf-after--pre">練習</h3><ul class="postList"><li name="dc24" id="dc24" class="graf graf--li graf-after--h3">搭配 AI 建立自己感興趣的 JSON API</li></ul><div name="43b5" id="43b5" class="graf graf--mixtapeEmbed graf-after--li"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D-ai-%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E6%84%9F%E8%88%88%E8%B6%A3%E7%9A%84-json-api-f8c3f51cf81d" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D-ai-%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E6%84%9F%E8%88%88%E8%B6%A3%E7%9A%84-json-api-f8c3f51cf81d" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D-ai-%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E6%84%9F%E8%88%88%E8%B6%A3%E7%9A%84-json-api-f8c3f51cf81d"><strong class="markup--strong markup--mixtapeEmbed-strong">搭配 AI 建立自己感興趣的 JSON API</strong><br><em class="markup--em markup--mixtapeEmbed-em">新手剛開始學習串接網路 API 解析 JSON 時，常常會遇到以下兩個問題。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%90%AD%E9%85%8D-ai-%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E6%84%9F%E8%88%88%E8%B6%A3%E7%9A%84-json-api-f8c3f51cf81d" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9d2ebcf50cfa35b86dcd43ba580ba060" data-thumbnail-img-id="1*2mxcczrMRowRy5IMCdKs_Q.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*2mxcczrMRowRy5IMCdKs_Q.png);"></a></div><ul class="postList"><li name="0515" id="0515" class="graf graf--li graf-after--mixtapeEmbed">更多的隨機 API</li></ul><div name="81e6" id="81e6" class="graf graf--mixtapeEmbed graf-after--li"><a href="https://some-random-api.ml" data-href="https://some-random-api.ml" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://some-random-api.ml"><strong class="markup--strong markup--mixtapeEmbed-strong">Some Random Api &amp;bullet; Home</strong><br><em class="markup--em markup--mixtapeEmbed-em">Some Random Api is a place where you can find a lot of random apis from games, sites, even animal facts!</em>some-random-api.ml</a><a href="https://some-random-api.ml" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d11492da12ba9e869ee3e31c9ff43a84" data-thumbnail-img-id="0*u60eihLNnnu7kJ-J" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*u60eihLNnnu7kJ-J);"></a></div><h3 name="b605" id="b605" class="graf graf--h3 graf-after--mixtapeEmbed">iTunes API</h3><p name="5c5b" id="5c5b" class="graf graf--p graf-after--h3">了解比較簡單的歌詞 API 例子後，接著讓我們挑戰更複雜的 iTunes API。</p><p name="db7f" id="db7f" class="graf graf--p graf-after--p">iTunes Search API 的文件如下。</p><div name="3f19" id="3f19" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/iTuneSearchAPI/Searching.html#//apple_ref/doc/uid/TP40017632-CH5-SW1" data-href="https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/iTuneSearchAPI/Searching.html#//apple_ref/doc/uid/TP40017632-CH5-SW1" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/iTuneSearchAPI/Searching.html#//apple_ref/doc/uid/TP40017632-CH5-SW1"><strong class="markup--strong markup--mixtapeEmbed-strong">Constructing Searches</strong><br><em class="markup--em markup--mixtapeEmbed-em">To search for content from a field in your website and display the results in your website, you must create a search…</em>developer.apple.com</a><a href="https://developer.apple.com/library/archive/documentation/AudioVideo/Conceptual/iTuneSearchAPI/Searching.html#//apple_ref/doc/uid/TP40017632-CH5-SW1" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="7f60438aa55eeb931e6493682df62ba5"></a></div><p name="0719" id="0719" class="graf graf--p graf-after--mixtapeEmbed">我們以從 iTunes 搜尋好聽的暖暖當例子，API 的網址為</p><pre data-code-block-mode="0" spellcheck="false" name="3299" id="3299" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://itunes.apple.com/search?term=暖暖&amp;media=music&amp;country=tw</span></pre><p name="15f1" id="15f1" class="graf graf--p graf-after--pre">後台回傳的資料利用網站 JSON Editor Online 顯示後截圖如下:</p><figure name="3ca3" id="3ca3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7si-K33ZSlIsbay-tUdrIQ.png" data-width="1290" data-height="1222" src="https://cdn-images-1.medium.com/max/800/1*7si-K33ZSlIsbay-tUdrIQ.png"></figure><p name="e9af" id="e9af" class="graf graf--p graf-after--figure">定義 JSON 對應的型別時，記得由第一層開始層層解析，如此就算它像地獄一樣有十八層我們也可順利解析。</p><h4 name="a2b9" id="a2b9" class="graf graf--h4 graf-after--p">解析第一層</h4><figure name="5ea0" id="5ea0" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*hRCgAXZiRweSxDpE7Q0G3w.png" data-width="488" data-height="236" src="https://cdn-images-1.medium.com/max/800/1*hRCgAXZiRweSxDpE7Q0G3w.png"></figure><p name="8418" id="8418" class="graf graf--p graf-after--figure">上圖是 JSON 第一層的內容，它是以 { } 描述的物件，因此我們定義它對應的型別 SearchResponse，並且宣告它的兩個 property resultCount &amp; results。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1cca" id="1cca" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SearchResponse</span>: <span class="hljs-title class_">Codable</span> {<br />   <span class="hljs-keyword">let</span> resultCount: <span class="hljs-type">Int</span><br />   <span class="hljs-keyword">let</span> results: []<br />}</span></pre><p name="a730" id="a730" class="graf graf--p graf-after--pre">results 的內容是 [ ] 描述的 array，不過我們還不知道 array 成員的型別，所以先寫 [ ]，[ ] 裡的內容等下再填。</p><h4 name="b9b0" id="b9b0" class="graf graf--h4 graf-after--p">解析第二層</h4><figure name="82f3" id="82f3" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*zTJACYbg2m0DCV2GvGg-LA.png" data-width="418" data-height="700" src="https://cdn-images-1.medium.com/max/800/1*zTJACYbg2m0DCV2GvGg-LA.png"></figure><p name="4a3c" id="4a3c" class="graf graf--p graf-after--figure">array 裡的每個成員是 { } 描述的物件，因此我們定義它對應的型別 StoreItem。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b807" id="b807" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">StoreItem</span>: <span class="hljs-title class_">Codable</span> {<br /><br />}</span></pre><p name="8f86" id="8f86" class="graf graf--p graf-after--pre">然後再回頭將 results 的型別宣告為 <code class="markup--code markup--p-code"><strong class="markup--strong markup--p-strong">[StoreItem]</strong></code>。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e238" id="e238" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SearchResponse</span>: <span class="hljs-title class_">Codable</span> {<br />   <span class="hljs-keyword">let</span> resultCount: <span class="hljs-type">Int</span><br />   <span class="hljs-keyword">let</span> results: [<span class="hljs-type">StoreItem</span>]<br />}</span></pre><figure name="cc69" id="cc69" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*Qwqdk5joXVJ5KiQ1CaygvQ.png" data-width="946" data-height="1038" src="https://cdn-images-1.medium.com/max/800/1*Qwqdk5joXVJ5KiQ1CaygvQ.png"></figure><p name="2c6c" id="2c6c" class="graf graf--p graf-after--figure">上圖是 JSON 第二層的 { } 內容，因此我們在 StoreItem 宣告以下 property 對應 { } 裡的 key。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c9dd" id="c9dd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">StoreItem</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> trackId: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">let</span> artistName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> trackName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> collectionName: <span class="hljs-type">String</span>?<br />    <span class="hljs-keyword">let</span> previewUrl: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> artworkUrl100: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> trackPrice: <span class="hljs-type">Double</span>?<br />    <span class="hljs-keyword">let</span> isStreamable: <span class="hljs-type">Bool</span>?<br />}</span></pre><p name="a8f2" id="a8f2" class="graf graf--p graf-after--pre">值得注意的，StoreItem 裡有些 property 被宣告為 optional，因為 JSON 裡有些 key 不會每一筆資料都有，比方不是每首歌都可以買，所以不一定有 trackPrice。因此我們將不一定會有的 collectionName，trackPrice &amp; isStreamable 設為 optional。如果沒有設為 optional，到時候一旦發現沒有這些欄位，將造成轉換失敗。</p><p name="64c3" id="64c3" class="graf graf--p graf-after--p">通常 API 文件會說明哪些欄位不一定會有，所以我們知道哪些 property 要加 ?。若是沒有文件，或是文件寫得不清楚，我們只能一邊測試，一邊針對有問題欄位加上 ?。</p><p name="bfe1" id="bfe1" class="graf graf--p graf-after--p">現在我們已成功定義出 iTunes 音樂 JSON 對應的型別，答案如下。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="dfa5" id="dfa5" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">SearchResponse</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> resultCount: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">let</span> results: [<span class="hljs-type">StoreItem</span>]<br />}<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">StoreItem</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> trackId: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">let</span> artistName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> trackName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> collectionName: <span class="hljs-type">String</span>?<br />    <span class="hljs-keyword">let</span> previewUrl: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> artworkUrl100: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> trackPrice: <span class="hljs-type">Double</span>?<br />    <span class="hljs-keyword">let</span> isStreamable: <span class="hljs-type">Bool</span>?<br />}</span></pre><h4 name="5d61" id="5d61" class="graf graf--h4 graf-after--pre">測試 JSON 解碼</h4><ul class="postList"><li name="e287" id="e287" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">方法 1: 使用 async &amp; await</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3f11" id="3f11" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://itunes.apple.com/search?term=暖暖&amp;media=music&amp;country=tw&quot;</span>) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />    <span class="hljs-keyword">let</span> (data, <span class="hljs-keyword">_</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(from: url)<br />    <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />    <span class="hljs-keyword">let</span> searchResponse <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode(<span class="hljs-type">SearchResponse</span>.<span class="hljs-keyword">self</span>, from: data)<br />    <span class="hljs-built_in">print</span>(searchResponse.results)<br />}<br /><br /><span class="hljs-type">Task</span> {<br />    <span class="hljs-keyword">do</span> {<br />        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchData()<br />    } <span class="hljs-keyword">catch</span> {<br />        <span class="hljs-built_in">print</span>(error)<br />    }<br />}</span></pre><ul class="postList"><li name="8f71" id="8f71" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">方法 2: 使用 completion handler</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1c54" id="1c54" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() {<br />    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://itunes.apple.com/search?term=暖暖&amp;media=music&amp;country=tw&quot;</span>) {<br />        <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response , error <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />                <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />                <span class="hljs-keyword">do</span> {<br />                    <span class="hljs-keyword">let</span> searchResponse <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode(<span class="hljs-type">SearchResponse</span>.<span class="hljs-keyword">self</span>, from: data)<br />                    <span class="hljs-built_in">print</span>(searchResponse.results)<br />                } <span class="hljs-keyword">catch</span> {<br />                    <span class="hljs-built_in">print</span>(error)<br />                }<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error {<br />                <span class="hljs-built_in">print</span>(error)<br />            }<br />        }.resume()<br />    }<br />}<br /><br />fetchData()</span></pre><h4 name="9557" id="9557" class="graf graf--h4 graf-after--pre">iTunes API 補充</h4><ul class="postList"><li name="cdee" id="cdee" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">抓取大圖</strong></li></ul><p name="4354" id="4354" class="graf graf--p graf-after--li">假設 JSON 的圖片網址如下</p><pre data-code-block-mode="0" spellcheck="false" name="e94c" id="e94c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://is3-ssl.mzstatic.com/image/thumb/Music/v4/76/54/ea/7654ea84-2830-26d3-1526-01833cfe68fc/source/100x100bb.jpg</span></pre><p name="039e" id="039e" class="graf graf--p graf-after--pre">我們可以調整圖片的尺寸，比方將 100x100bb.jpg 改成 500x500bb.jpg。</p><pre data-code-block-mode="0" spellcheck="false" name="3f12" id="3f12" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://is3-ssl.mzstatic.com/image/thumb/Music/v4/76/54/ea/7654ea84-2830-26d3-1526-01833cfe68fc/source/500x500bb.jpg</span></pre><p name="4c39" id="4c39" class="graf graf--p graf-after--pre">Swift 程式寫法。</p><p name="1edb" id="1edb" class="graf graf--p graf-after--p">宣告 computed property artworkUrl500。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e952" id="e952" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">StoreItem</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> trackId: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">let</span> artistName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> trackName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> collectionName: <span class="hljs-type">String</span>?<br />    <span class="hljs-keyword">let</span> previewUrl: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> artworkUrl100: <span class="hljs-type">URL</span><br />    <span class="hljs-keyword">let</span> trackPrice: <span class="hljs-type">Double</span>?<br />    <span class="hljs-keyword">let</span> isStreamable: <span class="hljs-type">Bool</span>?<br />    <br />    <span class="hljs-keyword">var</span> artworkUrl500: <span class="hljs-type">URL</span> {<br />        artworkUrl100.deletingLastPathComponent().appending(path: <span class="hljs-string">&quot;500x500bb.jpg&quot;</span>)<br />    }<br />}</span></pre><h3 name="2655" id="2655" class="graf graf--h3 graf-after--pre">當 JSON 的第一層是 array</h3><p name="2944" id="2944" class="graf graf--p graf-after--h3">掌握剛剛提到的方法，我們已經具備解析大部分 JSON 資料的能力。不過如果 JSON 的第一層是 array，不是 object 呢 ? 比方以下從 GitHub 抓取 twostraws 大大的 followers。</p><pre data-code-block-mode="0" spellcheck="false" name="990c" id="990c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">https://api.github.com/users/twostraws/followers</span></pre><p name="b263" id="b263" class="graf graf--p graf-after--pre">JSON 如下，第一層是 array，array 的成員是 follower 的相關資訊。</p><figure name="11bd" id="11bd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*h3eft1eITP_jkoorOaONmw.png" data-width="954" data-height="988" src="https://cdn-images-1.medium.com/max/800/1*h3eft1eITP_jkoorOaONmw.png"></figure><p name="f291" id="f291" class="graf graf--p graf-after--figure">這時候我們只有一個小地方要調整，只要在呼叫 decode function 時傳入的型別加上 [ ] 即可，例如以下例子傳入<code class="markup--code markup--p-code"> [Follower].self</code>。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="af4d" id="af4d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Follower</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> login: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> id: <span class="hljs-type">Int</span><br />}</span></pre><ul class="postList"><li name="972e" id="972e" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">方法 1: 使用 async &amp; await</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3850" id="3850" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><br /><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() <span class="hljs-keyword">async</span> <span class="hljs-keyword">throws</span> {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://api.github.com/users/twostraws/followers&quot;</span>) <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />    <span class="hljs-keyword">let</span> (data, <span class="hljs-keyword">_</span>) <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> <span class="hljs-type">URLSession</span>.shared.data(from: url)<br />    <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />    <span class="hljs-keyword">let</span> followers <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode([<span class="hljs-type">Follower</span>].<span class="hljs-keyword">self</span>, from: data)<br />    <span class="hljs-built_in">print</span>(followers)<br />}<br /><br /><span class="hljs-type">Task</span> {<br />    <span class="hljs-keyword">do</span> {<br />        <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> fetchData()<br />    } <span class="hljs-keyword">catch</span> {<br />        <span class="hljs-built_in">print</span>(error)<br />    }<br />}</span></pre><ul class="postList"><li name="12a0" id="12a0" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">方法 2: 使用 completion handler</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="a28f" id="a28f" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">fetchData</span>() {<br />    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: <span class="hljs-string">&quot;https://api.github.com/users/twostraws/followers&quot;</span>) {<br />        <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response , error <span class="hljs-keyword">in</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />                <span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br />                <span class="hljs-keyword">do</span> {<br />                    <span class="hljs-keyword">let</span> followers <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode([<span class="hljs-type">Follower</span>].<span class="hljs-keyword">self</span>, from: data)<br />                    <span class="hljs-built_in">print</span>(followers)<br />                } <span class="hljs-keyword">catch</span>  {<br />                    <span class="hljs-built_in">print</span>(error)<br />                }<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> error {<br />                <span class="hljs-built_in">print</span>(error)<br />            }<br />        }.resume()<br />    }<br />}<br /><br />fetchData()</span></pre><h3 name="5433" id="5433" class="graf graf--h3 graf-after--pre">找出 JSONDecoder 的 decode 錯誤</h3><p name="f8a5" id="f8a5" class="graf graf--p graf-after--h3">我們都知道寫程式時常會遇到問題，沒有問題才是不正常的。如果不幸遇到 decode 失敗， 可參考以下連結找出失敗的原因。</p><div name="afe8" id="afe8" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%89%BE%E5%87%BA-jsondecoder-%E7%9A%84-decode-%E9%8C%AF%E8%AA%A4-c9c6deae297" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%89%BE%E5%87%BA-jsondecoder-%E7%9A%84-decode-%E9%8C%AF%E8%AA%A4-c9c6deae297" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%89%BE%E5%87%BA-jsondecoder-%E7%9A%84-decode-%E9%8C%AF%E8%AA%A4-c9c6deae297"><strong class="markup--strong markup--mixtapeEmbed-strong">找出 JSONDecoder 的 decode 錯誤</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 JSONDecoder，我們可以很方便地將 API 回傳的 JSON 資料轉成遵從 Decodable 的自訂型別，例如以下結合 Dog API，抓取可愛小狗圖片的例子。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E6%89%BE%E5%87%BA-jsondecoder-%E7%9A%84-decode-%E9%8C%AF%E8%AA%A4-c9c6deae297" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f92eb45295053a73661fd98f8e29b01a" data-thumbnail-img-id="1*VGvuY1ViIdR7xAtXBliy1Q.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*VGvuY1ViIdR7xAtXBliy1Q.jpeg);"></a></div><h3 name="a2fc" id="a2fc" class="graf graf--h3 graf-after--mixtapeEmbed">讓 property 名稱和 JSON 裡 object 的 key 名字不一樣</h3><div name="8483" id="8483" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 keyDecodingStrategy 的 convertFromSnakeCase 自動轉換 JSON 欄位名稱 — Swift 4.1</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 JSONDecoder，現在我們不再需要第三方套件，很方便就能將 JSON 資料轉換成自訂型別。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="19556f2f269fafd988fd8fdf2f4d72ba" data-thumbnail-img-id="1*lO3GaREhhQfoKBqXgN8-Gg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*lO3GaREhhQfoKBqXgN8-Gg.jpeg);"></a></div><div name="c4c5" id="c4c5" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-enum-codingkeys-%E5%AE%A2%E8%A3%BD-json-%E5%B0%8D%E6%87%89%E7%9A%84-property-1b27f29c0c32" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-enum-codingkeys-%E5%AE%A2%E8%A3%BD-json-%E5%B0%8D%E6%87%89%E7%9A%84-property-1b27f29c0c32" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-enum-codingkeys-%E5%AE%A2%E8%A3%BD-json-%E5%B0%8D%E6%87%89%E7%9A%84-property-1b27f29c0c32"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 CodingKey 客製 JSON 對應的 property</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 JSONDecoder 我們可以方便地串接 API，將網路上的 JSON 資料轉換成方便 App 使用的自訂型別。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-enum-codingkeys-%E5%AE%A2%E8%A3%BD-json-%E5%B0%8D%E6%87%89%E7%9A%84-property-1b27f29c0c32" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f9911457c2d20b76f9dea0fff2d83a17" data-thumbnail-img-id="1*BEnqHultUN2yBm6iZwfeAw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*BEnqHultUN2yBm6iZwfeAw.jpeg);"></a></div><h3 name="961d" id="961d" class="graf graf--h3 graf-after--mixtapeEmbed">解析 JSON 裡的時間</h3><p name="6336" id="6336" class="graf graf--p graf-after--h3">當我們利用 JSONDecoder 串接 API 回傳的 JSON 資料時，通常我們會將時間欄位的資料對應到 Date 型別，方便之後App 使用一些時間運算的 function。不過 API 回傳的時間有許多格式，因此我們須告訴 JSONDecoder 時間的格式，它才能將時間解析後儲存成 Date 型別。</p><div name="209c" id="209c" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/jsondecoder-%E8%A7%A3%E6%9E%90%E6%99%82%E9%96%93%E7%9A%84-datedecodingstrategy-a4095481f193" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/jsondecoder-%E8%A7%A3%E6%9E%90%E6%99%82%E9%96%93%E7%9A%84-datedecodingstrategy-a4095481f193" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/jsondecoder-%E8%A7%A3%E6%9E%90%E6%99%82%E9%96%93%E7%9A%84-datedecodingstrategy-a4095481f193"><strong class="markup--strong markup--mixtapeEmbed-strong">JSONDecoder 解析時間的 DateDecodingStrategy</strong><br><em class="markup--em markup--mixtapeEmbed-em">當我們利用 JSONDecoder 串接 API 回傳的 JSON 資料時，通常我們會將時間欄位的資料對應到 Date 型別，方便之後App 使用一些時間運算的 function。不過 API 回傳的時間有許多格式，因此我們須告訴…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/jsondecoder-%E8%A7%A3%E6%9E%90%E6%99%82%E9%96%93%E7%9A%84-datedecodingstrategy-a4095481f193" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fad371785dbafdf71cb84bb33b2027f6" data-thumbnail-img-id="1*ReAitj-hKl0IxZ2546Jyeg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*ReAitj-hKl0IxZ2546Jyeg.jpeg);"></a></div><h3 name="b72f" id="b72f" class="graf graf--h3 graf-after--mixtapeEmbed">新手的 Swift JSON decode 練習題 &amp; 解答</h3><div name="440f" id="440f" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/%E6%96%B0%E6%89%8B%E7%9A%84-swift-json-decode-%E7%B7%B4%E7%BF%92%E9%A1%8C-3b89559c0aa8" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/%E6%96%B0%E6%89%8B%E7%9A%84-swift-json-decode-%E7%B7%B4%E7%BF%92%E9%A1%8C-3b89559c0aa8" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/%E6%96%B0%E6%89%8B%E7%9A%84-swift-json-decode-%E7%B7%B4%E7%BF%92%E9%A1%8C-3b89559c0aa8"><strong class="markup--strong markup--mixtapeEmbed-strong">新手的 Swift JSON decode 練習題</strong><br><em class="markup--em markup--mixtapeEmbed-em">題目</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/%E6%96%B0%E6%89%8B%E7%9A%84-swift-json-decode-%E7%B7%B4%E7%BF%92%E9%A1%8C-3b89559c0aa8" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f379d28008937fa757e44542d051d408" data-thumbnail-img-id="1*DciLvHO-TjudD2ntht3-pg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*DciLvHO-TjudD2ntht3-pg.png);"></a></div><h3 name="e2ab" id="e2ab" class="graf graf--h3 graf-after--mixtapeEmbed">請 AI 定義 JSON 資料對應的 Codable 型別和指定需要的資料</h3><div name="8d37" id="8d37" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E5%AE%9A%E7%BE%A9-json-%E8%B3%87%E6%96%99%E5%B0%8D%E6%87%89%E7%9A%84-codable-%E5%9E%8B%E5%88%A5%E5%92%8C%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E7%9A%84%E8%B3%87%E6%96%99-878a95656141" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E5%AE%9A%E7%BE%A9-json-%E8%B3%87%E6%96%99%E5%B0%8D%E6%87%89%E7%9A%84-codable-%E5%9E%8B%E5%88%A5%E5%92%8C%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E7%9A%84%E8%B3%87%E6%96%99-878a95656141" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E5%AE%9A%E7%BE%A9-json-%E8%B3%87%E6%96%99%E5%B0%8D%E6%87%89%E7%9A%84-codable-%E5%9E%8B%E5%88%A5%E5%92%8C%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E7%9A%84%E8%B3%87%E6%96%99-878a95656141"><strong class="markup--strong markup--mixtapeEmbed-strong">請 AI 定義 JSON 資料對應的 Codable 型別和指定需要的資料</strong><br><em class="markup--em markup--mixtapeEmbed-em">定義 JSON 資料對應的 Codable 型別並不難，只要懂得將欄位複製貼上。不過遇到多層的 JSON 時，定義多個 Codable 型別和屬性也是頗辛苦的事。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AB%8B-ai-%E5%AE%9A%E7%BE%A9-json-%E8%B3%87%E6%96%99%E5%B0%8D%E6%87%89%E7%9A%84-codable-%E5%9E%8B%E5%88%A5%E5%92%8C%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E7%9A%84%E8%B3%87%E6%96%99-878a95656141" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c4fa9b2ec058568460ffdc9484eeb76b" data-thumbnail-img-id="1*METcH5SKQCwTs1VCiGP_OA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*METcH5SKQCwTs1VCiGP_OA.png);"></a></div><h3 name="9c93" id="9c93" class="graf graf--h3 graf-after--mixtapeEmbed">貼上 JSON，自動產生 Swift Codable 型別的 quicktype</h3><div name="6eea" id="6eea" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://app.quicktype.io" data-href="https://app.quicktype.io" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://app.quicktype.io"><strong class="markup--strong markup--mixtapeEmbed-strong">Instantly parse JSON in any language | quicktype</strong><br><em class="markup--em markup--mixtapeEmbed-em">Whether you&#39;re using C#, Swift, TypeScript, Go, C++ or other languages, quicktype generates models and helper code for…</em>app.quicktype.io</a><a href="https://app.quicktype.io" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="f9f4fadbabab3a925e6e5f34fd6ac73b"></a></div><h3 name="a352" id="a352" class="graf graf--h3 graf-after--mixtapeEmbed">在 Codable 型別裡宣告跟 JSON 資料無關的 property</h3><p name="68ad" id="68ad" class="graf graf--p graf-after--h3">自訂型別的 property 必須對應 JSON 的 key，不過我們也可以加入跟 JSON 無關的 property 存資料，相關說明可參考以下連結。</p><div name="6622" id="6622" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122"><strong class="markup--strong markup--mixtapeEmbed-strong">在 Codable 型別裡宣告跟 JSON 資料無關的 property</strong><br><em class="markup--em markup--mixtapeEmbed-em">有時我們會想在遵從 Codable 的型別裡宣告跟 JSON 資料無關的 property。接下來讓我們以 Meme API 的 JSON 為例，介紹 4 種不同的方法。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="f504dc0d88688d4826c417d68d81a020"></a></div><h3 name="c473" id="c473" class="graf graf--h3 graf-after--mixtapeEmbed">iOS 解碼 &amp; 編碼 JSON 的文章整理</h3><p name="ca9f" id="ca9f" class="graf graf--p graf-after--h3">關於 iOS 解碼 &amp; 編碼 JSON 的故事，其實還有很多，比方想自己控制解碼 JSON，可定義 function init(from:)。有興趣的朋友可進一步參考以下連結的說明。</p><div name="16cd" id="16cd" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-%E8%A7%A3%E7%A2%BC-%E7%B7%A8%E7%A2%BC-json-%E7%9A%84%E6%96%87%E7%AB%A0%E6%95%B4%E7%90%86-d3f6aa7abf95" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-%E8%A7%A3%E7%A2%BC-%E7%B7%A8%E7%A2%BC-json-%E7%9A%84%E6%96%87%E7%AB%A0%E6%95%B4%E7%90%86-d3f6aa7abf95" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-%E8%A7%A3%E7%A2%BC-%E7%B7%A8%E7%A2%BC-json-%E7%9A%84%E6%96%87%E7%AB%A0%E6%95%B4%E7%90%86-d3f6aa7abf95"><strong class="markup--strong markup--mixtapeEmbed-strong">iOS 解碼 &amp; 編碼 JSON 的文章整理</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 JSONDecoder 和 Codable 解析 JSON 和生成自訂型別資料</em>medium.co</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/ios-%E8%A7%A3%E7%A2%BC-%E7%B7%A8%E7%A2%BC-json-%E7%9A%84%E6%96%87%E7%AB%A0%E6%95%B4%E7%90%86-d3f6aa7abf95" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="eb831f5d2a82033bb27fe8044279e271" data-thumbnail-img-id="1*jGKr22M8tS4VtslkA8_uOw.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*jGKr22M8tS4VtslkA8_uOw.png);"></a></div><div name="7562" id="7562" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://matteomanferdini.com/swift-parse-json/" data-href="https://matteomanferdini.com/swift-parse-json/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://matteomanferdini.com/swift-parse-json/"><strong class="markup--strong markup--mixtapeEmbed-strong">Parsing JSON in Swift: The Complete Guide [With Examples]</strong><br><em class="markup--em markup--mixtapeEmbed-em">Parsing JSON Data is a fundamental in modern SwiftUI apps. This comprehensive guide covers all the aspects of the…</em>matteomanferdini.com</a><a href="https://matteomanferdini.com/swift-parse-json/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="431cc570b19b68209041d5f28fd93c14" data-thumbnail-img-id="0*eBhqDKYmt5CGbRz2" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*eBhqDKYmt5CGbRz2);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/ee793622629e"><time class="dt-published" datetime="2017-08-24T14:53:50.658Z">August 24, 2017</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>