<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>實現 Swift Charts 長條圖(BarMark)的動畫</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">實現 Swift Charts 長條圖(BarMark)的動畫</h1>
</header>
<section data-field="subtitle" class="p-summary">
透過 Swift Charts 的 BarMark 我們可以快速做出長條圖，例如以下顯示寶可夢傳說角色彼得潘的例子(誤)。
</section>
<section data-field="body" class="e-content">
<section name="ce67" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d1b3" id="d1b3" class="graf graf--h3 graf--leading graf--title">實現 Swift Charts 長條圖(BarMark)的動畫</h3><p name="8c63" id="8c63" class="graf graf--p graf-after--h3">透過 Swift Charts 的 BarMark 我們可以快速做出長條圖，例如以下顯示寶可夢傳說角色彼得潘的例子(誤)。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="785f" id="785f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Pokemon</span> {<br />    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">var</span> hp: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">var</span> attack: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">var</span> defense: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">var</span> specialAttack: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">var</span> specialDefense: <span class="hljs-type">Int</span><br />    <span class="hljs-keyword">var</span> speed: <span class="hljs-type">Int</span><br />}</span></pre><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7245" id="7245" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> pokemonPeter <span class="hljs-operator">=</span> <span class="hljs-type">Pokemon</span>(<br />        name: <span class="hljs-string">&quot;彼得潘&quot;</span>,<br />        hp: <span class="hljs-number">900</span>,<br />        attack: <span class="hljs-number">880</span>,<br />        defense: <span class="hljs-number">800</span>,<br />        specialAttack: <span class="hljs-number">999</span>,<br />        specialDefense: <span class="hljs-number">800</span>,<br />        speed: <span class="hljs-number">950</span><br />    )<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(pokemonPeter.name)<br />                .font(.title)<br />            <span class="hljs-type">Image</span>(.peter)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(height: <span class="hljs-number">200</span>)<br />            <span class="hljs-type">Chart</span> {<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;HP&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.hp))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;攻擊&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.attack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;防禦&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.defense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特攻&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.specialAttack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特防&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.specialDefense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;速度&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, pokemonPeter.speed))<br />            }<br />            .foregroundStyle(.orange.gradient)<br />            <br />            <span class="hljs-type">Spacer</span>()<br />        }<br />        .padding()<br />    }<br />}</span></pre><figure name="77ca" id="77ca" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*AjhP8gSALsaw5DOAZwsWcA.png" data-width="1206" data-height="2622" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*AjhP8gSALsaw5DOAZwsWcA.png"></figure><p name="e567" id="e567" class="graf graf--p graf-after--figure">不過我們往往希望長條圖出現時能有酷炫的動畫效果，以下我們示範如何實現長條圖由下而上長出的動畫效果。</p><figure name="a5b9" id="a5b9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*bRuhtOJxAHhj9xYk1wZxqg.gif" data-width="295" data-height="640" src="https://cdn-images-1.medium.com/max/800/1*bRuhtOJxAHhj9xYk1wZxqg.gif"></figure><h3 name="c564" id="c564" class="graf graf--h3 graf-after--figure">寫法 1</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3b63" id="3b63" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> pokemonPeter <span class="hljs-operator">=</span> <span class="hljs-type">Pokemon</span>(<br />        name: <span class="hljs-string">&quot;彼得潘&quot;</span>,<br />        hp: <span class="hljs-number">900</span>,<br />        attack: <span class="hljs-number">880</span>,<br />        defense: <span class="hljs-number">800</span>,<br />        specialAttack: <span class="hljs-number">999</span>,<br />        specialDefense: <span class="hljs-number">800</span>,<br />        speed: <span class="hljs-number">950</span><br />    )<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hp <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> attack <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> defense <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> specialAttack <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> specialDefense <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> speed <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(pokemonPeter.name)<br />                .font(.title)<br />            <span class="hljs-type">Image</span>(.peter)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(height: <span class="hljs-number">200</span>)<br />            <span class="hljs-type">Chart</span> {<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;HP&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, hp))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;攻擊&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, attack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;防禦&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, defense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特攻&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, specialAttack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特防&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, specialDefense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;速度&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, speed))<br />            }<br />            .foregroundStyle(.orange.gradient)<br />            .chartYScale(domain: [<span class="hljs-number">0</span>, <span class="hljs-number">1000</span>])<br />            .onAppear {<br />                withAnimation(.linear(duration: <span class="hljs-number">3</span>)) {<br />                    hp <span class="hljs-operator">=</span> pokemonPeter.hp<br />                    attack <span class="hljs-operator">=</span> pokemonPeter.attack<br />                    defense <span class="hljs-operator">=</span> pokemonPeter.defense<br />                    specialAttack <span class="hljs-operator">=</span> pokemonPeter.specialAttack<br />                    specialDefense <span class="hljs-operator">=</span> pokemonPeter.specialDefense<br />                    speed <span class="hljs-operator">=</span> pokemonPeter.speed<br />                }<br />            }<br />            <span class="hljs-type">Spacer</span>()<br />        }<br />        .padding()<br />    }<br />}</span></pre><p name="1960" id="1960" class="graf graf--p graf-after--pre">利用 State 變數數值的變化和 withAnimation 實現動畫效果。值得注意的，必須用 chartYScale 設定 Y 軸的範圍，讓長條圖知道上限跟下限，它才能由下往上長。若是忘了加 chartYScale，長條圖動畫將奇怪地從中間往上下兩端長。</p><p name="9398" id="9398" class="graf graf--p graf-after--p">剛剛的例子 Y 軸的上限是寫死的，若想做得更彈性，則可從資料動態計算最大值，例如以下的 maxValue。算出資料的最大值後，圖表的 Y 軸上限通常會希望比最大值再大一點，因此我們將 chartYScale 的上限設為 maxValue + 10。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="0cb1" id="0cb1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> pokemonPeter <span class="hljs-operator">=</span> <span class="hljs-type">Pokemon</span>(<br />        name: <span class="hljs-string">&quot;彼得潘&quot;</span>,<br />        hp: <span class="hljs-number">900</span>,<br />        attack: <span class="hljs-number">880</span>,<br />        defense: <span class="hljs-number">800</span>,<br />        specialAttack: <span class="hljs-number">999</span>,<br />        specialDefense: <span class="hljs-number">800</span>,<br />        speed: <span class="hljs-number">950</span><br />    )<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hp <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> attack <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> defense <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> specialAttack <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> specialDefense <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> speed <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-keyword">let</span> maxValue <span class="hljs-operator">=</span> <span class="hljs-built_in">max</span>(<br />            pokemonPeter.hp,<br />            pokemonPeter.attack,<br />            pokemonPeter.defense,<br />            pokemonPeter.specialAttack,<br />            pokemonPeter.specialDefense,<br />            pokemonPeter.speed<br />        )<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(pokemonPeter.name)<br />                .font(.title)<br />            <span class="hljs-type">Image</span>(.peter)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(height: <span class="hljs-number">200</span>)<br />            <span class="hljs-type">Chart</span> {<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;HP&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, hp))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;攻擊&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, attack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;防禦&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, defense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特攻&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, specialAttack))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;特防&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, specialDefense))<br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, <span class="hljs-string">&quot;速度&quot;</span>), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, speed))<br />            }<br />            .foregroundStyle(.orange.gradient)<br />            .chartYScale(domain: [<span class="hljs-number">0</span>, maxValue <span class="hljs-operator">+</span> <span class="hljs-number">10</span>])<br />            .onAppear {<br />                withAnimation(.linear(duration: <span class="hljs-number">3</span>)) {<br />                    hp <span class="hljs-operator">=</span> pokemonPeter.hp<br />                    attack <span class="hljs-operator">=</span> pokemonPeter.attack<br />                    defense <span class="hljs-operator">=</span> pokemonPeter.defense<br />                    specialAttack <span class="hljs-operator">=</span> pokemonPeter.specialAttack<br />                    specialDefense <span class="hljs-operator">=</span> pokemonPeter.specialDefense<br />                    speed <span class="hljs-operator">=</span> pokemonPeter.speed<br />                }<br />            }<br />            <span class="hljs-type">Spacer</span>()<br />        }<br />        .padding()<br />    }<br />}</span></pre><h3 name="fa86" id="fa86" class="graf graf--h3 graf-after--pre">寫法 2</h3><p name="3f18" id="3f18" class="graf graf--p graf-after--h3">一個個寫出寶可夢每個屬性的 BarMark 未免有點辛苦，精簡一點的寫法是將它變成 array，再讓 Chart 依據 array 生成 BarMark。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9797" id="9797" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> Foundation<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Stat</span>: <span class="hljs-title class_">Identifiable</span> {<br />    <span class="hljs-keyword">let</span> id <span class="hljs-operator">=</span> <span class="hljs-type">UUID</span>()<br />    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">var</span> value: <span class="hljs-type">Int</span><br />}</span></pre><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="63a5" id="63a5" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> pokemonPeter <span class="hljs-operator">=</span> <span class="hljs-type">Pokemon</span>(<br />        name: <span class="hljs-string">&quot;彼得潘&quot;</span>,<br />        hp: <span class="hljs-number">900</span>,<br />        attack: <span class="hljs-number">880</span>,<br />        defense: <span class="hljs-number">800</span>,<br />        specialAttack: <span class="hljs-number">999</span>,<br />        specialDefense: <span class="hljs-number">800</span>,<br />        speed: <span class="hljs-number">950</span><br />    )<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> stats <span class="hljs-operator">=</span> [<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;HP&quot;</span>, value: <span class="hljs-number">0</span>),<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;攻擊&quot;</span>, value: <span class="hljs-number">0</span>),<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;防禦&quot;</span>, value: <span class="hljs-number">0</span>),<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;特攻&quot;</span>, value: <span class="hljs-number">0</span>),<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;特防&quot;</span>, value: <span class="hljs-number">0</span>),<br />        <span class="hljs-type">Stat</span>(name: <span class="hljs-string">&quot;速度&quot;</span>, value: <span class="hljs-number">0</span>)<br />    ]<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-keyword">let</span> maxValue <span class="hljs-operator">=</span> <span class="hljs-built_in">max</span>(<br />            pokemonPeter.hp,<br />            pokemonPeter.attack,<br />            pokemonPeter.defense,<br />            pokemonPeter.specialAttack,<br />            pokemonPeter.specialDefense,<br />            pokemonPeter.speed<br />        )<br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(pokemonPeter.name)<br />                .font(.title)<br />            <span class="hljs-type">Image</span>(.peter)<br />                .resizable()<br />                .scaledToFit()<br />                .frame(height: <span class="hljs-number">200</span>)<br />            <span class="hljs-type">Chart</span>(stats) { stat <span class="hljs-keyword">in</span><br />                <span class="hljs-type">BarMark</span>(x: .value(<span class="hljs-string">&quot;能力值&quot;</span>, stat.name), y: .value(<span class="hljs-string">&quot;數值&quot;</span>, stat.value))<br />            }<br />            .foregroundStyle(.orange.gradient)<br />            .chartYScale(domain: [<span class="hljs-number">0</span>, maxValue <span class="hljs-operator">+</span> <span class="hljs-number">10</span>])<br />            .onAppear {<br />                withAnimation(.linear(duration: <span class="hljs-number">3</span>)) {<br />                    stats[<span class="hljs-number">0</span>].value <span class="hljs-operator">=</span> pokemonPeter.hp<br />                    stats[<span class="hljs-number">1</span>].value <span class="hljs-operator">=</span> pokemonPeter.attack<br />                    stats[<span class="hljs-number">2</span>].value <span class="hljs-operator">=</span> pokemonPeter.defense<br />                    stats[<span class="hljs-number">3</span>].value <span class="hljs-operator">=</span> pokemonPeter.specialAttack<br />                    stats[<span class="hljs-number">4</span>].value <span class="hljs-operator">=</span> pokemonPeter.specialDefense<br />                    stats[<span class="hljs-number">5</span>].value <span class="hljs-operator">=</span> pokemonPeter.speed<br />                }<br />            }<br />            <span class="hljs-type">Spacer</span>()<br />        }<br />        .padding()<br />    }<br />}</span></pre><h3 name="fca3" id="fca3" class="graf graf--h3 graf-after--pre">其它例子: 寶可夢的 HP 比較圖</h3><figure name="6e15" id="6e15" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*OBzqVbRQvfiYFbKSZI5how.gif" data-width="295" data-height="640" src="https://cdn-images-1.medium.com/max/800/1*OBzqVbRQvfiYFbKSZI5how.gif"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ca9b" id="ca9b" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> pokemons <span class="hljs-operator">=</span> [<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;皮卡丘&quot;</span>,<br />            hp: <span class="hljs-number">35</span>,<br />            attack: <span class="hljs-number">55</span>,<br />            defense: <span class="hljs-number">40</span>,<br />            specialAttack: <span class="hljs-number">50</span>,<br />            specialDefense: <span class="hljs-number">50</span>,<br />            speed: <span class="hljs-number">90</span><br />        ),<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;伊布&quot;</span>,<br />            hp: <span class="hljs-number">55</span>,<br />            attack: <span class="hljs-number">55</span>,<br />            defense: <span class="hljs-number">50</span>,<br />            specialAttack: <span class="hljs-number">45</span>,<br />            specialDefense: <span class="hljs-number">65</span>,<br />            speed: <span class="hljs-number">55</span><br />        ),<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;妙蛙種子&quot;</span>,<br />            hp: <span class="hljs-number">45</span>,<br />            attack: <span class="hljs-number">49</span>,<br />            defense: <span class="hljs-number">49</span>,<br />            specialAttack: <span class="hljs-number">65</span>,<br />            specialDefense: <span class="hljs-number">65</span>,<br />            speed: <span class="hljs-number">45</span><br />        ),<br />    ]<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hps <span class="hljs-operator">=</span> <span class="hljs-type">Array</span>(repeating: <span class="hljs-number">0</span>, count: <span class="hljs-number">3</span>)<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-keyword">let</span> maxHp <span class="hljs-operator">=</span> pokemons.map(\.hp).max()<span class="hljs-operator">!</span><br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;寶可夢 HP 比較&quot;</span>)<br />                .font(.title)<br />            <span class="hljs-type">Chart</span>(pokemons.indices, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span><br />                <span class="hljs-keyword">let</span> pokemon <span class="hljs-operator">=</span> pokemons[index]<br />                <span class="hljs-type">BarMark</span>(<br />                    x: .value(<span class="hljs-string">&quot;名稱&quot;</span>, pokemon.name),<br />                    y: .value(<span class="hljs-string">&quot;HP&quot;</span>, hps[index])<br />                )<br />            }<br />            .frame(height: <span class="hljs-number">300</span>)<br />            .foregroundStyle(.orange.gradient)<br />            .chartYScale(domain: [<span class="hljs-number">0</span>, maxHp <span class="hljs-operator">+</span> <span class="hljs-number">10</span>])<br />            .onAppear {<br />                withAnimation(.linear(duration: <span class="hljs-number">3</span>)) {<br />                    hps <span class="hljs-operator">=</span> pokemons.map(\.hp)<br />                }<br />            }<br />        }<br />        .padding()<br />    }<br />}</span></pre><p name="9fe1" id="9fe1" class="graf graf--p graf-after--pre">剛剛的 hps 用 <code class="markup--code markup--p-code">Array(repeating: 0, count: 3) </code>初始內容，成員的數量是寫死的，若希望依據資料的數量初始 hps，則可另外定義 init 設定 hps。(ps: 不能寫成 @State private var hps: [Int] = pokemons.count，因為宣告 property 時不能存取另一個 property)</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7e93" id="7e93" class="graf graf--pre graf-after--p graf--trailing graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> Charts<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> pokemons <span class="hljs-operator">=</span> [<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;皮卡丘&quot;</span>,<br />            hp: <span class="hljs-number">35</span>,<br />            attack: <span class="hljs-number">55</span>,<br />            defense: <span class="hljs-number">40</span>,<br />            specialAttack: <span class="hljs-number">50</span>,<br />            specialDefense: <span class="hljs-number">50</span>,<br />            speed: <span class="hljs-number">90</span><br />        ),<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;伊布&quot;</span>,<br />            hp: <span class="hljs-number">55</span>,<br />            attack: <span class="hljs-number">55</span>,<br />            defense: <span class="hljs-number">50</span>,<br />            specialAttack: <span class="hljs-number">45</span>,<br />            specialDefense: <span class="hljs-number">65</span>,<br />            speed: <span class="hljs-number">55</span><br />        ),<br />        <span class="hljs-type">Pokemon</span>(<br />            name: <span class="hljs-string">&quot;妙蛙種子&quot;</span>,<br />            hp: <span class="hljs-number">45</span>,<br />            attack: <span class="hljs-number">49</span>,<br />            defense: <span class="hljs-number">49</span>,<br />            specialAttack: <span class="hljs-number">65</span>,<br />            specialDefense: <span class="hljs-number">65</span>,<br />            speed: <span class="hljs-number">45</span><br />        ),<br />    ]<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> hps: [<span class="hljs-type">Int</span>]<br />    <br />    <span class="hljs-keyword">init</span>() {<br />        _hps <span class="hljs-operator">=</span> <span class="hljs-type">State</span>(initialValue: <span class="hljs-type">Array</span>(repeating: <span class="hljs-number">0</span>, count: pokemons.count))<br />    }<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-keyword">let</span> maxHp <span class="hljs-operator">=</span> pokemons.map(\.hp).max()<span class="hljs-operator">!</span><br />        <span class="hljs-type">VStack</span> {<br />            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;寶可夢 HP 比較&quot;</span>)<br />                .font(.title)<br />            <span class="hljs-type">Chart</span>(pokemons.indices, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span><br />                <span class="hljs-keyword">let</span> pokemon <span class="hljs-operator">=</span> pokemons[index]<br />                <span class="hljs-type">BarMark</span>(<br />                    x: .value(<span class="hljs-string">&quot;名稱&quot;</span>, pokemon.name),<br />                    y: .value(<span class="hljs-string">&quot;HP&quot;</span>, hps[index])<br />                )<br />            }<br />            .frame(height: <span class="hljs-number">300</span>)<br />            .foregroundStyle(.orange.gradient)<br />            .chartYScale(domain: [<span class="hljs-number">0</span>, maxHp <span class="hljs-operator">+</span> <span class="hljs-number">10</span>])<br />            .onAppear {<br />                withAnimation(.linear(duration: <span class="hljs-number">3</span>)) {<br />                    hps <span class="hljs-operator">=</span> pokemons.map(\.hp)<br />                }<br />            }<br />        }<br />        .padding()<br />    }<br />}</span></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/9bb81c0328c8"><time class="dt-published" datetime="2024-12-09T03:25:01.105Z">December 9, 2024</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%AF%A6%E7%8F%BE-swift-charts-%E9%95%B7%E6%A2%9D%E5%9C%96-barmark-%E7%9A%84%E5%8B%95%E7%95%AB-9bb81c0328c8" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>