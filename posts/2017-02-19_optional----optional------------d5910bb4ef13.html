<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>optional 和非 optional 可以直接比較是否相等</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">optional 和非 optional 可以直接比較是否相等</h1>
</header>
<section data-field="subtitle" class="p-summary">
大部分的時候，我們習慣將 optional 的內容讀取後再做相等(equal)的比較，例如以下例子:
</section>
<section data-field="body" class="e-content">
<section name="9959" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><figure name="358d" id="358d" class="graf graf--figure graf--leading"><img class="graf-image" data-image-id="1*4Oj6SHrGWmM1Hessu055_A.jpeg" data-width="1814" data-height="744" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*4Oj6SHrGWmM1Hessu055_A.jpeg"></figure><h3 name="750e" id="750e" class="graf graf--h3 graf-after--figure graf--title"><strong class="markup--strong markup--h3-strong">optional 和非 optional 可以直接比較是否相等</strong></h3><p name="bcc1" id="bcc1" class="graf graf--p graf-after--h3">大部分的時候，我們習慣將 optional 的內容讀取後再做相等(equal)的比較，例如以下例子:</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="4b54" id="4b54" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-string">&quot;彼得潘&quot;</span><br /><span class="hljs-keyword">if</span> name<span class="hljs-operator">!</span> <span class="hljs-operator">==</span> <span class="hljs-string">&quot;彼得潘&quot;</span> {<br />   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;best name in the world&quot;</span>)<br />}<br /><span class="hljs-keyword">if</span> name <span class="hljs-operator">!=</span> <span class="hljs-literal">nil</span> <span class="hljs-operator">&amp;&amp;</span> name<span class="hljs-operator">!</span> <span class="hljs-operator">==</span> <span class="hljs-string">&quot;彼得潘&quot;</span> {<br />   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;best name in the world&quot;</span>)<br />}<br /><span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> name <span class="hljs-operator">=</span> name, name <span class="hljs-operator">==</span> <span class="hljs-string">&quot;彼得潘&quot;</span> {<br />   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;best name in the world&quot;</span>)<br />}</span></pre><p name="9329" id="9329" class="graf graf--p graf-after--pre">例子裡的字串可以比較，是因為 String 裡定義了以下 function。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c48e" id="c48e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">==</span>(<span class="hljs-params">lhs</span>: <span class="hljs-type">String</span>, <span class="hljs-params">rhs</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Bool</span></span></pre><p name="1e01" id="1e01" class="graf graf--p graf-after--pre">其實用不著這麼麻煩，在剛剛的例子，我們可以將 optional 的變數 name 直接和字串”彼得潘” 比較，唯有當 name 不等於 nil，且 name 的內容為”彼得潘” 時，比較的結果才會為 true :</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="68b9" id="68b9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>? <span class="hljs-operator">=</span> <span class="hljs-string">&quot;彼得潘&quot;</span><br /><span class="hljs-keyword">if</span> name <span class="hljs-operator">==</span> <span class="hljs-string">&quot;彼得潘&quot;</span> {<br />   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;best name in the world&quot;</span>)<br />}</span></pre><p name="2161" id="2161" class="graf graf--p graf-after--pre">為什麼 optional 的 name 可以和非 optional 的字串比較相等呢 ? 它們明明不同型，應該不能比呀。就好像彼得潘應該只能跟小王子比，不能跟小公主比呀。</p><p name="e51b" id="e51b" class="graf graf--p graf-after--p">真相就藏在定義 optional 的 enum Optional&lt;Wrapped&gt; : ExpressibleByNilLiteral 裡。enum Optional 裡定義了以下 function。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="aa15" id="aa15" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">public</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">==&lt;</span><span class="hljs-type">T</span><span class="hljs-operator">&gt;</span>(lhs: <span class="hljs-type">T</span>?, rhs: <span class="hljs-type">T</span>?) -&gt; <span class="hljs-type">Bool</span> <span class="hljs-keyword">where</span> <span class="hljs-type">T</span> : <span class="hljs-type">Equatable</span></span></pre><p name="334b" id="334b" class="graf graf--p graf-after--pre">從這個 function，我們了解 optional 可以跟 optional 比。但這並沒有解答我們的問題呀，為什麼 optional 可以跟非 optional 比 ? 別急，請耐心看完它上面的注解。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="bfc1" id="bfc1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-comment">/// Returns a Boolean value indicating whether two optional instances are</span><br /><span class="hljs-comment">/// equal.</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">/// Use this equal-to operator (`==`) to compare any two optional instances of</span><br /><span class="hljs-comment">/// a type that conforms to the `Equatable` protocol. The comparison returns</span><br /><span class="hljs-comment">/// `true` if both arguments are `nil` or if the two arguments wrap values</span><br /><span class="hljs-comment">/// that are equal. Conversely, the comparison returns `false` if only one of</span><br /><span class="hljs-comment">/// the arguments is `nil` or if the two arguments wrap values that are not</span><br /><span class="hljs-comment">/// equal.</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">///     let group1 = [1, 2, 3, 4, 5]</span><br /><span class="hljs-comment">///     let group2 = [1, 3, 5, 7, 9]</span><br /><span class="hljs-comment">///     if group1.first == group2.first {</span><br /><span class="hljs-comment">///         print(&quot;The two groups start the same.&quot;)</span><br /><span class="hljs-comment">///     }</span><br /><span class="hljs-comment">///     // Prints &quot;The two groups start the same.&quot;</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">/// You can also use this operator to compare a non-optional value to an</span><br /><span class="hljs-comment">/// optional that wraps the same type. The non-optional value is wrapped as an</span><br /><span class="hljs-comment">/// optional before the comparison is made. In the following example, the</span><br /><span class="hljs-comment">/// `numberToMatch` constant is wrapped as an optional before comparing to the</span><br /><span class="hljs-comment">/// optional `numberFromString`:</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">///     let numberToFind: Int = 23</span><br /><span class="hljs-comment">///     let numberFromString: Int? = Int(&quot;23&quot;)      // Optional(23)</span><br /><span class="hljs-comment">///     if numberToFind == numberFromString {</span><br /><span class="hljs-comment">///         print(&quot;It&#x27;s a match!&quot;)</span><br /><span class="hljs-comment">///     }</span><br /><span class="hljs-comment">///     // Prints &quot;It&#x27;s a match!&quot;</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">/// An instance that is expressed as a literal can also be used with this</span><br /><span class="hljs-comment">/// operator. In the next example, an integer literal is compared with the</span><br /><span class="hljs-comment">/// optional integer `numberFromString`. The literal `23` is inferred as an</span><br /><span class="hljs-comment">/// `Int` instance and then wrapped as an optional before the comparison is</span><br /><span class="hljs-comment">/// performed.</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">///     if 23 == numberFromString {</span><br /><span class="hljs-comment">///         print(&quot;It&#x27;s a match!&quot;)</span><br /><span class="hljs-comment">///     }</span><br /><span class="hljs-comment">///     // Prints &quot;It&#x27;s a match!&quot;</span><br /><span class="hljs-comment">///</span><br /><span class="hljs-comment">/// - Parameters:</span><br /><span class="hljs-comment">///   - lhs: An optional value to compare.</span><br /><span class="hljs-comment">///   - rhs: Another optional value to compare.</span></span></pre><p name="bc8d" id="bc8d" class="graf graf--p graf-after--pre">是不是覺得注解超長，我的字典裡只有放棄呀。好啦，簡單的說，注解裡提到，以下三種情況都可比較是否相等:</p><blockquote name="1fff" id="1fff" class="graf graf--blockquote graf-after--p">1 兩個變數(常數)都是 optional</blockquote><blockquote name="272b" id="272b" class="graf graf--blockquote graf-after--blockquote">2 一個變數(常數)是 optional，一個不是。</blockquote><blockquote name="d708" id="d708" class="graf graf--blockquote graf-after--blockquote">3 變數(常數)是 optional，另一個是 literal，比方數字 10，字串 “peter”。</blockquote><p name="b115" id="b115" class="graf graf--p graf-after--blockquote">後兩者可以比是因為非 optional 的變數(常數)或 literal 會先被包成 optional，然後再和 optional 的對手比較。因此，這時就可以比了，因為它們是同一型的人 ! 同樣都是 optional。</p><p name="008b" id="008b" class="graf graf--p graf-after--p">optional 既然可以比較相等，那它是否可以比大小呢 ? 很可惜的，它不能，因為它是膽小鬼，不敢比。在 enum Optional 裡，我們找不到 function &gt; 或 &lt; 的定義。</p><p name="a52e" id="a52e" class="graf graf--p graf-after--p">文章內容為彼得潘的 Swift 程式設計入門新增章節 ，<strong class="markup--strong markup--p-strong">18–10 optional 和非 optional 可以直接比較是否相等。</strong></p><div name="d979" id="d979" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="http://swiftbook.strikingly.com" data-href="http://swiftbook.strikingly.com" class="markup--anchor markup--mixtapeEmbed-anchor" title="http://swiftbook.strikingly.com"><strong class="markup--strong markup--mixtapeEmbed-strong">彼得潘的 Swift 程式設計入門</strong><br><em class="markup--em markup--mixtapeEmbed-em">本書搭配全新的 Swift 4、Xcode 9 和 iOS 11 SDK，以各種生動有趣的實例帶領讀者由淺入深認識 Swift，並在 Xcode 全新打造的練功樂園 playground 盡情敞佯，學習關於 Swift…</em>swiftbook.strikingly.com</a><a href="http://swiftbook.strikingly.com" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fc2e5dddacd017ff26e6a0f6a524c76a" data-thumbnail-img-id="0*U5MyZBfOJ3r-1Bhy." style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*U5MyZBfOJ3r-1Bhy.);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/d5910bb4ef13"><time class="dt-published" datetime="2017-02-19T07:46:06.098Z">February 19, 2017</time></a>.</p><p><a href="https://medium.com/@apppeterpan/optional-%E5%92%8C%E9%9D%9E-optional-%E7%9A%84%E7%9B%B8%E7%AD%89%E6%AF%94%E8%BC%83-d5910bb4ef13" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>