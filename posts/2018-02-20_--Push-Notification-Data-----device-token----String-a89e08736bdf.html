<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>將 Push Notification Data 型別的 device token 變成 String</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">將 Push Notification Data 型別的 device token 變成 String</h1>
</header>
<section data-field="subtitle" class="p-summary">
當彼得潘要找到溫蒂的家時，靠的是溫蒂家的豪宅地址，英國倫敦豪宅路 1 號。當 Apple 的 APNs server 要發送推播到使用者手機上的某個 App 時，一樣也要依靠某個類似地址的東西，我們稱它為 device token。
</section>
<section data-field="body" class="e-content">
<section name="4b16" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="bd03" id="bd03" class="graf graf--h3 graf--leading graf--title">將 Push Notification Data 型別的 device token 變成 String</h3><p name="8665" id="8665" class="graf graf--p graf-after--h3">當彼得潘要找到溫蒂的家時，靠的是溫蒂家的豪宅地址，英國倫敦豪宅路 1 號。當 Apple 的 APNs server 要發送推播到使用者手機上的某個 App 時，一樣也要依靠某個類似地址的東西，我們稱它為 device token。</p><p name="0e66" id="0e66" class="graf graf--p graf-after--p">在開發 iOS App 時，我們可透過以下 function 取得 token。</p><pre name="a059" id="a059" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="c8e1" id="c8e1" class="graf graf--pre graf-after--pre">}</pre><div name="bb5e" id="bb5e" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622958-application" data-href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622958-application" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622958-application"><strong class="markup--strong markup--mixtapeEmbed-strong">application(_:didRegisterForRemoteNotificationsWithDeviceToken:) - UIApplicationDelegate | Apple…</strong><br><em class="markup--em markup--mixtapeEmbed-em">The app might call this method in other rare circumstances, such as when the user launches an app after having restored…</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uiapplicationdelegate/1622958-application" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="e6db09bbe0b42fbff91db75f1802d85f"></a></div><p name="d7ff" id="d7ff" class="graf graf--p graf-after--mixtapeEmbed">一般我們會在此 function 裡將 Data 型別的 deviceToken 轉換為字串後，上傳到 provider server (我們自己的後台) ，方便到時候 provider 發送推播時，告訴 APNs server 推播的對象。</p><figure name="8f6f" id="8f6f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wqFD5TLXuuzDxgjb9J5OVA.jpeg" data-width="1576" data-height="552" src="https://cdn-images-1.medium.com/max/800/1*wqFD5TLXuuzDxgjb9J5OVA.jpeg"></figure><p name="3a7d" id="3a7d" class="graf graf--p graf-after--figure">此字串的格式必須為十六進位，如以下 Apple 文件裡的範例，00fc13adff785122b4ad28809a3420982341241421348097878e577c991de8f0。</p><figure name="82b2" id="82b2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*S5-wXiLrsqRMZMK6OZjKDQ.jpeg" data-width="1432" data-height="1014" src="https://cdn-images-1.medium.com/max/800/1*S5-wXiLrsqRMZMK6OZjKDQ.jpeg"></figure><div name="98f6" id="98f6" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html#//apple_ref/doc/uid/TP40008194-CH11-SW1" data-href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html#//apple_ref/doc/uid/TP40008194-CH11-SW1" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html#//apple_ref/doc/uid/TP40008194-CH11-SW1"><strong class="markup--strong markup--mixtapeEmbed-strong">Local and Remote Notification Programming Guide: Communicating with APNs</strong><br><em class="markup--em markup--mixtapeEmbed-em">Describes how apps can send and receive user notifications locally and remotely.</em>developer.apple.com</a><a href="https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/CommunicatingwithAPNs.html#//apple_ref/doc/uid/TP40008194-CH11-SW1" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="c09bd13b29e766e00f47c0f58127c9cf"></a></div><p name="0132" id="0132" class="graf graf--p graf-after--mixtapeEmbed">接下來，我們將一步步說明如何將 Data 型別的 deviceToken 轉換為字串。我們將介紹兩種方法，你可以在 App 裡先轉換為十六進位後上傳到 provider server，或者你也可以上傳 base64 格式(64進位)，交給 provider server 轉換為十六進位。</p><blockquote name="6edc" id="6edc" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">方法一: App 裡將 device token 轉換為十六進位字串</strong></blockquote><p name="d188" id="d188" class="graf graf--p graf-after--blockquote">先印出 deviceToken，看看它到底長什麼樣子。</p><pre name="4dfb" id="4dfb" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="f872" id="f872" class="graf graf--pre graf-after--pre">   print(deviceToken)</pre><pre name="4c0c" id="4c0c" class="graf graf--pre graf-after--pre">}</pre><p name="1a8f" id="1a8f" class="graf graf--p graf-after--pre">結果</p><blockquote name="9fb8" id="9fb8" class="graf graf--blockquote graf-after--p">32 bytes</blockquote><p name="d6e8" id="d6e8" class="graf graf--p graf-after--blockquote">當我們列印 Data 型別的東西時，只能看到它的大小，無法看到實際的內容。</p><p name="6eab" id="6eab" class="graf graf--p graf-after--p">沒關係，只要將它轉型成 NSData 再印出，即可看到每個 byte 的內容。。</p><pre name="1840" id="1840" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="5aab" id="5aab" class="graf graf--pre graf-after--pre">   print(deviceToken as NSData)</pre><pre name="40ab" id="40ab" class="graf graf--pre graf-after--pre">}</pre><p name="8dd3" id="8dd3" class="graf graf--p graf-after--pre">結果</p><figure name="660a" id="660a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*QUSYCiMTtL9bVZyPjqCzcQ.jpeg" data-width="1004" data-height="112" src="https://cdn-images-1.medium.com/max/800/1*QUSYCiMTtL9bVZyPjqCzcQ.jpeg"></figure><p name="27f7" id="27f7" class="graf graf--p graf-after--figure">每個 byte 用 2 個十六進位數字表示，因此 d7 是第一個 byte，5e 是第二個 byte。每 4 個 bytes 一組，所以 d75e441c 和 494714ec 之間有空白。</p><p name="ff5c" id="ff5c" class="graf graf--p graf-after--p">我們也可以利用 for in ，將每個 byte 的內容當成 UInt8 型別讀取。</p><pre name="b92f" id="b92f" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="eae3" id="eae3" class="graf graf--pre graf-after--pre">   for byte in deviceToken {</pre><pre name="7b50" id="7b50" class="graf graf--pre graf-after--pre">      print(byte, terminator: &quot; &quot;)</pre><pre name="7004" id="7004" class="graf graf--pre graf-after--pre">   }</pre><pre name="fba8" id="fba8" class="graf graf--pre graf-after--pre">}</pre><figure name="d75f" id="d75f" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*vSg1kBwVkkMYqPYmwrXxrw.jpeg" data-width="1102" data-height="234" src="https://cdn-images-1.medium.com/max/800/1*vSg1kBwVkkMYqPYmwrXxrw.jpeg"></figure><p name="d56d" id="d56d" class="graf graf--p graf-after--figure">結果</p><figure name="1533" id="1533" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aU5vkUvHJpAjyEFaDVpu7Q.jpeg" data-width="1138" data-height="138" src="https://cdn-images-1.medium.com/max/800/1*aU5vkUvHJpAjyEFaDVpu7Q.jpeg"></figure><p name="a19a" id="a19a" class="graf graf--p graf-after--figure">由於型別為 UInt8，內容將以十進位的方式印出。和前面例子的結果比對， 215 其實就是剛剛第一個 byte 的 d7。</p><p name="c743" id="c743" class="graf graf--p graf-after--p">利用 String(format: “%02x”, byte)，可將數字變成十六進位的字串，因為 %02x 的 x 代表十六進位，02 表示將以兩個數字表示，若內容不足兩位數，第一位將補 0。比方 a 將變成 0a。</p><pre name="1bee" id="1bee" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="039d" id="039d" class="graf graf--pre graf-after--pre">   for byte in deviceToken {</pre><pre name="0d34" id="0d34" class="graf graf--pre graf-after--pre">      let hexString = String(format: &quot;%02x&quot;, byte)</pre><pre name="d27b" id="d27b" class="graf graf--pre graf-after--pre">      print(hexString, terminator: &quot; &quot;)</pre><pre name="8b79" id="8b79" class="graf graf--pre graf-after--pre">   }</pre><pre name="fb0c" id="fb0c" class="graf graf--pre graf-after--pre">}</pre><p name="294b" id="294b" class="graf graf--p graf-after--pre">結果</p><figure name="ccda" id="ccda" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*v7XbUoud8V1LPgleUcKqkg.jpeg" data-width="1114" data-height="96" src="https://cdn-images-1.medium.com/max/800/1*v7XbUoud8V1LPgleUcKqkg.jpeg"></figure><p name="49a1" id="49a1" class="graf graf--p graf-after--figure">我們要上傳給 provider server 的 device token 是十六進位字串，因此我們透過 for in 將每個 byte 的十六進位字串組合。</p><pre name="fca3" id="fca3" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="6a34" id="6a34" class="graf graf--pre graf-after--pre">   var tokenString = &quot;&quot;</pre><pre name="d89e" id="d89e" class="graf graf--pre graf-after--pre">   for byte in deviceToken {</pre><pre name="956e" id="956e" class="graf graf--pre graf-after--pre">      let hexString = String(format: &quot;%02x&quot;, byte)</pre><pre name="9f12" id="9f12" class="graf graf--pre graf-after--pre">      tokenString += hexString</pre><pre name="7327" id="7327" class="graf graf--pre graf-after--pre">   }</pre><pre name="a94d" id="a94d" class="graf graf--pre graf-after--pre">   print(tokenString)</pre><pre name="1d0a" id="1d0a" class="graf graf--pre graf-after--pre">}</pre><p name="eed2" id="eed2" class="graf graf--p graf-after--pre">結果</p><figure name="2df4" id="2df4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1wHV0LV6QCUdKkQQwwtIGA.jpeg" data-width="1120" data-height="118" src="https://cdn-images-1.medium.com/max/800/1*1wHV0LV6QCUdKkQQwwtIGA.jpeg"></figure><p name="0cf3" id="0cf3" class="graf graf--p graf-after--figure">如果熟悉 function reduce 的朋友，也可以用以下寫法組合出十六進位的字串。</p><pre name="a73a" id="a73a" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="647c" id="647c" class="graf graf--pre graf-after--pre">   let deviceTokenString = deviceToken.reduce(&quot;&quot;) {</pre><pre name="c04a" id="c04a" class="graf graf--pre graf-after--pre">      return $0 + String(format: &quot;%02x&quot;, $1)</pre><pre name="d1a3" id="d1a3" class="graf graf--pre graf-after--pre">   }</pre><pre name="8be9" id="8be9" class="graf graf--pre graf-after--pre">   print(deviceTokenString)</pre><pre name="04c1" id="04c1" class="graf graf--pre graf-after--pre">}</pre><blockquote name="6043" id="6043" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">方法二: App 裡將 device token 變成 base64 格式上傳，由 provider server 負責轉換為十六進位</strong></blockquote><p name="e4d1" id="e4d1" class="graf graf--p graf-after--blockquote">此做法對 App 來說比較簡單，因為只要呼叫 function base64EncodedString 即可得到 base64 格式的字串。但前一個方法較常被採用，因為此方法需要 provider server 的程式另外將 base64 轉換成十六進位。</p><pre name="b67b" id="b67b" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {</pre><pre name="e138" id="e138" class="graf graf--pre graf-after--pre">   let base64Token = deviceToken.base64EncodedString()</pre><pre name="cb20" id="cb20" class="graf graf--pre graf-after--pre">   print(base64Token)</pre><pre name="05f7" id="05f7" class="graf graf--pre graf-after--pre">}</pre><p name="fb7f" id="fb7f" class="graf graf--p graf-after--pre">結果</p><figure name="4d7a" id="4d7a" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*6DJl9Dr4QnkUTu3wnDzJCw.jpeg" data-width="1036" data-height="74" src="https://cdn-images-1.medium.com/max/800/1*6DJl9Dr4QnkUTu3wnDzJCw.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/a89e08736bdf"><time class="dt-published" datetime="2018-02-20T11:49:51.472Z">February 20, 2018</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%B0%87-push-notification-data-%E5%9E%8B%E5%88%A5%E7%9A%84-device-token-%E8%AE%8A%E6%88%90-string-a89e08736bdf" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>