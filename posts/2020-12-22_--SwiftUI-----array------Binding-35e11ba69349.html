<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>在 SwiftUI 如何將 array 的成員變 Binding</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">在 SwiftUI 如何將 array 的成員變 Binding</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 SwiftUI App 時，我們時常用到 Binding，而且產生的方法也很簡單   ，比方在 @State property 的變數加上 $，例如以下透過 toogle 設定書籍是否已讀的例子。
</section>
<section data-field="body" class="e-content">
<section name="58c8" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7507" id="7507" class="graf graf--h3 graf--leading graf--title">在 SwiftUI 如何將 array 的成員變 Binding</h3><figure name="b0f8" id="b0f8" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*lw3wwAYjyRUK_fRdI3ryug.png" data-width="1888" data-height="1324" src="https://cdn-images-1.medium.com/max/800/1*lw3wwAYjyRUK_fRdI3ryug.png"></figure><p name="a8b3" id="a8b3" class="graf graf--p graf-after--figure">開發 SwiftUI App 時，我們時常用到 Binding，而且產生的方法也很簡單 ，比方在 @State property 的變數加上 $，例如以下透過 toogle 設定書籍是否已讀的例子。</p><p name="c6fd" id="c6fd" class="graf graf--p graf-after--p">假設 Book 的型別如下。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="96a3" id="96a3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> Foundation<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Book</span>: <span class="hljs-title class_">Identifiable</span> {<br />    <span class="hljs-keyword">let</span> id <span class="hljs-operator">=</span> <span class="hljs-type">UUID</span>()<br />    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">var</span> isFinish: <span class="hljs-type">Bool</span><br />}</span></pre><p name="f3c1" id="f3c1" class="graf graf--p graf-after--pre">Toggle 的參數 isOn 型別為 Binding&lt;Bool&gt;，我們可以在 book 前加上 $ 得到 Binding，傳入 $book.isFinish。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c952" id="c952" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> book <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;野獸該死&quot;</span>, isFinish: <span class="hljs-literal">true</span>)<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">HStack</span> {<br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$book</span>.isFinish)<br />            }<br />        }<br />            <br />    }<br />}</span></pre><figure name="c567" id="c567" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*tN_YFYEwE1yNCBD_zkVDqQ.png" data-width="790" data-height="372" src="https://cdn-images-1.medium.com/max/800/1*tN_YFYEwE1yNCBD_zkVDqQ.png"></figure><p name="9084" id="9084" class="graf graf--p graf-after--figure">不過當 @State property 是 array 時，我們想得到它的成員的 Binding 時，卻沒那麼簡單，例如以下例子。</p><h3 name="67f5" id="67f5" class="graf graf--h3 graf-after--p">在 Book 裡定義 array data 儲存測試的書籍</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="363b" id="363b" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">Book</span> {<br />    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> data: [<span class="hljs-type">Book</span>] {<br />        [<br />            <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;野獸該死&quot;</span>, isFinish: <span class="hljs-literal">true</span>),<br />            <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;幻影女子&quot;</span>, isFinish: <span class="hljs-literal">false</span>),<br />            <span class="hljs-type">Book</span>(name: <span class="hljs-string">&quot;the world worst teacher&quot;</span>, isFinish: <span class="hljs-literal">false</span>)<br />        ]<br />    }<br />}</span></pre><p name="7691" id="7691" class="graf graf--p graf-after--pre">我們利用 List 顯示 array 裡的書籍。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="f062" id="f062" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(books) { book <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: )<br />            }<br />        }<br />            <br />    }<br />}</span></pre><figure name="ca85" id="ca85" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*pNbNqCE4_UpEHQMGWhEt1g.png" data-width="1344" data-height="1050" src="https://cdn-images-1.medium.com/max/800/1*pNbNqCE4_UpEHQMGWhEt1g.png"></figure><p name="bc2d" id="bc2d" class="graf graf--p graf-after--figure">此時 Toogle 的參數 isOn 要傳入 Binding&lt;Bool&gt;，因此我們不能直接傳入 book.isFinish。</p><figure name="0bd3" id="0bd3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mfFJPxC58yOICaHpi3kK8Q.png" data-width="1352" data-height="386" src="https://cdn-images-1.medium.com/max/800/1*mfFJPxC58yOICaHpi3kK8Q.png"></figure><p name="9f52" id="9f52" class="graf graf--p graf-after--figure">但是我們也不能在 book 前加上 $，因為 book 只是一個型別 Book 的常數，加上 $ 並不會變成 Binding。</p><figure name="227b" id="227b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*gHj8P0plTmR2vGbnhtzZ4A.png" data-width="1362" data-height="354" src="https://cdn-images-1.medium.com/max/800/1*gHj8P0plTmR2vGbnhtzZ4A.png"></figure><p name="b805" id="b805" class="graf graf--p graf-after--figure">透過 books 我們可以得到 Binding，比方 $books[0].isFinish 可以得到 Binding&lt;Bool&gt;，不過在此我們不能寫 [0]，因為它只會改到第一本書。我們應該要找出 book 是 array books 的第幾本書，在 [ ] 裡傳入對應的數字。</p><figure name="d69a" id="d69a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*WRNP19BU6JHDgxpQtClKUA.png" data-width="1234" data-height="344" src="https://cdn-images-1.medium.com/max/800/1*WRNP19BU6JHDgxpQtClKUA.png"></figure><p name="cb79" id="cb79" class="graf graf--p graf-after--figure">於是我們卡關了，因為在剛剛 List 的 { } 裡我們只能拿到 book，拿不到它在 array 裡是第幾個。</p><p name="6dc0" id="6dc0" class="graf graf--p graf-after--p">此問題有很多解法，以下我們一一說明:</p><ul class="postList"><li name="36ea" id="36ea" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">方法1: 在 List 或 ForEach 裡傳入 array 的 Binding</strong></li><li name="ba51" id="ba51" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法2: 自訂產生 Binding 的 function</strong></li><li name="d3b7" id="d3b7" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法3: 定義可在 [ ] 裡傳入成員的 subscript</strong></li><li name="e6b0" id="e6b0" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法4: 利用 enumerated 取得 array 成員的 index，然後再產生 Binding</strong></li><li name="48be" id="48be" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法5: 利用 Binding 的 init(get:set:) 產生 Binding</strong></li><li name="148b" id="148b" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">方法6: 方法6: 利用 array 的 index 當 id，然後再產生 Binding (比較不建議，比方動畫可能有問題)</strong></li></ul><h3 name="19a6" id="19a6" class="graf graf--h3 graf-after--li">方法1: 在 List 或 ForEach 裡傳入 array 的 Binding</h3><p name="78a0" id="78a0" class="graf graf--p graf-after--h3">List &amp; ForEach 等接受 array 的集合元件可以傳入 array 的 Binding，然後當我們讀取 array 成員時，加上 $ 即可得到 Binding 型別的成員。</p><ul class="postList"><li name="c8c7" id="c8c7" class="graf graf--li graf-after--p">List 搭配 Binding 參數</li></ul><figure name="b5b4" id="b5b4" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*JHdocRpv9PZCKyKmFLNIRw.png" data-width="2044" data-height="920" src="https://cdn-images-1.medium.com/max/800/1*JHdocRpv9PZCKyKmFLNIRw.png"></figure><ul class="postList"><li name="84cd" id="84cd" class="graf graf--li graf-after--figure">ForEach 搭配 Binding 參數</li></ul><figure name="4f9e" id="4f9e" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*WAIEo9ioW6ATShGNVyeKRA.png" data-width="2232" data-height="900" src="https://cdn-images-1.medium.com/max/800/1*WAIEo9ioW6ATShGNVyeKRA.png"></figure><p name="2537" id="2537" class="graf graf--p graf-after--figure">剛剛的例子我們可以改成以下寫法，在 List ( ) 裡傳入 $books，然後 在 closure { } 的參數宣告 $book，表示它是 Binding。之後在讀取 book 時，只要加上 $ 即可產生 Binding 型別。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="edc6" id="edc6" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(<span class="hljs-variable">$books</span>) { <span class="hljs-variable">$book</span> <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$book</span>.isFinish)<br />            }<br />        }<br />            <br />    }<br />}</span></pre><figure name="f5f8" id="f5f8" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*WHIr1C-_1fJzg1UNhJuk6w.png" data-width="1430" data-height="268" src="https://cdn-images-1.medium.com/max/800/1*WHIr1C-_1fJzg1UNhJuk6w.png"></figure><p name="6285" id="6285" class="graf graf--p graf-after--figure">Apple 在 WWDC21 What’s new in SwiftUI 也有關於此方法的範例，有興趣的朋友可參考以下程式碼。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ca8b" id="ca8b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">var</span> directions: [<span class="hljs-type">Direction</span>] <span class="hljs-operator">=</span> [<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;car&quot;</span>, color: .mint, text: <span class="hljs-string">&quot;Drive to SFO&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;airplane&quot;</span>, color: .blue, text: <span class="hljs-string">&quot;Fly to SJC&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;tram&quot;</span>, color: .purple, text: <span class="hljs-string">&quot;Ride to Cupertino&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;bicycle&quot;</span>, color: .orange, text: <span class="hljs-string">&quot;Bike to Apple Park&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;figure.walk&quot;</span>, color: .green, text: <span class="hljs-string">&quot;Walk to pond&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;lifepreserver&quot;</span>, color: .blue, text: <span class="hljs-string">&quot;Swim to the center&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;drop&quot;</span>, color: .indigo, text: <span class="hljs-string">&quot;Dive to secret airlock&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;tram.tunnel.fill&quot;</span>, color: .brown, text: <span class="hljs-string">&quot;Ride through underground tunnels&quot;</span>),<br />        <span class="hljs-type">Direction</span>(symbol: <span class="hljs-string">&quot;key&quot;</span>, color: .red, text: <span class="hljs-string">&quot;Enter door code:&quot;</span>),<br />    ]<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">NavigationView</span> {<br />            <span class="hljs-type">List</span>(<span class="hljs-variable">$directions</span>) { <span class="hljs-variable">$direction</span> <span class="hljs-keyword">in</span><br />                <span class="hljs-type">Label</span> {<br />                    <span class="hljs-type">TextField</span>(<span class="hljs-string">&quot;Instructions&quot;</span>, text: <span class="hljs-variable">$direction</span>.text)<br />                } icon: {<br />                    <span class="hljs-type">DirectionsIcon</span>(direction)<br />                }<br />            }<br />            .listStyle(.sidebar)<br />            .navigationTitle(<span class="hljs-string">&quot;Secret Hideout&quot;</span>)<br />        }<br />    }<br />}<br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Direction</span>: <span class="hljs-title class_">Identifiable</span> {<br />    <span class="hljs-keyword">var</span> id <span class="hljs-operator">=</span> <span class="hljs-type">UUID</span>()<br />    <span class="hljs-keyword">var</span> symbol: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">var</span> color: <span class="hljs-type">Color</span><br />    <span class="hljs-keyword">var</span> text: <span class="hljs-type">String</span><br />}<br /><span class="hljs-keyword">private</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">DirectionsIcon</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> direction: <span class="hljs-type">Direction</span><br />    <br />    <span class="hljs-keyword">init</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">direction</span>: <span class="hljs-type">Direction</span>) {<br />        <span class="hljs-keyword">self</span>.direction <span class="hljs-operator">=</span> direction<br />    }<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">Image</span>(systemName: direction.symbol)<br />            .resizable()<br />            .aspectRatio(contentMode: .fit)<br />            .foregroundStyle(.white)<br />            .padding(<span class="hljs-number">6</span>)<br />            .frame(width: <span class="hljs-number">33</span>, height: <span class="hljs-number">33</span>)<br />            .background(direction.color, in: <span class="hljs-type">RoundedRectangle</span>(cornerRadius: <span class="hljs-number">8</span>))<br />    }<br />}</span></pre><figure name="83f2" id="83f2" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*9WgMmcLeH8A-PhTztpzwnQ.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*9WgMmcLeH8A-PhTztpzwnQ.png"></figure><div name="c533" id="c533" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://developer.apple.com/videos/play/wwdc2021/10018/" data-href="https://developer.apple.com/videos/play/wwdc2021/10018/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/videos/play/wwdc2021/10018/"><strong class="markup--strong markup--mixtapeEmbed-strong">What&#39;s new in SwiftUI - WWDC 2021 - Videos - Apple Developer</strong><br><em class="markup--em markup--mixtapeEmbed-em">There&#39;s never been a better time to develop your apps with SwiftUI. Discover the latest updates to the UI framework …</em>developer.apple.com</a><a href="https://developer.apple.com/videos/play/wwdc2021/10018/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d19ac0a7b713377b64b30eaf33e1879a" data-thumbnail-img-id="0*Ra78XKjjH7A6TrBN" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*Ra78XKjjH7A6TrBN);"></a></div><h3 name="d86c" id="d86c" class="graf graf--h3 graf-after--mixtapeEmbed">方法2: 自訂產生 Binding 的 function</h3><p name="82c9" id="82c9" class="graf graf--p graf-after--h3">模仿 Apple 官方範例 Passing Data with Bindings 的寫法。</p><div name="3beb" id="3beb" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/tutorials/app-dev-training/passing-data-with-bindings" data-href="https://developer.apple.com/tutorials/app-dev-training/passing-data-with-bindings" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/tutorials/app-dev-training/passing-data-with-bindings"><strong class="markup--strong markup--mixtapeEmbed-strong">Passing data with bindings | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">In the previous tutorial, you used bindings to share data between the edit view and individual UI controls within that…</em>developer.apple.com</a><a href="https://developer.apple.com/tutorials/app-dev-training/passing-data-with-bindings" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d15ce97525a2dba7c3259299f5e77494" data-thumbnail-img-id="0*ACCx3gmfyO8EC8FA" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*ACCx3gmfyO8EC8FA);"></a></div><p name="af81" id="af81" class="graf graf--p graf-after--mixtapeEmbed">在 BookView 裡定義產生 Binding 的 function binding(for:)。 利用 array 的 firstIndex(where:) 找出 book 在 array 裡的位置，然後再利用 $books 產生 Binding。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="8995" id="8995" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">private</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">binding</span>(<span class="hljs-params">for</span> <span class="hljs-params">book</span>: <span class="hljs-type">Book</span>) -&gt; <span class="hljs-type">Binding</span>&lt;<span class="hljs-type">Book</span>&gt; {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> bookIndex <span class="hljs-operator">=</span> books.firstIndex(where: { <span class="hljs-variable">$0</span>.id <span class="hljs-operator">==</span> book.id }) <span class="hljs-keyword">else</span> {<br />        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;Can&#x27;t find book in array&quot;</span>)<br />    }<br />    <span class="hljs-keyword">return</span> <span class="hljs-variable">$books</span>[bookIndex]<br />}</span></pre><p name="cc38" id="cc38" class="graf graf--p graf-after--pre">在 Toggle 的 isOn 參數傳入 binding(for: book).isFinish。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="0f26" id="0f26" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />    <span class="hljs-type">List</span>(books) { book <span class="hljs-keyword">in</span><br />        <span class="hljs-type">Image</span>(book.name)<br />            .resizable()<br />            .scaledToFill()<br />            .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />            .clipShape(.circle)<br />        <span class="hljs-type">VStack</span>(alignment: .leading) {<br />            <span class="hljs-type">Text</span>(book.name)<br />            <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: binding(for: book).isFinish)<br />        }<br />    }<br />}</span></pre><figure name="1ce2" id="1ce2" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*NXU2zxEeLjSXf3p-T1FmPg.png" data-width="1380" data-height="248" src="https://cdn-images-1.medium.com/max/800/1*NXU2zxEeLjSXf3p-T1FmPg.png"></figure><p name="155a" id="155a" class="graf graf--p graf-after--figure">結果</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="a962" id="a962" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.052%;"><img class="graf-image" data-image-id="1*fqqC1A1Y_Sxs6ejFT_Xw2Q.png" data-width="490" data-height="1018" src="https://cdn-images-1.medium.com/max/600/1*fqqC1A1Y_Sxs6ejFT_Xw2Q.png"></figure><figure name="fcc8" id="fcc8" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.948%;"><img class="graf-image" data-image-id="1*sPqsoR-GTK-Xp6rQtp0Rtg.png" data-width="486" data-height="1012" src="https://cdn-images-1.medium.com/max/600/1*sPqsoR-GTK-Xp6rQtp0Rtg.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="5df1" id="5df1" class="graf graf--p graf-after--figure">ps: 如果不想另外定義產生 Binding 的 function，也可以採用以下寫法。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5819" id="5819" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(books) { book <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                    .resizable()<br />                    .scaledToFill()<br />                    .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$books</span>[books.firstIndex(where: { <span class="hljs-variable">$0</span>.id <span class="hljs-operator">==</span> book.id })<span class="hljs-operator">!</span>].isFinish)<br />            }<br />        }<br />    }<br />}</span></pre><h3 name="9bb2" id="9bb2" class="graf graf--h3 graf-after--pre">方法3: 定義可在 [ ] 裡傳入成員的 <strong class="markup--strong markup--h3-strong">subscript</strong></h3><p name="b3c2" id="b3c2" class="graf graf--p graf-after--h3">參考課程 CS193p Lecture 12: Bindings Sheet Navigation EditMode 的寫法，我們定義以下的 extension，之後讀取 array 時可在 [ ] 裡傳入成員。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="bf88" id="bf88" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">Collection</span> <span class="hljs-title class_">where</span> <span class="hljs-title class_">Element</span>: <span class="hljs-title class_">Identifiable</span> {<br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">index</span>(<span class="hljs-params">matching</span> <span class="hljs-params">element</span>: <span class="hljs-type">Element</span>) -&gt; <span class="hljs-keyword">Self</span>.<span class="hljs-type">Index</span>? {<br />        firstIndex(where: { <span class="hljs-variable">$0</span>.id <span class="hljs-operator">==</span> element.id })<br />    }<br />}<br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">RangeReplaceableCollection</span> <span class="hljs-title class_">where</span> <span class="hljs-title class_">Element</span>: <span class="hljs-title class_">Identifiable</span> {<br />   <span class="hljs-keyword">subscript</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">element</span>: <span class="hljs-type">Element</span>) -&gt; <span class="hljs-type">Element</span> {<br />        <span class="hljs-keyword">get</span> {<br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> index <span class="hljs-operator">=</span> index(matching: element) {<br />                <span class="hljs-keyword">return</span> <span class="hljs-keyword">self</span>[index]<br />            } <span class="hljs-keyword">else</span> {<br />                <span class="hljs-keyword">return</span> element<br />            }<br />        }<br />        <span class="hljs-keyword">set</span> {<br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> index <span class="hljs-operator">=</span> index(matching: element) {<br />                replaceSubrange(index<span class="hljs-operator">...</span>index, with: [newValue])<br />            }<br />        }<br />    }<br />}</span></pre><p name="9147" id="9147" class="graf graf--p graf-after--pre">現在我們讀取 array 時可在 [ ] 裡傳入成員，因此可用 <code class="markup--code markup--p-code">$books[book].isFinish</code> 的寫法取得 Binding。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ecd2" id="ecd2" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <br />        <span class="hljs-type">List</span>(books) { book <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$books</span>[book].isFinish)<br />            }<br />        }<br />    }<br />}</span></pre><h3 name="56e9" id="56e9" class="graf graf--h3 graf-after--pre">方法4: 利用 enumerated 取得 array 成員的 index，然後再產生 Binding</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="f35e" id="f35e" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(<span class="hljs-type">Array</span>(books.enumerated()), id: \.element.id) { index, book <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$books</span>[index].isFinish)<br />            }<br />        }<br />    }<br />}</span></pre><h3 name="1c43" id="1c43" class="graf graf--h3 graf-after--pre">方法5: 利用 Binding 的 init(get:set:) 產生 Binding</h3><p name="9ef5" id="9ef5" class="graf graf--p graf-after--h3">不過實驗測試時，發現以下寫法效能比較差，開關切換時會 lag。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ab29" id="ab29" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(books) { book <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(book.name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(book.name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-type">Binding</span>(get: {<br />                    book.isFinish<br />                }, set: {<br />                    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> bookIndex <span class="hljs-operator">=</span> books.firstIndex(where: { <span class="hljs-variable">$0</span>.id <span class="hljs-operator">==</span> book.id }) <span class="hljs-keyword">else</span> {<br />                        <span class="hljs-built_in">fatalError</span>(<span class="hljs-string">&quot;Can&#x27;t find book in array&quot;</span>)<br />                    }<br />                    books[bookIndex].isFinish <span class="hljs-operator">=</span> <span class="hljs-variable">$0</span><br />                }))<br />            }<br />        }<br />    }<br />}</span></pre><div name="5945" id="5945" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E7%9A%84-custom-binding-4d98ea84c551" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E7%9A%84-custom-binding-4d98ea84c551" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E7%9A%84-custom-binding-4d98ea84c551"><strong class="markup--strong markup--mixtapeEmbed-strong">SwiftUI 的 custom binding</strong><br><em class="markup--em markup--mixtapeEmbed-em">開發 SwiftUI App 時，很多 UI 元件都搭配了 Binding 型別的參數，因此具有元件修改時自動更新資料，資料修改時自動更新元件的神奇效果，比方以下跟變數 isPlay 綁在一起的 Toggle 元件。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E7%9A%84-custom-binding-4d98ea84c551" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c31236c7018a67dfc54193eca8a3048d" data-thumbnail-img-id="1*Fo5zRXEY3kXCUAcjS07k7g.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*Fo5zRXEY3kXCUAcjS07k7g.jpeg);"></a></div><ul class="postList"><li name="379a" id="379a" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">方法6: 利用 array 的 index 當 id，然後再產生 Binding (比較不建議，比方動畫可能有問題)</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="05b5" id="05b5" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">BookView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> books <span class="hljs-operator">=</span> <span class="hljs-type">Book</span>.data<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">List</span>(books.indices, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span><br />            <span class="hljs-type">Image</span>(books[index].name)<br />                .resizable()<br />                .scaledToFill()<br />                .frame(width: <span class="hljs-number">100</span>, height: <span class="hljs-number">100</span>)<br />                .clipShape(.circle)<br />            <span class="hljs-type">VStack</span>(alignment: .leading) {<br />                <span class="hljs-type">Text</span>(books[index].name)<br />                <span class="hljs-type">Toggle</span>(<span class="hljs-string">&quot;已讀&quot;</span>, isOn: <span class="hljs-variable">$books</span>[index].isFinish)<br />            }<br />        }<br />    }<br />}</span></pre><p name="fcdc" id="fcdc" class="graf graf--p graf-after--pre">ps: 不建議的原因可參考以下連結。</p><div name="1271" id="1271" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-foreach-%E6%90%AD%E9%85%8D-array-%E6%99%82-%E5%A6%82%E4%BD%95%E5%8F%96%E5%BE%97%E6%88%90%E5%93%A1%E7%9A%84%E4%BD%8D%E7%BD%AE-index-b2c64c3bbca3" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-foreach-%E6%90%AD%E9%85%8D-array-%E6%99%82-%E5%A6%82%E4%BD%95%E5%8F%96%E5%BE%97%E6%88%90%E5%93%A1%E7%9A%84%E4%BD%8D%E7%BD%AE-index-b2c64c3bbca3" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-foreach-%E6%90%AD%E9%85%8D-array-%E6%99%82-%E5%A6%82%E4%BD%95%E5%8F%96%E5%BE%97%E6%88%90%E5%93%A1%E7%9A%84%E4%BD%8D%E7%BD%AE-index-b2c64c3bbca3"><strong class="markup--strong markup--mixtapeEmbed-strong">SwiftUI ForEach 搭配 array 時，如何取得成員的位置(index)</strong><br><em class="markup--em markup--mixtapeEmbed-em">使用 SwiftUI 的 ForEach 可以快速顯示 array 的內容，例如以下顯示歌單的例子。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-foreach-%E6%90%AD%E9%85%8D-array-%E6%99%82-%E5%A6%82%E4%BD%95%E5%8F%96%E5%BE%97%E6%88%90%E5%93%A1%E7%9A%84%E4%BD%8D%E7%BD%AE-index-b2c64c3bbca3" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="224023201e4764e52f86ebb8a1837366" data-thumbnail-img-id="1*13cNMdWq-i5C8_sfUoROhA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*13cNMdWq-i5C8_sfUoROhA.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/35e11ba69349"><time class="dt-published" datetime="2020-12-22T06:42:17.143Z">December 22, 2020</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%9C%A8-swiftui-%E5%A6%82%E4%BD%95%E5%B0%87-array-%E7%9A%84%E6%88%90%E5%93%A1%E8%AE%8A-binding-35e11ba69349" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>