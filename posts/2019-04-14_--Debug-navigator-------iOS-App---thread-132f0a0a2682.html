<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>從 Debug navigator 和程式看到 iOS App 的 thread</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">從 Debug navigator 和程式看到 iOS App 的 thread</h1>
</header>
<section data-field="subtitle" class="p-summary">
在學習 iOS App 開發時，thread 是初學者比較容易覺得陌生難懂的傢伙。我們可以將 thread 想成執行程式的人，當 iOS App 執行時，一開始就會產生多個 thread，每個 thread 做不同的事情，而 main thread 是其中最重要的…
</section>
<section data-field="body" class="e-content">
<section name="9fdb" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="bc77" id="bc77" class="graf graf--h3 graf--leading graf--title">從 Debug navigator 和程式看到 iOS App 的 thread</h3><p name="7395" id="7395" class="graf graf--p graf-after--h3">在學習 iOS App 開發時，thread 是初學者比較容易覺得陌生難懂的傢伙。我們可以將 thread 想成執行程式的人，當 iOS App 執行時，一開始就會產生多個 thread，每個 thread 做不同的事情，而 main thread 是其中最重要的 thread，負責比較重要，要優先處理的事，比方 UI 相關操作就是它負責的。(其實它的名字 main 正說明了它是主要的 thread)</p><p name="1006" id="1006" class="graf graf--p graf-after--p">thread 難懂的其中一個原因是我們看不到它，不過只要你願意鼓起勇氣設定中斷點讓 App 中斷，即可在 Debug navigator 看到滿滿的 thread (其實 App 閃退時也可以看到 thread，因為閃退也是中斷的一種) ~</p><p name="703b" id="703b" class="graf graf--p graf-after--p">接下來就讓我們親手實驗看看吧。</p><blockquote name="b9ec" id="b9ec" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">1 在 function viewDidLoad 裡加入下載網路圖片的程式，然後在第 17 行設定中斷點。</strong></blockquote><figure name="168d" id="168d" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*MPmfZ4zleoYYjM_ZWV_Rbw.png" data-width="1932" data-height="676" src="https://cdn-images-1.medium.com/max/800/1*MPmfZ4zleoYYjM_ZWV_Rbw.png"></figure><blockquote name="4a36" id="4a36" class="graf graf--blockquote graf-after--figure"><strong class="markup--strong markup--blockquote-strong">2 執行 App，當 App 中斷在第 17 行時，我們可在左邊看到滿滿的 thread。</strong></blockquote><figure name="44ed" id="44ed" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*dJF_QFdHhIvTLgbjP69O1Q.png" data-width="2770" data-height="1166" src="https://cdn-images-1.medium.com/max/800/1*dJF_QFdHhIvTLgbjP69O1Q.png"></figure><p name="531a" id="531a" class="graf graf--p graf-after--figure">左邊 Debug navigator 裡滿滿的 9 個 thread。</p><figure name="6d9d" id="6d9d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*eKRLLAI9kMIA0en8pbjUmQ.png" data-width="774" data-height="1104" src="https://cdn-images-1.medium.com/max/800/1*eKRLLAI9kMIA0en8pbjUmQ.png"></figure><p name="e5db" id="e5db" class="graf graf--p graf-after--figure">其中名列第一的正是最重要的 main thread。</p><figure name="70ab" id="70ab" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SmzYCjATtjr-Xy9oN3gZAQ.png" data-width="920" data-height="522" src="https://cdn-images-1.medium.com/max/800/1*SmzYCjATtjr-Xy9oN3gZAQ.png"></figure><p name="f1a9" id="f1a9" class="graf graf--p graf-after--figure">當程式中斷在第 17 行時，資料已經抓完，正在執行 function dataTask 的 completionHandler { } 的程式碼。</p><p name="27b3" id="27b3" class="graf graf--p graf-after--p">利用 URLSession 產生的 task 會在背景抓資料，不會卡住 UI，因此資料抓完時，也會在背景執行 completionHandler { } 的程式碼。此時左邊 Debug navigator 標示著 Thread 7 下的 viewDidLoad，因此 completionHandler 的程式果然是由背景 thread 執行，不是原本的 main thread。</p><figure name="25bf" id="25bf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*eKRLLAI9kMIA0en8pbjUmQ.png" data-width="774" data-height="1104" src="https://cdn-images-1.medium.com/max/800/1*eKRLLAI9kMIA0en8pbjUmQ.png"></figure><p name="ea3f" id="ea3f" class="graf graf--p graf-after--figure">除了從 Debug navigator 觀看 thread，我們也可以從程式查詢 thread 的相關資訊。</p><blockquote name="fa3d" id="fa3d" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">1 利用 Thread.isMainThread 判斷目前執行程式的是否為 main thread</strong></blockquote><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="4a78" id="4a78" class="graf graf--pre graf-after--blockquote graf--preV2"><span class="pre--content"><span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response, error <span class="hljs-keyword">in</span><br />   <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />      <span class="hljs-built_in">print</span>(data)<br />   }<br />   <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;目前執行程式的是 main thread 嗎? &quot;</span>, <span class="hljs-type">Thread</span>.isMainThread)<br />}.resume()</span></pre><p name="e9f5" id="e9f5" class="graf graf--p graf-after--pre">結果</p><pre name="facf" id="facf" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">目前執行程式的是 main thread 嗎?  false</strong></pre><div name="5c33" id="5c33" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/foundation/thread/1408455-ismainthread" data-href="https://developer.apple.com/documentation/foundation/thread/1408455-ismainthread" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/thread/1408455-ismainthread"><strong class="markup--strong markup--mixtapeEmbed-strong">isMainThread - Thread | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/thread/1408455-ismainthread" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="4e13dd13a537dd001df190e7317697b3"></a></div><blockquote name="a7a0" id="a7a0" class="graf graf--blockquote graf-after--mixtapeEmbed"><strong class="markup--strong markup--blockquote-strong">2 利用 Thread.current 取得目前執行程式的 Thread 物件。</strong></blockquote><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="933f" id="933f" class="graf graf--pre graf-after--blockquote graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />   <span class="hljs-keyword">super</span>.viewDidLoad()<br />   <span class="hljs-keyword">let</span> urlStr <span class="hljs-operator">=</span> <span class="hljs-string">&quot;https://wakelandtheatre.files.wordpress.com/2013/11/final-poster.jpg&quot;</span><br />   <span class="hljs-built_in">print</span>(<span class="hljs-type">Thread</span>.current)<br />   <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">URL</span>(string: urlStr) {<br />      <span class="hljs-type">URLSession</span>.shared.dataTask(with: url) { data, response, error <span class="hljs-keyword">in</span><br />         <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />            <span class="hljs-built_in">print</span>(data)<br />         }<br />         <span class="hljs-built_in">print</span>(<span class="hljs-type">Thread</span>.current)<br />      }.resume()<br />   }<br />}</span></pre><p name="3c05" id="3c05" class="graf graf--p graf-after--pre">結果</p><pre name="3b5c" id="3b5c" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">&lt;NSThread: 0x6000025c28c0&gt;{number = 1, name = main}</strong></pre><pre name="5b63" id="5b63" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">541715 bytes</strong></pre><pre name="71cb" id="71cb" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">&lt;NSThread: 0x600002594e80&gt;{number = 3, name = (null)}</strong></pre><div name="4b9b" id="4b9b" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/foundation/thread/1410679-current" data-href="https://developer.apple.com/documentation/foundation/thread/1410679-current" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/thread/1410679-current"><strong class="markup--strong markup--mixtapeEmbed-strong">current | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns the thread object representing the current thread of execution.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/thread/1410679-current" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3cde0fe19ae03154dae1b114d9cd8281" data-thumbnail-img-id="0*YeQ2zH-coUm7JFT2" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*YeQ2zH-coUm7JFT2);"></a></div><p name="0c5a" id="0c5a" class="graf graf--p graf-after--mixtapeEmbed graf--trailing">不出我們所料，viewDidLoad 一開始的程式由 main thread 執行，但 task 抓完資料後則由別的 thread 執行 completionHandler { } 的程式。</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/132f0a0a2682"><time class="dt-published" datetime="2019-04-14T15:08:24.289Z">April 14, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%BE%9E-debug-navigator-%E5%92%8C%E7%A8%8B%E5%BC%8F%E7%9C%8B%E5%88%B0-ios-app-%E7%9A%84-thread-132f0a0a2682" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>