<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>儲存 UIPageViewController 曾經建立的 view controller</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">儲存 UIPageViewController 曾經建立的 view controller</h1>
</header>
<section data-field="subtitle" class="p-summary">
為了效能跟記憶體的考量，UIPageViewController 預設只會保留目前頁面，上一頁 &amp; 下一頁的 view controller。以 Apple 的 Page-Based App template 為例，它有 12 個月份的頁面，它最多同時間保留三個月份的 view…
</section>
<section data-field="body" class="e-content">
<section name="bf1f" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5713" id="5713" class="graf graf--h3 graf--leading graf--title">儲存 UIPageViewController 曾經建立的 view controller</h3><p name="75e3" id="75e3" class="graf graf--p graf-after--h3">為了效能跟記憶體的考量，UIPageViewController 預設只會保留目前頁面，上一頁 &amp; 下一頁的 view controller。以 Apple 的 Page-Based App template 為例，它有 12 個月份的頁面，它最多同時間保留三個月份的 view controller 頁面。</p><p name="bdbc" id="bdbc" class="graf graf--p graf-after--p">比方我們在 1 月頁面輸入許哲珮的歌詞<code class="markup--code markup--p-code">我瘋言 我瘋語</code>，然後切換到 2 月，此時 1 月的 view controller 還是會保留，因為它是 2 月的上一頁，因此我們切換回 1 月時還是能看到<code class="markup--code markup--p-code">我瘋言 我瘋語</code>。</p><figure name="5b74" id="5b74" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*i4II6ow6QWP6wKVGztdVTA.png" data-width="1256" data-height="860" src="https://cdn-images-1.medium.com/max/800/1*i4II6ow6QWP6wKVGztdVTA.png"></figure><p name="7b34" id="7b34" class="graf graf--p graf-after--figure">然而若我們在 1 月頁面輸入<code class="markup--code markup--p-code">我瘋言 我瘋語</code>，然後往左滑到 3 月，此時只會保留 2, 3 , 4 月的 view controller，1 月的 view controller 已經不在這個世界上。因此我們切換回 1 月時將重新產生 1 月的 view controller，它的 text field 將一片空白。</p><figure name="37d0" id="37d0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*kuo6tXjbUfuISraDH8MRnw.png" data-width="1258" data-height="862" src="https://cdn-images-1.medium.com/max/800/1*kuo6tXjbUfuISraDH8MRnw.png"></figure><p name="1c2b" id="1c2b" class="graf graf--p graf-after--figure">有時為了讓使用者有更好的體驗，我們會希望保留使用者之前在分頁瀏覽的狀態，比方滑回剛剛的 1 月頁面時看到之前輸入的內容。</p><p name="71fa" id="71fa" class="graf graf--p graf-after--p">此功能有以下兩種解法:</p><ul class="postList"><li name="06f2" id="06f2" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">解法 1: 儲存每個頁面顯示的內容</strong></li></ul><p name="8dea" id="8dea" class="graf graf--p graf-after--li">儲存每個頁面顯示的內容，讓 view controller 重新產生時顯示之前的內容。</p><ul class="postList"><li name="b00c" id="b00c" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">解法 2: 儲存 UIPageViewController 曾經建立的 view controller</strong></li></ul><p name="fc03" id="fc03" class="graf graf--p graf-after--li">比方使用者曾經瀏覽 1 月份 view controller 的頁面，因此 1 月的 view controller 將被存起來，下次要顯示 1 月時，直接回傳當初的 view controller，而不是重新產生 view controller。</p><p name="85ca" id="85ca" class="graf graf--p graf-after--p">接下來我們將示範解法 2，說明如何儲存 UIPageViewController 曾經建立的 view controller。</p><h3 name="2e12" id="2e12" class="graf graf--h3 graf-after--p">使用 Xcode 的 Page-Based App template 建立專案</h3><p name="6451" id="6451" class="graf graf--p graf-after--h3">新版的 Xcode 沒有 Page-Based App template，請參考以下連結取得 Page-Based App template。</p><div name="8cdb" id="8cdb" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/xcode-%E7%9A%84-page-based-app-template-69f20a9937f7" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/xcode-%E7%9A%84-page-based-app-template-69f20a9937f7" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/xcode-%E7%9A%84-page-based-app-template-69f20a9937f7"><strong class="markup--strong markup--mixtapeEmbed-strong">Xcode 的 Page-Based App template</strong><br><em class="markup--em markup--mixtapeEmbed-em">UIKit 的 UIPageViewController 可以方便地做出 App 的分頁效果，因此舊版的 Xcode 在建立專案時提供了 Page-Based App template 給我們參考。不過在新版的 Xcode…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/xcode-%E7%9A%84-page-based-app-template-69f20a9937f7" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="8691fa0ffd2d02981f6db29d22f6d9d5" data-thumbnail-img-id="1*_eHjfUQmNBXYZCsxJvAKKg.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*_eHjfUQmNBXYZCsxJvAKKg.png);"></a></div><h3 name="0fe1" id="0fe1" class="graf graf--h3 graf-after--mixtapeEmbed">將捲動效果改成 scroll</h3><p name="0a05" id="0a05" class="graf graf--p graf-after--h3">修改 RootViewController.swift，將 UIPageViewController 的 transitionStyle 設為 scroll。</p><pre name="0579" id="0579" class="graf graf--pre graf-after--p">override func viewDidLoad() {<br>        super.viewDidLoad()<br>       <br>        self.pageViewController = UIPageViewController(transitionStyle: .<strong class="markup--strong markup--pre-strong">scroll</strong>, navigationOrientation: .horizontal, options: nil)</pre><h3 name="0dd4" id="0dd4" class="graf graf--h3 graf-after--pre">在 Data View Controller 加入 text field</h3><figure name="5303" id="5303" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*uULEmEVJS0CW1sjEiEPrcg.png" data-width="1578" data-height="1208" src="https://cdn-images-1.medium.com/max/800/1*uULEmEVJS0CW1sjEiEPrcg.png"></figure><h3 name="2995" id="2995" class="graf graf--h3 graf-after--figure">在 ModelController 宣告 property <strong class="markup--strong markup--h3-strong">pageViewControllerDic</strong></h3><p name="436e" id="436e" class="graf graf--p graf-after--h3">pageViewControllerDic 將儲存 UIPageViewController 曾經建立的 view controller，以頁面的 index 當 key。</p><pre name="602a" id="602a" class="graf graf--pre graf-after--p">class ModelController: NSObject, UIPageViewControllerDataSource {</pre><pre name="3064" id="3064" class="graf graf--pre graf-after--pre">    var pageData: [String] = []<br><strong class="markup--strong markup--pre-strong">    var pageViewControllerDic = [Int: UIViewController]()</strong></pre><h3 name="944f" id="944f" class="graf graf--h3 graf-after--pre">修改 ModelController 的 viewControllerAtIndex(_:storyboard:)</h3><p name="a618" id="a618" class="graf graf--p graf-after--h3">從 pageViewControllerDic 讀取曾經建立的 view controller，讀不到時才重新產生 view controller。</p><pre name="ebde" id="ebde" class="graf graf--pre graf-after--p">func viewControllerAtIndex(_ index: Int, storyboard: UIStoryboard) -&gt; DataViewController? {<br>        // Return the data view controller for the given index.<br>        if (pageData.count == 0) || (index &gt;= pageData.count) {<br>            return nil<br>        }<br>        <br>        <strong class="markup--strong markup--pre-strong">let dataViewController = (pageViewControllerDic[index] ?? storyboard.instantiateViewController(withIdentifier: &quot;DataViewController&quot;)) as! DataViewController<br>        pageViewControllerDic[index] = dataViewController<br>        dataViewController.dataObject = pageData[index]</strong><br>        return dataViewController<br>}</pre><h3 name="75be" id="75be" class="graf graf--h3 graf-after--pre">執行 App</h3><p name="baaf" id="baaf" class="graf graf--p graf-after--h3">Cool，現在我們在 1 月輸入的文字內容不再因頁面切換而消失了，因為我們已將它的 view controller 好好地存起來。</p><figure name="7f98" id="7f98" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*-gCCP-v6E8-OIk8bADqpZw.png" data-width="1262" data-height="860" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*-gCCP-v6E8-OIk8bADqpZw.png"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/960f86f72409"><time class="dt-published" datetime="2022-01-03T08:51:36.412Z">January 3, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%84%B2%E5%AD%98-uipageviewcontroller-%E6%9B%BE%E7%B6%93%E5%BB%BA%E7%AB%8B%E7%9A%84-view-controller-960f86f72409" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>