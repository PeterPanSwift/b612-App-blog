<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Optional Chaining 程式範例 — Apple’s The Swift Programming Language</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Optional Chaining 程式範例 — Apple’s The Swift Programming Language</h1>
</header>
<section data-field="subtitle" class="p-summary">
Optional Chaining as an Alternative to Forced Unwrapping
</section>
<section data-field="body" class="e-content">
<section name="72bc" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="e058" id="e058" class="graf graf--h3 graf--leading graf--title">Optional Chaining 程式範例 — Apple’s The Swift Programming Language</h3><div name="ecc6" id="ecc6" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html" data-href="https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html"><strong class="markup--strong markup--mixtapeEmbed-strong">Optional Chaining - The Swift Programming Language (Swift 4.2)</strong><br><em class="markup--em markup--mixtapeEmbed-em">Optional chaining is a process for querying and calling properties, methods, and subscripts on an optional that might…</em>docs.swift.org</a><a href="https://docs.swift.org/swift-book/LanguageGuide/OptionalChaining.html" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="51b375fd5dd01b4094f7f2d12df967bd"></a></div><blockquote name="9c07" id="9c07" class="graf graf--blockquote graf-after--mixtapeEmbed"><strong class="markup--strong markup--blockquote-strong">Optional Chaining as an Alternative to Forced Unwrapping</strong></blockquote><p name="75d1" id="75d1" class="graf graf--p graf-after--blockquote">利用 <code class="markup--code markup--p-code">?.</code> 讀取 property，呼叫 method 或 subscript，得到的資料為 optional。</p><p name="ed19" id="ed19" class="graf graf--p graf-after--p">好處: 比較安全，當 optional 為 nil 時會回傳 nil，不會像加 ! 的 Forced Unwrapping 造成閃退。</p><pre name="fa8d" id="fa8d" class="graf graf--pre graf-after--p">class Person {</pre><pre name="ddc5" id="ddc5" class="graf graf--pre graf-after--pre">   var residence: Residence?</pre><pre name="5378" id="5378" class="graf graf--pre graf-after--pre">}</pre><pre name="e33e" id="e33e" class="graf graf--pre graf-after--pre">class Residence {</pre><pre name="8e75" id="8e75" class="graf graf--pre graf-after--pre">   var numberOfRooms = 1</pre><pre name="a6a8" id="a6a8" class="graf graf--pre graf-after--pre">}</pre><pre name="9c4c" id="9c4c" class="graf graf--pre graf-after--pre">let john = Person()</pre><pre name="e5d1" id="e5d1" class="graf graf--pre graf-after--pre">if let roomCount = john.residence?.numberOfRooms {</pre><pre name="f129" id="f129" class="graf graf--pre graf-after--pre">   print(&quot;John&#39;s residence has \(roomCount) room(s).&quot;)</pre><pre name="b6de" id="b6de" class="graf graf--pre graf-after--pre">} else {</pre><pre name="10d8" id="10d8" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the number of rooms.&quot;)</pre><pre name="6789" id="6789" class="graf graf--pre graf-after--pre">}</pre><pre name="0ce8" id="0ce8" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;Unable to retrieve the number of rooms.&quot;</em></pre><pre name="a678" id="a678" class="graf graf--pre graf-after--pre">john.residence = Residence()</pre><pre name="584b" id="584b" class="graf graf--pre graf-after--pre">if let roomCount = john.residence?.numberOfRooms {</pre><pre name="d872" id="d872" class="graf graf--pre graf-after--pre">print(&quot;John&#39;s residence has \(roomCount) room(s).&quot;)</pre><pre name="998e" id="998e" class="graf graf--pre graf-after--pre">} else {</pre><pre name="0829" id="0829" class="graf graf--pre graf-after--pre">print(&quot;Unable to retrieve the number of rooms.&quot;)</pre><pre name="f4c1" id="f4c1" class="graf graf--pre graf-after--pre">}</pre><pre name="71a6" id="71a6" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;John&#39;s residence has 1 room(s).&quot;</em></pre><blockquote name="b5a0" id="b5a0" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Defining Model Classes for Optional Chaining</strong></blockquote><pre name="daa6" id="daa6" class="graf graf--pre graf-after--blockquote">class Address {</pre><pre name="34c3" id="34c3" class="graf graf--pre graf-after--pre">   var buildingName: String?</pre><pre name="4b1b" id="4b1b" class="graf graf--pre graf-after--pre">   var buildingNumber: String?</pre><pre name="8152" id="8152" class="graf graf--pre graf-after--pre">   var street: String?</pre><pre name="f6f9" id="f6f9" class="graf graf--pre graf-after--pre">   func buildingIdentifier() -&gt; String? {</pre><pre name="6dcb" id="6dcb" class="graf graf--pre graf-after--pre">      if let buildingNumber = buildingNumber, let street = street {</pre><pre name="8eb5" id="8eb5" class="graf graf--pre graf-after--pre">         return &quot;\(buildingNumber) \(street)&quot;</pre><pre name="4555" id="4555" class="graf graf--pre graf-after--pre">      } else if buildingName != nil {</pre><pre name="9ac8" id="9ac8" class="graf graf--pre graf-after--pre">         return buildingName</pre><pre name="4825" id="4825" class="graf graf--pre graf-after--pre">      } else {</pre><pre name="cdc7" id="cdc7" class="graf graf--pre graf-after--pre">         return nil</pre><pre name="dac6" id="dac6" class="graf graf--pre graf-after--pre">      }</pre><pre name="42ba" id="42ba" class="graf graf--pre graf-after--pre">   }</pre><pre name="a84e" id="a84e" class="graf graf--pre graf-after--pre">}</pre><pre name="8636" id="8636" class="graf graf--pre graf-after--pre">class Room {</pre><pre name="7799" id="7799" class="graf graf--pre graf-after--pre">   let name: String</pre><pre name="b556" id="b556" class="graf graf--pre graf-after--pre">   init(name: String) { self.name = name }</pre><pre name="e0d0" id="e0d0" class="graf graf--pre graf-after--pre">}</pre><pre name="8e10" id="8e10" class="graf graf--pre graf-after--pre">class Residence {</pre><pre name="afc6" id="afc6" class="graf graf--pre graf-after--pre">   var rooms = [Room]()</pre><pre name="019d" id="019d" class="graf graf--pre graf-after--pre">   var numberOfRooms: Int {</pre><pre name="dce0" id="dce0" class="graf graf--pre graf-after--pre">      return rooms.count</pre><pre name="2fc7" id="2fc7" class="graf graf--pre graf-after--pre">   }</pre><pre name="b03c" id="b03c" class="graf graf--pre graf-after--pre">   subscript(i: Int) -&gt; Room {</pre><pre name="e1df" id="e1df" class="graf graf--pre graf-after--pre">      get {</pre><pre name="1912" id="1912" class="graf graf--pre graf-after--pre">         return rooms[i]</pre><pre name="438a" id="438a" class="graf graf--pre graf-after--pre">      }</pre><pre name="bda1" id="bda1" class="graf graf--pre graf-after--pre">      set {</pre><pre name="82b1" id="82b1" class="graf graf--pre graf-after--pre">         rooms[i] = newValue</pre><pre name="2639" id="2639" class="graf graf--pre graf-after--pre">      }</pre><pre name="07d1" id="07d1" class="graf graf--pre graf-after--pre">   }</pre><pre name="082d" id="082d" class="graf graf--pre graf-after--pre">   func printNumberOfRooms() {</pre><pre name="5291" id="5291" class="graf graf--pre graf-after--pre">      print(&quot;The number of rooms is \(numberOfRooms)&quot;)</pre><pre name="fb43" id="fb43" class="graf graf--pre graf-after--pre">   }</pre><pre name="5886" id="5886" class="graf graf--pre graf-after--pre">   var address: Address?</pre><pre name="7c34" id="7c34" class="graf graf--pre graf-after--pre">}</pre><pre name="0d7f" id="0d7f" class="graf graf--pre graf-after--pre">class Person {</pre><pre name="7712" id="7712" class="graf graf--pre graf-after--pre">   var residence: Residence?</pre><pre name="4fbd" id="4fbd" class="graf graf--pre graf-after--pre">}</pre><blockquote name="76fd" id="76fd" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Accessing Properties Through Optional Chaining</strong></blockquote><pre name="ca3e" id="ca3e" class="graf graf--pre graf-after--blockquote">let john = Person()</pre><pre name="27dc" id="27dc" class="graf graf--pre graf-after--pre">if let roomCount = john.residence?.numberOfRooms {</pre><pre name="ce65" id="ce65" class="graf graf--pre graf-after--pre">   print(&quot;John&#39;s residence has \(roomCount) room(s).&quot;)</pre><pre name="42f0" id="42f0" class="graf graf--pre graf-after--pre">} else {</pre><pre name="11f2" id="11f2" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the number of rooms.&quot;)</pre><pre name="4f44" id="4f44" class="graf graf--pre graf-after--pre">}</pre><pre name="9ca4" id="9ca4" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;Unable to retrieve the number of rooms.&quot;</em></pre><pre name="7c8c" id="7c8c" class="graf graf--pre graf-after--pre">let someAddress = Address()</pre><pre name="700d" id="700d" class="graf graf--pre graf-after--pre">someAddress.buildingNumber = &quot;29&quot;</pre><pre name="2947" id="2947" class="graf graf--pre graf-after--pre">someAddress.street = &quot;Acacia Road&quot;</pre><pre name="42d8" id="42d8" class="graf graf--pre graf-after--pre">john.residence?.address = someAddress</pre><pre name="3195" id="3195" class="graf graf--pre graf-after--pre">func createAddress() -&gt; Address {</pre><pre name="1cbb" id="1cbb" class="graf graf--pre graf-after--pre">   print(&quot;Function was called.&quot;)</pre><pre name="8f9a" id="8f9a" class="graf graf--pre graf-after--pre">   let someAddress = Address()</pre><pre name="d517" id="d517" class="graf graf--pre graf-after--pre">   someAddress.buildingNumber = &quot;29&quot;</pre><pre name="5452" id="5452" class="graf graf--pre graf-after--pre">   someAddress.street = &quot;Acacia Road&quot;</pre><pre name="4c4b" id="4c4b" class="graf graf--pre graf-after--pre">   return someAddress</pre><pre name="17af" id="17af" class="graf graf--pre graf-after--pre">}</pre><pre name="bd92" id="bd92" class="graf graf--pre graf-after--pre">john.residence?.address = createAddress()</pre><p name="49c0" id="49c0" class="graf graf--p graf-after--pre">在剛剛的例子裡，有個特別值得注意的地方，john.residence?.address = createAddress() 的 createAddress 並沒有執行，因為等於的左邊用到 optional chaining，當它回傳 nil 時，等於的右邊也就失去執行的意義，因為就算它執行了也無法存入 address 。</p><blockquote name="5d26" id="5d26" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">Calling Methods Through Optional Chaining</strong></blockquote><pre name="9493" id="9493" class="graf graf--pre graf-after--blockquote">if john.residence?.printNumberOfRooms() != nil {</pre><pre name="1be3" id="1be3" class="graf graf--pre graf-after--pre">   print(&quot;It was possible to print the number of rooms.&quot;)</pre><pre name="3568" id="3568" class="graf graf--pre graf-after--pre">} else {</pre><pre name="7cb8" id="7cb8" class="graf graf--pre graf-after--pre">   print(&quot;It was not possible to print the number of rooms.&quot;)</pre><pre name="fded" id="fded" class="graf graf--pre graf-after--pre">}</pre><pre name="b1f3" id="b1f3" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;It was not possible to print the number of rooms.&quot;</em></pre><pre name="910a" id="910a" class="graf graf--pre graf-after--pre">if (john.residence?.address = someAddress) != nil {</pre><pre name="c53f" id="c53f" class="graf graf--pre graf-after--pre">   print(&quot;It was possible to set the address.&quot;)</pre><pre name="4572" id="4572" class="graf graf--pre graf-after--pre">} else {</pre><pre name="38ee" id="38ee" class="graf graf--pre graf-after--pre">   print(&quot;It was not possible to set the address.&quot;)</pre><pre name="e947" id="e947" class="graf graf--pre graf-after--pre">}</pre><pre name="67e1" id="67e1" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;It was not possible to set the address.&quot;</em></pre><blockquote name="eca6" id="eca6" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Accessing Subscripts Through Optional Chaining</strong></blockquote><pre name="c54b" id="c54b" class="graf graf--pre graf-after--blockquote">if let firstRoomName = john.residence?[0].name {</pre><pre name="af45" id="af45" class="graf graf--pre graf-after--pre">   print(&quot;The first room name is \(firstRoomName).&quot;)</pre><pre name="cdc2" id="cdc2" class="graf graf--pre graf-after--pre">} else {</pre><pre name="180f" id="180f" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the first room name.&quot;)</pre><pre name="9e16" id="9e16" class="graf graf--pre graf-after--pre">}</pre><pre name="ee93" id="ee93" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;Unable to retrieve the first room name.&quot;</em></pre><pre name="9f71" id="9f71" class="graf graf--pre graf-after--pre"><br>john.residence?[0] = Room(name: &quot;Bathroom&quot;)</pre><pre name="a374" id="a374" class="graf graf--pre graf-after--pre">let johnsHouse = Residence()</pre><pre name="9ab7" id="9ab7" class="graf graf--pre graf-after--pre">johnsHouse.rooms.append(Room(name: &quot;Living Room&quot;))</pre><pre name="e0db" id="e0db" class="graf graf--pre graf-after--pre">johnsHouse.rooms.append(Room(name: &quot;Kitchen&quot;))</pre><pre name="6471" id="6471" class="graf graf--pre graf-after--pre">john.residence = johnsHouse</pre><pre name="e284" id="e284" class="graf graf--pre graf-after--pre">if let firstRoomName = john.residence?[0].name {</pre><pre name="3553" id="3553" class="graf graf--pre graf-after--pre">   print(&quot;The first room name is \(firstRoomName).&quot;)</pre><pre name="5056" id="5056" class="graf graf--pre graf-after--pre">} else {</pre><pre name="ed94" id="ed94" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the first room name.&quot;)</pre><pre name="8154" id="8154" class="graf graf--pre graf-after--pre">}</pre><pre name="ef0c" id="ef0c" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;The first room name is Living Room.&quot;</em></pre><blockquote name="5f98" id="5f98" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Accessing Subscripts of Optional Type</strong></blockquote><pre name="4990" id="4990" class="graf graf--pre graf-after--blockquote">var testScores = [&quot;Dave&quot;: [86, 82, 84], &quot;Bev&quot;: [79, 94, 81]]</pre><pre name="1f2b" id="1f2b" class="graf graf--pre graf-after--pre">testScores[&quot;Dave&quot;]?[0] = 91</pre><pre name="2704" id="2704" class="graf graf--pre graf-after--pre">testScores[&quot;Bev&quot;]?[0] += 1</pre><pre name="3d3a" id="3d3a" class="graf graf--pre graf-after--pre">testScores[&quot;Brian&quot;]?[0] = 72</pre><pre name="55b4" id="55b4" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// the &quot;Dave&quot; array is now [91, 82, 84] and the &quot;Bev&quot; array is now [80, 94, 81]</em></pre><blockquote name="1afd" id="1afd" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Linking Multiple Levels of Chaining</strong></blockquote><pre name="20a9" id="20a9" class="graf graf--pre graf-after--blockquote">if let johnsStreet = john.residence?.address?.street {</pre><pre name="0897" id="0897" class="graf graf--pre graf-after--pre">   print(&quot;John&#39;s street name is \(johnsStreet).&quot;)</pre><pre name="cf47" id="cf47" class="graf graf--pre graf-after--pre">} else {</pre><pre name="2476" id="2476" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the address.&quot;)</pre><pre name="7f25" id="7f25" class="graf graf--pre graf-after--pre">}</pre><pre name="5c21" id="5c21" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;Unable to retrieve the address.&quot;</em></pre><pre name="3840" id="3840" class="graf graf--pre graf-after--pre">let johnsAddress = Address()</pre><pre name="ba59" id="ba59" class="graf graf--pre graf-after--pre">johnsAddress.buildingName = &quot;The Larches&quot;</pre><pre name="fa4e" id="fa4e" class="graf graf--pre graf-after--pre">johnsAddress.street = &quot;Laurel Street&quot;</pre><pre name="4e5b" id="4e5b" class="graf graf--pre graf-after--pre">john.residence?.address = johnsAddress</pre><pre name="2186" id="2186" class="graf graf--pre graf-after--pre">if let johnsStreet = john.residence?.address?.street {</pre><pre name="6c0c" id="6c0c" class="graf graf--pre graf-after--pre">   print(&quot;John&#39;s street name is \(johnsStreet).&quot;)</pre><pre name="506c" id="506c" class="graf graf--pre graf-after--pre">} else {</pre><pre name="d500" id="d500" class="graf graf--pre graf-after--pre">   print(&quot;Unable to retrieve the address.&quot;)</pre><pre name="b7ae" id="b7ae" class="graf graf--pre graf-after--pre">}</pre><pre name="5a57" id="5a57" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;John&#39;s street name is Laurel Street.&quot;</em></pre><blockquote name="7420" id="7420" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Chaining on Methods with Optional Return Values</strong></blockquote><pre name="40ce" id="40ce" class="graf graf--pre graf-after--blockquote">if let buildingIdentifier = john.residence?.address?.buildingIdentifier() {</pre><pre name="3883" id="3883" class="graf graf--pre graf-after--pre">   print(&quot;John&#39;s building identifier is \(buildingIdentifier).&quot;)</pre><pre name="3bfb" id="3bfb" class="graf graf--pre graf-after--pre">}</pre><pre name="266a" id="266a" class="graf graf--pre graf-after--pre"><em class="markup--em markup--pre-em">// Prints &quot;John&#39;s building identifier is The Larches.&quot;</em></pre><pre name="ba64" id="ba64" class="graf graf--pre graf-after--pre">if let beginsWithThe =</pre><pre name="25c5" id="25c5" class="graf graf--pre graf-after--pre">john.residence?.address?.buildingIdentifier()?.hasPrefix(&quot;The&quot;) {</pre><pre name="ce0a" id="ce0a" class="graf graf--pre graf-after--pre">   if beginsWithThe {</pre><pre name="ee17" id="ee17" class="graf graf--pre graf-after--pre">      print(&quot;John&#39;s building identifier begins with \&quot;The\&quot;.&quot;)</pre><pre name="7166" id="7166" class="graf graf--pre graf-after--pre">   } else {</pre><pre name="cbcb" id="cbcb" class="graf graf--pre graf-after--pre">      print(&quot;John&#39;s building identifier does not begin with \&quot;The\&quot;.&quot;)</pre><pre name="5353" id="5353" class="graf graf--pre graf-after--pre">   }</pre><pre name="d9f5" id="d9f5" class="graf graf--pre graf-after--pre">}</pre><pre name="8289" id="8289" class="graf graf--pre graf-after--pre graf--trailing"><em class="markup--em markup--pre-em">// Prints &quot;John&#39;s building identifier begins with &quot;The&quot;.&quot;</em></pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/43f71e3fe91c"><time class="dt-published" datetime="2018-09-17T16:36:18.384Z">September 17, 2018</time></a>.</p><p><a href="https://medium.com/@apppeterpan/optional-chaining-%E7%A8%8B%E5%BC%8F%E7%AF%84%E4%BE%8B-apples-the-swift-programming-language-43f71e3fe91c" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>