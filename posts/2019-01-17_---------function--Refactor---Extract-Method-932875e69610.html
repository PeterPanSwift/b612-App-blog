<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>將重覆的程式變成 function 的Refactor &gt; Extract Method</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">將重覆的程式變成 function 的Refactor &gt; Extract Method</h1>
</header>
<section data-field="subtitle" class="p-summary">
切學者剛開始學程式時，能夠寫出正確的程式，實現想要的功能和結果是第一目標。等可以寫出正確的程式後，不妨以寫出好的程式為下個目標。
</section>
<section data-field="body" class="e-content">
<section name="5be0" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="199d" id="199d" class="graf graf--h3 graf--leading graf--title">將重覆的程式變成 function 的Refactor &gt; Extract Method</h3><p name="8069" id="8069" class="graf graf--p graf-after--h3">切學者剛開始學程式時，能夠寫出正確的程式，實現想要的功能和結果是第一目標。等可以寫出正確的程式後，不妨以寫出好的程式為下個目標。</p><p name="2fbb" id="2fbb" class="graf graf--p graf-after--p">讓程式更好的技巧有很多，但對初學者來說，第一個努力的目標可以放在將重覆的程式寫成 function，不要同樣的程式重覆 copy paste ，實現傳說中好程式應遵守的原則:</p><h3 name="da96" id="da96" class="graf graf--h3 graf-after--p">DRY ( Don’t repeat yourself)</h3><div name="60ad" id="60ad" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://deviq.com/don-t-repeat-yourself/" data-href="https://deviq.com/don-t-repeat-yourself/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://deviq.com/don-t-repeat-yourself/"><strong class="markup--strong markup--mixtapeEmbed-strong">Don&#39;t Repeat Yourself</strong><br><em class="markup--em markup--mixtapeEmbed-em">The Don&#39;t Repeat Yourself (DRY) principle states that duplication in logic should be eliminated via abstraction…</em>deviq.com</a><a href="https://deviq.com/don-t-repeat-yourself/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="effb235d78761855f18e7d8861aa9f2a" data-thumbnail-img-id="0*nJWycnszz45KMo79" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*nJWycnszz45KMo79);"></a></div><p name="4c7c" id="4c7c" class="graf graf--p graf-after--mixtapeEmbed">讓我們以一個實際的 App，問答題 App 為例，瞧瞧為什麼會產生重覆的程式。</p><figure name="b123" id="b123" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*7ppTb-QIkaqTkqI1ksYIwg.jpeg" data-width="816" data-height="1372" src="https://cdn-images-1.medium.com/max/800/1*7ppTb-QIkaqTkqI1ksYIwg.jpeg"></figure><pre name="e667" id="e667" class="graf graf--pre graf-after--figure">class ViewController: UIViewController {</pre><pre name="2444" id="2444" class="graf graf--pre graf-after--pre">   var questions = [Question(description: &quot;暗戀要看什麼書&quot;, answer: &quot;Swift&quot;), Question(description: &quot;失戀要看什麼書&quot;, answer: &quot;Swift&quot;), Question(description: &quot;熱戀要看什麼書&quot;, answer: &quot;Swift&quot;)]</pre><pre name="a0c5" id="a0c5" class="graf graf--pre graf-after--pre">   var index = 0</pre><pre name="7d70" id="7d70" class="graf graf--pre graf-after--pre">   @IBOutlet weak var questionNumberLabel: UILabel!</pre><pre name="d164" id="d164" class="graf graf--pre graf-after--pre">   @IBOutlet weak var answerLabel: UILabel!</pre><pre name="4652" id="4652" class="graf graf--pre graf-after--pre">   @IBOutlet weak var questionLabel: UILabel!</pre><pre name="9a5e" id="9a5e" class="graf graf--pre graf-after--pre">   override func viewDidLoad() {</pre><pre name="a0d8" id="a0d8" class="graf graf--pre graf-after--pre">      super.viewDidLoad()</pre><pre name="da58" id="da58" class="graf graf--pre graf-after--pre">      questionLabel.text = questions[index].description</pre><pre name="dc3b" id="dc3b" class="graf graf--pre graf-after--pre">      questionNumberLabel.text = &quot;\(index+1)&quot;</pre><pre name="9482" id="9482" class="graf graf--pre graf-after--pre">      answerLabel.text = &quot;&quot;</pre><pre name="a31d" id="a31d" class="graf graf--pre graf-after--pre">   }</pre><pre name="90e1" id="90e1" class="graf graf--pre graf-after--pre">   @IBAction func nextQuestion(_ sender: Any) {</pre><pre name="5c29" id="5c29" class="graf graf--pre graf-after--pre">      if index &lt; questions.count - 1 {</pre><pre name="1825" id="1825" class="graf graf--pre graf-after--pre">         index = index + 1</pre><pre name="1b38" id="1b38" class="graf graf--pre graf-after--pre">         questionLabel.text = questions[index].description</pre><pre name="fa9b" id="fa9b" class="graf graf--pre graf-after--pre">         questionNumberLabel.text = &quot;\(index+1)&quot; </pre><pre name="16c3" id="16c3" class="graf graf--pre graf-after--pre">         answerLabel.text = &quot;&quot;</pre><pre name="15cf" id="15cf" class="graf graf--pre graf-after--pre">      }</pre><pre name="b2ef" id="b2ef" class="graf graf--pre graf-after--pre">   }</pre><pre name="b448" id="b448" class="graf graf--pre graf-after--pre">   @IBAction func replay(_ sender: Any) {</pre><pre name="9310" id="9310" class="graf graf--pre graf-after--pre">       index = 0</pre><pre name="5fc1" id="5fc1" class="graf graf--pre graf-after--pre">       questionLabel.text = questions[index].description</pre><pre name="a55b" id="a55b" class="graf graf--pre graf-after--pre">       questionNumberLabel.text = &quot;\(index+1)&quot;</pre><pre name="0846" id="0846" class="graf graf--pre graf-after--pre">       answerLabel.text = &quot;&quot;</pre><pre name="8d21" id="8d21" class="graf graf--pre graf-after--pre">   }</pre><pre name="7de8" id="7de8" class="graf graf--pre graf-after--pre">}</pre><p name="b4e2" id="b4e2" class="graf graf--p graf-after--pre">我們利用 function viewDidLoad 顯示第一題， function nextQuestion 顯示下一題，function replay 回到第一題重玩，以上的程式將可實現問答題 App 的功能，但卻有許多重覆的程式，比方下圖三個紅色長方形的框框寫著一模一樣的程式。</p><figure name="77ea" id="77ea" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Qm6Vqm_02r-7c3SiIMZDwg.jpeg" data-width="1358" data-height="1114" src="https://cdn-images-1.medium.com/max/800/1*Qm6Vqm_02r-7c3SiIMZDwg.jpeg"></figure><p name="ece8" id="ece8" class="graf graf--p graf-after--figure">重覆的程式有很多缺點，比方我們想在顯示問題時，將 answerLabel 的文字改成顯示 ?，我們要改三個地方，少改一個就會產生討厭的 bug。</p><figure name="af34" id="af34" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*BMNYcdY-aptUL-WoJRdpjQ.jpeg" data-width="1358" data-height="1124" src="https://cdn-images-1.medium.com/max/800/1*BMNYcdY-aptUL-WoJRdpjQ.jpeg"></figure><p name="1737" id="1737" class="graf graf--p graf-after--figure">接下來就讓我們解決問題，讓程式不再重覆吧。</p><p name="2289" id="2289" class="graf graf--p graf-after--p">有些厲害的高手一開始就能想好某個功能的程式可重覆利用，一開始就將它寫成 function。不過就算沒那麼厲害，不小心寫出重覆的程式，我們還是可以亡羊補牢，利用 refactor (重構)將重覆的程式變成 function。</p><blockquote name="d2bc" id="d2bc" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">1 選取重覆的程式碼。</strong></blockquote><figure name="a679" id="a679" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*OgOVdxTGsUrK_PalKJys6g.jpeg" data-width="1290" data-height="358" src="https://cdn-images-1.medium.com/max/800/1*OgOVdxTGsUrK_PalKJys6g.jpeg"></figure><blockquote name="d3f7" id="d3f7" class="graf graf--blockquote graf-after--figure"><strong class="markup--strong markup--blockquote-strong">2 從右鍵選單點選 Refactor &gt; Extract Method。</strong></blockquote><figure name="71d5" id="71d5" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*eFP6JKsg_SfE066KljcxGg.jpeg" data-width="1686" data-height="774" src="https://cdn-images-1.medium.com/max/800/1*eFP6JKsg_SfE066KljcxGg.jpeg"></figure><p name="c199" id="c199" class="graf graf--p graf-after--figure">神奇的事發生了 ! 剛剛選取的程式變成呼叫 function extractedFunc ，而 function extractedFunc 的 { } 裡正是我們選取的重覆程式碼。</p><figure name="6e2a" id="6e2a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*iUSmTWlvR3vNGw1DJ8lGhg.jpeg" data-width="1252" data-height="550" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*iUSmTWlvR3vNGw1DJ8lGhg.jpeg"></figure><p name="ddb7" id="ddb7" class="graf graf--p graf-after--figure">不喜歡名字 extractedFunc 沒關係，此時我們可以輸入文字，取個喜歡的名字，比方 showQuestion。</p><figure name="0578" id="0578" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qj1kDcLUO3n0fcOgSEccXQ.jpeg" data-width="1282" data-height="562" src="https://cdn-images-1.medium.com/max/800/1*qj1kDcLUO3n0fcOgSEccXQ.jpeg"></figure><p name="12aa" id="12aa" class="graf graf--p graf-after--figure">接下來只要再將其它重覆的程式也改成呼叫 function showQuestion 即可。原本重覆的程式現在只出現在一個地方，單獨寫在 function showQuestion 裡，再也不重覆了。</p><pre name="d1e5" id="d1e5" class="graf graf--pre graf-after--p">override func viewDidLoad() {</pre><pre name="aaf8" id="aaf8" class="graf graf--pre graf-after--pre">   super.viewDidLoad()</pre><pre name="040e" id="040e" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">   showQuestion()</strong></pre><pre name="08ff" id="08ff" class="graf graf--pre graf-after--pre">}</pre><pre name="755f" id="755f" class="graf graf--pre graf-after--pre">@IBAction func nextQuestion(_ sender: Any) {</pre><pre name="4044" id="4044" class="graf graf--pre graf-after--pre">   if index &lt; questions.count - 1 {</pre><pre name="8a07" id="8a07" class="graf graf--pre graf-after--pre">      index = index + 1</pre><pre name="503a" id="503a" class="graf graf--pre graf-after--pre">     <strong class="markup--strong markup--pre-strong"> showQuestion()</strong></pre><pre name="984b" id="984b" class="graf graf--pre graf-after--pre">   }</pre><pre name="73b7" id="73b7" class="graf graf--pre graf-after--pre">}</pre><pre name="d536" id="d536" class="graf graf--pre graf-after--pre">fileprivate func showQuestion() {</pre><pre name="c2ee" id="c2ee" class="graf graf--pre graf-after--pre">   questionLabel.text = questions[index].description</pre><pre name="3f42" id="3f42" class="graf graf--pre graf-after--pre">   questionNumberLabel.text = &quot;\(index+1)&quot;</pre><pre name="5cc9" id="5cc9" class="graf graf--pre graf-after--pre">   answerLabel.text = &quot;&quot;</pre><pre name="6bac" id="6bac" class="graf graf--pre graf-after--pre">}</pre><pre name="7300" id="7300" class="graf graf--pre graf-after--pre">@IBAction func replay(_ sender: Any) {</pre><pre name="af4e" id="af4e" class="graf graf--pre graf-after--pre">   index = 0</pre><pre name="de5f" id="de5f" class="graf graf--pre graf-after--pre"> <strong class="markup--strong markup--pre-strong">  showQuestion()</strong></pre><pre name="b098" id="b098" class="graf graf--pre graf-after--pre graf--trailing">}</pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/932875e69610"><time class="dt-published" datetime="2019-01-17T14:18:05.996Z">January 17, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%B0%87%E9%87%8D%E8%A6%86%E7%9A%84%E7%A8%8B%E5%BC%8F%E8%AE%8A%E6%88%90-function-%E7%9A%84refactor-extract-method-932875e69610" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>