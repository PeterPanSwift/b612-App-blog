<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>swift 檢查版本的 #available，#unavailable &amp; @available</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">swift 檢查版本的 #available，#unavailable &amp; @available</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們時常要支援舊版的 iOS ，不能喜新厭舊地拋棄舊版 iOS 的使用者。
</section>
<section data-field="body" class="e-content">
<section name="ec97" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0286" id="0286" class="graf graf--h3 graf--leading graf--title">swift 檢查版本的 #available，#unavailable &amp; @available</h3><p name="b387" id="b387" class="graf graf--p graf-after--h3">開發 iOS App 時，我們時常要支援舊版的 iOS ，不能喜新厭舊地拋棄舊版 iOS 的使用者。</p><p name="a87a" id="a87a" class="graf graf--p graf-after--p">為了支援舊版，我們在寫程式時要特別注意，因為許多 iOS SDK 的新功能只支援新版的 iOS， 比方提供分享功能的 <strong class="markup--strong markup--p-strong">ShareLink</strong> 只支援 iOS 16。</p><figure name="71b1" id="71b1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*b4WKICLxNAedHrc25Grkpg.png" data-width="1220" data-height="476" src="https://cdn-images-1.medium.com/max/800/1*b4WKICLxNAedHrc25Grkpg.png"></figure><p name="2c95" id="2c95" class="graf graf--p graf-after--figure">若想 App 支援到 iOS 15，程式裡使用 ShareLink 的地方將出現錯誤，顯示 <code class="markup--code markup--p-code">&#39;xxx&#39; is only available in iOS 16.0 or newer</code>。</p><figure name="d3b2" id="d3b2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RmaND1sy2bTsc0iIBJvf3Q.png" data-width="2460" data-height="996" src="https://cdn-images-1.medium.com/max/800/1*RmaND1sy2bTsc0iIBJvf3Q.png"></figure><p name="5698" id="5698" class="graf graf--p graf-after--figure">為了同時支援 iOS 16 &amp; 舊版，我們必須使用兩種不同的寫法，iOS 16 以上使用 ShareLink，舊版使用別的寫法。因此我們必須在程式裡檢查 iOS 的版本，然後依據版本採用不同的寫法。</p><p name="8af8" id="8af8" class="graf graf--p graf-after--p">在程式裡檢查 iOS 版本的方法有以下三種:</p><ul class="postList"><li name="de74" id="de74" class="graf graf--li graf-after--p">方法 1: #available</li><li name="c7f2" id="c7f2" class="graf graf--li graf-after--li">方法 2: #unavailable</li><li name="7846" id="7846" class="graf graf--li graf-after--li">方法 3: @available</li></ul><h3 name="20b7" id="20b7" class="graf graf--h3 graf-after--li">方法 1: #available</h3><p name="51f6" id="51f6" class="graf graf--p graf-after--h3">#available 可搭配 if，guard &amp; while。以下例子的 <code class="markup--code markup--p-code">if #available(iOS 16.0, *) </code>表示 iOS 16 以上(包含 16) 採用 if { } 裡的 ShareLink，iOS 16 之前的版本採用 else { } 裡的寫法。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="de1a" id="de1a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>, <span class="hljs-operator">*</span>) {<br />            <span class="hljs-type">ShareLink</span>(item: <span class="hljs-string">&quot;有一首唱過的歌叫做願望，有一個追逐的夢叫做理想&quot;</span>)<br />        } <span class="hljs-keyword">else</span> {<br />            <span class="hljs-comment">// Fallback on earlier versions</span><br />        }<br />    }<br />}</span></pre><p name="958b" id="958b" class="graf graf--p graf-after--pre">那<code class="markup--code markup--p-code">#available()</code> 裡的 * 是什麼意思呢 ? 它表示其它沒有在 ( ) 裡提到的平台採用 if { } 裡的寫法，因此 macOS，watchOS 等平台將採用 if { } 裡的寫法。</p><p name="ff14" id="ff14" class="graf graf--p graf-after--p">若是 App 只支援 iOS，只設定 iOS 版本的限制是 ok 的，因為 App 不會跑在其它的平台。如果想支援更多平台，比方想支援 Apple Watch，剛剛的程式須同時加入 iOS &amp; watchOS 的版本限制，因為 watchOS 9 以上才支援 ShareLink。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="d93b" id="d93b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>, <span class="hljs-keyword">watchOS</span> <span class="hljs-number">9</span>, <span class="hljs-operator">*</span>) {</span></pre><p name="d182" id="d182" class="graf graf--p graf-after--pre">因此 #available 的 ( ) 裡可加入多個平台的版本限制，彼此以逗號分隔，然後在結尾一定要補上 *，代表支援其它沒提到的平台。</p><figure name="4fb2" id="4fb2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*GLeVi4Yc-ln_dfX6Jm8uvQ.png" data-width="2028" data-height="696" src="https://cdn-images-1.medium.com/max/800/1*GLeVi4Yc-ln_dfX6Jm8uvQ.png"><figcaption class="imageCaption">#available 的 ( ) 裡沒寫到 * 將出現錯誤</figcaption></figure><h3 name="3ee3" id="3ee3" class="graf graf--h3 graf-after--figure">方法 2: #unavailable</h3><p name="df0e" id="df0e" class="graf graf--p graf-after--h3">有時我們只想針對舊版撰寫對應的程式，此時使用 #available 有點浪費，因為 if 的 { } 裡是空的。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b44c" id="b44c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">if</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>, <span class="hljs-operator">*</span>) {<br />} <span class="hljs-keyword">else</span> {<br />   <span class="hljs-comment">// do something</span><br />}</span></pre><p name="75d5" id="75d5" class="graf graf--p graf-after--pre">guard else 的寫法稍微好一點，不過還是有點麻煩。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="620a" id="620a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">test</span>() {<br />    <span class="hljs-keyword">guard</span> <span class="hljs-keyword">#available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>, <span class="hljs-operator">*</span>) <span class="hljs-keyword">else</span> {<br />        <span class="hljs-comment">// do something</span><br />        <span class="hljs-keyword">return</span><br />    }<br />}</span></pre><p name="a2c7" id="a2c7" class="graf graf--p graf-after--pre">因此 Swift 5.6(搭配 Xcode 13.3) 推出了跟 #available 意思相反的 #unavailable，一樣可搭配 if，guard &amp; while，方便我們針對舊版撰寫對應的程式。</p><figure name="031c" id="031c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*cDXfgBFNxhilbuXF5flbgw.png" data-width="862" data-height="510" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*cDXfgBFNxhilbuXF5flbgw.png"></figure><div name="ff2c" id="ff2c" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://github.com/apple/swift-evolution/blob/main/proposals/0290-negative-availability.md" data-href="https://github.com/apple/swift-evolution/blob/main/proposals/0290-negative-availability.md" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/apple/swift-evolution/blob/main/proposals/0290-negative-availability.md"><strong class="markup--strong markup--mixtapeEmbed-strong">swift-evolution/0290-negative-availability.md at main · apple/swift-evolution</strong><br><em class="markup--em markup--mixtapeEmbed-em">Swift historically supported the #available condition to check if a specific symbol is available for usage, but not the…</em>github.com</a><a href="https://github.com/apple/swift-evolution/blob/main/proposals/0290-negative-availability.md" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="fb5ff1f10d44672425051c495334e104" data-thumbnail-img-id="0*QMd_dYp5h8Ju92Eu" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*QMd_dYp5h8Ju92Eu);"></a></div><p name="73fc" id="73fc" class="graf graf--p graf-after--mixtapeEmbed">以下的 <code class="markup--code markup--p-code">if #unavailable(iOS 16)</code> 表示 iOS 16 之前(不包含 16)的版本將採用 if { } 裡的寫法。跟 #available 一樣，#unavailable 的 ( ) 裡可加入多個平台的版本限制，彼此以逗號分隔。不過有一點要特別注意，它不用加 *。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="1760" id="1760" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">if</span> <span class="hljs-keyword">#unavailable</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>) {<br />           <br />}</span></pre><h3 name="7a1c" id="7a1c" class="graf graf--h3 graf-after--pre">方法 3: @available</h3><p name="2f40" id="2f40" class="graf graf--p graf-after--h3">@available 也可以檢查版本，( ) 裡的寫法跟 #available 類似，不過它只能單獨寫，不能搭配 if，guard &amp; while，因此它通常加在型別定義或 function &amp; 變數的宣告前，例如以下例子表示只在 iOS 16 以上版本(包含 16)定義 ContentView。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="1ddd" id="1ddd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">@available</span>(<span class="hljs-keyword">iOS</span> <span class="hljs-number">16.0</span>, <span class="hljs-operator">*</span>)<br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">ShareLink</span>(item: <span class="hljs-string">&quot;有一首唱過的歌叫做願望，有一個追逐的夢叫做理想&quot;</span>)<br />    }<br />}</span></pre><h3 name="fc28" id="fc28" class="graf graf--h3 graf-after--pre">參考連結</h3><p name="3a22" id="3a22" class="graf graf--p graf-after--h3">關於從程式檢查版本的寫法，有興趣的朋友也可進一步參考 nshipster 的說明。</p><div name="f361" id="f361" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://nshipster.com/available/" data-href="https://nshipster.com/available/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://nshipster.com/available/"><strong class="markup--strong markup--mixtapeEmbed-strong">Swift API Availability</strong><br><em class="markup--em markup--mixtapeEmbed-em">Code exists in a world of infinite abundance. Whatever you can imagine is willed into being - so long as you know how…</em>nshipster.com</a><a href="https://nshipster.com/available/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="83567f91929ad9994eaddd7e48e115c4" data-thumbnail-img-id="0*bLclLMLaQ89fP798" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*bLclLMLaQ89fP798);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/bf7fa0f0e6b6"><time class="dt-published" datetime="2022-02-05T14:07:43.558Z">February 5, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swift-%E6%AA%A2%E6%9F%A5%E7%89%88%E6%9C%AC%E7%9A%84-available-unavailable-available-bf7fa0f0e6b6" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>