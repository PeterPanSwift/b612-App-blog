<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>從 auto layout 算出 cell 高度的  Interface Builder — Xcode 11 新功能</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">從 auto layout 算出 cell 高度的  Interface Builder — Xcode 11 新功能</h1>
</header>
<section data-field="subtitle" class="p-summary">
為了讓表格 cell 的內容在不同大小的 iPhone 都能完整顯示，我們通常要為 cell 裡的元件加入 auto layout 條件。不過 Interface Builder 原本不太聰明，無法由我們設定的條件算出 cell 的高度。
</section>
<section data-field="body" class="e-content">
<section name="3930" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="95c2" id="95c2" class="graf graf--h3 graf--leading graf--title">利用 auto layout 條件自動計算 cell 高度</h3><p name="9303" id="9303" class="graf graf--p graf-after--h3">為了讓表格 cell 的內容在不同大小的 iPhone 都能完整顯示，我們通常要為 cell 裡的元件加入 auto layout 條件。有了這些條件，透過 subview 條件決定 superview 大小的原理，auto layout 將可自動計算 cell 容納元件所需的高度。</p><p name="e106" id="e106" class="graf graf--p graf-after--p">讓我們先看一兩個簡單的例子，然後再說明複雜的例子。</p><ul class="postList"><li name="69d8" id="69d8" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">例子 1</strong></li></ul><p name="69e1" id="69e1" class="graf graf--p graf-after--li">label 跟 ContentView 之間的上間距 &amp; 下間距為 10。</p><figure name="8650" id="8650" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dJB3y65hEN_H4Nl7tk23jg.png" data-width="1330" data-height="548" src="https://cdn-images-1.medium.com/max/800/1*dJB3y65hEN_H4Nl7tk23jg.png"></figure><p name="2c3f" id="2c3f" class="graf graf--p graf-after--figure">想讓 auto layout 正確計算 cell 的高度，關鍵在於 Y 軸的條件。剛剛的例子裡，Y 軸的條件有上間距 10，下間距 10，label 的高度由文字內容決定，文字的行數愈多 label 愈高，因此 cell 高度將是 10 + 10 + label 的高度。</p><figure name="2250" id="2250" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_ol1UNIjUVaBFTY61WACfw.png" data-width="1190" data-height="384" src="https://cdn-images-1.medium.com/max/800/1*_ol1UNIjUVaBFTY61WACfw.png"></figure><ul class="postList"><li name="3405" id="3405" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">例子 2</strong></li></ul><p name="6200" id="6200" class="graf graf--p graf-after--li">圖片的高度為 85，上下間距各為 20。</p><figure name="b9c6" id="b9c6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*lj3QLemGooKXxgwXhTCGCQ.jpeg" data-width="1288" data-height="574" src="https://cdn-images-1.medium.com/max/800/1*lj3QLemGooKXxgwXhTCGCQ.jpeg"></figure><p name="eb49" id="eb49" class="graf graf--p graf-after--figure">剛剛的例子裡，Y 軸的條件有上間距 20，下間距 20，圖片高度 85，因此 cell 高度將是 125。(85 + 20 + 20)</p><figure name="a228" id="a228" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*A0zrvJA45uG8Q_ob9MuAwQ.png" data-width="1206" data-height="552" src="https://cdn-images-1.medium.com/max/800/1*A0zrvJA45uG8Q_ob9MuAwQ.png"></figure><p name="48d6" id="48d6" class="graf graf--p graf-after--figure">接下來讓我們看一些更複雜的例子，在 cell 裡顯示蘇軾的名作念奴嬌為例說明。</p><h3 name="613e" id="613e" class="graf graf--h3 graf-after--p">在 storyboard 加入 table view controller</h3><p name="7533" id="7533" class="graf graf--p graf-after--h3">調整 cell 的高度，方便待會在 cell 裡加入 label。</p><figure name="29cf" id="29cf" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ybVNG0yjruD0Wz-EDSeYZQ.png" data-width="1004" data-height="1168" src="https://cdn-images-1.medium.com/max/800/1*ybVNG0yjruD0Wz-EDSeYZQ.png"></figure><h3 name="9240" id="9240" class="graf graf--h3 graf-after--figure">加入 2 個 label</h3><ul class="postList"><li name="376e" id="376e" class="graf graf--li graf-after--h3">label 的文字輸入念奴嬌 &amp; 大江東去的內容。</li><li name="f3a6" id="f3a6" class="graf graf--li graf-after--li">大江東去 label 的 lines 設為 0，讓它可以顯示多行文字。</li><li name="e1e0" id="e1e0" class="graf graf--li graf-after--li">將 label 上下左右的間距設為 10。</li></ul><p name="8f2a" id="8f2a" class="graf graf--p graf-after--li">cell 有 margin，在此我們不包含 margin，因此取消 Constrain to margins 的勾選。</p><figure name="812d" id="812d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*2ACt-OmTGcOhYq5GDmaz-Q.png" data-width="1092" data-height="1192" src="https://cdn-images-1.medium.com/max/800/1*2ACt-OmTGcOhYq5GDmaz-Q.png"></figure><figure name="f265" id="f265" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*lg8S2oQyBpJu1qxu4JeKUQ.png" data-width="510" data-height="476" src="https://cdn-images-1.medium.com/max/800/1*lg8S2oQyBpJu1qxu4JeKUQ.png"></figure><figure name="7f41" id="7f41" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*Kqm1WGaOEhskdwhekP_5vA.png" data-width="522" data-height="476" src="https://cdn-images-1.medium.com/max/800/1*Kqm1WGaOEhskdwhekP_5vA.png"></figure><p name="bb6d" id="bb6d" class="graf graf--p graf-after--figure">加了 auto layout 條件後，此時卻跑出了可怕的紅色錯誤。</p><figure name="3b17" id="3b17" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*b5q9T9suQR8E23Cw0A6-HA.png" data-width="546" data-height="1118" src="https://cdn-images-1.medium.com/max/800/1*b5q9T9suQR8E23Cw0A6-HA.png"></figure><figure name="0713" id="0713" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*rAZdsKXQofnSuIriinMIQg.png" data-width="1246" data-height="1148" src="https://cdn-images-1.medium.com/max/800/1*rAZdsKXQofnSuIriinMIQg.png"></figure><p name="98cf" id="98cf" class="graf graf--p graf-after--figure">此錯誤其實是假的，若我們執行 App，App 將可完美地顯示大江東去。</p><p name="2fb2" id="2fb2" class="graf graf--p graf-after--p">不過紅色錯誤看了還是令人心煩。沒關係，只要設定以下欄位，即可讓 interface builder 從條件算出正確的 cell 高度，不再看到紅色錯誤。</p><ul class="postList"><li name="ec00" id="ec00" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">table view 的 row height &amp; estimate 為 Automatic。</strong></li></ul><p name="7984" id="7984" class="graf graf--p graf-after--li">row height &amp; estimate 為 Automatic 時，表示利用 auto layout 條件自動計算 cell 高度。當框框裡沒有輸入數字時，內容將預設為 Automatic。</p><figure name="e197" id="e197" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yEN8DImTrMx_3NWxC_DWzA.png" data-width="528" data-height="246" src="https://cdn-images-1.medium.com/max/800/1*yEN8DImTrMx_3NWxC_DWzA.png"></figure><p name="e87d" id="e87d" class="graf graf--p graf-after--figure">ps: 上圖的設定若要從程式設定，可透過以下程式。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="142e" id="142e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">tableView.rowHeight <span class="hljs-operator">=</span> <span class="hljs-type">UITableView</span>.automaticDimension<br />tableView.estimatedRowHeight <span class="hljs-operator">=</span> <span class="hljs-type">UITableView</span>.automaticDimension</span></pre><ul class="postList"><li name="5763" id="5763" class="graf graf--li graf-after--pre"><strong class="markup--strong markup--li-strong">清空 table view cell 的 Row Height 框框。</strong></li></ul><p name="4ae4" id="4ae4" class="graf graf--p graf-after--li">請空 Row Height 框框，讓 interface builder 顯示 cell 時依據 auto layout 條件計算並更新 cell 高度。</p><figure name="b16a" id="b16a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*c7_qXxbbM9EzaBdxw5_NVQ.png" data-width="516" data-height="204" src="https://cdn-images-1.medium.com/max/800/1*c7_qXxbbM9EzaBdxw5_NVQ.png"></figure><ul class="postList"><li name="eda2" id="eda2" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">將念奴嬌 label 的 content hugging priority vertical 設成 252。</strong></li></ul><p name="dc77" id="dc77" class="graf graf--p graf-after--li">讓兩個 label 的 content hugging priority vertical 不一樣，讓 interface builder 知道該如何分配 2 個 label 的高度。(ps: 其實 App 執行時是正常的，調整 priority 只是為了修正 interface builder 顯示的問題)</p><figure name="1f5b" id="1f5b" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ct-mTnDfTrDyw_KPSKmSbg.png" data-width="530" data-height="636" src="https://cdn-images-1.medium.com/max/800/1*ct-mTnDfTrDyw_KPSKmSbg.png"></figure><p name="8c67" id="8c67" class="graf graf--p graf-after--figure">Cool，現在我們終於可以在 interface builder 看到大江東去完整顯示，cell 也能顯示正確的高度。</p><figure name="b7a2" id="b7a2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*lI0RpFKcOXkJHWD0us1FOQ.png" data-width="1302" data-height="1094" src="https://cdn-images-1.medium.com/max/800/1*lI0RpFKcOXkJHWD0us1FOQ.png"></figure><h3 name="b193" id="b193" class="graf graf--h3 graf-after--figure">當條件有問題</h3><p name="a48c" id="a48c" class="graf graf--p graf-after--h3">搭配 auto layout 條件計算 cell 高度時記得條件要設好設滿，如果條件有問題，它可是算不出來的，cell 只能可憐地變成預設的高度。</p><p name="73af" id="73af" class="graf graf--p graf-after--p">比方大江東去 label 少了跟 cell 下邊界的條件，因此無法算出 cell 的高度。</p><figure name="b00e" id="b00e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*x7L0Phd7ZwaUWbpI8Xkrvw.jpeg" data-width="526" data-height="366" src="https://cdn-images-1.medium.com/max/800/1*x7L0Phd7ZwaUWbpI8Xkrvw.jpeg"></figure><p name="9e63" id="9e63" class="graf graf--p graf-after--figure">此時不會有錯誤，但 cell 的高度將變成 43.5。</p><figure name="d1a7" id="d1a7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*DLumvrcvCvL1K9yfp8n4bg.jpeg" data-width="1046" data-height="334" src="https://cdn-images-1.medium.com/max/800/1*DLumvrcvCvL1K9yfp8n4bg.jpeg"></figure><figure name="a219" id="a219" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*TmjE-lTPIyi9BTPKcABJyQ.jpeg" data-width="814" data-height="1392" src="https://cdn-images-1.medium.com/max/800/1*TmjE-lTPIyi9BTPKcABJyQ.jpeg"></figure><h3 name="52e2" id="52e2" class="graf graf--h3 graf-after--figure">搭配 stack view 設計 cell</h3><p name="1220" id="1220" class="graf graf--p graf-after--h3">cell 裡的內容也很適合搭配 stack view 設計，如下圖所示，我們可將兩個 label 裝在 vertical stack view 裡。</p><figure name="c117" id="c117" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ssQNp4kTWT5eXLyBwIDZcA.png" data-width="1338" data-height="642" src="https://cdn-images-1.medium.com/max/800/1*ssQNp4kTWT5eXLyBwIDZcA.png"></figure><p name="7567" id="7567" class="graf graf--p graf-after--figure">而且搭配 stack view 後，我們要設定的條件變少了。原本上下左右間距 10 要 7 個條件，現在我們只要設定 4 個條件。(為了讓 interface builder 正確顯示，念奴嬌 label 的 content hugging priority vertical 記得要設成 252。)</p><figure name="a070" id="a070" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*CaSfuAdve1Ux5moddIxSrw.jpeg" data-width="518" data-height="446" src="https://cdn-images-1.medium.com/max/800/1*CaSfuAdve1Ux5moddIxSrw.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/4ed68758d5e3"><time class="dt-published" datetime="2019-07-26T07:10:45.972Z">July 26, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%BE%9E-auto-layout-%E7%AE%97%E5%87%BA-cell-%E9%AB%98%E5%BA%A6%E7%9A%84-interface-builder-xcode-11-%E6%96%B0%E5%8A%9F%E8%83%BD-4ed68758d5e3" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>