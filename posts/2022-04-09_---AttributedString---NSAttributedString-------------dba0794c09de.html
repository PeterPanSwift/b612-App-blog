<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 AttributedString 或 NSAttributedString 實現多種樣式組合的文字</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 AttributedString 或 NSAttributedString 實現多種樣式組合的文字</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們時常會看到多種樣式組合的文字，比方下圖 IG App 紅色框框的文字區塊，人名 anwei20 跟終於 … 的文字是不同的樣式。
</section>
<section data-field="body" class="e-content">
<section name="76c9" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7763" id="7763" class="graf graf--h3 graf--leading graf--title">利用 AttributedString 或 NSAttributedString 實現多種樣式組合的文字</h3><p name="7db4" id="7db4" class="graf graf--p graf-after--h3">開發 iOS App 時，我們時常會看到多種樣式組合的文字，比方下圖 IG App 紅色框框的文字區塊，人名 anwei20 跟終於 … 的文字是不同的樣式。</p><figure name="a787" id="a787" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CsMzd-Ha-pZbEj-vpo-WUw.png" data-width="1125" data-height="2436" src="https://cdn-images-1.medium.com/max/800/1*CsMzd-Ha-pZbEj-vpo-WUw.png"></figure><p name="1eb9" id="1eb9" class="graf graf--p graf-after--figure">利用 AttributedString 或 NSAttributedString 將可實現多種樣式組合的文字效果，以下彼得潘將以戴佩妮創作的好聽歌曲<code class="markup--code markup--p-code">天花版的星星</code>說明。</p><h3 name="5c2e" id="5c2e" class="graf graf--h3 graf-after--p">從 Xcode playground 實驗 AttributedString</h3><p name="5240" id="5240" class="graf graf--p graf-after--h3">透過 iOS 15 推出的 AttributedString，我們可以實現多種樣式組合的文字效果。以下為 playground 的程式範例。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2752" id="2752" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> UIKit<br /><span class="hljs-keyword">import</span> Playgrounds<br /><br />#<span class="hljs-type">Playground</span> {<br />    <span class="hljs-keyword">var</span> content <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>()<br />    <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;anwei20 &quot;</span>)<br />    name.font <span class="hljs-operator">=</span> .boldSystemFont(ofSize: <span class="hljs-number">30</span>)<br />    name.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.black<br />    content <span class="hljs-operator">+=</span> name<br />    <br />    <span class="hljs-keyword">var</span> message <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;戴佩妮創作的天花版的星星<span class="hljs-subst">\n</span>&quot;</span>)<br />    message.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">18</span>)<br />    message.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.gray<br />    content <span class="hljs-operator">+=</span> message<br />    <br />    <span class="hljs-keyword">var</span> lyrics <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;看你從没看過的風景 躲没躲過的大雨 創造一個天晴 避開你最討厭的擁擠 你最害怕的猜疑 好好喘口氣&quot;</span>)<br />    lyrics.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">14</span>)<br />    lyrics.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.systemPink<br />    lyrics.backgroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.cyan<br />    <span class="hljs-keyword">let</span> paragraphStyle <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableParagraphStyle</span>()<br />    paragraphStyle.lineSpacing <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />    <span class="hljs-keyword">let</span> container <span class="hljs-operator">=</span> <span class="hljs-type">AttributeContainer</span>([.paragraphStyle: paragraphStyle])<br />    lyrics.mergeAttributes(container)<br />    content <span class="hljs-operator">+=</span> lyrics<br /><br />    <span class="hljs-keyword">let</span> label <span class="hljs-operator">=</span> <span class="hljs-type">UILabel</span>()<br />    label.attributedText <span class="hljs-operator">=</span> <span class="hljs-type">NSAttributedString</span>(content)<br />    label.numberOfLines <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-keyword">let</span> size <span class="hljs-operator">=</span> label.sizeThatFits(<span class="hljs-type">CGSize</span>(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">0</span>))<br />    label.frame.size <span class="hljs-operator">=</span> size<br />    label.backgroundColor <span class="hljs-operator">=</span> .white<br />    label<br />}</span></pre><p name="675d" id="675d" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c408" id="c408" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">message.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.gray</span></pre><p name="deb0" id="deb0" class="graf graf--p graf-after--pre">UIColor.gray 如果要省略成 .gray，可改成 <code class="markup--code markup--p-code">message.uiKit.foregroundColor</code>，讓程式知道我們指的是 UIKit 的顏色，不是 SwiftUI 的顏色。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9d0a" id="9d0a" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">label.attributedText <span class="hljs-operator">=</span> <span class="hljs-type">NSAttributedString</span>(content)</span></pre><p name="2497" id="2497" class="graf graf--p graf-after--pre">由於 attributedText 的型別是 NSAttributedString，因此我們要從型別AttributedString 的 content 生成 NSAttributedString，才能存入 attributedText。</p><figure name="56e8" id="56e8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XCJLdrY1apOaSXe16ZVzuQ.png" data-width="754" data-height="472" src="https://cdn-images-1.medium.com/max/800/1*XCJLdrY1apOaSXe16ZVzuQ.png"></figure><p name="049b" id="049b" class="graf graf--p graf-after--figure">接下來讓我們搭配 storyboard 設計的 App 畫面，實驗 AttributedString &amp; NSAttributedString 組合文字的效果。</p><h3 name="d271" id="d271" class="graf graf--h3 graf-after--p">storyboard 的畫面設計</h3><figure name="48d9" id="48d9" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*jZVOCW7FWQixqq_A6tBW6w.png" data-width="1430" data-height="1400" src="https://cdn-images-1.medium.com/max/800/1*jZVOCW7FWQixqq_A6tBW6w.png"></figure><h3 name="cad0" id="cad0" class="graf graf--h3 graf-after--figure">iOS 15 以上: 使用 AttributedString</h3><p name="a4c9" id="a4c9" class="graf graf--p graf-after--h3">透過 AttributedString 的各種屬性設定文字樣式，比方字體，文字顏色，背景顏色，行距等。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1e90" id="1e90" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />   <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> label: <span class="hljs-type">UILabel</span>!<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />        <span class="hljs-keyword">var</span> content <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>()<br />        <br />        <span class="hljs-keyword">var</span> name <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;anwei20 &quot;</span>)<br />        name.font <span class="hljs-operator">=</span> .boldSystemFont(ofSize: <span class="hljs-number">30</span>)<br />        name.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.black<br />        content <span class="hljs-operator">+=</span> name<br />        <br />        <span class="hljs-keyword">var</span> message <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;戴佩妮創作的天花版的星星<span class="hljs-subst">\n</span>&quot;</span>)<br />        message.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">18</span>)<br />        message.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.gray<br />        content <span class="hljs-operator">+=</span> message<br />        <br />        <span class="hljs-keyword">var</span> lyrics <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;看你從没看過的風景 躲没躲過的大雨 創造一個天晴 避開你最討厭的擁擠 你最害怕的猜疑 好好喘口氣&quot;</span>)<br />        lyrics.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">14</span>)<br />        lyrics.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.systemPink<br />        lyrics.backgroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.cyan<br />        <span class="hljs-keyword">let</span> paragraphStyle <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableParagraphStyle</span>()<br />        paragraphStyle.lineSpacing <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />        <span class="hljs-keyword">let</span> container <span class="hljs-operator">=</span> <span class="hljs-type">AttributeContainer</span>([.paragraphStyle: paragraphStyle])<br />        lyrics.mergeAttributes(container)<br />        content <span class="hljs-operator">+=</span> lyrics<br />        <br />        label.attributedText <span class="hljs-operator">=</span> <span class="hljs-type">NSAttributedString</span>(content)<br />        <br />    }<br />}</span></pre><figure name="86ba" id="86ba" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*hxZz_p9w-Xi1OnyjingHnA.png" data-width="1400" data-height="2700" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*hxZz_p9w-Xi1OnyjingHnA.png"></figure><p name="0849" id="0849" class="graf graf--p graf-after--figure">當 AttributedString 的文字有不同大小時，預設將對齊文字底部，因此上圖的 <code class="markup--code markup--p-code">anwei20</code> &amp; <code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>底部對齊。</p><p name="5e74" id="5e74" class="graf graf--p graf-after--p">不過我們也可以透過 baselineOffset 微調整對齊，比方以下例子將讓<code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>向上移動，實現 <code class="markup--code markup--p-code">anwei20</code> &amp; <code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>置中對齊的效果。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3640" id="3640" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> message <span class="hljs-operator">=</span> <span class="hljs-type">AttributedString</span>(<span class="hljs-string">&quot;戴佩妮創作的天花版的星星<span class="hljs-subst">\n</span>&quot;</span>)<br />message.font <span class="hljs-operator">=</span> .systemFont(ofSize: <span class="hljs-number">18</span>)<br />message.foregroundColor <span class="hljs-operator">=</span> <span class="hljs-type">UIColor</span>.gray<br />message.baselineOffset <span class="hljs-operator">=</span> <span class="hljs-number">4</span></span></pre><figure name="8b60" id="8b60" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*Pmhz4BvPM8XgcAnpzCDOOA.png" data-width="1400" data-height="2700" src="https://cdn-images-1.medium.com/max/800/1*Pmhz4BvPM8XgcAnpzCDOOA.png"></figure><h3 name="111d" id="111d" class="graf graf--h3 graf-after--figure">舊版: 使用 NSAttributedString</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="89d4" id="89d4" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> label: <span class="hljs-type">UILabel</span>!<br />    <br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />        <span class="hljs-keyword">let</span> content <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableAttributedString</span>()<br />        <br />        <span class="hljs-keyword">let</span> name <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableAttributedString</span>(string: <span class="hljs-string">&quot;anwei20 &quot;</span>, attributes: [<br />            .font: <span class="hljs-type">UIFont</span>.boldSystemFont(ofSize: <span class="hljs-number">30</span>),<br />            .foregroundColor: <span class="hljs-type">UIColor</span>.black<br />        ])<br />        content.append(name)<br />        <br />        <span class="hljs-keyword">let</span> message <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableAttributedString</span>(string: <span class="hljs-string">&quot;戴佩妮創作的天花版的星星<span class="hljs-subst">\n</span>&quot;</span>, attributes: [<br />            .font: <span class="hljs-type">UIFont</span>.systemFont(ofSize: <span class="hljs-number">18</span>),<br />            .foregroundColor: <span class="hljs-type">UIColor</span>.gray<br />        ])<br />        content.append(message)<br />        <br />        <span class="hljs-keyword">let</span> paragraphStyle <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableParagraphStyle</span>()<br />        paragraphStyle.lineSpacing <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />        <span class="hljs-keyword">let</span> lyrics <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableAttributedString</span>(string: <span class="hljs-string">&quot;看你從没看過的風景 躲没躲過的大雨 創造一個天晴 避開你最討厭的擁擠 你最害怕的猜疑 好好喘口氣&quot;</span>, attributes: [<br />            .font: <span class="hljs-type">UIFont</span>.systemFont(ofSize: <span class="hljs-number">14</span>),<br />            .foregroundColor: <span class="hljs-type">UIColor</span>.systemPink,<br />            .backgroundColor: <span class="hljs-type">UIColor</span>.cyan,<br />            .paragraphStyle: paragraphStyle<br />        ])<br />        content.append(lyrics)<br />        <br />        label.attributedText <span class="hljs-operator">=</span> content<br />   }<br />}</span></pre><figure name="757b" id="757b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*hxZz_p9w-Xi1OnyjingHnA.png" data-width="1400" data-height="2700" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*hxZz_p9w-Xi1OnyjingHnA.png"></figure><p name="dd94" id="dd94" class="graf graf--p graf-after--figure">當 NSMutableAttributedString 的文字有不同大小時，預設將對齊文字底部，因此上圖的 <code class="markup--code markup--p-code">anwei20</code> &amp; <code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>底部對齊。</p><p name="c94d" id="c94d" class="graf graf--p graf-after--p">不過我們也可以透過 baselineOffset 微調整對齊，比方以下例子將讓<code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>向上移動，實現 <code class="markup--code markup--p-code">anwei20</code> &amp; <code class="markup--code markup--p-code">戴佩妮創作的天花版的星星</code>置中對齊的效果。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1aae" id="1aae" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> message <span class="hljs-operator">=</span> <span class="hljs-type">NSMutableAttributedString</span>(string: <span class="hljs-string">&quot;戴佩妮創作的天花版的星星<span class="hljs-subst">\n</span>&quot;</span>, attributes: [<br />            .font: <span class="hljs-type">UIFont</span>.systemFont(ofSize: <span class="hljs-number">18</span>),<br />            .foregroundColor: <span class="hljs-type">UIColor</span>.gray,<br />            .baselineOffset: <span class="hljs-number">4</span><br />])</span></pre><figure name="f6d0" id="f6d0" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*Pmhz4BvPM8XgcAnpzCDOOA.png" data-width="1400" data-height="2700" src="https://cdn-images-1.medium.com/max/800/1*Pmhz4BvPM8XgcAnpzCDOOA.png"></figure><figure name="9b09" id="9b09" class="graf graf--figure graf--iframe graf-after--figure"><iframe src="https://www.youtube.com/embed/KfZ4Ey2-0ao?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe></figure><h3 name="74d7" id="74d7" class="graf graf--h3 graf-after--figure">作品集</h3><div name="c493" id="c493" class="graf graf--mixtapeEmbed graf-after--h3 graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A3%E2%91%A1%E5%88%A9%E7%94%A8-attributedstring-%E5%AF%A6%E7%8F%BE%E5%A4%9A%E7%A8%AE%E6%A8%A3%E5%BC%8F%E7%B5%84%E5%90%88%E7%9A%84%E6%96%87%E5%AD%97-326942dd0db1" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A3%E2%91%A1%E5%88%A9%E7%94%A8-attributedstring-%E5%AF%A6%E7%8F%BE%E5%A4%9A%E7%A8%AE%E6%A8%A3%E5%BC%8F%E7%B5%84%E5%90%88%E7%9A%84%E6%96%87%E5%AD%97-326942dd0db1" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A3%E2%91%A1%E5%88%A9%E7%94%A8-attributedstring-%E5%AF%A6%E7%8F%BE%E5%A4%9A%E7%A8%AE%E6%A8%A3%E5%BC%8F%E7%B5%84%E5%90%88%E7%9A%84%E6%96%87%E5%AD%97-326942dd0db1"><strong class="markup--strong markup--mixtapeEmbed-strong">④②利用 AttributedString 實現多種樣式組合的文字</strong><br><em class="markup--em markup--mixtapeEmbed-em">ft. Ninja Turtles</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A3%E2%91%A1%E5%88%A9%E7%94%A8-attributedstring-%E5%AF%A6%E7%8F%BE%E5%A4%9A%E7%A8%AE%E6%A8%A3%E5%BC%8F%E7%B5%84%E5%90%88%E7%9A%84%E6%96%87%E5%AD%97-326942dd0db1" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="90518f14aa28c6bbf904bf0b45723070" data-thumbnail-img-id="1*XD-5gxRMBbwrwcM5kKOSGQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*XD-5gxRMBbwrwcM5kKOSGQ.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/dba0794c09de"><time class="dt-published" datetime="2022-04-09T16:46:09.057Z">April 9, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-attributedstring-%E6%88%96-nsattributedstring-%E5%AF%A6%E7%8F%BE%E5%A4%9A%E7%A8%AE%E6%A8%A3%E5%BC%8F%E7%B5%84%E5%90%88%E7%9A%84%E6%96%87%E5%AD%97-dba0794c09de" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>