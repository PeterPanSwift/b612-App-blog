<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 UIGraphicsImageRenderer 裁切圖片</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 UIGraphicsImageRenderer 裁切圖片</h1>
</header>
<section data-field="subtitle" class="p-summary">
利用 UIGraphicsImageRenderer 我們可以裁切圖片，從圖片裡裁切出我們喜歡的區塊，比方從以下圖片裁切出可愛的小彼得。
</section>
<section data-field="body" class="e-content">
<section name="5be5" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5797" id="5797" class="graf graf--h3 graf--leading graf--title">利用 UIGraphicsImageRenderer 裁切圖片</h3><p name="ffbc" id="ffbc" class="graf graf--p graf-after--h3">利用 UIGraphicsImageRenderer 搭配 UIImage 的 draw(at:) ，我們可以從圖片裡裁切出喜歡的區塊，比方從以下圖片裁切出可愛的小彼得。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="ccd7" id="ccd7" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 57.235%;"><img class="graf-image" data-image-id="1*0Xp4v0Y1-Z-h4Ih3i-d4Dg.jpeg" data-width="4032" data-height="3024" src="https://cdn-images-1.medium.com/max/800/1*0Xp4v0Y1-Z-h4Ih3i-d4Dg.jpeg"></figure><figure name="8b97" id="8b97" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 42.765%;"><img class="graf-image" data-image-id="1*TYIYIM-pYuVeG9Q3ZRcrig.jpeg" data-width="494" data-height="496" src="https://cdn-images-1.medium.com/max/600/1*TYIYIM-pYuVeG9Q3ZRcrig.jpeg"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="0b6d" id="0b6d" class="graf graf--p graf-after--figure">程式範例如下</p><pre name="ad60" id="ad60" class="graf graf--pre graf-after--p">class ViewController: UIViewController {</pre><pre name="479c" id="479c" class="graf graf--pre graf-after--pre">   @IBOutlet weak var imageView: UIImageView!</pre><pre name="3e6f" id="3e6f" class="graf graf--pre graf-after--pre">   override func viewDidLoad() {</pre><pre name="dabd" id="dabd" class="graf graf--pre graf-after--pre">      super.viewDidLoad()</pre><pre name="0148" id="0148" class="graf graf--pre graf-after--pre">      if let originalImage = UIImage(named: &quot;peter&quot;) {</pre><pre name="1c5a" id="1c5a" class="graf graf--pre graf-after--pre">         let width = originalImage.size.width / 2</pre><pre name="5528" id="5528" class="graf graf--pre graf-after--pre">         <strong class="markup--strong markup--pre-strong">let renderer = UIGraphicsImageRenderer(size: CGSize(width: width, height: width))</strong></pre><pre name="8f5b" id="8f5b" class="graf graf--pre graf-after--pre">         let x = -(originalImage.size.width - width) / 2</pre><pre name="530d" id="530d" class="graf graf--pre graf-after--pre">         let y = -(originalImage.size.height - width) / 2</pre><pre name="8ee6" id="8ee6" class="graf graf--pre graf-after--pre">        <strong class="markup--strong markup--pre-strong"> let image = renderer.image { (context) in</strong></pre><pre name="460f" id="460f" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">            originalImage.draw(at: CGPoint(x: x, y: y))</strong></pre><pre name="2611" id="2611" class="graf graf--pre graf-after--pre"><strong class="markup--strong markup--pre-strong">         }</strong></pre><pre name="94e9" id="94e9" class="graf graf--pre graf-after--pre">         imageView.image = image</pre><pre name="af9f" id="af9f" class="graf graf--pre graf-after--pre">      }</pre><pre name="f62e" id="f62e" class="graf graf--pre graf-after--pre">   }</pre><pre name="b8af" id="b8af" class="graf graf--pre graf-after--pre">}</pre><p name="f695" id="f695" class="graf graf--p graf-after--pre">Assets.xcassets 的圖片</p><figure name="25a0" id="25a0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*cLSByCr1crl4xVvtbyXutg.jpeg" data-width="1602" data-height="774" src="https://cdn-images-1.medium.com/max/800/1*cLSByCr1crl4xVvtbyXutg.jpeg"></figure><p name="5d7d" id="5d7d" class="graf graf--p graf-after--figure">結果</p><figure name="1ead" id="1ead" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*olDft456O04iJX2nqLVH2A.jpeg" data-width="962" data-height="1656" src="https://cdn-images-1.medium.com/max/800/1*olDft456O04iJX2nqLVH2A.jpeg"></figure><p name="13bb" id="13bb" class="graf graf--p graf-after--figure">說明</p><blockquote name="922f" id="922f" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">1. 生成 UIGraphicsImageRenderer 物件，指定<em class="markup--em markup--blockquote-em">繪製的</em>圖片大小。</strong></blockquote><p name="aed0" id="aed0" class="graf graf--p graf-after--blockquote">我們想要裁切圖片中間的正方形區塊，寬為圖片原本尺寸的一半。</p><figure name="9738" id="9738" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ALSefUe__G7NY2GcTDe5kw.jpeg" data-width="894" data-height="670" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*ALSefUe__G7NY2GcTDe5kw.jpeg"></figure><pre name="da68" id="da68" class="graf graf--pre graf-after--figure">let width = originalImage.size.width / 2</pre><pre name="7e19" id="7e19" class="graf graf--pre graf-after--pre">let renderer = UIGraphicsImageRenderer(size: CGSize(width: width, height: width))</pre><p name="99ff" id="99ff" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2 利用 UIGraphicsImageRenderer 的 function image(actions:) 生成UIImage 型別的裁切圖片。</strong></p><pre name="3659" id="3659" class="graf graf--pre graf-after--p">let x = -(originalImage.size.width - width) / 2</pre><pre name="1f96" id="1f96" class="graf graf--pre graf-after--pre">let y = -(originalImage.size.height - width) / 2</pre><pre name="6c82" id="6c82" class="graf graf--pre graf-after--pre">let image = renderer.image { (context) in</pre><pre name="1e8f" id="1e8f" class="graf graf--pre graf-after--pre">   originalImage.draw(at: CGPoint(x: x, y: y))</pre><pre name="53f9" id="53f9" class="graf graf--pre graf-after--pre">}</pre><p name="e31d" id="e31d" class="graf graf--p graf-after--pre">function image(actions:) 的宣告如下</p><pre name="f9d3" id="f9d3" class="graf graf--pre graf-after--p">func image(actions: (UIGraphicsImageRendererContext) -&gt; Void) -&gt; UIImage</pre><div name="d64b" id="d64b" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649230-image" data-href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649230-image" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649230-image"><strong class="markup--strong markup--mixtapeEmbed-strong">image(actions:) - UIGraphicsImageRenderer | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649230-image" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="e57226cf7526ddd83477f9c50fc57f31"></a></div><p name="6e07" id="6e07" class="graf graf--p graf-after--mixtapeEmbed">我們在參數 actions 的 closure 裡呼叫 UIImage 的 draw(at:) 繪製圖片。</p><pre name="77bf" id="77bf" class="graf graf--pre graf-after--p">func draw(at point: CGPoint)</pre><div name="9af0" id="9af0" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/uikit/uiimage/1624132-draw" data-href="https://developer.apple.com/documentation/uikit/uiimage/1624132-draw" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uiimage/1624132-draw"><strong class="markup--strong markup--mixtapeEmbed-strong">draw(at:) — UIImage | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">This method draws the entire image in the current graphics context, respecting the image’s orientation setting. In the…</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uiimage/1624132-draw" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="946662a1e2cf00d957fa34c84408f6e0"></a></div><p name="e218" id="e218" class="graf graf--p graf-after--mixtapeEmbed">為什麼我們能裁切出圖片的某個區塊呢 ? 關鍵就在我們傳入的 point 座標。我們可參考以下的圖片了解背後的原理。</p><figure name="2edd" id="2edd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_NxcNLZAEUizWWQYERVu7A.jpeg" data-width="570" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*_NxcNLZAEUizWWQYERVu7A.jpeg"></figure><p name="2e98" id="2e98" class="graf graf--p graf-after--figure">紅色框框代表我們想生成的圖片大小(當初生成 UIGraphicsImageRenderer 時指定的大小)，此框框就像一塊畫布，最後我們得到的 UIImage 圖片將是此框框顯示的內容。</p><p name="8542" id="8542" class="graf graf--p graf-after--p">當我們呼叫 draw(at:) 繪製圖片時，它將從圖片的左上角開始繪製整張圖片，並以框框的左上角當原點。由於我們傳入的座標是負數，它將從框框外的左上角開始繪製，超出框框的部分則被切掉，因此我們將得到紅色框框裡顯示的可愛小彼得 ~</p><p name="fef5" id="fef5" class="graf graf--p graf-after--p">讓我們看看底下更多的例子，更加熟練圖片裁切的技巧。</p><ul class="postList"><li name="ae0a" id="ae0a" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">從 (0, 0) 開始繪製</strong></li></ul><pre name="86b8" id="86b8" class="graf graf--pre graf-after--li">let image = renderer.image { (context) in</pre><pre name="ba10" id="ba10" class="graf graf--pre graf-after--pre">   originalImage.draw(at: .zero)</pre><pre name="c7c0" id="c7c0" class="graf graf--pre graf-after--pre">}</pre><figure name="5b79" id="5b79" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*QY8XqHz9XMvozXqDefD5iQ.jpeg" data-width="962" data-height="1656" src="https://cdn-images-1.medium.com/max/800/1*QY8XqHz9XMvozXqDefD5iQ.jpeg"></figure><p name="08c7" id="08c7" class="graf graf--p graf-after--figure">2 從框框內 (100, 100) 的位置開始繪製圖片。</p><pre name="b022" id="b022" class="graf graf--pre graf-after--p">let image = renderer.image { (context) in</pre><pre name="d337" id="d337" class="graf graf--pre graf-after--pre">   originalImage.draw(at: CGPoint(x: 100, y: 100))</pre><pre name="a8c6" id="a8c6" class="graf graf--pre graf-after--pre">}</pre><figure name="e383" id="e383" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*JNGiun67apH2JIcQcVlm4g.jpeg" data-width="962" data-height="1656" src="https://cdn-images-1.medium.com/max/800/1*JNGiun67apH2JIcQcVlm4g.jpeg"><figcaption class="imageCaption">image view 的背景顏色為黃色</figcaption></figure><p name="3b07" id="3b07" class="graf graf--p graf-after--figure">3 傳入代表長方形的 CGRect 指定繪圖的範圍，從框框的左上角 (0, 0) 開始畫，將整張圖縮放變形到 (400, 800) 的大小。</p><pre name="e54b" id="e54b" class="graf graf--pre graf-after--p">let image = renderer.image { (context) in</pre><pre name="dff2" id="dff2" class="graf graf--pre graf-after--pre">   originalImage.draw(in: CGRect(x: 0, y: 0, width: 400, height: 800))</pre><pre name="524b" id="524b" class="graf graf--pre graf-after--pre">}</pre><div name="4de9" id="4de9" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/uikit/uiimage/1624092-draw" data-href="https://developer.apple.com/documentation/uikit/uiimage/1624092-draw" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uiimage/1624092-draw"><strong class="markup--strong markup--mixtapeEmbed-strong">draw(in:) - UIImage | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">This method draws the entire image in the current graphics context, respecting the image&#39;s orientation setting. In the…</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uiimage/1624092-draw" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="91f875a1b59f533983b4d0ca613363d5"></a></div><p name="7199" id="7199" class="graf graf--p graf-after--mixtapeEmbed">由於 (400, 800) 跟原來的圖片比例差很多，因此圖片的樣子慘不忍睹，變形的程度十分嚴重。</p><figure name="2d3c" id="2d3c" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*J1C9QLSn9ffQYbV835P6AQ.jpeg" data-width="962" data-height="1656" src="https://cdn-images-1.medium.com/max/800/1*J1C9QLSn9ffQYbV835P6AQ.jpeg"><figcaption class="imageCaption">image view 的背景顏色為黃色</figcaption></figure></div></div></section><section name="afbb" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><p name="a05e" id="a05e" class="graf graf--p graf--leading">補充</p><p name="33a7" id="33a7" class="graf graf--p graf-after--p">剛剛的例子我們利用 UIGraphicsImageRenderer 的 function image(actions:) 生成 UIImage 型別的裁切圖片，不然如果想要生成 Data ，則可參考以下產生 jpeg &amp; png data 的 function。</p><div name="1a18" id="1a18" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649234-jpegdata" data-href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649234-jpegdata" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649234-jpegdata"><strong class="markup--strong markup--mixtapeEmbed-strong">jpegData(withCompressionQuality:actions:) - UIGraphicsImageRenderer | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649234-jpegdata" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="ecee9c255a4a23aa2172ead267ec97c7"></a></div><div name="f7ec" id="f7ec" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649233-pngdata" data-href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649233-pngdata" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649233-pngdata"><strong class="markup--strong markup--mixtapeEmbed-strong">pngData(actions:) - UIGraphicsImageRenderer | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uigraphicsimagerenderer/1649233-pngdata" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="f4d91692f1fc6187a3cd26fc75e9b9f9"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/a41fe3d711bb"><time class="dt-published" datetime="2019-05-28T14:03:14.411Z">May 28, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-uigraphicsimagerenderer-%E8%A3%81%E5%88%87%E5%9C%96%E7%89%87-a41fe3d711bb" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>