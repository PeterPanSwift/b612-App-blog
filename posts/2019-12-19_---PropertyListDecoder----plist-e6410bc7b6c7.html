<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 PropertyListDecoder 解析 plist</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 PropertyListDecoder 解析 plist</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們有時會建立 plist 檔儲存 App 需要存取的固定資料，比方開發訂飲料 App 時，將飲料的 menu 存在 plist 檔，然後再利用 Swift 程式讀取，顯示在表格或 picker 上。
</section>
<section data-field="body" class="e-content">
<section name="8fcf" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="7bb5" id="7bb5" class="graf graf--h3 graf--leading graf--title">利用 PropertyListDecoder 解析 plist</h3><p name="fa62" id="fa62" class="graf graf--p graf-after--h3">開發 iOS App 時，我們有時會建立 plist 檔儲存 App 需要存取的固定資料，比方開發訂飲料 App 時，將飲料的 menu 存在 plist 檔，然後再利用 Swift 程式讀取，顯示在表格或 picker 上。</p><p name="cd11" id="cd11" class="graf graf--p graf-after--p">不過要如何將 plist 檔的內容變成我們自訂的型別呢 ? 透過 PropertyListDecoder 的幫忙，只要幾行程式就能搞定，接下來就讓我們親手實驗看看吧。</p><h3 name="b902" id="b902" class="graf graf--h3 graf-after--p">建立儲存可不可熟成紅茶飲料 menu 的 plist</h3><p name="cd7b" id="cd7b" class="graf graf--p graf-after--h3">File &gt; New &gt; File。</p><figure name="ecc8" id="ecc8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*lCwG3aefa8I73JMfjvGYdg.jpeg" data-width="1154" data-height="306" src="https://cdn-images-1.medium.com/max/800/1*lCwG3aefa8I73JMfjvGYdg.jpeg"></figure><p name="6f37" id="6f37" class="graf graf--p graf-after--figure">選擇 iOS Resources 下的 Property List。</p><figure name="43ef" id="43ef" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oZ0k9SiLoPCSjsNkJGHMaQ.jpeg" data-width="1452" data-height="1046" src="https://cdn-images-1.medium.com/max/800/1*oZ0k9SiLoPCSjsNkJGHMaQ.jpeg"></figure><p name="3f0c" id="3f0c" class="graf graf--p graf-after--figure">將 plist 取名為 Drinks。</p><figure name="dfda" id="dfda" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*vfFSCGPfsC9k4NY62ts77w.jpeg" data-width="1718" data-height="894" src="https://cdn-images-1.medium.com/max/800/1*vfFSCGPfsC9k4NY62ts77w.jpeg"></figure><h3 name="83f7" id="83f7" class="graf graf--h3 graf-after--figure">在 plist 裡輸入飲料的 menu</h3><p name="a2c3" id="a2c3" class="graf graf--p graf-after--h3">預設的 plist 如下圖所示，第一層 Root 的型別是 Dictionary。</p><figure name="5321" id="5321" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*qjcgoTg_eTpZhXugXHoynQ.jpeg" data-width="900" data-height="236" src="https://cdn-images-1.medium.com/max/800/1*qjcgoTg_eTpZhXugXHoynQ.jpeg"></figure><p name="9720" id="9720" class="graf graf--p graf-after--figure">plist 內容的第一層可以是 Array 或 Dictionary，由於我們想用 array 儲存 menu 裡的各種飲料，因此我們將 Root 的 Type 改成 Array。</p><figure name="047a" id="047a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wHo2t78lsBZS3JYNG1VzNg.jpeg" data-width="706" data-height="130" src="https://cdn-images-1.medium.com/max/800/1*wHo2t78lsBZS3JYNG1VzNg.jpeg"></figure><figure name="924a" id="924a" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*utcf_Femm5h49Riih605sw.jpeg" data-width="832" data-height="126" src="https://cdn-images-1.medium.com/max/800/1*utcf_Femm5h49Riih605sw.jpeg"></figure><p name="c5dd" id="c5dd" class="graf graf--p graf-after--figure">接著我們點選 Root 的 +，新增 array 裡的第一筆飲料資料。</p><figure name="47b9" id="47b9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wV5wNQxVggnWtee3mlf1ww.jpeg" data-width="908" data-height="182" src="https://cdn-images-1.medium.com/max/800/1*wV5wNQxVggnWtee3mlf1ww.jpeg"></figure><p name="2e66" id="2e66" class="graf graf--p graf-after--figure">我們希望飲料的資料包含名字和價錢，因此我們將它的 Type 從 String 改成可以容納多個欄位的 Dictionary。</p><figure name="51cb" id="51cb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wfoCgQDvTscbpc-8kI4_6g.jpeg" data-width="698" data-height="306" src="https://cdn-images-1.medium.com/max/800/1*wfoCgQDvTscbpc-8kI4_6g.jpeg"></figure><figure name="d7b4" id="d7b4" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*f6z1yFbTQis2N-iMx4rJzA.jpeg" data-width="814" data-height="162" src="https://cdn-images-1.medium.com/max/800/1*f6z1yFbTQis2N-iMx4rJzA.jpeg"></figure><p name="650b" id="650b" class="graf graf--p graf-after--figure">點選 Item 0 旁的三角形，讓它變成向下的三角形再點選 +，因為這樣才代表我們要新增 Dictionary 的欄位，而不是新增 array 裡的資料</p><figure name="27d2" id="27d2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xjWbrJDGnwImQxXC0eYCcg.jpeg" data-width="736" data-height="174" src="https://cdn-images-1.medium.com/max/800/1*xjWbrJDGnwImQxXC0eYCcg.jpeg"></figure><p name="b72f" id="b72f" class="graf graf--p graf-after--figure">在 Item 0 輸入熟成紅茶的資訊。</p><figure name="81b0" id="81b0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*spiYXY_UWIc73Db8116YtQ.jpeg" data-width="836" data-height="204" src="https://cdn-images-1.medium.com/max/800/1*spiYXY_UWIc73Db8116YtQ.jpeg"></figure><p name="895d" id="895d" class="graf graf--p graf-after--figure">有了第一個飲料，第二個第三個就簡單多了，因為可以使用我們最愛的複製貼上。請先點選 Item 0 旁的三角形，讓它變成向右的三角形。</p><figure name="e0cb" id="e0cb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*YWj0Jq3aLXfan-cPUNha-A.jpeg" data-width="846" data-height="146" src="https://cdn-images-1.medium.com/max/800/1*YWj0Jq3aLXfan-cPUNha-A.jpeg"></figure><p name="b991" id="b991" class="graf graf--p graf-after--figure">然後按下 cmd +c &amp; cmd + v 產生 Item 1，此時 Item 1 也會是 Dictionary，而且已經包含欄位 name &amp; price，我們只要修改內容即可。</p><figure name="a1db" id="a1db" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*O6Zme0EWAIASVX99Pto-uA.jpeg" data-width="840" data-height="248" src="https://cdn-images-1.medium.com/max/800/1*O6Zme0EWAIASVX99Pto-uA.jpeg"></figure><p name="4c62" id="4c62" class="graf graf--p graf-after--figure">以同樣的方法複製貼上，輸入 Item 2 的飲料。</p><figure name="9944" id="9944" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Uq-xqBdwOs-dq5s8Yydggw.jpeg" data-width="908" data-height="468" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*Uq-xqBdwOs-dq5s8Yydggw.jpeg"></figure><p name="e5d0" id="e5d0" class="graf graf--p graf-after--figure">可不可熟成紅茶還有很多飲料，不過彼得潘累了，我們就先用三種飲料測試吧。</p><h3 name="bf18" id="bf18" class="graf graf--h3 graf-after--p">定義 plist 內容對應的 Decodable 型別 Drink</h3><p name="e7dc" id="e7dc" class="graf graf--p graf-after--h3">為了將 plist 的內容變成自訂的型別，我們必須定義符合 plist 內容格式且遵從 protocol Decodable 的型別。定義此型別的原理跟定義 JSON 對應的資料型別類似，差別只在 plist &amp; JSON 有著不同的格式，plist 背後的格式是 XML。</p><div name="4c13" id="4c13" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 JSONDecoder 和 Codable 解析 JSON 和生成自訂型別資料</strong><br><em class="markup--em markup--mixtapeEmbed-em">抓取網路上的 JSON 資料並不是太困難的事，但是如果想要解析它，甚至是把它變成方便 App 使用的自訂型別，卻需要寫許多程式碼才能實現。因此從前一些解析 JSON 和將 JSON 變成自訂型別的第三方套件大受歡迎，不過在 Swift…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a1068ad2918bf3673e0459e185327c1a" data-thumbnail-img-id="1*l-tGFvpI-VyDff3rAGlYUQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*l-tGFvpI-VyDff3rAGlYUQ.png);"></a></div><p name="bce7" id="bce7" class="graf graf--p graf-after--mixtapeEmbed">plist 裡的 Dictionary 型別將被定義成對應的自訂型別，因此我們定義遵從 protocol Decodable 的 Drink 型別。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b7c8" id="b7c8" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Drink</span>: <span class="hljs-title class_">Decodable</span> {<br />   <br />}</span></pre><figure name="fd3b" id="fd3b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*rwZ7ACBjsS7_cOzbFKablw.jpeg" data-width="838" data-height="432" src="https://cdn-images-1.medium.com/max/800/1*rwZ7ACBjsS7_cOzbFKablw.jpeg"></figure><p name="5451" id="5451" class="graf graf--p graf-after--figure">Dictionary 的 key 將成為自訂型別 property 的名字，property 的型別則由 Dictionary value 的 Type 決定。如下圖所示，Plist 裡資料的型別有七種，這七種都可以對應到常見的 Swift 基本型別。</p><figure name="07e4" id="07e4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*KtQjBezNwpAJLgP1uVjadA.jpeg" data-width="272" data-height="310" src="https://cdn-images-1.medium.com/max/800/1*KtQjBezNwpAJLgP1uVjadA.jpeg"></figure><p name="d2e0" id="d2e0" class="graf graf--p graf-after--figure">因此我們在 Drink 裡宣告型別為 String &amp; Int 的 property name &amp; price。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="bddb" id="bddb" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Drink</span>: <span class="hljs-title class_">Decodable</span> {<br />    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> price: <span class="hljs-type">Int</span><br />}</span></pre><h3 name="958f" id="958f" class="graf graf--h3 graf-after--pre">利用 PropertyListDecoder 析解 plist</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2a47" id="2a47" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">Bundle</span>.main.url(forResource: <span class="hljs-string">&quot;Drinks&quot;</span>, withExtension: <span class="hljs-string">&quot;plist&quot;</span>)<span class="hljs-operator">!</span><br />        <br /><span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">Data</span>(contentsOf: url), <br />   <span class="hljs-keyword">let</span> drinks <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">PropertyListDecoder</span>().decode([<span class="hljs-type">Drink</span>].<span class="hljs-keyword">self</span>, from: data) {<br />   <span class="hljs-built_in">print</span>(drinks)<br />}</span></pre><p name="9461" id="9461" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="8cbf" id="8cbf" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">Bundle</span>.main.url(forResource: <span class="hljs-string">&quot;Drinks&quot;</span>, withExtension: <span class="hljs-string">&quot;plist&quot;</span>)<span class="hljs-operator">!</span></span></pre><p name="2172" id="2172" class="graf graf--p graf-after--pre">取得 Drinks.plist 檔的 URL。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="859f" id="859f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">Data</span>(contentsOf: url), <br />   <span class="hljs-keyword">let</span> drinks <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-type">PropertyListDecoder</span>().decode([<span class="hljs-type">Drink</span>].<span class="hljs-keyword">self</span>, from: data) {<br />   <span class="hljs-built_in">print</span>(drinks)<br />}</span></pre><p name="fd4a" id="fd4a" class="graf graf--p graf-after--pre">從 URL 讀取 Data 後，利用 PropertyListDecoder 的 decode function 將 Data 變成型別 [Drink] 的 array。decode function 的宣告如下，第一個參數 type 控制轉換後的資料型別，因此我們傳入<code class="markup--code markup--p-code"> [Drink].self</code> 將得到型別 [Drink] 的飲料清單。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="43ae" id="43ae" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">decode</span>&lt;<span class="hljs-type">T</span>&gt;(<span class="hljs-keyword">_</span> <span class="hljs-params">type</span>: <span class="hljs-type">T</span>.<span class="hljs-keyword">Type</span>, <span class="hljs-params">from</span> <span class="hljs-params">data</span>: <span class="hljs-type">Data</span>) <span class="hljs-keyword">throws</span> -&gt; <span class="hljs-type">T</span> <span class="hljs-keyword">where</span> <span class="hljs-type">T</span> : <span class="hljs-type">Decodable</span></span></pre><div name="9519" id="9519" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/foundation/propertylistdecoder/2895397-decode" data-href="https://developer.apple.com/documentation/foundation/propertylistdecoder/2895397-decode" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/propertylistdecoder/2895397-decode"><strong class="markup--strong markup--mixtapeEmbed-strong">decode(_:from:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns a value of the specified type by decoding a property list using the default property list format.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/propertylistdecoder/2895397-decode" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="20e848bb317a6ce30faf3edb3bb334cb" data-thumbnail-img-id="0*a5lBQCv2R_WAX-tb" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*a5lBQCv2R_WAX-tb);"></a></div><h3 name="f7c9" id="f7c9" class="graf graf--h3 graf-after--mixtapeEmbed">結果</h3><figure name="8913" id="8913" class="graf graf--figure graf-after--h3 graf--trailing"><img class="graf-image" data-image-id="1*FnjaGuQLwELVRaTj26LIAw.jpeg" data-width="1276" data-height="526" src="https://cdn-images-1.medium.com/max/800/1*FnjaGuQLwELVRaTj26LIAw.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/e6410bc7b6c7"><time class="dt-published" datetime="2019-12-19T17:44:06.599Z">December 19, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-propertylistdecoder-%E8%A7%A3%E6%9E%90-plist-e6410bc7b6c7" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>