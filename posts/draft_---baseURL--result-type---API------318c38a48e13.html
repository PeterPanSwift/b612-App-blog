<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>搭配 baseURL ，result type 的 API 程式範例</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">搭配 baseURL ，result type 的 API 程式範例</h1>
</header>
<section data-field="body" class="e-content">
<section name="5625" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="0f43" id="0f43" class="graf graf--h3 graf--leading graf--title">搭配 baseURL ，result type 的 API 程式範例</h3><p name="5ca4" id="5ca4" class="graf graf--p graf--empty graf-after--h3"><br></p><pre name="4f26" id="4f26" class="graf graf--pre graf-after--p">import UIKit</pre><pre name="0adc" id="0adc" class="graf graf--pre graf-after--pre">extension URL {<br>    func withQueries(_ queries: [String: String]) -&gt; URL? {<br>        var components = URLComponents(url: self, resolvingAgainstBaseURL: true)<br>        components?.queryItems = queries.map {<br>            URLQueryItem(name: $0.0, value: $0.1)<br>        }<br>        return components?.url<br>    }<br>}</pre><pre name="1a3d" id="1a3d" class="graf graf--pre graf-after--pre">enum MovieServiceError: Error {<br>    case invalidUrl<br>    case requestFailed(Error)<br>    case invalidData<br>    case invalidResponse<br>}</pre><pre name="df7a" id="df7a" class="graf graf--pre graf-after--pre">struct Movie: Decodable {<br>    var title: String?<br>    var voteAverage: Float?<br>    var overview: String?<br>}</pre><pre name="62a7" id="62a7" class="graf graf--pre graf-after--pre">struct NowPlayingMovie: Decodable {<br>    var page: Int<br>    var totalPages: Int<br>    var results: [Movie]<br>}</pre><pre name="23be" id="23be" class="graf graf--pre graf-after--pre">struct PopularMovie: Decodable {<br>    var page: Int<br>    var totalPages: Int<br>    var results: [Movie]<br>}</pre><pre name="13fb" id="13fb" class="graf graf--pre graf-after--pre">class MovieService {<br>    static let shared = MovieService()<br>    let baseURL = URL(string: &quot;<a href="https://api.themoviedb.org" data-href="https://api.themoviedb.org" class="markup--anchor markup--pre-anchor" rel="nofollow noopener" target="_blank">https://api.themoviedb.org</a>&quot;)<br>    let apiKey = &quot;b17c1f1148864e6cc74057601a2df8e5&quot;<br>    let version = 3<br>    let language = &quot;zh-TW&quot;<br>    <br>    <br>    <br>    private func processData&lt;T: Decodable&gt;(data: Data?, response: URLResponse?, error: Error?, dataType: T.Type) -&gt; Result&lt;T, MovieServiceError&gt;  {<br>        <br>        if let error = error {<br>            return .failure(.requestFailed(error))<br>        }<br>        guard let httpResponse = response as? HTTPURLResponse, httpResponse.statusCode == 200 else {<br>            return .failure(.invalidResponse)<br>        }<br>        <br>        let decoder = JSONDecoder()<br>        decoder.keyDecodingStrategy = .convertFromSnakeCase<br>        <br>        guard let data = data, let decodeData = try? decoder.decode(dataType, from: data)  else {<br>            return .failure(.invalidData)<br>        }<br>        return .success(decodeData)<br>    }<br>    <br>    func getPopularMovie(page: Int, completion: <a href="http://twitter.com/escaping" data-href="http://twitter.com/escaping" class="markup--anchor markup--pre-anchor" title="Twitter profile for @escaping" rel="noopener" target="_blank">@escaping</a> (Result&lt;PopularMovie, MovieServiceError&gt;) -&gt; Void ) {<br>        let queries = [<br>            &quot;api_key&quot;: &quot;\(apiKey)&quot;,<br>            &quot;page&quot;: &quot;\(page)&quot;,<br>            &quot;language&quot;: &quot;\(language)&quot;<br>        ]<br>        guard let url = baseURL?.appendingPathComponent(&quot;\(version)/movie/popular&quot;).withQueries(queries) else {<br>            completion(.failure(.invalidUrl))<br>            return<br>        }<br>        URLSession.shared.dataTask(with: url) { (data, response, error) in<br>            let result = self.processData(data: data, response: response, error: error, dataType: PopularMovie.self)<br>            completion(result)<br>        }.resume()<br>    }<br>    <br>    func getNowPlayingMovie(page: Int, completion: <a href="http://twitter.com/escaping" data-href="http://twitter.com/escaping" class="markup--anchor markup--pre-anchor" title="Twitter profile for @escaping" rel="noopener" target="_blank">@escaping</a> (Result&lt;NowPlayingMovie, MovieServiceError&gt;) -&gt; Void ) {<br>        let queries = [<br>            &quot;api_key&quot;: &quot;\(apiKey)&quot;,<br>            &quot;page&quot;: &quot;\(page)&quot;,<br>            &quot;language&quot;: &quot;\(language)&quot;<br>        ]<br>        guard let url = baseURL?.appendingPathComponent(&quot;\(version)/movie/now_playing&quot;).withQueries(queries) else {<br>            completion(.failure(.invalidUrl))<br>            return<br>        }<br>        URLSession.shared.dataTask(with: url) { (data, response, error) in<br>            <br>            let result = self.processData(data: data, response: response, error: error, dataType: NowPlayingMovie.self)<br>            completion(result)<br>            <br>        }.resume()<br>    }<br>}</pre><pre name="35f1" id="35f1" class="graf graf--pre graf-after--pre">MovieService.shared.getNowPlayingMovie(page: 1) { (result) in<br>    switch result {<br>    case .success(let nowPlaying):<br>        print(nowPlaying.results.first?.title)<br>    case .failure(let error):<br>        print(error)<br>    }<br>}</pre><pre name="8e8c" id="8e8c" class="graf graf--pre graf-after--pre">MovieService.shared.getPopularMovie(page: 1) { (result) in<br>    switch result {<br>    case .success(let popularMovie):<br>        print(popularMovie.results.first?.title)<br>    case .failure(let error):<br>        print(error)<br>    }<br>}</pre><p name="eb96" id="eb96" class="graf graf--p graf--empty graf-after--pre graf--trailing"><br></p></div></div></section>
</section>
<footer><p><a href="https://medium.com/p/318c38a48e13">View original.</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>