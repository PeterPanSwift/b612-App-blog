<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>SwiftUI @State 的進階解析</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">SwiftUI @State 的進階解析</h1>
</header>
<section data-field="subtitle" class="p-summary">
在之前的文章裡，我們認識了 SwiftUI @State 的基本用法，接下來讓我們認識更多關於 @State 的故事。
</section>
<section data-field="body" class="e-content">
<section name="4325" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="3ffb" id="3ffb" class="graf graf--h3 graf--leading graf--title">SwiftUI @State 的進階解析</h3><figure name="8a62" id="8a62" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*1OFqEL6FA2sbdESKGBvSBw.png" data-width="1748" data-height="990" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*1OFqEL6FA2sbdESKGBvSBw.png"></figure><p name="eb5e" id="eb5e" class="graf graf--p graf-after--figure">在之前的文章裡，我們認識了 SwiftUI @State 的基本用法，接下來讓我們認識更多關於 @State 的故事。</p><div name="f83e" id="f83e" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E7%94%A8%E7%8B%80%E6%85%8B%E8%A8%AD%E8%A8%88-swiftui-%E7%95%AB%E9%9D%A2-%E8%AA%8D%E8%AD%98-state-property-binding-27fea6885ead" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E7%94%A8%E7%8B%80%E6%85%8B%E8%A8%AD%E8%A8%88-swiftui-%E7%95%AB%E9%9D%A2-%E8%AA%8D%E8%AD%98-state-property-binding-27fea6885ead" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E7%94%A8%E7%8B%80%E6%85%8B%E8%A8%AD%E8%A8%88-swiftui-%E7%95%AB%E9%9D%A2-%E8%AA%8D%E8%AD%98-state-property-binding-27fea6885ead"><strong class="markup--strong markup--mixtapeEmbed-strong">用狀態設計 SwiftUI 畫面 — 認識 @State property，binding &amp; Toggle</strong><br><em class="markup--em markup--mixtapeEmbed-em">SwiftUI 用狀態決定如何顯示和更新畫面，因此它的很多 UI 元件都跟狀態有關。接下來我們就以下雨時顯示孫燕姿的壞天氣，放晴時顯示盧廣仲的我愛你歌詞為例，說明狀態如何深深影響著 SwiftUI 的畫面。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E7%94%A8%E7%8B%80%E6%85%8B%E8%A8%AD%E8%A8%88-swiftui-%E7%95%AB%E9%9D%A2-%E8%AA%8D%E8%AD%98-state-property-binding-27fea6885ead" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3eccc537cf5f5874156de70bdd4ed7ca" data-thumbnail-img-id="1*ba5aE2HYNpyxBClu7CfRAw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*ba5aE2HYNpyxBClu7CfRAw.jpeg);"></a></div><h3 name="1a08" id="1a08" class="graf graf--h3 graf-after--mixtapeEmbed">State 搭配 Int，Double，String，Bool，Array 等基本的 value type</h3><ul class="postList"><li name="6173" id="6173" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">搭配 Int</strong></li></ul><pre name="a444" id="a444" class="graf graf--pre graf-after--li">struct ContentView: View {<br><strong class="markup--strong markup--pre-strong">    </strong><a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@State</strong></a><strong class="markup--strong markup--pre-strong"> private var number = 1<br></strong>    <br>    var body: some View {<br>        Button(action: {<br>            number = Int.random(in: 1...6)<br>        }, label: {<br>            Image(systemName: &quot;die.face.\(number).fill&quot;)<br>                .resizable()<br>                .scaledToFit()<br>        })<br>    }<br>}</pre></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="08e1" id="08e1" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--pre" style="width: 50.315%;"><img class="graf-image" data-image-id="1*ohL8qxuEm4PHzgTlSl3FBw.png" data-width="504" data-height="1052" src="https://cdn-images-1.medium.com/max/600/1*ohL8qxuEm4PHzgTlSl3FBw.png"></figure><figure name="b5d2" id="b5d2" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.685%;"><img class="graf-image" data-image-id="1*m-ladiz172pcr-8j7HR_Yg.png" data-width="488" data-height="1032" src="https://cdn-images-1.medium.com/max/600/1*m-ladiz172pcr-8j7HR_Yg.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><ul class="postList"><li name="0c71" id="0c71" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">搭配 Array</strong></li></ul><pre name="13e9" id="13e9" class="graf graf--pre graf-after--li">struct ContentView: View {<br><strong class="markup--strong markup--pre-strong">    </strong><a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@State</strong></a><strong class="markup--strong markup--pre-strong"> private var numbers = [Int]()<br></strong>    <br>    var body: some View {<br>        <br>        VStack {<br>            Button(action: {<br>                numbers.insert(Int.random(in: 1...100), at: 0)<br>            }, label: {<br>                Image(systemName: &quot;plus.circle.fill&quot;)<br>                    .resizable()<br>                    .frame(width: 100, height: 100)<br>            })<br>            List(numbers, id: \.self) { number in<br>                Text(&quot;\(number)&quot;)<br>            }<br>        }<br>    }<br>}</pre></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="be43" id="be43" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--pre" style="width: 48.337%;"><img class="graf-image" data-image-id="1*AdgLcqDaeqD-Z0zW6rO44Q.png" data-width="488" data-height="1050" src="https://cdn-images-1.medium.com/max/600/1*AdgLcqDaeqD-Z0zW6rO44Q.png"></figure><figure name="343a" id="343a" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 51.663%;"><img class="graf-image" data-image-id="1*ONMcQWG1SRdabWFLxzT-Zw.png" data-width="514" data-height="1034" src="https://cdn-images-1.medium.com/max/800/1*ONMcQWG1SRdabWFLxzT-Zw.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="1e7b" id="1e7b" class="graf graf--h3 graf-after--figure">State 搭配複雜的型別，比方自訂的 struct 型別</h3><p name="3604" id="3604" class="graf graf--p graf-after--h3">比方撲克牌 Card 的定義如下</p><pre name="f105" id="f105" class="graf graf--pre graf-after--p">struct Card {<br>    var suit: String<br>    var rank: String<br>    <br>    var isRed: Bool {<br>        suit == &quot;♥︎&quot; || suit == &quot;♦︎&quot;<br>    }<br>}</pre><p name="c8bf" id="c8bf" class="graf graf--p graf-after--pre">State 搭配 struct 型別 Card。</p><pre name="0d5a" id="0d5a" class="graf graf--pre graf-after--p">struct ContentView: View {<br><strong class="markup--strong markup--pre-strong">    </strong><a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@State</strong></a><strong class="markup--strong markup--pre-strong"> private var card = Card(suit: &quot;♠︎&quot;, rank: &quot;A&quot;)<br></strong>    <br>    <br>    var body: some View {<br>        <br>        VStack {<br>            Text(card.rank)<br>                .foregroundColor(card.isRed ? .red : .black)<br>            Text(card.suit)<br>                .foregroundColor(card.isRed ? .red : .black)<br>            Button(action: {<br>                card.rank = [&quot;A&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;J&quot;, &quot;Q&quot;, &quot;K&quot;].randomElement()!<br>            }, label: {<br>                Text(&quot;random rank&quot;)<br>            })<br>            Button(action: {<br>                card.suit = [&quot;♠︎&quot;, &quot;♣︎&quot;, &quot;♥︎&quot;, &quot;♦︎&quot;].randomElement()!<br>            }, label: {<br>                Text(&quot;random suit&quot;)<br>            })<br>        }<br>        .font(.largeTitle)<br>    }<br>}</pre><p name="3d3a" id="3d3a" class="graf graf--p graf-after--pre">點選 Random Rank 隨機牌的數字。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="16d7" id="16d7" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.209%;"><img class="graf-image" data-image-id="1*ozXimXvU6PDjDZh4IIIsDg.png" data-width="494" data-height="1030" src="https://cdn-images-1.medium.com/max/600/1*ozXimXvU6PDjDZh4IIIsDg.png"></figure><figure name="a49a" id="a49a" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.791%;"><img class="graf-image" data-image-id="1*gom1pS0XZA8IJ0Uuaovuog.png" data-width="486" data-height="1022" src="https://cdn-images-1.medium.com/max/600/1*gom1pS0XZA8IJ0Uuaovuog.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="569a" id="569a" class="graf graf--p graf-after--figure">點選 Random suit 隨機牌的花色。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="338b" id="338b" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50.204%;"><img class="graf-image" data-image-id="1*7-lR9W2qkXGrepyycTf9Cg.png" data-width="508" data-height="1032" src="https://cdn-images-1.medium.com/max/600/1*7-lR9W2qkXGrepyycTf9Cg.png"></figure><figure name="c28c" id="c28c" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 49.796%;"><img class="graf-image" data-image-id="1*BSFnmtuwyRudxtSM2XH5Kw.png" data-width="508" data-height="1042" src="https://cdn-images-1.medium.com/max/600/1*BSFnmtuwyRudxtSM2XH5Kw.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="15cb" id="15cb" class="graf graf--h3 graf-after--figure">State 搭配 reference type， 比方自訂的 class 型別</h3><p name="d259" id="d259" class="graf graf--p graf-after--h3">通常 State 會搭配 value type，因為搭配 reference type 會產生很特別的結果，比方我們將剛剛例子的 Card 改以 class 定義。</p><pre name="0adb" id="0adb" class="graf graf--pre graf-after--p">class Card {<br>    var suit: String<br>    var rank: String<br>    var isRed: Bool {<br>        suit == &quot;♥︎&quot; || suit == &quot;♦︎&quot;<br>    }<br>    <br>    internal init(suit: String, rank: String) {<br>        self.suit = suit<br>        self.rank = rank<br>    }<br>}</pre><p name="7c43" id="7c43" class="graf graf--p graf-after--pre">此時我們的夢想成真了。我們的牌永遠是黑桃 A，不管我們按了幾次 random rank 或 random suit。</p><figure name="c1a6" id="c1a6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ykD8oPmqw0Ycwpdg2tB23w.png" data-width="474" data-height="1016" src="https://cdn-images-1.medium.com/max/800/1*ykD8oPmqw0Ycwpdg2tB23w.png"></figure><p name="0072" id="0072" class="graf graf--p graf-after--figure">當我們點選 random rank 或 random suit 時，card 的內容其實真的有改變，只是畫面沒有更新，所以我們沒看到。</p><p name="e6d5" id="e6d5" class="graf graf--p graf-after--p">為什麼畫面不會更新呢? 因為當 State 搭配的資料是 reference type 時，它儲存的是資料的記憶體位置。因此要資料的記憶體位置改變，它才會覺得資料有改變，此時才會更新畫面。</p><p name="0edb" id="0edb" class="graf graf--p graf-after--p">因此若我們修改剛剛的程式，在點選 button 時重新生成一個 Card 存入變數 card，即可讓 card 儲存的記憶體位置改變，觸發畫面更新。</p><pre name="1442" id="1442" class="graf graf--pre graf-after--p">struct ContentView: View {<br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var card = Card(suit: &quot;♠︎&quot;, rank: &quot;A&quot;)<br>    <br>    <br>    var body: some View {<br>        <br>        VStack {<br>            Text(card.rank)<br>                .foregroundColor(card.isRed ? .red : .black)<br>            Text(card.suit)<br>                .foregroundColor(card.isRed ? .red : .black)<br>            Button(action: {<br><strong class="markup--strong markup--pre-strong">                card = Card(suit: card.suit, rank: [&quot;A&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;, &quot;J&quot;, &quot;Q&quot;, &quot;K&quot;].randomElement()!)<br></strong>            }, label: {<br>                Text(&quot;random rank&quot;)<br>            })<br>            Button(action: {<br><strong class="markup--strong markup--pre-strong">                card = Card(suit:  [&quot;♠︎&quot;, &quot;♣︎&quot;, &quot;♥︎&quot;, &quot;♦︎&quot;].randomElement()!, rank: card.rank)<br></strong>                   <br>            }, label: {<br>                Text(&quot;random suit&quot;)<br>            })<br>        }<br>        .font(.largeTitle)<br>    }<br>}</pre><p name="c7bd" id="c7bd" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">實驗:</strong></p><ol class="postList"><li name="54f5" id="54f5" class="graf graf--li graf-after--p">一開始顯示黑桃 A。</li><li name="bba8" id="bba8" class="graf graf--li graf-after--li">點選 random rank，rank 變成 6。</li><li name="ccd3" id="ccd3" class="graf graf--li graf-after--li">點選 random suit，suit 變成愛心。</li></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"></ol><figure name="e872" id="e872" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--li" style="width: 33.357%;"><img class="graf-image" data-image-id="1*L-ecaYD73iKrTacCoMDC-Q.png" data-width="494" data-height="1032" src="https://cdn-images-1.medium.com/max/400/1*L-ecaYD73iKrTacCoMDC-Q.png"></figure><figure name="1299" id="1299" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.148%;"><img class="graf-image" data-image-id="1*RzQYgkpJV9ifNnwgiuj5Eg.png" data-width="494" data-height="1038" src="https://cdn-images-1.medium.com/max/400/1*RzQYgkpJV9ifNnwgiuj5Eg.png"></figure><figure name="56bf" id="56bf" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.496%;"><img class="graf-image" data-image-id="1*hGmJpG5B9_3Txap_BXcwLA.png" data-width="490" data-height="1018" src="https://cdn-images-1.medium.com/max/400/1*hGmJpG5B9_3Txap_BXcwLA.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="69e5" id="69e5" class="graf graf--p graf-after--figure">利用剛剛的方法，當 State 搭配的 reference type 資料改變時，畫面也可以正常更新。不過此方法其實不太好，因為它需要重新生成物件，即使我們只是想改變物件的某個 property。</p><p name="c134" id="c134" class="graf graf--p graf-after--p">因此若資料是 reference type，比較建議的做法是搭配 @StateObject， @ObservedObject，@Published &amp; ObservableObject，有興趣的朋友可進一步研究相關說明。</p><h3 name="abb5" id="abb5" class="graf graf--h3 graf-after--p">當 view 原本就在畫面上，view 重新產生時將維持 State 變數之前儲存的資料</h3><pre name="284f" id="284f" class="graf graf--pre graf-after--h3">struct PokerView: View {<br>    <br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var pokerNumber = 1<br>    <br>    var body: some View {<br>        VStack {<br>            Text(&quot;poker number \(pokerNumber)&quot;)<br>            Button(action: {<br>                pokerNumber = Int.random(in: 1...13)<br>            }, label: {<br>                Text(&quot;Random&quot;)<br>            })<br><strong class="markup--strong markup--pre-strong">            DiceView()<br></strong>        }<br>        .font(.largeTitle)</pre><pre name="e953" id="e953" class="graf graf--pre graf-after--pre">    }<br>}</pre><pre name="e4d4" id="e4d4" class="graf graf--pre graf-after--pre">struct DiceView: View {<br><strong class="markup--strong markup--pre-strong">    </strong><a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@State</strong></a><strong class="markup--strong markup--pre-strong"> private var diceNumber = 1<br></strong>    <br>    init() {<br>        print(&quot;Create DiceView&quot;)<br>    }<br>    <br>    var body: some View {<br>        VStack {<br>            Text(&quot;dice number \(diceNumber)&quot;)<br>            Button(action: {<br>                diceNumber = Int.random(in: 1...6)<br>            }, label: {<br>                Text(&quot;Random&quot;)<br>            })<br>        } <br>        .font(.largeTitle)</pre><pre name="a6e5" id="a6e5" class="graf graf--pre graf-after--pre">    }<br>}</pre><p name="3d0a" id="3d0a" class="graf graf--p graf-after--pre">當 pokerNumber 改變時，PokerView 的畫面會更新，它的 body 程式將執行，因此重新生成 DiceView，印出 Create DiceView。值得注意的，此時 DiceView 的 diceNumber 將維持之前的數值，而非初始值 1，因為 State 宣告的 diceNumber 存在其它的地方，並不是存在 DiceView 裡。</p><p name="03fe" id="03fe" class="graf graf--p graf-after--p">實驗:</p><ol class="postList"><li name="3af3" id="3af3" class="graf graf--li graf-after--p">一開始 poker &amp; dice 都是 1。</li><li name="d0c7" id="d0c7" class="graf graf--li graf-after--li">點選 random dice，dice 變成 5，poker 維持 1。</li><li name="aaba" id="aaba" class="graf graf--li graf-after--li">點選 random poker，poker 變成 7，dice 維持 5。</li></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"></ol><figure name="f10b" id="f10b" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--li" style="width: 33.723%;"><img class="graf-image" data-image-id="1*Ox_vrtQaHsLpoEuyWRE5fg.png" data-width="508" data-height="1034" src="https://cdn-images-1.medium.com/max/600/1*Ox_vrtQaHsLpoEuyWRE5fg.png"></figure><figure name="9d5e" id="9d5e" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 32.555%;"><img class="graf-image" data-image-id="1*Xn1V7EKQYjs77pnnY2rYoQ.png" data-width="492" data-height="1038" src="https://cdn-images-1.medium.com/max/400/1*Xn1V7EKQYjs77pnnY2rYoQ.png"></figure><figure name="af10" id="af10" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.723%;"><img class="graf-image" data-image-id="1*jzE1A9wFsBA5yanHKVyc0A.png" data-width="508" data-height="1034" src="https://cdn-images-1.medium.com/max/600/1*jzE1A9wFsBA5yanHKVyc0A.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="acef" id="acef" class="graf graf--h3 graf-after--figure">當 view 重新顯示到畫面上，state 儲存的資料將重新產生，不會維持之前的內容</h3><p name="c0a9" id="c0a9" class="graf graf--p graf-after--h3">剛剛的例子的 DiceView 重新產生時，state 儲存的資料可以維持之前的內容，因為 DiceView 原本就顯示在畫面上。不過若是 DiceView 是重新出現到畫面上，SwiftUI 將認為此時我們想要的是全新的資料，而非之前的資料，所以以下例子 DiceView 的 diceNumber 都會被初始為 1，不會維持之前的內容。</p><ul class="postList"><li name="d6f9" id="d6f9" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">例子 1: 利用 if 控制 DiceView 的顯示</strong></li></ul><pre name="aa3f" id="aa3f" class="graf graf--pre graf-after--li">struct PokerView: View {<br>    <br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var pokerNumber = 1<br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var showDiceView = false</pre><pre name="180e" id="180e" class="graf graf--pre graf-after--pre">    var body: some View {<br>        VStack {<br>            Text(&quot;poker number \(pokerNumber)&quot;)<br>            Button(action: {<br>                pokerNumber = Int.random(in: 1...13)<br>            }, label: {<br>                Text(&quot;Random Poker&quot;)<br>            })<br>            Button(action: {<br>                showDiceView.toggle()<br>            }, label: {<br>                Text(&quot;\(showDiceView ? &quot;Hide&quot; : &quot;Show&quot;) Dice&quot;)<br>            })<br>           <strong class="markup--strong markup--pre-strong"> if showDiceView {<br>                DiceView()<br>                    .onTapGesture {<br>                        showDiceView = false<br>                    }<br>            }</strong><br>        }<br>        .font(.largeTitle)<br>    }<br>}</pre><p name="dee0" id="dee0" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">實驗:</strong></p><ol class="postList"><li name="1127" id="1127" class="graf graf--li graf-after--p">點選 Show Dice，顯示 DiceView，此時 dice number 為 1。</li><li name="9121" id="9121" class="graf graf--li graf-after--li">點選 Random Dice，此時 dice number 為 5。</li><li name="1997" id="1997" class="graf graf--li graf-after--li">點選 Hide Dice，</li></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"></ol><figure name="dc68" id="dc68" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--li" style="width: 33.498%;"><img class="graf-image" data-image-id="1*HEi5uuHiKlDByXUjRYmpmg.png" data-width="486" data-height="1022" src="https://cdn-images-1.medium.com/max/400/1*HEi5uuHiKlDByXUjRYmpmg.png"></figure><figure name="48aa" id="48aa" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.99%;"><img class="graf-image" data-image-id="1*atfCIZ84gE1OREe4PpifgQ.png" data-width="498" data-height="1030" src="https://cdn-images-1.medium.com/max/600/1*atfCIZ84gE1OREe4PpifgQ.png"></figure><figure name="e724" id="e724" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 32.512%;"><img class="graf-image" data-image-id="1*C_Z_QfW30orHXzjO9AUrgQ.png" data-width="478" data-height="1034" src="https://cdn-images-1.medium.com/max/400/1*C_Z_QfW30orHXzjO9AUrgQ.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="c8ec" id="c8ec" class="graf graf--p graf-after--figure">4. 點選 Show Dice，再次顯示 DiceView，此時 dice number 為 1，而非之前的 5。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="9e99" id="9e99" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><img class="graf-image" data-image-id="1*YouXQJ8xlQU3qEDUxl0Q7w.png" data-width="478" data-height="1020" src="https://cdn-images-1.medium.com/max/600/1*YouXQJ8xlQU3qEDUxl0Q7w.png"></figure><figure name="6e92" id="6e92" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><img class="graf-image" data-image-id="1*kLMsv1BhhmzgoAIkiosHHQ.png" data-width="480" data-height="1024" src="https://cdn-images-1.medium.com/max/600/1*kLMsv1BhhmzgoAIkiosHHQ.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><ul class="postList"><li name="3356" id="3356" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">例子 2: 利用 sheet 控制 DiceView 的顯示</strong></li></ul><pre name="587c" id="587c" class="graf graf--pre graf-after--li">struct PokerView: View {<br>    <br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var pokerNumber = 1<br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var showDiceView = false</pre><pre name="4ba4" id="4ba4" class="graf graf--pre graf-after--pre">    var body: some View {<br>        VStack {<br>            Text(&quot;poker number \(pokerNumber)&quot;)<br>            Button(action: {<br>                pokerNumber = Int.random(in: 1...13)<br>            }, label: {<br>                Text(&quot;Random Poker&quot;)<br>            })<br>            Button(action: {<br>                showDiceView.toggle()<br>            }, label: {<br>                Text(&quot;\(showDiceView ? &quot;Hide&quot; : &quot;Show&quot;) Dice&quot;)<br>            })<br>        }<br>        .font(.largeTitle)<br>       <strong class="markup--strong markup--pre-strong"> .sheet(isPresented: $showDiceView, content: {<br>            DiceView()<br>        })</strong><br>    }<br>}</pre><p name="e123" id="e123" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">實驗:</strong></p><ol class="postList"><li name="3efc" id="3efc" class="graf graf--li graf-after--p">點選 Show Dice，顯示 DiceView，此時 dice number 為 1。</li><li name="1c71" id="1c71" class="graf graf--li graf-after--li">點選 Random Dice，此時 dice number 為 3。</li><li name="ceea" id="ceea" class="graf graf--li graf-after--li">將 Dice View 往下拖曳關閉。</li></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"></ol><figure name="4083" id="4083" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--li" style="width: 33.096%;"><img class="graf-image" data-image-id="1*M02P4mSfV_Q4fUyz7ZMmHw.png" data-width="472" data-height="1018" src="https://cdn-images-1.medium.com/max/400/1*M02P4mSfV_Q4fUyz7ZMmHw.png"></figure><figure name="ef98" id="ef98" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.31%;"><img class="graf-image" data-image-id="1*ZV13hAATXjs28XeVICu0Fg.png" data-width="474" data-height="1014" src="https://cdn-images-1.medium.com/max/400/1*ZV13hAATXjs28XeVICu0Fg.png"></figure><figure name="75b4" id="75b4" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.595%;"><img class="graf-image" data-image-id="1*8aqwlmOw_8PBGdGmUfG8sw.png" data-width="482" data-height="1024" src="https://cdn-images-1.medium.com/max/600/1*8aqwlmOw_8PBGdGmUfG8sw.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="f4cf" id="f4cf" class="graf graf--p graf-after--figure">4. 點選 Show Dice，再次顯示 DiceView，此時 dice number 為 1，而非之前的 3。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="2098" id="2098" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 49.469%;"><img class="graf-image" data-image-id="1*Kb7dD430HH_mKERR1Hn-3Q.png" data-width="474" data-height="1018" src="https://cdn-images-1.medium.com/max/600/1*Kb7dD430HH_mKERR1Hn-3Q.png"></figure><figure name="51a5" id="51a5" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure graf--trailing" style="width: 50.531%;"><img class="graf-image" data-image-id="1*RS3TKciJQUxexRN4ksd3-Q.png" data-width="482" data-height="1012" src="https://cdn-images-1.medium.com/max/800/1*RS3TKciJQUxexRN4ksd3-Q.png"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/6e98cb1dc87a"><time class="dt-published" datetime="2021-02-16T14:13:31.613Z">February 16, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swiftui-state-%E7%9A%84%E9%80%B2%E9%9A%8E%E8%A7%A3%E6%9E%90-6e98cb1dc87a" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>