<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Swift 5.3 的 multiple trailing closure</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Swift 5.3 的 multiple trailing closure</h1>
</header>
<section data-field="subtitle" class="p-summary">
Swift 的  trailing closure 語法幫助我們寫出更簡潔易懂的程式，比方以下 Timer 的範例。
</section>
<section data-field="body" class="e-content">
<section name="6f86" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="eea1" id="eea1" class="graf graf--h3 graf--leading graf--title">Swift 5.3 的 multiple trailing closure</h3><figure name="a977" id="a977" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*OFDU_M8PKn0d0RKs4vD9OA.png" data-width="1360" data-height="626" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*OFDU_M8PKn0d0RKs4vD9OA.png"></figure><p name="60e9" id="60e9" class="graf graf--p graf-after--figure">Swift 的 trailing closure 語法幫助我們寫出更簡潔易懂的程式，比方以下 Timer 的範例。</p><figure name="b457" id="b457" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nW8qfydbnYortst9B7Oabw.png" data-width="1584" data-height="166" src="https://cdn-images-1.medium.com/max/800/1*nW8qfydbnYortst9B7Oabw.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9f0f" id="9f0f" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-type">Timer</span>.scheduledTimer(withTimeInterval: <span class="hljs-number">1</span>, repeats: <span class="hljs-literal">true</span>) { timer <span class="hljs-keyword">in</span><br />    <span class="hljs-built_in">print</span>(timer.fireDate)<br />}</span></pre><div name="f38b" id="f38b" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swift-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%90%8D%E7%9A%84-trailing-closure-7ae2eae93215" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swift-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%90%8D%E7%9A%84-trailing-closure-7ae2eae93215" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swift-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%90%8D%E7%9A%84-trailing-closure-7ae2eae93215"><strong class="markup--strong markup--mixtapeEmbed-strong">Swift 最後一名的 trailing closure</strong><br><em class="markup--em markup--mixtapeEmbed-em">小時候唸書時，我們都不喜歡當最後一名，因為只有壞事，沒有好事。然而在 Swift 的世界，如果傳入 function 的 closure 參數剛好是最後一個參數，反而會有好事發生呢! 我們可以採用 trailing closure…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swift-%E6%9C%80%E5%BE%8C%E4%B8%80%E5%90%8D%E7%9A%84-trailing-closure-7ae2eae93215" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9a1ecccccae305b067d514063f86294c" data-thumbnail-img-id="1*sVMqkpEgVF2cB7Y7Pok0zQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*sVMqkpEgVF2cB7Y7Pok0zQ.png);"></a></div><p name="cd9c" id="cd9c" class="graf graf--p graf-after--mixtapeEmbed">可惜原本它有個限制，它只能作用在 function 的最後一個參數，因此當 function 有多個 closure 時，程式會變得有點複雜，而且有點難懂，比方以下 UIViewPropertyAnimator 的例子。</p><figure name="d0c6" id="d0c6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*45MjVNpQT1QE-3buY5uAPg.png" data-width="1630" data-height="296" src="https://cdn-images-1.medium.com/max/800/1*45MjVNpQT1QE-3buY5uAPg.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9eb6" id="9eb6" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-type">UIViewPropertyAnimator</span>.runningPropertyAnimator(withDuration: <span class="hljs-number">5</span>, delay: <span class="hljs-number">0</span>, animations: {<br />    <br />}) { animatingPosition <span class="hljs-keyword">in</span><br />    <br />}</span></pre><p name="d900" id="d900" class="graf graf--p graf-after--pre">以上程式有兩個 closure，第一個 closure 的 { } 寫在 ( ) 裡，因此看起來不易閱讀，而第二個 closure 則因參數名省略的關係，讓人不易看出它將在動畫 completion 時執行。</p><p name="b906" id="b906" class="graf graf--p graf-after--p">由於這些缺點，Swift 5.3 推出了 multiple trailing closure !</p><h3 name="c104" id="c104" class="graf graf--h3 graf-after--p">SE-0279 Multiple Trailing Closures</h3><div name="883d" id="883d" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0279-multiple-trailing-closures.md" data-href="https://github.com/apple/swift-evolution/blob/master/proposals/0279-multiple-trailing-closures.md" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/apple/swift-evolution/blob/master/proposals/0279-multiple-trailing-closures.md"><strong class="markup--strong markup--mixtapeEmbed-strong">apple/swift-evolution</strong><br><em class="markup--em markup--mixtapeEmbed-em">Since its inception, Swift has supported trailing closure syntax: a bit of syntactic sugar that lets you “pop” the…</em>github.com</a><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0279-multiple-trailing-closures.md" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="25cd75feb7f23562cc64a49a96cc286a" data-thumbnail-img-id="0*5EK1YEkwGoJ98LTs" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*5EK1YEkwGoJ98LTs);"></a></div><p name="670e" id="670e" class="graf graf--p graf-after--mixtapeEmbed">現在 function 可以接收多個 Trailing Closure，任何參數都可以傳入 Trailing Closure，不再限制要最後一個參數。</p><p name="abc3" id="abc3" class="graf graf--p graf-after--p">使用 Multiple Trailing Closures 時，必須遵守以下規則 :</p><ul class="postList"><li name="9b9f" id="9b9f" class="graf graf--li graf-after--p">第一個 closure 省略參數名字。</li></ul><p name="10de" id="10de" class="graf graf--p graf-after--li">它將不影響程式的可讀性，因為它通常代表 function 的主要功能。</p><ul class="postList"><li name="394a" id="394a" class="graf graf--li graf-after--p">之後的 closure 保留參數名字。</li></ul><p name="651e" id="651e" class="graf graf--p graf-after--li">增加程式的可讀性，通常代表 function 的附加設定。</p><p name="e4ce" id="e4ce" class="graf graf--p graf-after--p">接著讓我們改以 Multiple Trailing Closures 輸入UIViewPropertyAnimator 的程式:</p><figure name="113c" id="113c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*h7lZ3lJ-5K4bZaS-7-eHxw.png" data-width="1642" data-height="294" src="https://cdn-images-1.medium.com/max/800/1*h7lZ3lJ-5K4bZaS-7-eHxw.png"></figure><p name="25df" id="25df" class="graf graf--p graf-after--figure">在 <code class="markup--code markup--p-code">( ) -&gt; Void</code> 或 <code class="markup--code markup--p-code">((UIViewAnimatingPosition) -&gt; Void)?</code> 的藍色長方形按下 Enter，它將自動變成 multiple trailing closure 的語法。</p><figure name="c209" id="c209" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*VhJKwjE-EUL3wyvugZStbw.png" data-width="1860" data-height="448" src="https://cdn-images-1.medium.com/max/800/1*VhJKwjE-EUL3wyvugZStbw.png"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="824e" id="824e" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-type">UIViewPropertyAnimator</span>.runningPropertyAnimator(withDuration: <span class="hljs-number">5</span>, delay: <span class="hljs-number">0</span>) {<br />    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;animation&quot;</span>)<br />} completion: { animatingPosition <span class="hljs-keyword">in</span><br />    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;completion&quot;</span>)<br />}</span></pre><p name="14fb" id="14fb" class="graf graf--p graf-after--pre">以上程式完美解決剛剛提到的問題:</p><ul class="postList"><li name="cfd5" id="cfd5" class="graf graf--li graf-after--p">兩個 closure 的 { } 都寫在 ( ) 之外，不再跟 ( ) 混在一起，看起來較為精簡易懂。</li><li name="3acb" id="3acb" class="graf graf--li graf-after--li">第一個 closure 省略參數名，不過並不影響可讀性，因為它通常代表 function 主要的功能，在此代表動畫的程式。</li><li name="5092" id="5092" class="graf graf--li graf-after--li graf--trailing">第二個 closure 保留參數名，讓人容易了解它的意思，在此代表動畫 completion 時執行的程式。</li></ul></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/b124ff4c43f9"><time class="dt-published" datetime="2021-02-25T04:24:04.075Z">February 25, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swift-5-3-%E7%9A%84-multiple-trailing-closure-b124ff4c43f9" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>