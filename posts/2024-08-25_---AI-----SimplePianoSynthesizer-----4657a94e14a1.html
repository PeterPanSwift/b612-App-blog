<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>使用 AI 製作的 SimplePianoSynthesizer 彈鋼琴</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">使用 AI 製作的 SimplePianoSynthesizer 彈鋼琴</h1>
</header>
<section data-field="subtitle" class="p-summary">
彼得潘小時候學過一點點鋼琴，所以一直有個夢想是用 Swift 寫個鋼琴 App。彼得潘稍微研究後，發現彈鋼琴的程式沒那麼簡單，尤其如果不想辛苦錄製鋼琴 88 鍵的音檔，而是用音頻合成的寫法，還需具備一些樂理和聲音處理的相關知識。
</section>
<section data-field="body" class="e-content">
<section name="1f67" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="766b" id="766b" class="graf graf--h3 graf--leading graf--title">使用 AI 製作的 SimplePianoSynthesizer 彈鋼琴</h3><p name="db16" id="db16" class="graf graf--p graf-after--h3">彼得潘小時候學過一點點鋼琴，所以一直有個夢想是用 Swift 寫個鋼琴 App。彼得潘稍微研究後，發現彈鋼琴的程式沒那麼簡單，尤其如果不想辛苦錄製鋼琴 88 鍵的音檔，而是用音頻合成的寫法，還需具備一些樂理和聲音處理的相關知識。</p><p name="6782" id="6782" class="graf graf--p graf-after--p">不過沒關係，我們可以請 AI 幫忙，以下我們將利用 AI 寫的SimplePianoSynthesizer 開發彈鋼琴 App。</p><h3 name="80b5" id="80b5" class="graf graf--h3 graf-after--p">請 AI 不用音檔播放鋼琴聲</h3><p name="b987" id="b987" class="graf graf--p graf-after--h3">AI 使用 AVAudioEngine &amp; AVAudioPlayerNode 實現播放鋼琴聲的程式，播放的原理跟聲音的頻率有關。</p><div name="1c90" id="1c90" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://sengpielaudio.com/calculator-notenames.htm" data-href="https://sengpielaudio.com/calculator-notenames.htm" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://sengpielaudio.com/calculator-notenames.htm"><strong class="markup--strong markup--mixtapeEmbed-strong">Note names of musical notes keyboard piano frequencies = octave piano keys number tone tones 88…</strong><br><em class="markup--em markup--mixtapeEmbed-em">Note names concert standard pitch tuning keyboard music piano key numbers frequencies octave musical grand piano keys…</em>sengpielaudio.com</a><a href="https://sengpielaudio.com/calculator-notenames.htm" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="8c054e160ea60207305fda5c4c5ddea0" data-thumbnail-img-id="0*M612Ygzq9rXtVAT3" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*M612Ygzq9rXtVAT3);"></a></div><p name="2692" id="2692" class="graf graf--p graf-after--mixtapeEmbed">待會我們將利用簡譜符號指定播放的音，數字 1 ~ 7 對應 do re mi fa so la si、低八度的音加 _，高八度的音加 .。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="6dea" id="6dea" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> AVFoundation<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {<br />    <span class="hljs-keyword">let</span> engine <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioEngine</span>()<br />    <span class="hljs-keyword">let</span> player <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPlayerNode</span>()<br />    <span class="hljs-keyword">var</span> noteDuration <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span><br />    <span class="hljs-keyword">let</span> noteToFrequency: [<span class="hljs-type">String</span>: <span class="hljs-type">Float</span>] <span class="hljs-operator">=</span> [<br />        <span class="hljs-comment">// 低八度</span><br />        <span class="hljs-string">&quot;1_&quot;</span>: <span class="hljs-number">130.81</span>, <span class="hljs-string">&quot;1#_&quot;</span>: <span class="hljs-number">138.59</span>, <span class="hljs-string">&quot;2_&quot;</span>: <span class="hljs-number">146.83</span>, <span class="hljs-string">&quot;2#_&quot;</span>: <span class="hljs-number">155.56</span>, <span class="hljs-string">&quot;3_&quot;</span>: <span class="hljs-number">164.81</span>,<br />        <span class="hljs-string">&quot;4_&quot;</span>: <span class="hljs-number">174.61</span>, <span class="hljs-string">&quot;4#_&quot;</span>: <span class="hljs-number">185.00</span>, <span class="hljs-string">&quot;5_&quot;</span>: <span class="hljs-number">196.00</span>, <span class="hljs-string">&quot;5#_&quot;</span>: <span class="hljs-number">207.65</span>,<br />        <span class="hljs-string">&quot;6_&quot;</span>: <span class="hljs-number">220.00</span>, <span class="hljs-string">&quot;6#_&quot;</span>: <span class="hljs-number">233.08</span>, <span class="hljs-string">&quot;7_&quot;</span>: <span class="hljs-number">246.94</span>,<br />        <span class="hljs-comment">// 中音八度</span><br />        <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-number">261.63</span>, <span class="hljs-string">&quot;1#&quot;</span>: <span class="hljs-number">277.18</span>, <span class="hljs-string">&quot;2&quot;</span>: <span class="hljs-number">293.66</span>, <span class="hljs-string">&quot;2#&quot;</span>: <span class="hljs-number">311.13</span>, <span class="hljs-string">&quot;3&quot;</span>: <span class="hljs-number">329.63</span>,<br />        <span class="hljs-string">&quot;4&quot;</span>: <span class="hljs-number">349.23</span>, <span class="hljs-string">&quot;4#&quot;</span>: <span class="hljs-number">369.99</span>, <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-number">392.00</span>, <span class="hljs-string">&quot;5#&quot;</span>: <span class="hljs-number">415.30</span>,<br />        <span class="hljs-string">&quot;6&quot;</span>: <span class="hljs-number">440.00</span>, <span class="hljs-string">&quot;6#&quot;</span>: <span class="hljs-number">466.16</span>, <span class="hljs-string">&quot;7&quot;</span>: <span class="hljs-number">493.88</span>,<br />        <span class="hljs-comment">// 高八度</span><br />        <span class="hljs-string">&quot;1.&quot;</span>: <span class="hljs-number">523.25</span>, <span class="hljs-string">&quot;1#.&quot;</span>: <span class="hljs-number">554.37</span>, <span class="hljs-string">&quot;2.&quot;</span>: <span class="hljs-number">587.33</span>, <span class="hljs-string">&quot;2#.&quot;</span>: <span class="hljs-number">622.25</span>, <span class="hljs-string">&quot;3.&quot;</span>: <span class="hljs-number">659.25</span>,<br />        <span class="hljs-string">&quot;4.&quot;</span>: <span class="hljs-number">698.46</span>, <span class="hljs-string">&quot;4#.&quot;</span>: <span class="hljs-number">739.99</span>, <span class="hljs-string">&quot;5.&quot;</span>: <span class="hljs-number">783.99</span>, <span class="hljs-string">&quot;5#.&quot;</span>: <span class="hljs-number">830.61</span>,<br />        <span class="hljs-string">&quot;6.&quot;</span>: <span class="hljs-number">880.00</span>, <span class="hljs-string">&quot;6#.&quot;</span>: <span class="hljs-number">932.33</span>, <span class="hljs-string">&quot;7.&quot;</span>: <span class="hljs-number">987.77</span>,<br />        <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 休止符</span><br />    ]<br />    <br />    <span class="hljs-keyword">init</span>() {<br />        engine.attach(player)<br />        engine.connect(player, to: engine.mainMixerNode, format: <span class="hljs-literal">nil</span>)<br />        <span class="hljs-keyword">do</span> {<br />            <span class="hljs-keyword">try</span> engine.start()<br />        } <span class="hljs-keyword">catch</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法啟動音頻引擎: <span class="hljs-subst">\(error)</span>&quot;</span>)<br />        }<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">note</span>: <span class="hljs-type">String</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[note] {<br />            playNote(frequency: frequency, duration: duration)<br />        }<br />    }<br /><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-params">frequency</span>: <span class="hljs-type">Float</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">let</span> sampleRate <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).sampleRate<br />        <span class="hljs-keyword">let</span> channelCount <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).channelCount<br />        <br />        <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFormat</span>(standardFormatWithSampleRate: sampleRate, channels: channelCount)<br />        <br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> audioFormat <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻格式&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        <span class="hljs-keyword">let</span> frameCount <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFrameCount</span>(sampleRate <span class="hljs-operator">*</span> duration)<br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> buffer <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPCMBuffer</span>(pcmFormat: audioFormat, frameCapacity: frameCount) <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻緩衝區&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        buffer.frameLength <span class="hljs-operator">=</span> frameCount<br />        <br />        <span class="hljs-keyword">for</span> channel <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(channelCount) {<br />            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> channelData <span class="hljs-operator">=</span> buffer.floatChannelData<span class="hljs-operator">?</span>[channel] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">continue</span> }<br />            <span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(frameCount) {<br />                <span class="hljs-keyword">let</span> value <span class="hljs-operator">=</span> sin(<span class="hljs-number">2.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frame) <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">/</span> sampleRate)<br />                channelData[frame] <span class="hljs-operator">=</span> <span class="hljs-type">Float</span>(value)<br />            }<br />        }<br />        <br />        player.scheduleBuffer(buffer)<br />        player.play()<br />    }<br />}<br /><br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {   <br />    <br />    <span class="hljs-comment">// 解析簡譜並返回(頻率, 持續時間)的數組</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">parseNotation</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) -&gt; [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> notation.components(separatedBy: .whitespaces)<br />        <span class="hljs-keyword">var</span> result: [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] <span class="hljs-operator">=</span> []<br />        <span class="hljs-keyword">for</span> note <span class="hljs-keyword">in</span> notes {<br />            <span class="hljs-keyword">var</span> noteKey <span class="hljs-operator">=</span> note<br />            <span class="hljs-keyword">var</span> duration <span class="hljs-operator">=</span> noteDuration<br /><br />            <span class="hljs-comment">// 處理延長音符</span><br />            <span class="hljs-keyword">if</span> note.hasSuffix(<span class="hljs-string">&quot;-&quot;</span>) {<br />                noteKey <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(note.dropLast())<br />                duration <span class="hljs-operator">*=</span> <span class="hljs-number">2</span><br />            }<br /><br />            <span class="hljs-comment">// 處理升降記號</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[noteKey] {<br />                result.append((frequency, duration))<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> noteKey.count <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> {<br />                <span class="hljs-keyword">let</span> baseNote <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.prefix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">let</span> modifier <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.suffix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> baseFrequency <span class="hljs-operator">=</span> noteToFrequency[baseNote] {<br />                    <span class="hljs-keyword">let</span> modifiedFrequency: <span class="hljs-type">Float</span><br />                    <span class="hljs-keyword">switch</span> modifier {<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">*</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;b&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">/</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">default</span>:<br />                        <span class="hljs-keyword">continue</span><br />                    }<br />                    result.append((modifiedFrequency, duration))<br />                }<br />            }<br />        }<br />        <span class="hljs-keyword">return</span> result<br />    }<br />    <br />    <span class="hljs-comment">// 播放整個簡譜</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playSong</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> parseNotation(notation)<br />        <span class="hljs-keyword">for</span> (frequency, duration) <span class="hljs-keyword">in</span> notes {<br />            playNote(frequency: frequency, duration: duration)<br />            <span class="hljs-type">Thread</span>.sleep(forTimeInterval: duration)<br />        }<br />    }<br />}</span></pre><h3 name="7bb5" id="7bb5" class="graf graf--h3 graf-after--pre">請 AI 讓音色更像鋼琴</h3><p name="5cb3" id="5cb3" class="graf graf--p graf-after--h3">AI 改進了 playNote，進行以下調整。</p><ul class="postList"><li name="1a6d" id="1a6d" class="graf graf--li graf-after--p">添加了 ADSR 包絡線，使音符有更真實的起音和衰減特性。</li><li name="7e33" id="7e33" class="graf graf--li graf-after--li">加入額外的諧波，豐富了音色。</li><li name="f041" id="f041" class="graf graf--li graf-after--li">應用了隨時間的衰減。</li><li name="2279" id="2279" class="graf graf--li graf-after--li">根據頻率調整音量，使低音更響亮。</li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="e91c" id="e91c" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> AVFoundation<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {<br />    <span class="hljs-keyword">let</span> engine <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioEngine</span>()<br />    <span class="hljs-keyword">let</span> player <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPlayerNode</span>()<br />    <span class="hljs-keyword">var</span> noteDuration <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span><br />    <span class="hljs-keyword">let</span> noteToFrequency: [<span class="hljs-type">String</span>: <span class="hljs-type">Float</span>] <span class="hljs-operator">=</span> [<br />        <span class="hljs-comment">// 低八度</span><br />        <span class="hljs-string">&quot;1_&quot;</span>: <span class="hljs-number">130.81</span>, <span class="hljs-string">&quot;1#_&quot;</span>: <span class="hljs-number">138.59</span>, <span class="hljs-string">&quot;2_&quot;</span>: <span class="hljs-number">146.83</span>, <span class="hljs-string">&quot;2#_&quot;</span>: <span class="hljs-number">155.56</span>, <span class="hljs-string">&quot;3_&quot;</span>: <span class="hljs-number">164.81</span>,<br />        <span class="hljs-string">&quot;4_&quot;</span>: <span class="hljs-number">174.61</span>, <span class="hljs-string">&quot;4#_&quot;</span>: <span class="hljs-number">185.00</span>, <span class="hljs-string">&quot;5_&quot;</span>: <span class="hljs-number">196.00</span>, <span class="hljs-string">&quot;5#_&quot;</span>: <span class="hljs-number">207.65</span>,<br />        <span class="hljs-string">&quot;6_&quot;</span>: <span class="hljs-number">220.00</span>, <span class="hljs-string">&quot;6#_&quot;</span>: <span class="hljs-number">233.08</span>, <span class="hljs-string">&quot;7_&quot;</span>: <span class="hljs-number">246.94</span>,<br />        <span class="hljs-comment">// 中音八度</span><br />        <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-number">261.63</span>, <span class="hljs-string">&quot;1#&quot;</span>: <span class="hljs-number">277.18</span>, <span class="hljs-string">&quot;2&quot;</span>: <span class="hljs-number">293.66</span>, <span class="hljs-string">&quot;2#&quot;</span>: <span class="hljs-number">311.13</span>, <span class="hljs-string">&quot;3&quot;</span>: <span class="hljs-number">329.63</span>,<br />        <span class="hljs-string">&quot;4&quot;</span>: <span class="hljs-number">349.23</span>, <span class="hljs-string">&quot;4#&quot;</span>: <span class="hljs-number">369.99</span>, <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-number">392.00</span>, <span class="hljs-string">&quot;5#&quot;</span>: <span class="hljs-number">415.30</span>,<br />        <span class="hljs-string">&quot;6&quot;</span>: <span class="hljs-number">440.00</span>, <span class="hljs-string">&quot;6#&quot;</span>: <span class="hljs-number">466.16</span>, <span class="hljs-string">&quot;7&quot;</span>: <span class="hljs-number">493.88</span>,<br />        <span class="hljs-comment">// 高八度</span><br />        <span class="hljs-string">&quot;1.&quot;</span>: <span class="hljs-number">523.25</span>, <span class="hljs-string">&quot;1#.&quot;</span>: <span class="hljs-number">554.37</span>, <span class="hljs-string">&quot;2.&quot;</span>: <span class="hljs-number">587.33</span>, <span class="hljs-string">&quot;2#.&quot;</span>: <span class="hljs-number">622.25</span>, <span class="hljs-string">&quot;3.&quot;</span>: <span class="hljs-number">659.25</span>,<br />        <span class="hljs-string">&quot;4.&quot;</span>: <span class="hljs-number">698.46</span>, <span class="hljs-string">&quot;4#.&quot;</span>: <span class="hljs-number">739.99</span>, <span class="hljs-string">&quot;5.&quot;</span>: <span class="hljs-number">783.99</span>, <span class="hljs-string">&quot;5#.&quot;</span>: <span class="hljs-number">830.61</span>,<br />        <span class="hljs-string">&quot;6.&quot;</span>: <span class="hljs-number">880.00</span>, <span class="hljs-string">&quot;6#.&quot;</span>: <span class="hljs-number">932.33</span>, <span class="hljs-string">&quot;7.&quot;</span>: <span class="hljs-number">987.77</span>,<br />        <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 休止符</span><br />    ]<br />    <br />    <span class="hljs-keyword">init</span>() {<br />        engine.attach(player)<br />        engine.connect(player, to: engine.mainMixerNode, format: <span class="hljs-literal">nil</span>)<br />        <span class="hljs-keyword">do</span> {<br />            <span class="hljs-keyword">try</span> engine.start()<br />        } <span class="hljs-keyword">catch</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法啟動音頻引擎: <span class="hljs-subst">\(error)</span>&quot;</span>)<br />        }<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">note</span>: <span class="hljs-type">String</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[note] {<br />            playNote(frequency: frequency, duration: duration)<br />        }<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-params">frequency</span>: <span class="hljs-type">Float</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">let</span> sampleRate <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).sampleRate<br />        <span class="hljs-keyword">let</span> channelCount <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).channelCount<br />        <br />        <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFormat</span>(standardFormatWithSampleRate: sampleRate, channels: channelCount)<br />        <br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> audioFormat <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻格式&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        <span class="hljs-keyword">let</span> frameCount <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFrameCount</span>(sampleRate <span class="hljs-operator">*</span> duration)<br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> buffer <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPCMBuffer</span>(pcmFormat: audioFormat, frameCapacity: frameCount) <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻緩衝區&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        buffer.frameLength <span class="hljs-operator">=</span> frameCount<br />        <br />        <span class="hljs-comment">// ADSR 參數</span><br />        <span class="hljs-keyword">let</span> attackTime <span class="hljs-operator">=</span> <span class="hljs-number">0.01</span><br />        <span class="hljs-keyword">let</span> decayTime <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><br />        <span class="hljs-keyword">let</span> sustainLevel <span class="hljs-operator">=</span> <span class="hljs-number">0.7</span><br />        <span class="hljs-keyword">let</span> releaseTime <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span><br />        <br />        <span class="hljs-keyword">for</span> channel <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(channelCount) {<br />            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> channelData <span class="hljs-operator">=</span> buffer.floatChannelData<span class="hljs-operator">?</span>[channel] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">continue</span> }<br />            <span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(frameCount) {<br />                <span class="hljs-keyword">let</span> t <span class="hljs-operator">=</span> <span class="hljs-type">Double</span>(frame) <span class="hljs-operator">/</span> sampleRate<br />                <br />                <span class="hljs-comment">// 基本音調</span><br />                <span class="hljs-keyword">var</span> value <span class="hljs-operator">=</span> sin(<span class="hljs-number">2.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                <br />                <span class="hljs-comment">// 添加諧波</span><br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.5</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">4.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.25</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">6.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.125</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">8.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                <br />                <span class="hljs-comment">// 應用 ADSR 包絡線</span><br />                <span class="hljs-keyword">let</span> envelopeValue: <span class="hljs-type">Double</span><br />                <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> attackTime {<br />                    envelopeValue <span class="hljs-operator">=</span> t <span class="hljs-operator">/</span> attackTime<br />                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> attackTime <span class="hljs-operator">+</span> decayTime {<br />                    envelopeValue <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> (<span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> sustainLevel) <span class="hljs-operator">*</span> ((t <span class="hljs-operator">-</span> attackTime) <span class="hljs-operator">/</span> decayTime)<br />                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> duration <span class="hljs-operator">-</span> releaseTime {<br />                    envelopeValue <span class="hljs-operator">=</span> sustainLevel<br />                } <span class="hljs-keyword">else</span> {<br />                    envelopeValue <span class="hljs-operator">=</span> sustainLevel <span class="hljs-operator">*</span> (<span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> (t <span class="hljs-operator">-</span> (duration <span class="hljs-operator">-</span> releaseTime)) <span class="hljs-operator">/</span> releaseTime)<br />                }<br />                <br />                <span class="hljs-comment">// 應用衰減</span><br />                <span class="hljs-keyword">let</span> decay <span class="hljs-operator">=</span> pow(<span class="hljs-number">0.5</span>, t <span class="hljs-operator">/</span> <span class="hljs-number">0.5</span>)<br />                <br />                <span class="hljs-comment">// 根據頻率調整音量</span><br />                <span class="hljs-keyword">let</span> volumeAdjustment <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(<span class="hljs-number">1.0</span>, sqrt(<span class="hljs-number">1000</span> <span class="hljs-operator">/</span> <span class="hljs-type">Double</span>(frequency)))<br />                <br />                channelData[frame] <span class="hljs-operator">=</span> <span class="hljs-type">Float</span>(value <span class="hljs-operator">*</span> envelopeValue <span class="hljs-operator">*</span> decay <span class="hljs-operator">*</span> volumeAdjustment <span class="hljs-operator">*</span> <span class="hljs-number">0.3</span>)<br />            }<br />        }<br />        <br />        player.scheduleBuffer(buffer)<br />        player.play()<br />    }<br />}<br /><br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {   <br />    <br />    <span class="hljs-comment">// 解析簡譜並返回(頻率, 持續時間)的數組</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">parseNotation</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) -&gt; [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> notation.components(separatedBy: .whitespaces)<br />        <span class="hljs-keyword">var</span> result: [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] <span class="hljs-operator">=</span> []<br />        <span class="hljs-keyword">for</span> note <span class="hljs-keyword">in</span> notes {<br />            <span class="hljs-keyword">var</span> noteKey <span class="hljs-operator">=</span> note<br />            <span class="hljs-keyword">var</span> duration <span class="hljs-operator">=</span> noteDuration<br /><br />            <span class="hljs-comment">// 處理延長音符</span><br />            <span class="hljs-keyword">if</span> note.hasSuffix(<span class="hljs-string">&quot;-&quot;</span>) {<br />                noteKey <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(note.dropLast())<br />                duration <span class="hljs-operator">*=</span> <span class="hljs-number">2</span><br />            }<br /><br />            <span class="hljs-comment">// 處理升降記號</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[noteKey] {<br />                result.append((frequency, duration))<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> noteKey.count <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> {<br />                <span class="hljs-keyword">let</span> baseNote <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.prefix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">let</span> modifier <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.suffix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> baseFrequency <span class="hljs-operator">=</span> noteToFrequency[baseNote] {<br />                    <span class="hljs-keyword">let</span> modifiedFrequency: <span class="hljs-type">Float</span><br />                    <span class="hljs-keyword">switch</span> modifier {<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">*</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;b&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">/</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">default</span>:<br />                        <span class="hljs-keyword">continue</span><br />                    }<br />                    result.append((modifiedFrequency, duration))<br />                }<br />            }<br />        }<br />        <span class="hljs-keyword">return</span> result<br />    }<br />    <br />    <span class="hljs-comment">// 播放整個簡譜</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playSong</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> parseNotation(notation)<br />        <span class="hljs-keyword">for</span> (frequency, duration) <span class="hljs-keyword">in</span> notes {<br />            playNote(frequency: frequency, duration: duration)<br />            <span class="hljs-type">Thread</span>.sleep(forTimeInterval: duration)<br />        }<br />    }<br />}</span></pre><h3 name="2170" id="2170" class="graf graf--h3 graf-after--pre">點選鋼琴鍵播音</h3><p name="8491" id="8491" class="graf graf--p graf-after--h3">利用 SimplePianoSynthesizer 實現播音功能，比方呼叫 <code class="markup--code markup--p-code">playNote(&quot;1&quot;, duration: 0.3)</code> 播放 Do，呼叫 <code class="markup--code markup--p-code">playNote(&quot;2&quot;, duration: 0.3)</code> 播放 Re。以下分別為 SwiftUI &amp; UIKit 的範例。</p><ul class="postList"><li name="ae4d" id="ae4d" class="graf graf--li graf-after--p">SwiftUI。</li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b755" id="b755" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> synth <span class="hljs-operator">=</span> <span class="hljs-type">SimplePianoSynthesizer</span>()<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">HStack</span> {<br />            <span class="hljs-type">Button</span>(<span class="hljs-string">&quot;Do&quot;</span>) {<br />                synth.playNote(<span class="hljs-string">&quot;1&quot;</span>, duration: <span class="hljs-number">0.3</span>)<br />            }<br />            <span class="hljs-type">Button</span>(<span class="hljs-string">&quot;Re&quot;</span>) {<br />                synth.playNote(<span class="hljs-string">&quot;2&quot;</span>, duration: <span class="hljs-number">0.3</span>)<br />            }<br />        }<br />    }<br />}</span></pre><ul class="postList"><li name="3fac" id="3fac" class="graf graf--li graf-after--pre">UIKit。</li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="3794" id="3794" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> UIKit<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">let</span> synth <span class="hljs-operator">=</span> <span class="hljs-type">SimplePianoSynthesizer</span>()<br /><br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <span class="hljs-comment">// Do any additional setup after loading the view.</span><br />    }<br />    <br />    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">playDo</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />        synth.playNote(<span class="hljs-string">&quot;1&quot;</span>, duration: <span class="hljs-number">0.3</span>)<br />    }<br />    <br />    <span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">playRe</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />        synth.playNote(<span class="hljs-string">&quot;2&quot;</span>, duration: <span class="hljs-number">0.3</span>)<br />    }<br />}</span></pre><h3 name="ba74" id="ba74" class="graf graf--h3 graf-after--pre">彈奏歌曲</h3><p name="c666" id="c666" class="graf graf--p graf-after--h3">呼叫 playSong 彈奏歌曲。</p><ul class="postList"><li name="0584" id="0584" class="graf graf--li graf-after--p">Do re mi fa so la si do</li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="a68e" id="a68e" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> notation <span class="hljs-operator">=</span> <span class="hljs-string">&quot;1 2 3 4 5 6 7 1.&quot;</span><br />synth.playSong(notation)</span></pre><ul class="postList"><li name="124f" id="124f" class="graf graf--li graf-after--pre">小星星。</li></ul><p name="5b5d" id="5b5d" class="graf graf--p graf-after--li">每句歌詞的結尾加上代表休止符的 0 稍做停頓。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="8423" id="8423" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> notation <span class="hljs-operator">=</span> <span class="hljs-string">&quot;1 1 5 5 6 6 5 0 &quot;</span> <span class="hljs-operator">+</span><br />        <span class="hljs-string">&quot;4 4 3 3 2 2 1 0 &quot;</span> <span class="hljs-operator">+</span><br />        <span class="hljs-string">&quot;5 5 4 4 3 3 2 0 &quot;</span> <span class="hljs-operator">+</span><br />        <span class="hljs-string">&quot;5 5 4 4 3 3 2 0 &quot;</span> <span class="hljs-operator">+</span><br />        <span class="hljs-string">&quot;1 1 5 5 6 6 5 0 &quot;</span> <span class="hljs-operator">+</span><br />        <span class="hljs-string">&quot;4 4 3 3 2 2 1&quot;</span><br />synth.playSong(notation)</span></pre><h3 name="538a" id="538a" class="graf graf--h3 graf-after--pre">請 AI 用 SwiftUI 製作鋼琴頁面</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="a705" id="a705" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">PianoView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> synthesizer <span class="hljs-operator">=</span> <span class="hljs-type">SimplePianoSynthesizer</span>()<br />    <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> [<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>]<br />    <span class="hljs-keyword">let</span> noteNames <span class="hljs-operator">=</span> [<span class="hljs-string">&quot;Do&quot;</span>, <span class="hljs-string">&quot;Re&quot;</span>, <span class="hljs-string">&quot;Mi&quot;</span>, <span class="hljs-string">&quot;Fa&quot;</span>, <span class="hljs-string">&quot;So&quot;</span>, <span class="hljs-string">&quot;La&quot;</span>, <span class="hljs-string">&quot;Si&quot;</span>]<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">ZStack</span> {<br />            <span class="hljs-type">LinearGradient</span>(gradient: <span class="hljs-type">Gradient</span>(colors: [<span class="hljs-type">Color</span>.blue.opacity(<span class="hljs-number">0.2</span>), <span class="hljs-type">Color</span>.purple.opacity(<span class="hljs-number">0.2</span>)]),<br />                           startPoint: .topLeading,<br />                           endPoint: .bottomTrailing)<br />                .ignoresSafeArea()<br />            <br />            <span class="hljs-type">VStack</span>(spacing: <span class="hljs-number">20</span>) {<br />                <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Virtual Piano&quot;</span>)<br />                    .font(.system(size: <span class="hljs-number">40</span>, weight: .bold, design: .rounded))<br />                    .foregroundStyle(.purple)<br />                    .padding()<br />                    .background(<br />                        <span class="hljs-type">RoundedRectangle</span>(cornerRadius: <span class="hljs-number">15</span>)<br />                            .fill(<span class="hljs-type">Color</span>.white.opacity(<span class="hljs-number">0.7</span>))<br />                            .shadow(color: .gray.opacity(<span class="hljs-number">0.3</span>), radius: <span class="hljs-number">10</span>, x: <span class="hljs-number">0</span>, y: <span class="hljs-number">5</span>)<br />                    )<br />                <br />                <span class="hljs-type">HStack</span>(spacing: <span class="hljs-number">4</span>) {<br />                    <span class="hljs-type">ForEach</span>(<span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-number">7</span>) { index <span class="hljs-keyword">in</span><br />                        <span class="hljs-type">PianoKey</span>(noteName: noteNames[index], action: {<br />                            synthesizer.playNote(notes[index], duration: <span class="hljs-number">0.3</span>)<br />                        })<br />                    }<br />                }<br />                .padding(.horizontal)<br />            }<br />        }<br />    }<br /><br />}<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">PianoKey</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-keyword">let</span> noteName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> action: () -&gt; <span class="hljs-type">Void</span><br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">Button</span>(action: action) {<br />            <span class="hljs-type">VStack</span> {<br />                <span class="hljs-type">Text</span>(noteName)<br />                    .font(.system(size: <span class="hljs-number">18</span>, weight: .semibold, design: .rounded))<br />                    .foregroundStyle(.black)<br />                <br />                <span class="hljs-type">RoundedRectangle</span>(cornerRadius: <span class="hljs-number">8</span>)<br />                    .fill(<br />                        <span class="hljs-type">LinearGradient</span>(gradient: <span class="hljs-type">Gradient</span>(colors: [<span class="hljs-type">Color</span>.white, <span class="hljs-type">Color</span>.gray.opacity(<span class="hljs-number">0.2</span>)]),<br />                                       startPoint: .top,<br />                                       endPoint: .bottom)<br />                    )<br />                    .frame(width: <span class="hljs-number">45</span>, height: <span class="hljs-number">140</span>)<br />                    .overlay(<br />                        <span class="hljs-type">RoundedRectangle</span>(cornerRadius: <span class="hljs-number">8</span>)<br />                            .stroke(<span class="hljs-type">Color</span>.black.opacity(<span class="hljs-number">0.2</span>), lineWidth: <span class="hljs-number">1</span>)<br />                    )<br />                    .shadow(color: .gray.opacity(<span class="hljs-number">0.5</span>), radius: <span class="hljs-number">5</span>, x: <span class="hljs-number">0</span>, y: <span class="hljs-number">5</span>)<br />            }<br />        }<br />    }<br />}</span></pre><figure name="189c" id="189c" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*N2UaJicKR5iupoT745X4Vg.png" data-width="1179" data-height="2556" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*N2UaJicKR5iupoT745X4Vg.png"></figure><h3 name="23df" id="23df" class="graf graf--h3 graf-after--figure">請 AI 加上踏板效果</h3><ul class="postList"><li name="f05a" id="f05a" class="graf graf--li graf-after--h3">大幅延長了釋放時間（從 0.3 秒增加到 3 秒）。</li><li name="cf88" id="cf88" class="graf graf--li graf-after--li">顯著減緩了衰減速度（將衰減系數從 0.5 增加到 3.0）。</li><li name="a633" id="a633" class="graf graf--li graf-after--li">增加了音符之間的重疊效果，通過保存上一個音符的緩衝區並在新音符中混合一部分。</li><li name="3742" id="3742" class="graf graf--li graf-after--li">添加了簡單的共鳴效果，包括低頻和高頻共鳴。</li><li name="b89b" id="b89b" class="graf graf--li graf-after--li">使用更緩慢的指數衰減（pow(releaseProgress, 0.3)）來使音符的尾音更加持久。</li></ul><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="b931" id="b931" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> AVFoundation<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {<br />    <span class="hljs-keyword">let</span> engine <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioEngine</span>()<br />    <span class="hljs-keyword">let</span> player <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPlayerNode</span>()<br />    <span class="hljs-keyword">var</span> noteDuration <span class="hljs-operator">=</span> <span class="hljs-number">0.3</span><br />    <span class="hljs-keyword">var</span> pedalOn <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br />    <span class="hljs-keyword">var</span> lastNoteBuffer: <span class="hljs-type">AVAudioPCMBuffer</span>?<br />    <span class="hljs-keyword">let</span> noteToFrequency: [<span class="hljs-type">String</span>: <span class="hljs-type">Float</span>] <span class="hljs-operator">=</span> [<br />        <span class="hljs-comment">// 低八度</span><br />        <span class="hljs-string">&quot;1_&quot;</span>: <span class="hljs-number">130.81</span>, <span class="hljs-string">&quot;1#_&quot;</span>: <span class="hljs-number">138.59</span>, <span class="hljs-string">&quot;2_&quot;</span>: <span class="hljs-number">146.83</span>, <span class="hljs-string">&quot;2#_&quot;</span>: <span class="hljs-number">155.56</span>, <span class="hljs-string">&quot;3_&quot;</span>: <span class="hljs-number">164.81</span>,<br />        <span class="hljs-string">&quot;4_&quot;</span>: <span class="hljs-number">174.61</span>, <span class="hljs-string">&quot;4#_&quot;</span>: <span class="hljs-number">185.00</span>, <span class="hljs-string">&quot;5_&quot;</span>: <span class="hljs-number">196.00</span>, <span class="hljs-string">&quot;5#_&quot;</span>: <span class="hljs-number">207.65</span>,<br />        <span class="hljs-string">&quot;6_&quot;</span>: <span class="hljs-number">220.00</span>, <span class="hljs-string">&quot;6#_&quot;</span>: <span class="hljs-number">233.08</span>, <span class="hljs-string">&quot;7_&quot;</span>: <span class="hljs-number">246.94</span>,<br />        <span class="hljs-comment">// 中音八度</span><br />        <span class="hljs-string">&quot;1&quot;</span>: <span class="hljs-number">261.63</span>, <span class="hljs-string">&quot;1#&quot;</span>: <span class="hljs-number">277.18</span>, <span class="hljs-string">&quot;2&quot;</span>: <span class="hljs-number">293.66</span>, <span class="hljs-string">&quot;2#&quot;</span>: <span class="hljs-number">311.13</span>, <span class="hljs-string">&quot;3&quot;</span>: <span class="hljs-number">329.63</span>,<br />        <span class="hljs-string">&quot;4&quot;</span>: <span class="hljs-number">349.23</span>, <span class="hljs-string">&quot;4#&quot;</span>: <span class="hljs-number">369.99</span>, <span class="hljs-string">&quot;5&quot;</span>: <span class="hljs-number">392.00</span>, <span class="hljs-string">&quot;5#&quot;</span>: <span class="hljs-number">415.30</span>,<br />        <span class="hljs-string">&quot;6&quot;</span>: <span class="hljs-number">440.00</span>, <span class="hljs-string">&quot;6#&quot;</span>: <span class="hljs-number">466.16</span>, <span class="hljs-string">&quot;7&quot;</span>: <span class="hljs-number">493.88</span>,<br />        <span class="hljs-comment">// 高八度</span><br />        <span class="hljs-string">&quot;1.&quot;</span>: <span class="hljs-number">523.25</span>, <span class="hljs-string">&quot;1#.&quot;</span>: <span class="hljs-number">554.37</span>, <span class="hljs-string">&quot;2.&quot;</span>: <span class="hljs-number">587.33</span>, <span class="hljs-string">&quot;2#.&quot;</span>: <span class="hljs-number">622.25</span>, <span class="hljs-string">&quot;3.&quot;</span>: <span class="hljs-number">659.25</span>,<br />        <span class="hljs-string">&quot;4.&quot;</span>: <span class="hljs-number">698.46</span>, <span class="hljs-string">&quot;4#.&quot;</span>: <span class="hljs-number">739.99</span>, <span class="hljs-string">&quot;5.&quot;</span>: <span class="hljs-number">783.99</span>, <span class="hljs-string">&quot;5#.&quot;</span>: <span class="hljs-number">830.61</span>,<br />        <span class="hljs-string">&quot;6.&quot;</span>: <span class="hljs-number">880.00</span>, <span class="hljs-string">&quot;6#.&quot;</span>: <span class="hljs-number">932.33</span>, <span class="hljs-string">&quot;7.&quot;</span>: <span class="hljs-number">987.77</span>,<br />        <span class="hljs-string">&quot;0&quot;</span>: <span class="hljs-number">0</span> <span class="hljs-comment">// 休止符</span><br />    ]<br />    <br />    <span class="hljs-keyword">init</span>() {<br />        engine.attach(player)<br />        engine.connect(player, to: engine.mainMixerNode, format: <span class="hljs-literal">nil</span>)<br />        <span class="hljs-keyword">do</span> {<br />            <span class="hljs-keyword">try</span> engine.start()<br />        } <span class="hljs-keyword">catch</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法啟動音頻引擎: <span class="hljs-subst">\(error)</span>&quot;</span>)<br />        }<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">note</span>: <span class="hljs-type">String</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[note] {<br />            playNote(frequency: frequency, duration: duration)<br />        }<br />    }<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playNote</span>(<span class="hljs-params">frequency</span>: <span class="hljs-type">Float</span>, <span class="hljs-params">duration</span>: <span class="hljs-type">Double</span>) {<br />        <span class="hljs-keyword">let</span> sampleRate <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).sampleRate<br />        <span class="hljs-keyword">let</span> channelCount <span class="hljs-operator">=</span> engine.outputNode.outputFormat(forBus: <span class="hljs-number">0</span>).channelCount<br />        <br />        <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFormat</span>(standardFormatWithSampleRate: sampleRate, channels: channelCount)<br />        <br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> audioFormat <span class="hljs-operator">=</span> audioFormat <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻格式&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        <span class="hljs-keyword">let</span> totalDuration <span class="hljs-operator">=</span> pedalOn <span class="hljs-operator">?</span> duration <span class="hljs-operator">+</span> <span class="hljs-number">3.0</span> : duration <span class="hljs-comment">// 踏板開啟時延長總時長</span><br />        <span class="hljs-keyword">let</span> frameCount <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioFrameCount</span>(sampleRate <span class="hljs-operator">*</span> totalDuration)<br />        <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> buffer <span class="hljs-operator">=</span> <span class="hljs-type">AVAudioPCMBuffer</span>(pcmFormat: audioFormat, frameCapacity: frameCount) <span class="hljs-keyword">else</span> {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;無法創建音頻緩衝區&quot;</span>)<br />            <span class="hljs-keyword">return</span><br />        }<br />        <br />        buffer.frameLength <span class="hljs-operator">=</span> frameCount<br />        <br />        <span class="hljs-comment">// ADSR 參數</span><br />        <span class="hljs-keyword">let</span> attackTime <span class="hljs-operator">=</span> <span class="hljs-number">0.01</span><br />        <span class="hljs-keyword">let</span> decayTime <span class="hljs-operator">=</span> <span class="hljs-number">0.1</span><br />        <span class="hljs-keyword">let</span> sustainLevel <span class="hljs-operator">=</span> <span class="hljs-number">0.7</span><br />        <span class="hljs-keyword">let</span> releaseTime <span class="hljs-operator">=</span> pedalOn <span class="hljs-operator">?</span> <span class="hljs-number">3.0</span> : <span class="hljs-number">0.3</span>  <span class="hljs-comment">// 大幅延長釋放時間</span><br />        <br />        <span class="hljs-keyword">for</span> channel <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(channelCount) {<br />            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> channelData <span class="hljs-operator">=</span> buffer.floatChannelData<span class="hljs-operator">?</span>[channel] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">continue</span> }<br />            <span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(frameCount) {<br />                <span class="hljs-keyword">let</span> t <span class="hljs-operator">=</span> <span class="hljs-type">Double</span>(frame) <span class="hljs-operator">/</span> sampleRate<br />                <br />                <span class="hljs-comment">// 基本音調和諧波</span><br />                <span class="hljs-keyword">var</span> value <span class="hljs-operator">=</span> sin(<span class="hljs-number">2.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.5</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">4.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.25</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">6.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                value <span class="hljs-operator">+=</span> <span class="hljs-number">0.125</span> <span class="hljs-operator">*</span> sin(<span class="hljs-number">8.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency) <span class="hljs-operator">*</span> t)<br />                <br />                <span class="hljs-comment">// 應用 ADSR 包絡線</span><br />                <span class="hljs-keyword">let</span> envelopeValue: <span class="hljs-type">Double</span><br />                <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> attackTime {<br />                    envelopeValue <span class="hljs-operator">=</span> t <span class="hljs-operator">/</span> attackTime<br />                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> attackTime <span class="hljs-operator">+</span> decayTime {<br />                    envelopeValue <span class="hljs-operator">=</span> <span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> (<span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> sustainLevel) <span class="hljs-operator">*</span> ((t <span class="hljs-operator">-</span> attackTime) <span class="hljs-operator">/</span> decayTime)<br />                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> t <span class="hljs-operator">&lt;</span> duration {<br />                    envelopeValue <span class="hljs-operator">=</span> sustainLevel<br />                } <span class="hljs-keyword">else</span> {<br />                    <span class="hljs-comment">// 踏板開啟時使用更緩慢的衰減</span><br />                    <span class="hljs-keyword">let</span> releaseProgress <span class="hljs-operator">=</span> (t <span class="hljs-operator">-</span> duration) <span class="hljs-operator">/</span> releaseTime<br />                    envelopeValue <span class="hljs-operator">=</span> sustainLevel <span class="hljs-operator">*</span> (pedalOn <span class="hljs-operator">?</span> (<span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> pow(releaseProgress, <span class="hljs-number">0.3</span>)) : (<span class="hljs-number">1.0</span> <span class="hljs-operator">-</span> releaseProgress))<br />                }<br />                <br />                <span class="hljs-comment">// 應用衰減</span><br />                <span class="hljs-keyword">let</span> decay <span class="hljs-operator">=</span> pow(<span class="hljs-number">0.5</span>, t <span class="hljs-operator">/</span> (pedalOn <span class="hljs-operator">?</span> <span class="hljs-number">3.0</span> : <span class="hljs-number">0.5</span>))  <span class="hljs-comment">// 大幅減緩衰減</span><br />                <br />                <span class="hljs-comment">// 根據頻率調整音量</span><br />                <span class="hljs-keyword">let</span> volumeAdjustment <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(<span class="hljs-number">1.0</span>, sqrt(<span class="hljs-number">1000</span> <span class="hljs-operator">/</span> <span class="hljs-type">Double</span>(frequency)))<br />                <br />                <span class="hljs-comment">// 添加共鳴效果</span><br />                <span class="hljs-keyword">var</span> finalValue <span class="hljs-operator">=</span> value <span class="hljs-operator">*</span> envelopeValue <span class="hljs-operator">*</span> decay <span class="hljs-operator">*</span> volumeAdjustment <span class="hljs-operator">*</span> <span class="hljs-number">0.3</span><br />                <span class="hljs-keyword">if</span> pedalOn {<br />                    finalValue <span class="hljs-operator">+=</span> sin(<span class="hljs-number">2.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency<span class="hljs-operator">/</span><span class="hljs-number">2</span>) <span class="hljs-operator">*</span> t) <span class="hljs-operator">*</span> <span class="hljs-number">0.05</span> <span class="hljs-operator">*</span> decay  <span class="hljs-comment">// 添加低頻共鳴</span><br />                    finalValue <span class="hljs-operator">+=</span> sin(<span class="hljs-number">2.0</span> <span class="hljs-operator">*</span> .pi <span class="hljs-operator">*</span> <span class="hljs-type">Double</span>(frequency<span class="hljs-operator">*</span><span class="hljs-number">2</span>) <span class="hljs-operator">*</span> t) <span class="hljs-operator">*</span> <span class="hljs-number">0.03</span> <span class="hljs-operator">*</span> decay  <span class="hljs-comment">// 添加高頻共鳴</span><br />                }<br />                <br />                channelData[frame] <span class="hljs-operator">=</span> <span class="hljs-type">Float</span>(finalValue)<br />            }<br />        }<br />        <br />        <span class="hljs-comment">// 如果踏板開啟，混合上一個音符的尾音</span><br />        <span class="hljs-keyword">if</span> pedalOn, <span class="hljs-keyword">let</span> lastBuffer <span class="hljs-operator">=</span> lastNoteBuffer {<br />            <span class="hljs-keyword">let</span> overlapFrames <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span>(lastBuffer.frameLength, buffer.frameLength)<br />            <span class="hljs-keyword">for</span> channel <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(channelCount) {<br />                <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> lastChannelData <span class="hljs-operator">=</span> lastBuffer.floatChannelData<span class="hljs-operator">?</span>[channel],<br />                      <span class="hljs-keyword">let</span> currentChannelData <span class="hljs-operator">=</span> buffer.floatChannelData<span class="hljs-operator">?</span>[channel] <span class="hljs-keyword">else</span> { <span class="hljs-keyword">continue</span> }<br />                <span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> <span class="hljs-number">0</span><span class="hljs-operator">..&lt;</span><span class="hljs-type">Int</span>(overlapFrames) {<br />                    <span class="hljs-keyword">let</span> lastValue <span class="hljs-operator">=</span> lastChannelData[frame]<br />                    <span class="hljs-keyword">let</span> currentValue <span class="hljs-operator">=</span> currentChannelData[frame]<br />                    currentChannelData[frame] <span class="hljs-operator">=</span> currentValue <span class="hljs-operator">+</span> lastValue <span class="hljs-operator">*</span> <span class="hljs-number">0.5</span>  <span class="hljs-comment">// 混合上一個音符的 50%</span><br />                }<br />            }<br />        }<br />        <br />        player.scheduleBuffer(buffer)<br />        player.play()<br />        <br />        <span class="hljs-comment">// 保存當前緩衝區為上一個音符</span><br />        lastNoteBuffer <span class="hljs-operator">=</span> buffer<br />    }<br />    <br />    <span class="hljs-comment">// 踏板控制方法</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">setPedal</span>(<span class="hljs-params">on</span>: <span class="hljs-type">Bool</span>) {<br />        pedalOn <span class="hljs-operator">=</span> on<br />        <span class="hljs-keyword">if</span> <span class="hljs-operator">!</span>pedalOn {<br />            lastNoteBuffer <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>  <span class="hljs-comment">// 釋放踏板時清除上一個音符緩衝區</span><br />        }<br />    }<br />}<br /><br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">SimplePianoSynthesizer</span> {<br />    <br />    <span class="hljs-comment">// 解析簡譜並返回(頻率, 持續時間)的數組</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">parseNotation</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) -&gt; [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> notation.components(separatedBy: .whitespaces)<br />        <span class="hljs-keyword">var</span> result: [(<span class="hljs-type">Float</span>, <span class="hljs-type">Double</span>)] <span class="hljs-operator">=</span> []<br />        <span class="hljs-keyword">for</span> note <span class="hljs-keyword">in</span> notes {<br />            <span class="hljs-keyword">var</span> noteKey <span class="hljs-operator">=</span> note<br />            <span class="hljs-keyword">var</span> duration <span class="hljs-operator">=</span> noteDuration<br />            <br />            <span class="hljs-comment">// 處理延長音符</span><br />            <span class="hljs-keyword">if</span> note.hasSuffix(<span class="hljs-string">&quot;-&quot;</span>) {<br />                noteKey <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(note.dropLast())<br />                duration <span class="hljs-operator">*=</span> <span class="hljs-number">2</span><br />            }<br />            <br />            <span class="hljs-comment">// 處理升降記號</span><br />            <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> frequency <span class="hljs-operator">=</span> noteToFrequency[noteKey] {<br />                result.append((frequency, duration))<br />            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> noteKey.count <span class="hljs-operator">&gt;</span> <span class="hljs-number">1</span> {<br />                <span class="hljs-keyword">let</span> baseNote <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.prefix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">let</span> modifier <span class="hljs-operator">=</span> <span class="hljs-type">String</span>(noteKey.suffix(<span class="hljs-number">1</span>))<br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> baseFrequency <span class="hljs-operator">=</span> noteToFrequency[baseNote] {<br />                    <span class="hljs-keyword">let</span> modifiedFrequency: <span class="hljs-type">Float</span><br />                    <span class="hljs-keyword">switch</span> modifier {<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;#&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">*</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">case</span> <span class="hljs-string">&quot;b&quot;</span>:<br />                        modifiedFrequency <span class="hljs-operator">=</span> baseFrequency <span class="hljs-operator">/</span> pow(<span class="hljs-number">2</span>, <span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">12</span>)<br />                    <span class="hljs-keyword">default</span>:<br />                        <span class="hljs-keyword">continue</span><br />                    }<br />                    result.append((modifiedFrequency, duration))<br />                }<br />            }<br />        }<br />        <span class="hljs-keyword">return</span> result<br />    }<br />    <br />    <span class="hljs-comment">// 播放整個簡譜</span><br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">playSong</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">notation</span>: <span class="hljs-type">String</span>) {<br />        <span class="hljs-keyword">let</span> notes <span class="hljs-operator">=</span> parseNotation(notation)<br />        <span class="hljs-keyword">for</span> (frequency, duration) <span class="hljs-keyword">in</span> notes {<br />            playNote(frequency: frequency, duration: duration)<br />            <span class="hljs-type">Thread</span>.sleep(forTimeInterval: duration)<br />        }<br />    }<br />}</span></pre><figure name="dc79" id="dc79" class="graf graf--figure graf--iframe graf-after--pre graf--trailing"><iframe src="https://www.youtube.com/embed/etlf-WzQ-Og?feature=oembed" width="640" height="480" frameborder="0" scrolling="no"></iframe></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/4657a94e14a1"><time class="dt-published" datetime="2024-08-25T10:13:23.545Z">August 25, 2024</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E4%BD%BF%E7%94%A8-ai-%E8%A3%BD%E4%BD%9C%E7%9A%84-simplepianosynthesizer-%E5%BD%88%E9%8B%BC%E7%90%B4-4657a94e14a1" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>