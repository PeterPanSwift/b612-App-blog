<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 UIBackgroundConfiguration 在 collection view cell 顯示圖片</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 UIBackgroundConfiguration 在 collection view cell 顯示圖片</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們經常使用 collection view 實作格子狀照片牆跟水平滑動的分頁照片牆。從前我們必須自訂 collection view cell 類別，然後加入顯示圖片的 image view。
</section>
<section data-field="body" class="e-content">
<section name="c07d" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d43b" id="d43b" class="graf graf--h3 graf--leading graf--title">利用 UIBackgroundConfiguration 在 collection view cell 顯示圖片</h3><figure name="1445" id="1445" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*0jw-A_WGPU-K4Y7_p0Af7w.png" data-width="1868" data-height="836" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*0jw-A_WGPU-K4Y7_p0Af7w.png"></figure><p name="b9c9" id="b9c9" class="graf graf--p graf-after--figure">開發 iOS App 時，我們經常使用 collection view 實作格子狀照片牆跟水平滑動的分頁照片牆。從前我們必須自訂 collection view cell 類別，然後加入顯示圖片的 image view。</p><p name="a065" id="a065" class="graf graf--p graf-after--p">在 iOS 15 我們有更簡單的方法。 透過 UIBackgroundConfiguration 的 property image &amp; imageContentMode，我們可以設定 cell 顯示的圖片，不用再額外加入 image view 了。</p><div name="7073" id="7073" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/uikit/uibackgroundconfiguration" data-href="https://developer.apple.com/documentation/uikit/uibackgroundconfiguration" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uibackgroundconfiguration"><strong class="markup--strong markup--mixtapeEmbed-strong">UIBackgroundConfiguration | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">A configuration that describes a specific background appearance.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uibackgroundconfiguration" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="162477a8c88531bf21be38a110206e7b" data-thumbnail-img-id="0*6d1qLDVJqyyOHr0n" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*6d1qLDVJqyyOHr0n);"></a></div><p name="4d3e" id="4d3e" class="graf graf--p graf-after--mixtapeEmbed">image &amp; imageContentMode 是 iOS 15 新增的 property，因此要 iOS 15 才支援。</p><figure name="509d" id="509d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*JKsDXPySFvnn5Zp953W1wg.png" data-width="1784" data-height="632" src="https://cdn-images-1.medium.com/max/800/1*JKsDXPySFvnn5Zp953W1wg.png"></figure><figure name="5e37" id="5e37" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*eit69ok1q5ZMVOQDzXAq_Q.png" data-width="1520" data-height="866" src="https://cdn-images-1.medium.com/max/800/1*eit69ok1q5ZMVOQDzXAq_Q.png"></figure><p name="a48d" id="a48d" class="graf graf--p graf-after--figure">接下來我們將示範如何利用 UIBackgroundConfiguration 實現四種常見的 App 畫面。</p><p name="66a1" id="66a1" class="graf graf--p graf-after--p">1. 格子狀照片牆。<br>2. 水平滑動的全螢幕分頁照片牆。<br>3. 不分頁的水平滑動照片牆。<br>4. 顯示網路圖片的格子狀照片牆。</p><h3 name="b5a8" id="b5a8" class="graf graf--h3 graf-after--p">格子狀照片牆</h3><h4 name="a6e7" id="a6e7" class="graf graf--h4 graf-after--h3">在 assets 加入圖片</h4><figure name="cfd0" id="cfd0" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*yJOL58hScSK7sX_9HhHGxQ.png" data-width="2230" data-height="1160" src="https://cdn-images-1.medium.com/max/800/1*yJOL58hScSK7sX_9HhHGxQ.png"></figure><h4 name="11e0" id="11e0" class="graf graf--h4 graf-after--figure">設定 cell ID</h4><ul class="postList"><li name="7baf" id="7baf" class="graf graf--li graf-after--h4"><strong class="markup--strong markup--li-strong">方法1: 從 Interface Builder 加入 cell，設定它的 cell ID。</strong></li></ul><figure name="4fd6" id="4fd6" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*XfZUAyZ7qdsuuvile1eKNQ.png" data-width="1602" data-height="962" src="https://cdn-images-1.medium.com/max/800/1*XfZUAyZ7qdsuuvile1eKNQ.png"></figure><figure name="3667" id="3667" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*fJ7yX2qcLdcIynkT0nqJUg.png" data-width="522" data-height="234" src="https://cdn-images-1.medium.com/max/800/1*fJ7yX2qcLdcIynkT0nqJUg.png"></figure><ul class="postList"><li name="e0cd" id="e0cd" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">方法2: 呼叫 register 設定 cell ID。</strong></li></ul><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6807" id="6807" class="graf graf--pre graf-after--li graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        collectionView.register(<span class="hljs-type">UICollectionViewCell</span>.<span class="hljs-keyword">self</span>, forCellWithReuseIdentifier: <span class="hljs-string">&quot;Cell&quot;</span>)<br />        <br />}</span></pre><p name="c668" id="c668" class="graf graf--p graf-after--pre">到時候 cell 將從程式產生，因此 Interface Builder 的 collection view 不須加入 cell。</p><figure name="7f56" id="7f56" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*U6qlM_tRvBoc7elQpUIffA.png" data-width="1270" data-height="730" src="https://cdn-images-1.medium.com/max/800/1*U6qlM_tRvBoc7elQpUIffA.png"></figure><h4 name="fc6d" id="fc6d" class="graf graf--h4 graf-after--figure">設定 cell 大小</h4><p name="cff4" id="cff4" class="graf graf--p graf-after--h4">假設一排 3 個 cell。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6385" id="6385" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CollectionViewController</span>: <span class="hljs-title class_">UICollectionViewController</span> {<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">configureCellSize</span>() {<br />        <span class="hljs-keyword">let</span> itemSpace: <span class="hljs-type">CGFloat</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br />        <span class="hljs-keyword">let</span> columnCount: <span class="hljs-type">CGFloat</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span><br />        <span class="hljs-keyword">let</span> flowLayout <span class="hljs-operator">=</span> collectionViewLayout <span class="hljs-keyword">as?</span> <span class="hljs-type">UICollectionViewFlowLayout</span><br />        <span class="hljs-keyword">let</span> width <span class="hljs-operator">=</span> floor((collectionView.bounds.width <span class="hljs-operator">-</span> itemSpace <span class="hljs-operator">*</span> (columnCount<span class="hljs-operator">-</span><span class="hljs-number">1</span>)) <span class="hljs-operator">/</span> columnCount)<br />        flowLayout<span class="hljs-operator">?</span>.itemSize <span class="hljs-operator">=</span> <span class="hljs-type">CGSize</span>(width: width, height: width)<br />        flowLayout<span class="hljs-operator">?</span>.estimatedItemSize <span class="hljs-operator">=</span> .zero<br />        flowLayout<span class="hljs-operator">?</span>.minimumInteritemSpacing <span class="hljs-operator">=</span> itemSpace<br />        flowLayout<span class="hljs-operator">?</span>.minimumLineSpacing <span class="hljs-operator">=</span> itemSpace<br />        <br />    }<br /><br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        configureCellSize()<br />    }</span></pre><h3 name="3296" id="3296" class="graf graf--h3 graf-after--pre">設定 cell 數量</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="52dc" id="52dc" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">numberOfItemsInSection</span> <span class="hljs-params">section</span>: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> {<br />    <span class="hljs-keyword">return</span> <span class="hljs-number">21</span><br />}</span></pre><h3 name="beda" id="beda" class="graf graf--h3 graf-after--pre">使用 UIBackgroundConfiguration 設定圖片</h3><p name="885c" id="885c" class="graf graf--p graf-after--h3">UIBackgroundConfiguration 的 image 設定顯示的圖片，imageContentMode 設定圖片縮放的模式，scaleAspectFill 將讓圖片維持比例填滿 cell。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="5dc3" id="5dc3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">cellForItemAt</span> <span class="hljs-params">indexPath</span>: <span class="hljs-type">IndexPath</span>) -&gt; <span class="hljs-type">UICollectionViewCell</span> {<br />        <span class="hljs-keyword">let</span> cell <span class="hljs-operator">=</span> collectionView.dequeueReusableCell(withReuseIdentifier: <span class="hljs-string">&quot;Cell&quot;</span>, for: indexPath)<br />        <span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />        backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;pic<span class="hljs-subst">\(indexPath.item)</span>&quot;</span>)<br />        backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFill<br />        cell.backgroundConfiguration <span class="hljs-operator">=</span> backgroundConfiguration<br />        <br />        <span class="hljs-keyword">return</span> cell<br />}</span></pre><p name="8590" id="8590" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">結果</strong></p><figure name="3fd2" id="3fd2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8b79NLVFl2ThMSd9UAFuHw.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*8b79NLVFl2ThMSd9UAFuHw.png"></figure><p name="4a85" id="4a85" class="graf graf--p graf-after--figure">透過 UIBackgroundConfiguration 我們還可設定許多特別的效果，比方以下例子。</p><ul class="postList"><li name="e3e4" id="e3e4" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">設定圓角</strong></li></ul><p name="0e2e" id="0e2e" class="graf graf--p graf-after--li">設定 cornerRadius。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2b2e" id="2b2e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;pic<span class="hljs-subst">\(indexPath.item)</span>&quot;</span>)<br />backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFill<br />backgroundConfiguration.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">20</span></span></pre><figure name="abf4" id="abf4" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*qRYIQuawwZ4G_1hYliomwA.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*qRYIQuawwZ4G_1hYliomwA.png"></figure><ul class="postList"><li name="2553" id="2553" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">設定圓角，邊框寬度，邊框顏色，圖片跟 cell 邊界的間距</strong></li></ul><p name="b502" id="b502" class="graf graf--p graf-after--li">backgroundInsets 可設定背景的內容跟 cell 上下左右邊界的間距。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="a0c3" id="a0c3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;pic<span class="hljs-subst">\(indexPath.item)</span>&quot;</span>)<br />backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFill<br />backgroundConfiguration.cornerRadius <span class="hljs-operator">=</span> <span class="hljs-number">20</span><br />backgroundConfiguration.strokeWidth <span class="hljs-operator">=</span> <span class="hljs-number">5</span><br />backgroundConfiguration.strokeColor <span class="hljs-operator">=</span> .black<br />backgroundConfiguration.backgroundInsets <span class="hljs-operator">=</span> <span class="hljs-type">NSDirectionalEdgeInsets</span>(top: <span class="hljs-number">5</span>, leading: <span class="hljs-number">5</span>, bottom: <span class="hljs-number">5</span>, trailing: <span class="hljs-number">5</span>)</span></pre><figure name="19d3" id="19d3" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*e3XmiXa4GTWYc2Mfthp91Q.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*e3XmiXa4GTWYc2Mfthp91Q.png"></figure><h3 name="540d" id="540d" class="graf graf--h3 graf-after--figure">水平滑動的分頁照片牆</h3><h4 name="5ed9" id="5ed9" class="graf graf--h4 graf-after--h3">在 assets 加入圖片跟設定 cell ID</h4><p name="d6e8" id="d6e8" class="graf graf--p graf-after--h4">參考格子狀照片牆的說明。</p><h4 name="99d2" id="99d2" class="graf graf--h4 graf-after--p">設定 collection view 的捲動方向為水平，勾選 Paging Enabled</h4><figure name="d3d6" id="d3d6" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*IpLzR6Gr1UaXvUES_9R3kQ.png" data-width="954" data-height="790" src="https://cdn-images-1.medium.com/max/800/1*IpLzR6Gr1UaXvUES_9R3kQ.png"></figure><p name="7fe7" id="7fe7" class="graf graf--p graf-after--figure">Scroll Direction 設為 Horizontal，勾選 Paging Enabled。</p><figure name="f9d1" id="f9d1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*UhJxq-42B_I2a0p2MCUdVA.png" data-width="534" data-height="768" src="https://cdn-images-1.medium.com/max/800/1*UhJxq-42B_I2a0p2MCUdVA.png"></figure><h4 name="50ff" id="50ff" class="graf graf--h4 graf-after--figure">設定 cell 大小為螢幕大小</h4><p name="2a2d" id="2a2d" class="graf graf--p graf-after--h4">由於 controller 繼承 UICollectionViewController，因此 collectionView.bounds.size 即為螢幕的大小。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2fc8" id="2fc8" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">CollectionViewController</span>: <span class="hljs-title class_">UICollectionViewController</span> {<br />    <br />    <span class="hljs-keyword">func</span> <span class="hljs-title function_">configureCellSize</span>() {<br />        <span class="hljs-keyword">let</span> flowLayout <span class="hljs-operator">=</span> collectionViewLayout <span class="hljs-keyword">as?</span> <span class="hljs-type">UICollectionViewFlowLayout</span><br />        flowLayout<span class="hljs-operator">?</span>.itemSize <span class="hljs-operator">=</span> collectionView.bounds.size<br />        flowLayout<span class="hljs-operator">?</span>.estimatedItemSize <span class="hljs-operator">=</span> .zero<br />        flowLayout<span class="hljs-operator">?</span>.minimumInteritemSpacing <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />        flowLayout<span class="hljs-operator">?</span>.minimumLineSpacing <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />        <br />    }<br /><br />    <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />        <span class="hljs-keyword">super</span>.viewDidLoad()<br />        configureCellSize()<br />        <br />    }</span></pre><h4 name="e9a1" id="e9a1" class="graf graf--h4 graf-after--pre">設定 cell 數量</h4><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1009" id="1009" class="graf graf--pre graf-after--h4 graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">numberOfItemsInSection</span> <span class="hljs-params">section</span>: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">Int</span> {<br />    <span class="hljs-keyword">return</span> <span class="hljs-number">21</span><br />}</span></pre><h4 name="5776" id="5776" class="graf graf--h4 graf-after--pre">使用 UIBackgroundConfiguration 設定圖片</h4><p name="bdaa" id="bdaa" class="graf graf--p graf-after--h4">imageContentMode 設為 scaleAspectFit，圖片將維持比例顯示，上下或左右留白。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2df7" id="2df7" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">cellForItemAt</span> <span class="hljs-params">indexPath</span>: <span class="hljs-type">IndexPath</span>) -&gt; <span class="hljs-type">UICollectionViewCell</span> {<br />        <span class="hljs-keyword">let</span> cell <span class="hljs-operator">=</span> collectionView.dequeueReusableCell(withReuseIdentifier: <span class="hljs-string">&quot;Cell&quot;</span>, for: indexPath)<br />        <span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />        backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;pic<span class="hljs-subst">\(indexPath.item)</span>&quot;</span>)<br />        backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFit<br />        cell.backgroundConfiguration <span class="hljs-operator">=</span> backgroundConfiguration<br />        <br />        <span class="hljs-keyword">return</span> cell<br />}</span></pre><p name="4e3c" id="4e3c" class="graf graf--p graf-after--pre">結果</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="5cf9" id="5cf9" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><img class="graf-image" data-image-id="1*ydZFLY1SKx5wLUXteuV7Eg.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/600/1*ydZFLY1SKx5wLUXteuV7Eg.png"></figure><figure name="58ff" id="58ff" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><img class="graf-image" data-image-id="1*uYw2IdVZ6ePx1CkkXYuQRw.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/600/1*uYw2IdVZ6ePx1CkkXYuQRw.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><h3 name="219d" id="219d" class="graf graf--h3 graf-after--figure">不分頁的水平滑動照片牆</h3><p name="8c0e" id="8c0e" class="graf graf--p graf-after--h3">我們也可以實現不分頁的水平滑動照片牆，比方以下例子。</p><p name="ec42" id="ec42" class="graf graf--p graf-after--p">設定 cell 的大小為 100 * 100，間距為 10。</p><figure name="7ba6" id="7ba6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*xTxAR865CKsyoGmaI_7zIg.png" data-width="1072" data-height="610" src="https://cdn-images-1.medium.com/max/800/1*xTxAR865CKsyoGmaI_7zIg.png"></figure><figure name="a636" id="a636" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*EttWASdYW8njwDM93emLyg.png" data-width="532" data-height="492" src="https://cdn-images-1.medium.com/max/800/1*EttWASdYW8njwDM93emLyg.png"></figure><p name="2329" id="2329" class="graf graf--p graf-after--figure">使用 UIBackgroundConfiguration 設定圖片。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="1f61" id="1f61" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">cellForItemAt</span> <span class="hljs-params">indexPath</span>: <span class="hljs-type">IndexPath</span>) -&gt; <span class="hljs-type">UICollectionViewCell</span> {<br />        <span class="hljs-keyword">let</span> cell <span class="hljs-operator">=</span> collectionView.dequeueReusableCell(withReuseIdentifier: <span class="hljs-string">&quot;Cell&quot;</span>, for: indexPath)<br />        <br />        <span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />        backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFill<br />        backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(named: <span class="hljs-string">&quot;pic<span class="hljs-subst">\(indexPath.item)</span>&quot;</span>)<br />        cell.backgroundConfiguration <span class="hljs-operator">=</span> backgroundConfiguration<br />        <br />        <br />        <span class="hljs-keyword">return</span> cell<br />        <br />}</span></pre><figure name="d1d6" id="d1d6" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*920fbJ0dshSq_p0qBgQO1A.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*920fbJ0dshSq_p0qBgQO1A.png"></figure><h3 name="60f1" id="60f1" class="graf graf--h3 graf-after--figure">顯示網路圖片的格子狀照片牆</h3><p name="6be4" id="6be4" class="graf graf--p graf-after--h3">搭配 NSCache 暫存網路圖片。</p><div name="c8a7" id="c8a7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-nscache-%E6%9A%AB%E5%AD%98%E7%B6%B2%E8%B7%AF%E5%9C%96%E7%89%87-70983260ceff" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-nscache-%E6%9A%AB%E5%AD%98%E7%B6%B2%E8%B7%AF%E5%9C%96%E7%89%87-70983260ceff" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-nscache-%E6%9A%AB%E5%AD%98%E7%B6%B2%E8%B7%AF%E5%9C%96%E7%89%87-70983260ceff"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 NSCache 暫存網路圖片</strong><br><em class="markup--em markup--mixtapeEmbed-em">開發 iOS App 時，我們時常從網路上抓圖，定義類似以下的抓圖 function。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-nscache-%E6%9A%AB%E5%AD%98%E7%B6%B2%E8%B7%AF%E5%9C%96%E7%89%87-70983260ceff" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d2e192d23eb72a59c549ffdfd9b3d30d" data-thumbnail-img-id="1*cKbq8UQav4vr8voEFP0MIA.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*cKbq8UQav4vr8voEFP0MIA.jpeg);"></a></div><p name="973d" id="973d" class="graf graf--p graf-after--mixtapeEmbed">先將 UIBackgroundConfiguration 的 image 設為預設圖片，抓到圖後再將 image 設為抓到的圖片。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6f1b" id="6f1b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">collectionView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">collectionView</span>: <span class="hljs-type">UICollectionView</span>, <span class="hljs-params">cellForItemAt</span> <span class="hljs-params">indexPath</span>: <span class="hljs-type">IndexPath</span>) -&gt; <span class="hljs-type">UICollectionViewCell</span> {<br />        <span class="hljs-keyword">let</span> cell <span class="hljs-operator">=</span> collectionView.dequeueReusableCell(withReuseIdentifier: <span class="hljs-string">&quot;Cell&quot;</span>, for: indexPath)<br />        <br />        <span class="hljs-keyword">var</span> backgroundConfiguration <span class="hljs-operator">=</span> <span class="hljs-type">UIBackgroundConfiguration</span>.listPlainCell()<br />        backgroundConfiguration.imageContentMode <span class="hljs-operator">=</span> .scaleAspectFill<br />        backgroundConfiguration.image <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(systemName: <span class="hljs-string">&quot;photo&quot;</span>)<br />        cell.backgroundConfiguration <span class="hljs-operator">=</span> backgroundConfiguration<br />        <br />        <span class="hljs-keyword">let</span> feed <span class="hljs-operator">=</span> feeds[indexPath.item]<br />        <span class="hljs-type">NetworkController</span>.shared.fetchImage(url: feed.artworkUrl100) { [<span class="hljs-keyword">weak</span> <span class="hljs-keyword">self</span>] image <span class="hljs-keyword">in</span><br />            <span class="hljs-type">DispatchQueue</span>.main.async {<br />                <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> <span class="hljs-keyword">self</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span>,<br />                      <span class="hljs-keyword">let</span> image <span class="hljs-operator">=</span> image,<br />                      <span class="hljs-keyword">let</span> item <span class="hljs-operator">=</span> collectionView.indexPath(for: cell)<span class="hljs-operator">?</span>.item,<br />                      feed.id <span class="hljs-operator">==</span> <span class="hljs-keyword">self</span>.feeds[item].id <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />                <br />                backgroundConfiguration.image <span class="hljs-operator">=</span> image<br />                cell.backgroundConfiguration <span class="hljs-operator">=</span> backgroundConfiguration<br />            }<br />        }<br />        <br />        <span class="hljs-keyword">return</span> cell<br />}</span></pre><figure name="f107" id="f107" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*JA9Q_6fHPukwQeayN7S9pw.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*JA9Q_6fHPukwQeayN7S9pw.png"></figure><p name="425d" id="425d" class="graf graf--p graf-after--figure">網路圖片照片牆的範例連結。</p><div name="cb63" id="cb63" class="graf graf--mixtapeEmbed graf-after--p graf--trailing"><a href="https://github.com/AppPeterPan/UIBackgroundConfiguration-collection-view" data-href="https://github.com/AppPeterPan/UIBackgroundConfiguration-collection-view" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/AppPeterPan/UIBackgroundConfiguration-collection-view"><strong class="markup--strong markup--mixtapeEmbed-strong">GitHub - AppPeterPan/UIBackgroundConfiguration-collection-view</strong><br><em class="markup--em markup--mixtapeEmbed-em">Contribute to AppPeterPan/UIBackgroundConfiguration-collection-view development by creating an account on GitHub.</em>github.com</a><a href="https://github.com/AppPeterPan/UIBackgroundConfiguration-collection-view" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="d75c8d3e9d2ada0aa232eadc1c415b1d" data-thumbnail-img-id="0*x3N1Elfea7HZxaVk" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*x3N1Elfea7HZxaVk);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/7d30e6df1a77"><time class="dt-published" datetime="2021-08-13T07:03:04.333Z">August 13, 2021</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-uibackgroundconfiguration-%E5%9C%A8-collection-view-cell-%E9%A1%AF%E7%A4%BA%E5%9C%96%E7%89%87-7d30e6df1a77" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>