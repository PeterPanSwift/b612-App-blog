<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>SwiftUI 選擇照片的 PhotosPicker</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">SwiftUI 選擇照片的 PhotosPicker</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 SwiftUI iOS App 時，利用 PhotosUI 的 PhotosPicker 可以快速實現從 iPhone 照片 App 選擇照片和影片的功能，而且還可以多選呢。以下我們一步步介紹 PhotosPicker 的相關功能。
</section>
<section data-field="body" class="e-content">
<section name="1bbe" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6830" id="6830" class="graf graf--h3 graf--leading graf--title">SwiftUI 選擇照片的 PhotosPicker</h3><p name="49e6" id="49e6" class="graf graf--p graf-after--h3">開發 SwiftUI iOS App 時，利用 PhotosUI 的 PhotosPicker 可以快速實現從 iPhone 照片 App 選擇照片和影片的功能，而且還可以多選呢。以下我們一步步介紹 PhotosPicker 的相關功能。</p><div name="0cfc" id="0cfc" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/photosui/photospicker" data-href="https://developer.apple.com/documentation/photosui/photospicker" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/photosui/photospicker"><strong class="markup--strong markup--mixtapeEmbed-strong">PhotosPicker | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">A view that displays a Photos picker for choosing assets from the photo library.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/photosui/photospicker" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="ecff7a4fef8eab1e2fb5e77e9847196d" data-thumbnail-img-id="0*BUFMvVpvWXK2dT35" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*BUFMvVpvWXK2dT35);"></a></div><ul class="postList"><li name="0bf9" id="0bf9" class="graf graf--li graf-after--mixtapeEmbed">顯示選擇照片的照片牆。</li><li name="f0cf" id="f0cf" class="graf graf--li graf-after--li">指定選擇的資料類型。</li><li name="fad6" id="fad6" class="graf graf--li graf-after--li">選擇多張照片。</li><li name="4891" id="4891" class="graf graf--li graf-after--li">將選擇的照片變成畫面上的 Image。</li><li name="ba3e" id="ba3e" class="graf graf--li graf-after--li">顯示選擇的多張照片。</li></ul><h3 name="c446" id="c446" class="graf graf--h3 graf-after--li">顯示選擇照片的照片牆</h3><p name="812b" id="812b" class="graf graf--p graf-after--h3">利用 PhotosUI 的 PhotosPicker 製作選擇照片的按鈕，它的 init 宣告如下，PhotosPicker 要綁定型別 PhotosPickerItem? 的資料。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="da6d" id="da6d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">init</span>(<br />    <span class="hljs-params">selection</span>: <span class="hljs-type">Binding</span>&lt;<span class="hljs-type">PhotosPickerItem</span>?&gt;,<br />    <span class="hljs-params">matching</span> <span class="hljs-params">filter</span>: <span class="hljs-type">PHPickerFilter</span>? <span class="hljs-operator">=</span> <span class="hljs-literal">nil</span>,<br />    <span class="hljs-params">preferredItemEncoding</span>: <span class="hljs-type">PhotosPickerItem</span>.<span class="hljs-type">EncodingDisambiguationPolicy</span> <span class="hljs-operator">=</span> .automatic,<br />    <span class="hljs-meta">@ViewBuilder</span> <span class="hljs-params">label</span>: () -&gt; <span class="hljs-type">Label</span><br />)</span></pre><p name="1467" id="1467" class="graf graf--p graf-after--pre">以下例子裡，選擇照片的按鈕將顯示 SF Symbol <code class="markup--code markup--p-code">photo.badge.plus.fill</code>，點擊按鈕後將顯示來自照片 App 的照片牆，選了照片後會存到 selectedPhotoItem。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6e9f" id="6e9f" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> PhotosUI<br /><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItem: <span class="hljs-type">PhotosPickerItem</span>?<br /><br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItem</span>) {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />        }<br />        .padding()<br />    }<br />}</span></pre><figure name="220e" id="220e" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*IBzizpUCSZOPJjurxfpiRQ.png" data-width="675" data-height="1380" src="https://cdn-images-1.medium.com/max/800/1*IBzizpUCSZOPJjurxfpiRQ.png"></figure><figure name="49c6" id="49c6" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*qYvrX-q2hz8GREYqP3-Aow.png" data-width="675" data-height="1380" src="https://cdn-images-1.medium.com/max/800/1*qYvrX-q2hz8GREYqP3-Aow.png"></figure><h3 name="e89e" id="e89e" class="graf graf--h3 graf-after--figure">指定選擇的資料類型</h3><p name="1fbf" id="1fbf" class="graf graf--p graf-after--h3">透過 PhotosPicker 的 matching 可指定選擇的資料類型，比方只想選照片，不想選影片可傳入 <code class="markup--code markup--p-code">.image</code>。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="3ac2" id="3ac2" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> PhotosUI<br /><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItem: <span class="hljs-type">PhotosPickerItem</span>?<br /><br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItem</span>, matching: .images) {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />        }<br />        .padding()<br />    }<br />}</span></pre><figure name="619a" id="619a" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*zeZfINOxZ3prxvDQOtvtkQ.png" data-width="854" data-height="970" src="https://cdn-images-1.medium.com/max/800/1*zeZfINOxZ3prxvDQOtvtkQ.png"></figure><h3 name="dca0" id="dca0" class="graf graf--h3 graf-after--figure">選擇多張照片</h3><p name="aa6e" id="aa6e" class="graf graf--p graf-after--h3">綁定 PhotosPickerItem? 的 PhotosPicker 只能選擇一張照片，若想選擇多張照片，請改成綁定型別 [PhotosPickerItem] 的 array。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ff57" id="ff57" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> PhotosUI<br /><span class="hljs-keyword">import</span> SwiftUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItems: [<span class="hljs-type">PhotosPickerItem</span>] <span class="hljs-operator">=</span> []<br /><br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItems</span>, matching: .images) {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />        }<br />        .padding()<br />    }<br />}</span></pre><p name="dfd8" id="dfd8" class="graf graf--p graf-after--pre">可選擇多張照片後再按右上的勾勾確認。</p><figure name="86c8" id="86c8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*FoMA0S_NdRiONsKelBgHrQ.png" data-width="675" data-height="1380" src="https://cdn-images-1.medium.com/max/800/1*FoMA0S_NdRiONsKelBgHrQ.png"></figure><p name="42ef" id="42ef" class="graf graf--p graf-after--figure">透過 PhotosPicker 的 maxSelectionCount 可限制多選的照片數量。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="9ed7" id="9ed7" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItems: [<span class="hljs-type">PhotosPickerItem</span>] <span class="hljs-operator">=</span> []<br /><br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItems</span>, maxSelectionCount: <span class="hljs-number">3</span>, matching: .images) {<br />            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                .resizable()<br />                .scaledToFit()<br />        }<br />        .padding()<br />    }<br />}</span></pre><h3 name="eecc" id="eecc" class="graf graf--h3 graf-after--pre">將選擇的照片變成畫面上的 Image</h3><p name="266f" id="266f" class="graf graf--p graf-after--h3">當使用者選擇照片後，我們得到的是型別 PhotosPickerItem 的資料，因此必須透過 function loadTransferable 將它變成 Data，然後再從 Data 變成 UIImage，最後再變成畫面上的 Image。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="9c08" id="9c08" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> PhotosUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItem: <span class="hljs-type">PhotosPickerItem</span>?<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> imageData: <span class="hljs-type">Data</span>?<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItem</span>, matching: .images) {<br />            <span class="hljs-type">Group</span> {<br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> imageData,<br />                   <span class="hljs-keyword">let</span> uiImage <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(data: imageData) {<br />                    <span class="hljs-type">Image</span>(uiImage: uiImage)<br />                        .resizable()<br />                        .scaledToFill()<br />                } <span class="hljs-keyword">else</span> {<br />                    <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                        .resizable()<br />                        .scaledToFit()<br />                }<br />            }<br />            .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />            .clipped()<br />        }<br />        .onChange(of: selectedPhotoItem) {<br />            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> selectedPhotoItem <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />            <span class="hljs-type">Task</span> {<br />                imageData <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> <span class="hljs-keyword">await</span> selectedPhotoItem.loadTransferable(type: <span class="hljs-type">Data</span>.<span class="hljs-keyword">self</span>)<br />            }<br />        }<br /><br />    }<br />}</span></pre><figure name="6f20" id="6f20" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*rqN_IeVDYrxQsgeUoQ1qiw.png" data-width="675" data-height="1380" src="https://cdn-images-1.medium.com/max/800/1*rqN_IeVDYrxQsgeUoQ1qiw.png"></figure><p name="5191" id="5191" class="graf graf--p graf-after--figure">程式說明。</p><ul class="postList"><li name="c69f" id="c69f" class="graf graf--li graf-after--p">利用 onChange 偵測 selectedPhotoItem 有變化，使用者選了照片。</li><li name="31a2" id="31a2" class="graf graf--li graf-after--li">透過 loadTransferable(type: Data.self) 得到型別 Data 的圖片資料。因此 loadTransferable 是 async throws function，因此要搭配 try await 並在 Task { } 裡呼叫。</li><li name="bf35" id="bf35" class="graf graf--li graf-after--li">有了 Data 後，將 Data 變成 UIImage，然後再用 <code class="markup--code markup--li-code">Image(uiImage: uiImage)</code> 變成畫面上的圖片。</li></ul><p name="08df" id="08df" class="graf graf--p graf-after--li">loadTransferable(type: Image.self) 是另一種可行的寫法，它可直接取得畫面上顯示的 Image。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e6a5" id="e6a5" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">selectedPhotoItem.loadTransferable(type: <span class="hljs-type">Image</span>.<span class="hljs-keyword">self</span>)</span></pre><p name="dd09" id="dd09" class="graf graf--p graf-after--pre">然而此做法有一些缺點，有些格式的圖片會轉換失敗，有些圖片會在轉換後方向出問題，因此還是建議使用 <code class="markup--code markup--p-code">loadTransferable(type: Data.self) </code>先取得圖片的 Data。</p><p name="9ab0" id="9ab0" class="graf graf--p graf-after--p">除了使用 onChange 偵測使用者選了照片，我們也可以透過 <code class="markup--code markup--p-code">task(id:priority:_:)</code> ，在參數 id 傳入 selectedPhotoItem，當 selectedPhotoItem 有變化時將觸發執行 task { } 的非同步程式。</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="swift" name="bad4" id="bad4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> PhotosUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItem: <span class="hljs-type">PhotosPickerItem</span>?<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> imageData: <span class="hljs-type">Data</span>?<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItem</span>, matching: .images) {<br />            <span class="hljs-type">Group</span> {<br />                <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> imageData,<br />                   <span class="hljs-keyword">let</span> uiImage <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(data: imageData) {<br />                    <span class="hljs-type">Image</span>(uiImage: uiImage)<br />                        .resizable()<br />                        .scaledToFill()<br />                } <span class="hljs-keyword">else</span> {<br />                    <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;photo.badge.plus.fill&quot;</span>)<br />                        .resizable()<br />                        .scaledToFit()<br />                }<br />            }<br />            .frame(width: <span class="hljs-number">300</span>, height: <span class="hljs-number">300</span>)<br />            .clipped()<br />        }<br />        .task(id: selectedPhotoItem, {<br />            <span class="hljs-keyword">guard</span> <span class="hljs-keyword">let</span> selectedPhotoItem <span class="hljs-keyword">else</span> { <span class="hljs-keyword">return</span> }<br />            imageData <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-keyword">await</span> selectedPhotoItem.loadTransferable(type: <span class="hljs-type">Data</span>.<span class="hljs-keyword">self</span>)<br />        })<br />        <br />    }<br />}</span></pre><h3 name="705a" id="705a" class="graf graf--h3 graf-after--pre">顯示選擇的多張照片</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ff59" id="ff59" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> PhotosUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItems <span class="hljs-operator">=</span> [<span class="hljs-type">PhotosPickerItem</span>]()<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> imagesData: [<span class="hljs-type">Data</span>] <span class="hljs-operator">=</span> []<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span>(spacing: <span class="hljs-number">20</span>) {<br />            <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItems</span>, matching: .images) {<br />                <span class="hljs-type">Label</span>(<span class="hljs-string">&quot;選擇照片&quot;</span>, systemImage: <span class="hljs-string">&quot;photo.on.rectangle.angled&quot;</span>)<br />                    .font(.headline)<br />                    .padding()<br />                    .background(<span class="hljs-type">Color</span>.blue, in: .rect(cornerRadius: <span class="hljs-number">10</span>))<br />                    .foregroundStyle(.white)<br />            }<br />            <span class="hljs-type">ScrollView</span>(.horizontal) {<br />                <span class="hljs-type">HStack</span>(spacing: <span class="hljs-number">15</span>) {<br />                    <span class="hljs-type">ForEach</span>(imagesData.indices, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span><br />                        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> uiImage <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(data: imagesData[index]) {<br />                            <span class="hljs-type">Image</span>(uiImage: uiImage)<br />                                .resizable()<br />                                .scaledToFill()<br />                                .frame(width: <span class="hljs-number">150</span>, height: <span class="hljs-number">150</span>)<br />                                .clipShape(.circle)<br />                        }<br />                    }<br />                }<br />            }<br />            .contentMargins(<span class="hljs-number">20</span>)<br />        }<br />        .onChange(of: selectedPhotoItems) {<br />            <span class="hljs-type">Task</span> {<br />                imagesData.removeAll()<br />                <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> selectedPhotoItems {<br />                    <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-keyword">try?</span> <span class="hljs-keyword">await</span> item.loadTransferable(type: <span class="hljs-type">Data</span>.<span class="hljs-keyword">self</span>) {<br />                        imagesData.append(data)<br />                    }<br />                }<br />            }<br />        }<br />    }<br />}</span></pre><p name="4253" id="4253" class="graf graf--p graf-after--pre">利用 for item in selectedPhotoItems 讀取 array 的成員，透過 loadTransferable 將多個選取的照片變成 Data。</p><figure name="a97a" id="a97a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*650w1C7ZTe0xn3T1rTd4xw.png" data-width="675" data-height="1380" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*650w1C7ZTe0xn3T1rTd4xw.png"></figure><p name="e059" id="e059" class="graf graf--p graf-after--figure">剛剛的寫法有個小小的缺點，它會依序呼叫 loadTransferable 取得圖片的 Data，因此要等第一張圖轉換成 Data 後再開始轉換第二張圖，等第二張圖轉換成 Data 後再開始轉換第三張圖。</p><p name="335e" id="335e" class="graf graf--p graf-after--p">若想要效能更好，可利用 Task Group 讓 array 的成員同時呼叫 loadTransferable。(ps: 此寫法圖片抓到的順序不見得跟原本使用者選擇照片的順序一致，若想要一致需另外處理)</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e373" id="e373" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> SwiftUI<br /><span class="hljs-keyword">import</span> PhotosUI<br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">ContentView</span>: <span class="hljs-title class_">View</span> {<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> selectedPhotoItems <span class="hljs-operator">=</span> [<span class="hljs-type">PhotosPickerItem</span>]()<br />    <span class="hljs-meta">@State</span> <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> imagesData: [<span class="hljs-type">Data</span>] <span class="hljs-operator">=</span> []<br />    <br />    <span class="hljs-keyword">var</span> body: <span class="hljs-keyword">some</span> <span class="hljs-type">View</span> {<br />        <span class="hljs-type">VStack</span>(spacing: <span class="hljs-number">20</span>) {<br />            <span class="hljs-type">PhotosPicker</span>(selection: <span class="hljs-variable">$selectedPhotoItems</span>, matching: .images) {<br />                <span class="hljs-type">Label</span>(<span class="hljs-string">&quot;選擇照片&quot;</span>, systemImage: <span class="hljs-string">&quot;photo.on.rectangle.angled&quot;</span>)<br />                    .font(.headline)<br />                    .padding()<br />                    .background(<span class="hljs-type">Color</span>.blue, in: .rect(cornerRadius: <span class="hljs-number">10</span>))<br />                    .foregroundStyle(.white)<br />            }<br />            <span class="hljs-type">ScrollView</span>(.horizontal) {<br />                <span class="hljs-type">HStack</span>(spacing: <span class="hljs-number">15</span>) {<br />                    <span class="hljs-type">ForEach</span>(imagesData.indices, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span><br />                        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> uiImage <span class="hljs-operator">=</span> <span class="hljs-type">UIImage</span>(data: imagesData[index]) {<br />                            <span class="hljs-type">Image</span>(uiImage: uiImage)<br />                                .resizable()<br />                                .scaledToFill()<br />                                .frame(width: <span class="hljs-number">150</span>, height: <span class="hljs-number">150</span>)<br />                                .clipShape(.circle)<br />                        }<br />                    }<br />                }<br />            }<br />            .contentMargins(<span class="hljs-number">20</span>)<br />        }<br />        .onChange(of: selectedPhotoItems) {<br />            <span class="hljs-type">Task</span> {<br />                imagesData <span class="hljs-operator">=</span> <span class="hljs-keyword">await</span> withTaskGroup(of: <span class="hljs-type">Data</span>?.<span class="hljs-keyword">self</span>) { group <span class="hljs-keyword">in</span><br />                    <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> selectedPhotoItems {<br />                        group.addTask {<br />                            <span class="hljs-keyword">try?</span> <span class="hljs-keyword">await</span> item.loadTransferable(type: <span class="hljs-type">Data</span>.<span class="hljs-keyword">self</span>)<br />                        }<br />                    }<br />                    <br />                    <span class="hljs-keyword">var</span> results: [<span class="hljs-type">Data</span>] <span class="hljs-operator">=</span> []<br />                    <span class="hljs-keyword">for</span> <span class="hljs-keyword">await</span> data <span class="hljs-keyword">in</span> group {<br />                        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> data {<br />                            results.append(data)<br />                        }<br />                    }<br />                    <span class="hljs-keyword">return</span> results<br />                }<br />            }<br />        }<br />    }<br />}</span></pre><h3 name="8a06" id="8a06" class="graf graf--h3 graf-after--pre">參考範例連結</h3><div name="22b0" id="22b0" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://developer.apple.com/tutorials/develop-in-swift/collect-model-and-store-data" data-href="https://developer.apple.com/tutorials/develop-in-swift/collect-model-and-store-data" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/tutorials/develop-in-swift/collect-model-and-store-data"><strong class="markup--strong markup--mixtapeEmbed-strong">Collect, model, and store data | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Start building an app that lets people record moments of gratitude. In this tutorial, you&#39;ll create an entry view with…</em>developer.apple.com</a><a href="https://developer.apple.com/tutorials/develop-in-swift/collect-model-and-store-data" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="305cffea2c2aaa258320bd7fc2865e79" data-thumbnail-img-id="0*4FaIuF2gWd1gf05u" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*4FaIuF2gWd1gf05u);"></a></div><div name="e09a" id="e09a" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developer.apple.com/documentation/photokit/implementing-an-inline-photos-picker" data-href="https://developer.apple.com/documentation/photokit/implementing-an-inline-photos-picker" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/photokit/implementing-an-inline-photos-picker"><strong class="markup--strong markup--mixtapeEmbed-strong">Implementing an inline Photos picker | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Embed a system-provided, half-height Photos picker into your app&#39;s view.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/photokit/implementing-an-inline-photos-picker" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="8b3f094289532ecc4fc3d8f56991ea16" data-thumbnail-img-id="0*pTAqvAOEY5QMEUEq" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*pTAqvAOEY5QMEUEq);"></a></div><div name="d7d6" id="d7d6" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed graf--trailing"><a href="https://developer.apple.com/documentation/photokit/bringing-photos-picker-to-your-swiftui-app" data-href="https://developer.apple.com/documentation/photokit/bringing-photos-picker-to-your-swiftui-app" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/photokit/bringing-photos-picker-to-your-swiftui-app"><strong class="markup--strong markup--mixtapeEmbed-strong">Bringing Photos picker to your SwiftUI app | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Select media assets by using a Photos picker view that SwiftUI provides.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/photokit/bringing-photos-picker-to-your-swiftui-app" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="5cc72e07c69d6214166ed0721a41b453" data-thumbnail-img-id="0*d-9kOvC8CGRGrRJr" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*d-9kOvC8CGRGrRJr);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/6dcbf4a5854d"><time class="dt-published" datetime="2025-10-29T03:25:17.924Z">October 29, 2025</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swiftui-%E9%81%B8%E6%93%87%E7%85%A7%E7%89%87%E7%9A%84-photospicker-6dcbf4a5854d" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on November 16, 2025.</p></footer></article></body></html>