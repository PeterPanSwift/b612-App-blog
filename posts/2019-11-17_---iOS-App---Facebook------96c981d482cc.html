<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>實作 iOS App 的 Facebook 登入功能</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">實作 iOS App 的 Facebook 登入功能</h1>
</header>
<section data-field="subtitle" class="p-summary">
在這個幾乎人人都有 FB 帳號的時代，很多 iOS App 都有 FB 登入功能，讓使用者不用再麻煩地註冊帳號密碼。
</section>
<section data-field="body" class="e-content">
<section name="a1a1" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="255f" id="255f" class="graf graf--h3 graf--leading graf--title">實作 iOS App 的 Facebook 登入功能</h3><p name="e271" id="e271" class="graf graf--p graf-after--h3">在這個幾乎人人都有 FB 帳號的時代，很多 iOS App 都有 FB 登入功能，讓使用者不用再麻煩地註冊帳號密碼。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="3"><figure name="afdd" id="afdd" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 33.333%;"><img class="graf-image" data-image-id="1*wn9n1lCizzBc6Yd2Soaoag.png" data-width="1125" data-height="2436" src="https://cdn-images-1.medium.com/max/400/1*wn9n1lCizzBc6Yd2Soaoag.png"></figure><figure name="e6b1" id="e6b1" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.333%;"><img class="graf-image" data-image-id="1*4O4WILTZEWSU7ltLWyLAyA.png" data-width="1125" data-height="2436" src="https://cdn-images-1.medium.com/max/400/1*4O4WILTZEWSU7ltLWyLAyA.png"></figure><figure name="ef38" id="ef38" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 33.333%;"><img class="graf-image" data-image-id="1*7plV8apGYd6SrH_MGGyQWg.png" data-width="1125" data-height="2436" data-is-featured="true" src="https://cdn-images-1.medium.com/max/400/1*7plV8apGYd6SrH_MGGyQWg.png"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="8bfe" id="8bfe" class="graf graf--p graf-after--figure">接下來就讓我們一步步實現 FB 登入功能吧。</p><h3 name="3705" id="3705" class="graf graf--h3 graf-after--p">FB iOS SDK 的官方文件</h3><p name="3f35" id="3f35" class="graf graf--p graf-after--h3">喜歡照著官方說明一步步操作的朋友，可參考以下連結。</p><div name="8a19" id="8a19" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developers.facebook.com/docs/ios/getting-started/" data-href="https://developers.facebook.com/docs/ios/getting-started/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developers.facebook.com/docs/ios/getting-started/"><strong class="markup--strong markup--mixtapeEmbed-strong">Getting Started - iOS SDK - Documentation - Facebook for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">The Facebook SDK for iOS is the easiest way to integrate your iOS app with Facebook. It enables: Open the Facebook App…</em>developers.facebook.com</a><a href="https://developers.facebook.com/docs/ios/getting-started/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c66e4f067030da3cd1749245065e2880" data-thumbnail-img-id="0*SjllYipYe3yFhoGM" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SjllYipYe3yFhoGM);"></a></div><div name="670a" id="670a" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developers.facebook.com/docs/facebook-login/ios" data-href="https://developers.facebook.com/docs/facebook-login/ios" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developers.facebook.com/docs/facebook-login/ios"><strong class="markup--strong markup--mixtapeEmbed-strong">iOS - Facebook Login - Documentation - Facebook for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">Set up your development environment before using Facebook Login for iOS. Using Swift Package Manager (SPM) In Xcode…</em>developers.facebook.com</a><a href="https://developers.facebook.com/docs/facebook-login/ios" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="90e9a59cc770c00074b4eef820141eb2" data-thumbnail-img-id="0*8SsbLgrvw5QzdnTk" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*8SsbLgrvw5QzdnTk);"></a></div><p name="0e7c" id="0e7c" class="graf graf--p graf-after--mixtapeEmbed">懶得看官方說明的朋友，則可跟著彼得潘一步步實現 FB 登入功能。</p><h3 name="2fa3" id="2fa3" class="graf graf--h3 graf-after--p">連到 Facebook 開發網站</h3><div name="d7b4" id="d7b4" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://developers.facebook.com/" data-href="https://developers.facebook.com/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developers.facebook.com/"><strong class="markup--strong markup--mixtapeEmbed-strong">Facebook for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">Join a community of developers, attend meetups and collaborate online. Learn what Facebook is creating to bring the…</em>developers.facebook.com</a><a href="https://developers.facebook.com/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="06ec1b01abc40685aa2506362adbb141" data-thumbnail-img-id="0*wANNmYUyG2FPGnVS" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*wANNmYUyG2FPGnVS);"></a></div><h3 name="f675" id="f675" class="graf graf--h3 graf-after--mixtapeEmbed">建立 App</h3><p name="7351" id="7351" class="graf graf--p graf-after--h3">為了在 iOS App 加入 FB 登入功能，我們得先在 FB 開發網站上建立一個對應的 App。</p><ul class="postList"><li name="5641" id="5641" class="graf graf--li graf-after--p">點選右上方的 My Apps。</li></ul><figure name="1ad7" id="1ad7" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*-Jnex9rDrQJDQHbY_1Mb0Q.png" data-width="1378" data-height="520" src="https://cdn-images-1.medium.com/max/800/1*-Jnex9rDrQJDQHbY_1Mb0Q.png"></figure><ul class="postList"><li name="af53" id="af53" class="graf graf--li graf-after--figure">點選右上的 Create App。</li></ul><figure name="a7e6" id="a7e6" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*sJNQJiEjOED3whgmKNV_JQ.png" data-width="254" data-height="132" src="https://cdn-images-1.medium.com/max/800/1*sJNQJiEjOED3whgmKNV_JQ.png"></figure><p name="9178" id="9178" class="graf graf--p graf-after--figure">選擇 App 的類型，一般我們會選擇 Consumer，比方 FB Login 功能即屬於 Consumer 類型。</p><figure name="f627" id="f627" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1LpWr26w3DcJyIOQoA6XQA.png" data-width="1600" data-height="1168" src="https://cdn-images-1.medium.com/max/800/1*1LpWr26w3DcJyIOQoA6XQA.png"></figure><p name="a803" id="a803" class="graf graf--p graf-after--figure">輸入 App 名稱後點選右下的 Create App。</p><figure name="69ff" id="69ff" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_MZdccACnkLxeD8GpL0NNQ.png" data-width="1456" data-height="794" src="https://cdn-images-1.medium.com/max/800/1*_MZdccACnkLxeD8GpL0NNQ.png"></figure><h3 name="6f7f" id="6f7f" class="graf graf--h3 graf-after--figure">在 App 頁面點選 Facebook Login 下的 Set up</h3><figure name="5e2d" id="5e2d" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*anjxj8E-0GqbRJmkdVU8Zw.png" data-width="2450" data-height="1190" src="https://cdn-images-1.medium.com/max/800/1*anjxj8E-0GqbRJmkdVU8Zw.png"></figure><h3 name="702f" id="702f" class="graf graf--h3 graf-after--figure">點選 iOS</h3><figure name="3dda" id="3dda" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*MPj_piVohkqNGHSGQ91TkQ.png" data-width="1774" data-height="550" src="https://cdn-images-1.medium.com/max/800/1*MPj_piVohkqNGHSGQ91TkQ.png"></figure><p name="0783" id="0783" class="graf graf--p graf-after--figure">點選 Next。</p><figure name="82e5" id="82e5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*78GiCKwiWnuJ8AJokAWzVA.png" data-width="2120" data-height="1028" src="https://cdn-images-1.medium.com/max/800/1*78GiCKwiWnuJ8AJokAWzVA.png"></figure><h3 name="64a6" id="64a6" class="graf graf--h3 graf-after--figure">輸入 Bundle ID</h3><figure name="986f" id="986f" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*xS_ku5tR4IdKMFEwhgpmKw.png" data-width="1946" data-height="926" src="https://cdn-images-1.medium.com/max/800/1*xS_ku5tR4IdKMFEwhgpmKw.png"></figure><p name="51a0" id="51a0" class="graf graf--p graf-after--figure">可從 TARGETS App 的 General 頁面查詢 Bundle ID 。</p><figure name="e823" id="e823" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jCgWBu96_Wsa-ZR21s7Tog.png" data-width="1400" data-height="349" src="https://cdn-images-1.medium.com/max/800/1*jCgWBu96_Wsa-ZR21s7Tog.png"></figure><h3 name="e3cd" id="e3cd" class="graf graf--h3 graf-after--figure">將 Single Sign On 設為 Yes</h3><figure name="cfa5" id="cfa5" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*vejg2F-YQshJmnxfVK9Qyw.png" data-width="1974" data-height="738" src="https://cdn-images-1.medium.com/max/800/1*vejg2F-YQshJmnxfVK9Qyw.png"></figure><h3 name="084c" id="084c" class="graf graf--h3 graf-after--figure">設定 Info 頁面</h3><figure name="04bd" id="04bd" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*1-SFC0FD-qK43YejDAOKxQ.png" data-width="1918" data-height="754" src="https://cdn-images-1.medium.com/max/800/1*1-SFC0FD-qK43YejDAOKxQ.png"></figure><p name="58ce" id="58ce" class="graf graf--p graf-after--figure">切換到 App 的 Info 頁面，找到 URL Types 區塊，點選 + 新增 URL Type。</p><figure name="d2d6" id="d2d6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SkxYBwAb35Vr4stB-wt0nQ.png" data-width="2342" data-height="1410" src="https://cdn-images-1.medium.com/max/800/1*SkxYBwAb35Vr4stB-wt0nQ.png"></figure><p name="baea" id="baea" class="graf graf--p graf-after--figure">在 URL Schemes 輸入剛剛在 Facebook 開發網站建立的 App 的 App ID，格式為 fb 後接 App ID。</p><figure name="d5ae" id="d5ae" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Fn4Q0ZRpWMmlGr8e7bsAlQ.png" data-width="1672" data-height="548" src="https://cdn-images-1.medium.com/max/800/1*Fn4Q0ZRpWMmlGr8e7bsAlQ.png"></figure><p name="ed68" id="ed68" class="graf graf--p graf-after--figure">App ID 可從 FB 開發網站上的 App 頁面查詢。</p><figure name="bc2d" id="bc2d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*KGKZJu_tEukBTcObMspbTw.png" data-width="988" data-height="428" src="https://cdn-images-1.medium.com/max/800/1*KGKZJu_tEukBTcObMspbTw.png"></figure><p name="fbf6" id="fbf6" class="graf graf--p graf-after--figure">在 Info 頁面新增 FacebookAppID &amp; FacebookDisplayName，內容一樣來自 FB 開發網站的 App 頁面。</p><figure name="a2ec" id="a2ec" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*nHQ26mztcMHkQIRj2L9RNA.png" data-width="2026" data-height="472" src="https://cdn-images-1.medium.com/max/800/1*nHQ26mztcMHkQIRj2L9RNA.png"></figure><figure name="dcbf" id="dcbf" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*KGKZJu_tEukBTcObMspbTw.png" data-width="988" data-height="428" src="https://cdn-images-1.medium.com/max/800/1*KGKZJu_tEukBTcObMspbTw.png"></figure><p name="db2c" id="db2c" class="graf graf--p graf-after--figure">在 Info 頁面新增 FacebookClientToken，內容一樣來自 FB 開發網站的 App 頁面。</p><figure name="0755" id="0755" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*p31qqMGlCTL7Lzcn8rItpQ.png" data-width="2040" data-height="488" src="https://cdn-images-1.medium.com/max/800/1*p31qqMGlCTL7Lzcn8rItpQ.png"></figure><p name="e5a9" id="e5a9" class="graf graf--p graf-after--figure">FacebookClientToken 可從 FB 開發網站上的 App 頁面查詢，從 Settings &gt; Advanced 的 Client token 欄位。</p><figure name="032c" id="032c" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*aZDdG0_aqqdUAurK9CBzyA.png" data-width="2466" data-height="686" src="https://cdn-images-1.medium.com/max/800/1*aZDdG0_aqqdUAurK9CBzyA.png"></figure><p name="68a0" id="68a0" class="graf graf--p graf-after--figure">在 App 的 Info 頁面新增型別 array 的 LSApplicationQueriesSchemes，包含 fbapi &amp; fb-messenger-share-api ，讓 App 之後能啟動 FB App。</p><figure name="3f6d" id="3f6d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*ddvZHq7LOHsWuQWZexZVlQ.png" data-width="1672" data-height="606" src="https://cdn-images-1.medium.com/max/800/1*ddvZHq7LOHsWuQWZexZVlQ.png"></figure><h3 name="836d" id="836d" class="graf graf--h3 graf-after--figure">打開 Keychain Sharing 的功能</h3><p name="c548" id="c548" class="graf graf--p graf-after--h3">切換到 TARGETS App 的 Signing &amp; Capabilities 頁面，點選 + 新增功能。</p><figure name="34b5" id="34b5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*AIALysoBKj_pyfew2AC44A.png" data-width="1568" data-height="646" src="https://cdn-images-1.medium.com/max/800/1*AIALysoBKj_pyfew2AC44A.png"></figure><p name="dc70" id="dc70" class="graf graf--p graf-after--figure">加入 Keychain Sharing。</p><figure name="e73a" id="e73a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*DSu1l8Ke-CLzwPkIWP-JSQ.png" data-width="1594" data-height="694" src="https://cdn-images-1.medium.com/max/800/1*DSu1l8Ke-CLzwPkIWP-JSQ.png"></figure><figure name="471c" id="471c" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*E-E6oaGUxmNw3Smsbx7fFg.png" data-width="1788" data-height="1058" src="https://cdn-images-1.medium.com/max/800/1*E-E6oaGUxmNw3Smsbx7fFg.png"></figure><h3 name="01e3" id="01e3" class="graf graf--h3 graf-after--figure">利用 SPM 安裝 Facebook iOS SDK</h3><p name="ef5a" id="ef5a" class="graf graf--p graf-after--h3">想在 App 裡加入 FB 登入功能，我們必須先將 Facebook iOS SDK 加到 Xcode 專案。</p><div name="70c3" id="70c3" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/facebook/facebook-ios-sdk" data-href="https://github.com/facebook/facebook-ios-sdk" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/facebook/facebook-ios-sdk"><strong class="markup--strong markup--mixtapeEmbed-strong">facebook/facebook-ios-sdk</strong><br><em class="markup--em markup--mixtapeEmbed-em">This open-source library allows you to integrate Facebook into your iOS app. Learn more about the provided samples…</em>github.com</a><a href="https://github.com/facebook/facebook-ios-sdk" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3687299502fccc0b76b6b932c83ccfb3" data-thumbnail-img-id="0*R7PUSiVQ-trPD3rw" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*R7PUSiVQ-trPD3rw);"></a></div><p name="7e99" id="7e99" class="graf graf--p graf-after--mixtapeEmbed">安裝 Facebook iOS SDK 的方法很多，比方 Cocoapods &amp; SPM。由於 Xcode 原生支援 SPM，接下來我們將利用 SPM 安裝。</p><div name="68b4" id="68b4" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E4%BD%BF%E7%94%A8-spm-%E5%AE%89%E8%A3%9D%E7%AC%AC%E4%B8%89%E6%96%B9%E5%A5%97%E4%BB%B6-xcode-11-%E6%96%B0%E5%8A%9F%E8%83%BD-2c4ffcf85b4b" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E4%BD%BF%E7%94%A8-spm-%E5%AE%89%E8%A3%9D%E7%AC%AC%E4%B8%89%E6%96%B9%E5%A5%97%E4%BB%B6-xcode-11-%E6%96%B0%E5%8A%9F%E8%83%BD-2c4ffcf85b4b" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E4%BD%BF%E7%94%A8-spm-%E5%AE%89%E8%A3%9D%E7%AC%AC%E4%B8%89%E6%96%B9%E5%A5%97%E4%BB%B6-xcode-11-%E6%96%B0%E5%8A%9F%E8%83%BD-2c4ffcf85b4b"><strong class="markup--strong markup--mixtapeEmbed-strong">使用 SPM 安裝第三方套件 — Xcode 11 新功能</strong><br><em class="markup--em markup--mixtapeEmbed-em">開發 iOS App 時，我們有許多管理安裝第三方套件的方法，其中最為人熟知的三大套件管理天王為 CocoaPods，SPM(Swift Package Manager) &amp; Carthage。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E4%BD%BF%E7%94%A8-spm-%E5%AE%89%E8%A3%9D%E7%AC%AC%E4%B8%89%E6%96%B9%E5%A5%97%E4%BB%B6-xcode-11-%E6%96%B0%E5%8A%9F%E8%83%BD-2c4ffcf85b4b" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="68d7ca0f1f357213624de0f00073e1ac" data-thumbnail-img-id="1*-b8pcc3pfLf0AQhPxAoH0A.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*-b8pcc3pfLf0AQhPxAoH0A.jpeg);"></a></div><p name="2450" id="2450" class="graf graf--p graf-after--mixtapeEmbed">新增套件時輸入 FB 套件的網址。</p><pre name="75aa" id="75aa" class="graf graf--pre graf-after--p"><a href="https://github.com/facebook/facebook-ios-sdk" data-href="https://github.com/facebook/facebook-ios-sdk" class="markup--anchor markup--pre-anchor" rel="nofollow noopener" target="_blank">https://github.com/facebook/facebook-ios-sdk</a></pre><p name="4698" id="4698" class="graf graf--p graf-after--pre">找到 Facebook SDK for iOS 後，在 Up to Next Major Version 輸入 13.0.0，然後點選 Add Package。(ps: 由於目前最新版是 13.2，因此輸入 13.0.0)</p><figure name="b336" id="b336" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*g8ugJv3BCl6g2PTk5IKcMg.png" data-width="2056" data-height="1204" src="https://cdn-images-1.medium.com/max/800/1*g8ugJv3BCl6g2PTk5IKcMg.png"></figure><p name="4e88" id="4e88" class="graf graf--p graf-after--figure">勾選 FacebookLogin。</p><figure name="92e5" id="92e5" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*O6wwt5opv2gTyS7_jCLG5w.png" data-width="1290" data-height="574" src="https://cdn-images-1.medium.com/max/800/1*O6wwt5opv2gTyS7_jCLG5w.png"></figure><p name="7984" id="7984" class="graf graf--p graf-after--figure">完成套件的安裝，此時 Project navigator 的 Swift Package Dependencies 下將長出 Facebook。</p><figure name="1695" id="1695" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*s3JVemWZEwgMTyLwXkwakg.png" data-width="580" data-height="930" src="https://cdn-images-1.medium.com/max/800/1*s3JVemWZEwgMTyLwXkwakg.png"></figure><h3 name="bbdf" id="bbdf" class="graf graf--h3 graf-after--figure">在 App 啟動時完成 FB 的相關設定</h3><p name="0966" id="0966" class="graf graf--p graf-after--h3">我們希望 App 一啟動就能完成 FB 的相關設定，以下分為 SwiftUI 跟 UIKit 版本的寫法。</p><h4 name="24e5" id="24e5" class="graf graf--h4 graf-after--p">SwiftUI App</h4><h4 name="17c6" id="17c6" class="graf graf--h4 graf-after--h4"><strong class="markup--strong markup--h4-strong">寫法 1: </strong>在遵從 protocol App 的型別裡定義 init</h4><pre name="6e4b" id="6e4b" class="graf graf--pre graf-after--h4">import SwiftUI<br>import FacebookCore</pre><pre name="2ca3" id="2ca3" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/main" data-href="http://twitter.com/main" class="markup--anchor markup--pre-anchor" title="Twitter profile for @main" rel="noopener" target="_blank">@main</a><br>struct DemoApp: App {<br>    <br>    init() {<br><strong class="markup--strong markup--pre-strong">        ApplicationDelegate.shared.application(UIApplication.shared)<br></strong>    }<br>    <br>    var body: some Scene {<br>        WindowGroup {<br>            ContentView()<br>        }<br>    }<br>}</pre><p name="d9ed" id="d9ed" class="graf graf--p graf-after--pre">說明</p><pre name="b821" id="b821" class="graf graf--pre graf-after--p">import FacebookCore</pre><p name="c8da" id="c8da" class="graf graf--p graf-after--pre">加入 FacebookCore 後才能使用 FB 的相關程式。</p><pre name="6cf7" id="6cf7" class="graf graf--pre graf-after--p">ApplicationDelegate.shared.application(UIApplication.shared)</pre><p name="f2ab" id="f2ab" class="graf graf--p graf-after--pre">呼叫 ApplicationDelegate.shared.application(UIApplication.shared)，完成 FB 的相關設定。</p><h4 name="9251" id="9251" class="graf graf--h4 graf-after--p"><strong class="markup--strong markup--h4-strong">寫法 2: 定義 </strong>AppDelegate</h4><ul class="postList"><li name="f2ca" id="f2ca" class="graf graf--li graf-after--h4">手動新增 AppDelegate.swift，輸入以下程式。</li></ul><pre name="60d1" id="60d1" class="graf graf--pre graf-after--li">import FacebookCore<br><br>class AppDelegate: UIResponder, UIApplicationDelegate {<br> <br>   func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {<br>        // Override point for customization after application launch.<br>        ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)<br>        return true<br>    }<br>   <br>}</pre><p name="c0ff" id="c0ff" class="graf graf--p graf-after--pre">說明</p><pre name="07a6" id="07a6" class="graf graf--pre graf-after--p">import FacebookCore</pre><p name="96d9" id="96d9" class="graf graf--p graf-after--pre">加入 FacebookCore 後才能使用 FB 的相關程式。</p><pre name="3083" id="3083" class="graf graf--pre graf-after--p">ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)</pre><p name="3fc5" id="3fc5" class="graf graf--p graf-after--pre">呼叫 ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)，完成 FB 的相關設定。</p><ul class="postList"><li name="e773" id="e773" class="graf graf--li graf-after--p">在遵從 protocol App 的型別裡加入以下程式</li></ul><pre name="b470" id="b470" class="graf graf--pre graf-after--li">import SwiftUI</pre><pre name="3953" id="3953" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/main" data-href="http://twitter.com/main" class="markup--anchor markup--pre-anchor" title="Twitter profile for @main" rel="noopener" target="_blank">@main</a><br>struct DemoApp: App {<br>    <br>   <strong class="markup--strong markup--pre-strong"> </strong><a href="http://twitter.com/UIApplicationDelegat" data-href="http://twitter.com/UIApplicationDelegat" class="markup--anchor markup--pre-anchor" title="Twitter profile for @UIApplicationDelegat" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@UIApplicationDelegat</strong></a><strong class="markup--strong markup--pre-strong">eAdaptor(AppDelegate.self) var delegate</strong></pre><p name="5246" id="5246" class="graf graf--p graf-after--pre">它將讓 SwiftUI 生成 AppDelegate，讓 AppDelegate 的 function 在某些事件發生時被觸發。</p><div name="2bdf" id="2bdf" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E5%A6%82%E4%BD%95%E6%90%AD%E9%85%8D-appdelegate-%E5%88%A9%E7%94%A8-uiapplicationdelegateadaptor-96446be3e17" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E5%A6%82%E4%BD%95%E6%90%AD%E9%85%8D-appdelegate-%E5%88%A9%E7%94%A8-uiapplicationdelegateadaptor-96446be3e17" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E5%A6%82%E4%BD%95%E6%90%AD%E9%85%8D-appdelegate-%E5%88%A9%E7%94%A8-uiapplicationdelegateadaptor-96446be3e17"><strong class="markup--strong markup--mixtapeEmbed-strong">SwiftUI 如何搭配 AppDelegate — 利用 UIApplicationDelegateAdaptor</strong><br><em class="markup--em markup--mixtapeEmbed-em">從 Xcode 12 開始，我們開發 SwiftUI App 時 Life Cycle 可以選擇 SwiftUI App。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/swiftui-%E5%A6%82%E4%BD%95%E6%90%AD%E9%85%8D-appdelegate-%E5%88%A9%E7%94%A8-uiapplicationdelegateadaptor-96446be3e17" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="01fdf92ed813d72ee778d83765aec958" data-thumbnail-img-id="1*1B6Mofvhc2dgPT2r1BVCFQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*1B6Mofvhc2dgPT2r1BVCFQ.png);"></a></div><h4 name="cd46" id="cd46" class="graf graf--h4 graf-after--mixtapeEmbed">UIKit App</h4><p name="d9e4" id="d9e4" class="graf graf--p graf-after--h4">在 AppDelegate 加入以下程式。</p><pre name="fa80" id="fa80" class="graf graf--pre graf-after--p">import UIKit<br><strong class="markup--strong markup--pre-strong">import FacebookCore</strong></pre><pre name="92a5" id="92a5" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/UIApplicationMain" data-href="http://twitter.com/UIApplicationMain" class="markup--anchor markup--pre-anchor" title="Twitter profile for @UIApplicationMain" rel="noopener" target="_blank">@UIApplicationMain</a><br>class AppDelegate: UIResponder, UIApplicationDelegate {</pre><pre name="2817" id="2817" class="graf graf--pre graf-after--pre">    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {<br>        // Override point for customization after application launch.<br>       <strong class="markup--strong markup--pre-strong"> ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)</strong><br>        return true<br>    }</pre><pre name="b17d" id="b17d" class="graf graf--pre graf-after--pre">  <strong class="markup--strong markup--pre-strong">  func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey : Any] = [:]) -&gt; Bool {<br>                <br>        ApplicationDelegate.shared.application(app, open: url, options: options)<br>    <br>    }</strong></pre><p name="98fb" id="98fb" class="graf graf--p graf-after--pre">說明</p><pre name="9b83" id="9b83" class="graf graf--pre graf-after--p">import FacebookCore</pre><p name="55a4" id="55a4" class="graf graf--p graf-after--pre">加入 FacebookCore 後才能使用 FB 的相關程式。</p><pre name="6ba2" id="6ba2" class="graf graf--pre graf-after--p">ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)</pre><p name="0f84" id="0f84" class="graf graf--p graf-after--pre">呼叫 ApplicationDelegate.shared.application(application, didFinishLaunchingWithOptions: launchOptions)，完成 FB 的相關設定。</p><pre name="d9d8" id="d9d8" class="graf graf--pre graf-after--p">func application(_ app: UIApplication, open url: URL, options: [UIApplication.OpenURLOptionsKey : Any] = [:]) -&gt; Bool {<br>                <br>     ApplicationDelegate.shared.application(app, open: url, options: options)<br>    <br>}</pre><p name="1b31" id="1b31" class="graf graf--p graf-after--pre">如果有切換到 FB App，再從 FB App 切換回我們的 App 時會呼叫 application(_:open:options:)，我們在裡面執行 ApplicationDelegate.shared 的 application(_:open: url:options:)。</p><h3 name="8a32" id="8a32" class="graf graf--h3 graf-after--p">在 openURL function 加入 FB 相關程式</h3><p name="118f" id="118f" class="graf graf--p graf-after--h3">處理從 FB App 切換回我們 App 時回傳的資料。以下分為 SwiftUI 跟 UIKit 版本的寫法。</p><h4 name="48e4" id="48e4" class="graf graf--h4 graf-after--p">SwiftUI 版本</h4><p name="ee0a" id="ee0a" class="graf graf--p graf-after--h4">在遵從 protocol App 的型別裡加入 onOpenURL modifier，如果有切換到 FB App，再從 FB App 切換回我們的 App 時會呼叫 onOpenURL。(ps: 記得要 import FacebookCore)</p><pre name="96a2" id="96a2" class="graf graf--pre graf-after--p">import SwiftUI<br><strong class="markup--strong markup--pre-strong">import FacebookCore</strong></pre><pre name="c3bf" id="c3bf" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/main" data-href="http://twitter.com/main" class="markup--anchor markup--pre-anchor" title="Twitter profile for @main" rel="noopener" target="_blank">@main</a><br>struct DemoApp: App {<br>    <a href="http://twitter.com/UIApplicationDelegat" data-href="http://twitter.com/UIApplicationDelegat" class="markup--anchor markup--pre-anchor" title="Twitter profile for @UIApplicationDelegat" rel="noopener" target="_blank">@UIApplicationDelegat</a>eAdaptor(AppDelegate.self) var delegate<br>    <br>    var body: some Scene {<br>        WindowGroup {<br>            ContentView()<br>                <strong class="markup--strong markup--pre-strong">.onOpenURL { url in<br>                    ApplicationDelegate.shared.application(UIApplication.shared, open: url, sourceApplication: nil, annotation: UIApplication.OpenURLOptionsKey.annotation)<br>                }</strong><br>        }<br>    }<br>}</pre><h4 name="25ba" id="25ba" class="graf graf--h4 graf-after--pre">UIKit 版本</h4><p name="5bd7" id="5bd7" class="graf graf--p graf-after--h4">在 SceneDelegate 加入以下程式。如果有切換到 FB App，再從 FB App 切換回我們的 App 時會呼叫 scene(_:openURLContexts:)。(ps: 記得要 import FacebookCore)</p><pre name="0491" id="0491" class="graf graf--pre graf-after--p">func scene(_ scene: UIScene, openURLContexts URLContexts: Set&lt;UIOpenURLContext&gt;) {<br>        guard let url = URLContexts.first?.url else {<br>            return<br>        }<br>        ApplicationDelegate.shared.application(<br>            UIApplication.shared,<br>            open: url,<br>            sourceApplication: nil,<br>            annotation: [UIApplication.OpenURLOptionsKey.annotation]<br>        )<br>        <br>}</pre><h3 name="8dec" id="8dec" class="graf graf--h3 graf-after--pre">FB 登入程式</h3><p name="0d4d" id="0d4d" class="graf graf--p graf-after--h3">以下我們先說明它的原理，然後再介紹如何套用在 SwiftUI 跟 UIKit。</p><p name="a4d2" id="a4d2" class="graf graf--p graf-after--p">生成 LoginManager 物件，透過它的 function logIn 登入，當 closure 參數 result 等於 success 時表示登入成功。(ps: 使用 LoginManager 前要先 import FacebookLogin)</p><pre name="b9dd" id="b9dd" class="graf graf--pre graf-after--p">let manager = LoginManager()<br>manager.logIn { result in<br>   switch result {<br>   case .success(granted: let granted, declined: let declined, token: let token):<br>       print(&quot;success&quot;)<br>   case .cancelled:<br>       print(&quot;cancelled&quot;)<br>   case .failed(_):<br>       print(&quot;failed&quot;)<br>   }<br>}</pre><p name="866c" id="866c" class="graf graf--p graf-after--pre">function logIn 的宣告如下</p><pre name="1be0" id="1be0" class="graf graf--pre graf-after--p">func logIn(permissions: [Permission] = [.publicProfile],<br>             viewController: UIViewController? = nil,<br>             completion: LoginResultBlock? = nil)</pre><p name="91ef" id="91ef" class="graf graf--p graf-after--pre">參數說明:</p><ul class="postList"><li name="d6bb" id="d6bb" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">permissions</strong>: 傳入 App 想要的權限，比方 publicProfile 表示想取得使用者 FB 的公開資訊。若需要更多權限，可參考下圖自動完成列出的選項。</li></ul><figure name="a257" id="a257" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*oemL7RcSpZAwqBQSdIc7ig.png" data-width="1768" data-height="782" src="https://cdn-images-1.medium.com/max/800/1*oemL7RcSpZAwqBQSdIc7ig.png"></figure><div name="b416" id="b416" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://developers.facebook.com/docs/facebook-login/permissions/overview/" data-href="https://developers.facebook.com/docs/facebook-login/permissions/overview/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developers.facebook.com/docs/facebook-login/permissions/overview/"><strong class="markup--strong markup--mixtapeEmbed-strong">Permissions — Facebook Login — Documentation — Facebook for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">When a person logs into your app via Facebook Login you can access a subset of that person’s data stored on Facebook…</em>developers.facebook.com</a><a href="https://developers.facebook.com/docs/facebook-login/permissions/overview/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="82ce6c1bf1095577928a8a78a773ffd9" data-thumbnail-img-id="0*wnWj554QmIwCxwXx" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*wnWj554QmIwCxwXx);"></a></div><p name="9e74" id="9e74" class="graf graf--p graf-after--mixtapeEmbed">值得注意的，若想要 public_profile &amp; email 以外的權限，還須經過 FB 的審核。除非有特別需求，不然建議只要求 publicProfile &amp; email 即可。</p><div name="2a18" id="2a18" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developers.facebook.com/docs/facebook-login/permissions/review" data-href="https://developers.facebook.com/docs/facebook-login/permissions/review" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developers.facebook.com/docs/facebook-login/permissions/review"><strong class="markup--strong markup--mixtapeEmbed-strong">Review — Facebook Login — Documentation — Facebook for Developers</strong><br><em class="markup--em markup--mixtapeEmbed-em">Permissions are placed into categories that reflect how they are presented to people and the review process. Some sets…</em>developers.facebook.com</a><a href="https://developers.facebook.com/docs/facebook-login/permissions/review" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="facd822612066815f481ae16c442fb24" data-thumbnail-img-id="0*TGZjJ3ymWq1nDaTg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*TGZjJ3ymWq1nDaTg);"></a></div><ul class="postList"><li name="2400" id="2400" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">viewController</strong>: 負責 present(顯示) FB 登入畫面的 controller。預設為 nil，表示由 topmost view controller present(顯示) FB 登入畫面。</li><li name="1539" id="1539" class="graf graf--li graf-after--li"><strong class="markup--strong markup--li-strong">completion</strong>: FB 登入完成後將執行 completion 的 closure 程式，我們可由型別 LoginResult 的參數判斷結果，當它等於 success 時表示登入成功。</li></ul><p name="0a67" id="0a67" class="graf graf--p graf-after--li">另外由於參數 permissions 的預設值是 [.publicProfile]，viewController 的預設值是 nil，若我們採用預設值，則可省略它們，在 login 後直接以 { } 傳入參數 completion 的 closure 程式。</p><pre name="f832" id="f832" class="graf graf--pre graf-after--p">let manager = LoginManager()<br>manager.logIn { result in<br>   switch result {<br>   case .success(granted: let granted, declined: let declined, token: let token):<br>       print(&quot;success&quot;)<br>   case .cancelled:<br>       print(&quot;cancelled&quot;)<br>   case .failed(_):<br>       print(&quot;failed&quot;)<br>   }<br>}</pre><p name="bb06" id="bb06" class="graf graf--p graf-after--pre">了解 FB 登入的原理後，以下分別為它們套用在 SwiftUI &amp; UIKit 的範例。</p><h4 name="071d" id="071d" class="graf graf--h4 graf-after--p">SwiftUI 登入</h4><pre name="741a" id="741a" class="graf graf--pre graf-after--h4">import SwiftUI<br>import FacebookLogin</pre><pre name="7efe" id="7efe" class="graf graf--pre graf-after--pre">struct ContentView: View {<br>    var body: some View {<br>        Button {<br>            let manager = LoginManager()<br>            manager.logIn { result in<br>                switch result {<br>                case .success(granted: let granted, declined: let declined, token: let token):<br>                    print(&quot;success&quot;)<br>                case .cancelled:<br>                    print(&quot;cancelled&quot;)<br>                case .failed(_):<br>                    print(&quot;failed&quot;)<br>                }<br>            }<br>        } label: {<br>            Text(&quot;Login&quot;)<br>        }<br>        <br>    }<br>}</pre><h4 name="0efc" id="0efc" class="graf graf--h4 graf-after--pre">UIKit controller 登入</h4><pre name="d570" id="d570" class="graf graf--pre graf-after--h4">import UIKit<br>import FacebookLogin</pre><pre name="1a30" id="1a30" class="graf graf--pre graf-after--pre">class ViewController: UIViewController {<br>    <br>    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        // Do any additional setup after loading the view.<br>    }<br>    <br>    <a href="http://twitter.com/IBAction" data-href="http://twitter.com/IBAction" class="markup--anchor markup--pre-anchor" title="Twitter profile for @IBAction" rel="noopener" target="_blank">@IBAction</a> func login(_ sender: Any) {<br>        let manager = LoginManager()<br>        manager.logIn { result in<br>            switch result {<br>            case .success(granted: let granted, declined: let declined, token: let token):<br>                print(&quot;success&quot;)<br>            case .cancelled:<br>                print(&quot;cancelled&quot;)<br>            case .failed(_):<br>                print(&quot;failed&quot;)<br>            }<br>        }<br>    }<br>    <br>}</pre><p name="5622" id="5622" class="graf graf--p graf-after--pre">測試 App 的 FB 登入</p><figure name="f9ff" id="f9ff" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*SrSNX2dvjtAnz07B1nFUGQ.png" data-width="1256" data-height="1302" src="https://cdn-images-1.medium.com/max/800/1*SrSNX2dvjtAnz07B1nFUGQ.png"></figure><p name="10d9" id="10d9" class="graf graf--p graf-after--figure">FB 登入後使用者將維持登入狀態，就算我們重新啟動 App ，使用者還是能保持登入。</p><h3 name="471d" id="471d" class="graf graf--h3 graf-after--p">檢查使用者的登入狀態</h3><p name="7020" id="7020" class="graf graf--p graf-after--h3">當 AccessToken.current 有值時即代表使用者已登入，從 AccessToken 物件的 userID 可取得使用者的 ID。</p><p name="ecdb" id="ecdb" class="graf graf--p graf-after--p">以下分別示範在 SwiftUI &amp; UIKit 畫面出現時檢查是否登入的範例。</p><h4 name="4f90" id="4f90" class="graf graf--h4 graf-after--p">SwiftUI</h4><pre name="689a" id="689a" class="graf graf--pre graf-after--h4">import SwiftUI<br>import FacebookLogin</pre><pre name="f110" id="f110" class="graf graf--pre graf-after--pre">struct ContentView: View {<br>    var body: some View {<br>        <strong class="markup--strong markup--pre-strong">if let accessToken = AccessToken.current,<br>           !accessToken.isExpired {<br>            Text(&quot;\(accessToken.userID) 登入&quot;)<br>        } else {<br>            Text(&quot;未登入&quot;)<br>        }</strong><br>    }<br>}</pre><h4 name="8ef9" id="8ef9" class="graf graf--h4 graf-after--pre">UIKit</h4><pre name="75ef" id="75ef" class="graf graf--pre graf-after--h4">import UIKit <br>import FacebookLogin</pre><pre name="cfdb" id="cfdb" class="graf graf--pre graf-after--pre">class ViewController: UIViewController {<br>    <br>    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        // Do any additional setup after loading the view.<br>        <br>      <strong class="markup--strong markup--pre-strong">  if let accessToken = AccessToken.current,<br>           !accessToken.isExpired {<br>            print(&quot;\(accessToken.userID) login&quot;)<br>        } else {<br>            print(&quot;not login&quot;)<br>        }</strong><br>    }</pre><h3 name="56cf" id="56cf" class="graf graf--h3 graf-after--pre">讀取使用者的 FB profile 資訊</h3><p name="7e10" id="7e10" class="graf graf--p graf-after--h3">從 Profile 呼叫 function loadCurrentProfile 下載使用者的 profile 資訊，比方使用者的名字跟大頭照網址。</p><pre name="5f89" id="5f89" class="graf graf--pre graf-after--p">if let _ = AccessToken.current {<br>    Profile.loadCurrentProfile { profile, error in<br>        if let profile = profile {<br>           print(profile.name)<br>           print(profile.imageURL(forMode: .square, size: CGSize(width: 300, height: 300)))<br>        }<br>    }<br> }</pre><p name="c4e3" id="c4e3" class="graf graf--p graf-after--pre">若想取得使用者的 email，記得呼叫 LoginManager 的 logIn 登入時參數 permissions 要包含 .email。</p><pre name="5ff9" id="5ff9" class="graf graf--pre graf-after--p">let manager = LoginManager()<br>manager.logIn(<strong class="markup--strong markup--pre-strong">permissions: [.publicProfile, .email]</strong>) { result in<br>     switch result {<br>     case .success(granted: let granted, declined: let declined, token: let token):<br>          print(&quot;success&quot;)<br>     case .cancelled:<br>          print(&quot;cancelled&quot;)<br>     case .failed(_):<br>          print(&quot;failed&quot;)<br>     }<br>}</pre><p name="1c1f" id="1c1f" class="graf graf--p graf-after--pre">然後在登入成功後透過 GraphRequest 取得個人的相關資訊，比方以下例子：</p><pre name="4707" id="4707" class="graf graf--pre graf-after--p">let request = GraphRequest(graphPath: &quot;me&quot;, parameters: [&quot;fields&quot;: &quot;id, email, name&quot;])</pre><pre name="1295" id="1295" class="graf graf--pre graf-after--pre">request.start { response, result, error in</pre><pre name="b369" id="b369" class="graf graf--pre graf-after--pre">   if let result = result as? [String:String] {</pre><pre name="f3f0" id="f3f0" class="graf graf--pre graf-after--pre">      print(result)</pre><pre name="e4f4" id="e4f4" class="graf graf--pre graf-after--pre">   }</pre><pre name="f31e" id="f31e" class="graf graf--pre graf-after--pre">}</pre><p name="c945" id="c945" class="graf graf--p graf-after--pre">結果</p><pre name="6103" id="6103" class="graf graf--pre graf-after--p">[&quot;name&quot;: &quot;Deeplove Pan&quot;, &quot;email&quot;: &quot;deeplovepan@gmail.com&quot;, &quot;id&quot;: &quot;10214280447396741&quot;]</pre><h4 name="d79e" id="d79e" class="graf graf--h4 graf-after--pre">FB 登出</h4><pre name="ae8b" id="ae8b" class="graf graf--pre graf-after--h4">let manager = LoginManager()</pre><pre name="fd07" id="fd07" class="graf graf--pre graf-after--pre">manager.logOut()</pre><h3 name="cb55" id="cb55" class="graf graf--h3 graf-after--pre">讓全世界的 FB 帳號都能登入</h3><p name="343a" id="343a" class="graf graf--p graf-after--h3">剛剛我們順利實現 FB 登入功能，但其實只有我們自己的 FB 帳號能登入。如下圖所示，其它的 FB 帳號登入將出現錯誤訊息。</p><figure name="05c7" id="05c7" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HrlwUmVrFebZ5Tt-w3lOqw.png" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*HrlwUmVrFebZ5Tt-w3lOqw.png"></figure><p name="c315" id="c315" class="graf graf--p graf-after--figure">此問題有很多解法，其中一種是將別人的 FB 帳號加上測試權限。不過我們想要的是 App 上架後世界上每個人的 FB 帳號都能登入，因此我們進行以下的調整。</p><ul class="postList"><li name="8658" id="8658" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">設定 Privacy Policy URL &amp; User data deletion</strong></li></ul><p name="16dc" id="16dc" class="graf graf--p graf-after--li">我們可先填入一個暫時的網址，方便測試 FB 的登入功能。等之後有正式的網址後，再回來修改。</p><p name="6aed" id="6aed" class="graf graf--p graf-after--p">進入 FB 開發網站上的 App 頁面，切換到 Settings &gt; Basic 頁面，輸入 Privacy Policy URL &amp; User data deletion 的網址。</p><figure name="574a" id="574a" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*pa05DJMREkQqTuKZG_wuXg.png" data-width="1664" data-height="1056" src="https://cdn-images-1.medium.com/max/800/1*pa05DJMREkQqTuKZG_wuXg.png"></figure><p name="ef3a" id="ef3a" class="graf graf--p graf-after--figure">進入 FB 開發網站上的 App 頁面，將右上的 Live 開關打開。</p><figure name="7ac6" id="7ac6" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*kVQfE2pAtyHcqIqr91J6Qw.png" data-width="1482" data-height="104" src="https://cdn-images-1.medium.com/max/800/1*kVQfE2pAtyHcqIqr91J6Qw.png"></figure><p name="24c6" id="24c6" class="graf graf--p graf-after--figure">現在全世界的 FB 帳號都可以登入我們的 App 了 !</p><h3 name="06a1" id="06a1" class="graf graf--h3 graf-after--p">Facebook iOS SDK 內建的 FBLoginButton</h3><p name="3ad6" id="3ad6" class="graf graf--p graf-after--h3">若是懶得自己實現 FB 登入功能，也可以直接在畫面上加入 Facebook iOS SDK 內建的 FBLoginButton。</p><h3 name="44f6" id="44f6" class="graf graf--h3 graf-after--p">SwiftUI App</h3><ul class="postList"><li name="af91" id="af91" class="graf graf--li graf-after--h3"><strong class="markup--strong markup--li-strong">將 FBLoginButton 包裝成 SwiftUI view LoginButton</strong></li></ul><pre name="d23e" id="d23e" class="graf graf--pre graf-after--li">import SwiftUI<br>import FacebookLogin</pre><pre name="0f63" id="0f63" class="graf graf--pre graf-after--pre">struct LoginButton: UIViewRepresentable {<br>    func makeUIView(context: Context) -&gt; FBLoginButton {<br>        FBLoginButton()<br>    }<br>    <br>    func updateUIView(_ uiView: FBLoginButton, context: Context) {<br>        <br>    }<br>    <br>    typealias UIViewType = FBLoginButton<br>    <br>    <br>}</pre><div name="2b9f" id="2b9f" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-swiftui-app-%E5%8A%A0%E5%85%A5-uikit-view-f74b70282487" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-swiftui-app-%E5%8A%A0%E5%85%A5-uikit-view-f74b70282487" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-swiftui-app-%E5%8A%A0%E5%85%A5-uikit-view-f74b70282487"><strong class="markup--strong markup--mixtapeEmbed-strong">在 SwiftUI App 加入 UIKit View，比方網頁</strong><br><em class="markup--em markup--mixtapeEmbed-em">SwiftUI 有很多很棒很炫的功能，幫助我們更容易地開發 iOS App，不過因為它才剛出生，所以一些傳統 iOS App 常用的 UI 元件還不支援，比方它缺少以下這些元件:</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-swiftui-app-%E5%8A%A0%E5%85%A5-uikit-view-f74b70282487" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="77a1e88573456859783eb5c1720418f5" data-thumbnail-img-id="1*UNgO9T_XpHisTW6G565EZg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*UNgO9T_XpHisTW6G565EZg.jpeg);"></a></div><ul class="postList"><li name="6b63" id="6b63" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">在畫面上加入 LoginButton</strong></li></ul><pre name="1f12" id="1f12" class="graf graf--pre graf-after--li">import SwiftUI</pre><pre name="21f1" id="21f1" class="graf graf--pre graf-after--pre">struct ContentView: View {<br>    var body: some View {<br>        <br>        LoginButton()<br>            .frame(width: 100, height: 40)<br>        <br>    }<br>}</pre><figure name="bbd5" id="bbd5" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*i9EdbzWKBTeB5ciNX4ucKQ.png" data-width="1220" data-height="1164" src="https://cdn-images-1.medium.com/max/800/1*i9EdbzWKBTeB5ciNX4ucKQ.png"></figure><h3 name="2dae" id="2dae" class="graf graf--h3 graf-after--figure">UIKit App</h3><pre name="38b0" id="38b0" class="graf graf--pre graf-after--h3">import UIKit<br>import FacebookLogin</pre><pre name="62c3" id="62c3" class="graf graf--pre graf-after--pre">class ViewController: UIViewController {<br>    <br>    override func viewDidLoad() {<br>        super.viewDidLoad()<br>        <br>        let loginButton = FBLoginButton()<br>        loginButton.center = view.center<br>        view.addSubview(loginButton)<br>    }<br>    <br>    <br>}</pre><h3 name="d84b" id="d84b" class="graf graf--h3 graf-after--pre">在模擬器切換 FB 帳號</h3><p name="9bf9" id="9bf9" class="graf graf--p graf-after--h3">在模擬器登入後，它會記得我們登入的帳號，若將 App 移除再重新安裝，登入時一樣會採用之前的帳號。若想切換帳號，可以直接將模擬器重置後再測試。</p><figure name="2c92" id="2c92" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*teUo4Cf7Zgo3E0eVZMn1gQ.png" data-width="1016" data-height="190" src="https://cdn-images-1.medium.com/max/800/1*teUo4Cf7Zgo3E0eVZMn1gQ.png"></figure><h3 name="c1f3" id="c1f3" class="graf graf--h3 graf-after--figure">作品集</h3><div name="8fdc" id="8fdc" class="graf graf--mixtapeEmbed graf-after--h3 graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/swift-%E7%B7%B4%E7%BF%92-group-orders%E8%A8%82%E9%A3%B2%E6%96%99-2-firebase-sdk-facebook-sdk-dd5ef07f5e1a" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/swift-%E7%B7%B4%E7%BF%92-group-orders%E8%A8%82%E9%A3%B2%E6%96%99-2-firebase-sdk-facebook-sdk-dd5ef07f5e1a" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/swift-%E7%B7%B4%E7%BF%92-group-orders%E8%A8%82%E9%A3%B2%E6%96%99-2-firebase-sdk-facebook-sdk-dd5ef07f5e1a"><strong class="markup--strong markup--mixtapeEmbed-strong">[Swift]練習。Group Orders訂飲料 #2 Firebase SDK, Facebook SDK</strong><br><em class="markup--em markup--mixtapeEmbed-em">新版本加上了使用者登入的功能。可以透過Firebase建立帳號、登入，也可以使用Facebook登入。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/swift-%E7%B7%B4%E7%BF%92-group-orders%E8%A8%82%E9%A3%B2%E6%96%99-2-firebase-sdk-facebook-sdk-dd5ef07f5e1a" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="ccf077386af42315a1c413d5fc984932" data-thumbnail-img-id="1*c-7QF9Gz0JbzqzlVjHWojA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*c-7QF9Gz0JbzqzlVjHWojA.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/96c981d482cc"><time class="dt-published" datetime="2019-11-17T15:01:26.542Z">November 17, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%AF%A6%E4%BD%9C-ios-app-%E7%9A%84-facebook-%E7%99%BB%E5%85%A5%E5%8A%9F%E8%83%BD-96c981d482cc" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>