<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>使用 CATransition &amp; Timer 實現文字跑馬燈的移動動畫</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">使用 CATransition &amp; Timer 實現文字跑馬燈的移動動畫</h1>
</header>
<section data-field="subtitle" class="p-summary">
利用搭配 push 的 CATransition，我們可以實現類似文字跑馬燈的移動動畫。接下來我們將以戴佩妮新專輯被動的觀眾 為例，讓專輯的 12 首歌名以跑馬燈動畫依序出現。
</section>
<section data-field="body" class="e-content">
<section name="9143" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1aa0" id="1aa0" class="graf graf--h3 graf--leading graf--title">使用 CATransition &amp; Timer 實現文字跑馬燈的移動動畫</h3><p name="e118" id="e118" class="graf graf--p graf-after--h3">利用搭配 push 的 CATransition，我們可以實現類似文字跑馬燈的移動動畫。接下來我們將以戴佩妮新專輯<code class="markup--code markup--p-code">被動的觀眾</code> 為例，讓專輯的 12 首歌名以跑馬燈動畫依序出現。</p><h3 name="ee32" id="ee32" class="graf graf--h3 graf-after--p">storyboard 畫面設計</h3><figure name="c6a1" id="c6a1" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*st1nZe7j9nVj8l63ZUsWtA.png" data-width="1202" data-height="1340" src="https://cdn-images-1.medium.com/max/800/1*st1nZe7j9nVj8l63ZUsWtA.png"></figure><h3 name="46f9" id="46f9" class="graf graf--h3 graf-after--figure">label 顯示歌名，songs 儲存專輯的 12 首歌，timer 控制每隔幾秒更換顯示的歌名</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e767" id="e767" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span> {<br />    <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">weak</span> <span class="hljs-keyword">var</span> label: <span class="hljs-type">UILabel</span>!<br />    <span class="hljs-keyword">var</span> index <span class="hljs-operator">=</span> <span class="hljs-number">0</span><br />    <span class="hljs-keyword">let</span> songs <span class="hljs-operator">=</span> [<br />        <span class="hljs-string">&quot;隨風所欲&quot;</span>,<br />        <span class="hljs-string">&quot;小失誤&quot;</span>,<br />        <span class="hljs-string">&quot;被動的觀眾&quot;</span>,<br />        <span class="hljs-string">&quot;鬧劇&quot;</span>,<br />        <span class="hljs-string">&quot;背信者&quot;</span>,<br />        <span class="hljs-string">&quot;三四點了還沒睡&quot;</span>,<br />        <span class="hljs-string">&quot;多虧你啊&quot;</span>,<br />        <span class="hljs-string">&quot;怕冷&quot;</span>,<br />        <span class="hljs-string">&quot;密室逃脫&quot;</span>,<br />        <span class="hljs-string">&quot;後果自負&quot;</span>,<br />        <span class="hljs-string">&quot;我嚮往&quot;</span>,<br />        <span class="hljs-string">&quot;有何不可&quot;</span><br />    ]<br />    <span class="hljs-keyword">var</span> timer: <span class="hljs-type">Timer</span>?</span></pre><h3 name="abe0" id="abe0" class="graf graf--h3 graf-after--pre">在畫面出現時建立 timer，每隔 2 秒更換顯示的歌名</h3><p name="a64b" id="a64b" class="graf graf--p graf-after--h3">每隔 2 秒鐘呼叫 nextSong 更換顯示的歌名。function nextSong 的定義將在待會介紹。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="af1e" id="af1e" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />    <span class="hljs-keyword">super</span>.viewDidLoad()<br />        <br />    label.text <span class="hljs-operator">=</span> songs[index]<br />    timer <span class="hljs-operator">=</span> <span class="hljs-type">Timer</span>.scheduledTimer(withTimeInterval: <span class="hljs-number">2</span>, repeats: <span class="hljs-literal">true</span>) { <span class="hljs-keyword">_</span> <span class="hljs-keyword">in</span><br />        <span class="hljs-keyword">self</span>.nextSong()<br />    }<br />}</span></pre><h3 name="29a5" id="29a5" class="graf graf--h3 graf-after--pre">定義 nextSong，利用 CATransition 實現文字移動的動畫效果</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="2ca8" id="2ca8" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">nextSong</span>() {<br />    index <span class="hljs-operator">=</span> (index <span class="hljs-operator">+</span> <span class="hljs-number">1</span>) <span class="hljs-operator">%</span> songs.count<br />    <span class="hljs-keyword">let</span> transition <span class="hljs-operator">=</span> <span class="hljs-type">CATransition</span>()<br />    transition.duration <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><br />    transition.type <span class="hljs-operator">=</span> .push<br />    transition.subtype <span class="hljs-operator">=</span> .fromTop<br />    label.text <span class="hljs-operator">=</span> songs[index]<br />    label.layer.add(transition, forKey: <span class="hljs-string">&quot;nextSong&quot;</span>)<br />}</span></pre><p name="56ca" id="56ca" class="graf graf--p graf-after--pre">說明</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="7a75" id="7a75" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">let</span> transition <span class="hljs-operator">=</span> <span class="hljs-type">CATransition</span>()<br />transition.duration <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span></span></pre><p name="de61" id="de61" class="graf graf--p graf-after--pre">當畫面從舊的樣子變新的樣子時，CATransition 控制著轉換的動畫效果，比方淡入淡出或移動的效果。在此我們將 duration 設為 0.5，表示動畫將跑 0.5 秒。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="cab9" id="cab9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">transition.type <span class="hljs-operator">=</span> .push<br />transition.subtype <span class="hljs-operator">=</span> .fromTop<br />label.text <span class="hljs-operator">=</span> songs[index]</span></pre><p name="7b87" id="7b87" class="graf graf--p graf-after--pre">CATransition 的 type 決定採用的動畫效果，subtype 控制方向，在此我們設定 push &amp; fromTop，因此顯示下一首歌名時，原本的歌名將向上移動消失，新的歌名則向上移動出現。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b185" id="b185" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">label.layer.add(transition, forKey: <span class="hljs-string">&quot;nextSong&quot;</span>)</span></pre><p name="710c" id="710c" class="graf graf--p graf-after--pre">從 label.layer 呼叫 add add(_:forKey:)，讓動畫 transition 作用在 label 上。</p><h3 name="f0e9" id="f0e9" class="graf graf--h3 graf-after--p">在畫面消失時將 timer 停止</h3><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="fce6" id="fce6" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidDisappear</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">animated</span>: <span class="hljs-type">Bool</span>) {<br />    <span class="hljs-keyword">super</span>.viewDidDisappear(animated)<br />        <br />    timer<span class="hljs-operator">?</span>.invalidate()<br />}</span></pre><h3 name="f707" id="f707" class="graf graf--h3 graf-after--pre">執行 App</h3><figure name="5dd0" id="5dd0" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*J9cV5w4CdjonCs5vIMeevw.gif" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*J9cV5w4CdjonCs5vIMeevw.gif"></figure><p name="dfd2" id="dfd2" class="graf graf--p graf-after--figure">接著我們將 subtype 改成 fromRight 試試。此時顯示下一首歌名時，原本的歌名將向左移動消失，新的歌名則向左移動出現。</p><figure name="e27f" id="e27f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*IZuX-LWF1lSyy7lrvf5rEQ.gif" data-width="1170" data-height="2532" src="https://cdn-images-1.medium.com/max/800/1*IZuX-LWF1lSyy7lrvf5rEQ.gif"></figure><h3 name="e319" id="e319" class="graf graf--h3 graf-after--figure">作品集</h3><div name="4362" id="4362" class="graf graf--mixtapeEmbed graf-after--h3 graf--trailing"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A4%E2%93%AAviewdidload%E7%B7%B4%E7%BF%92-%E4%BD%BF%E7%94%A8-catransition-%E5%AF%A6%E7%8F%BE%E6%96%87%E5%AD%97%E8%B7%91%E9%A6%AC%E7%87%88%E5%8B%95%E7%95%AB-af24d4c6e0b4" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A4%E2%93%AAviewdidload%E7%B7%B4%E7%BF%92-%E4%BD%BF%E7%94%A8-catransition-%E5%AF%A6%E7%8F%BE%E6%96%87%E5%AD%97%E8%B7%91%E9%A6%AC%E7%87%88%E5%8B%95%E7%95%AB-af24d4c6e0b4" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A4%E2%93%AAviewdidload%E7%B7%B4%E7%BF%92-%E4%BD%BF%E7%94%A8-catransition-%E5%AF%A6%E7%8F%BE%E6%96%87%E5%AD%97%E8%B7%91%E9%A6%AC%E7%87%88%E5%8B%95%E7%95%AB-af24d4c6e0b4"><strong class="markup--strong markup--mixtapeEmbed-strong">⑤⓪viewDidLoad練習-使用 CATransition 實現文字跑馬燈動畫</strong><br><em class="markup--em markup--mixtapeEmbed-em">使用跑馬燈顯示安溥的〈關於我愛你〉歌詞</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E6%95%99%E5%AE%A4/%E2%91%A4%E2%93%AAviewdidload%E7%B7%B4%E7%BF%92-%E4%BD%BF%E7%94%A8-catransition-%E5%AF%A6%E7%8F%BE%E6%96%87%E5%AD%97%E8%B7%91%E9%A6%AC%E7%87%88%E5%8B%95%E7%95%AB-af24d4c6e0b4" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c9436b31b80a27cd7cd21cb45e5b0f27" data-thumbnail-img-id="1*1vgG9ALev8aA94LBa58XmQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*1vgG9ALev8aA94LBa58XmQ.png);"></a></div></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/95f6c27ac03c"><time class="dt-published" datetime="2022-07-11T08:29:21.435Z">July 11, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E4%BD%BF%E7%94%A8-catransition-%E5%AF%A6%E7%8F%BE%E6%96%87%E5%AD%97%E8%B7%91%E9%A6%AC%E7%87%88%E7%9A%84%E7%A7%BB%E5%8B%95%E5%8B%95%E7%95%AB-95f6c27ac03c" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>