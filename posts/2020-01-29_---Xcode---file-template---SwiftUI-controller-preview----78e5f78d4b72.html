<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>建立 Xcode 的 file template，以 SwiftUI controller preview 為例</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">建立 Xcode 的 file template，以 SwiftUI controller preview 為例</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們可以從File &gt; New &gt;File 裡選擇 Xcode 事先幫我們設計好的檔案，加快程式的開發速度。
</section>
<section data-field="body" class="e-content">
<section name="da73" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="174e" id="174e" class="graf graf--h3 graf--leading graf--title">建立 Xcode 的 file template，以 view controller 的 preview 為例</h3><p name="c688" id="c688" class="graf graf--p graf-after--h3">開發 iOS App 時，我們常常從 New File from Template 選擇 Xcode 事先設計好的檔案，加快程式的開發速度。</p><figure name="e82e" id="e82e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8IE_BvLbQI1_V4C-SXG6Ng.png" data-width="1446" data-height="1032" src="https://cdn-images-1.medium.com/max/800/1*8IE_BvLbQI1_V4C-SXG6Ng.png"></figure><p name="be4c" id="be4c" class="graf graf--p graf-after--figure">有沒有可能把我們常用的程式也設計成 file template，到時候一鍵生成呢 ? 當然可以，接下來我們將以把 view controller 包裝成 SwiftUI preview 的程式做成 file template，方便讓從前用 view controller 寫的 iOS App 畫面享用 SwiftUI 方便的 preview 功能。</p><div name="fc69" id="fc69" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AE%93-view-controller-%E4%B9%9F%E8%83%BD%E4%BA%AB%E7%94%A8-swiftui-%E6%96%B9%E4%BE%BF%E7%9A%84-preview-314a2e2f0c0f" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AE%93-view-controller-%E4%B9%9F%E8%83%BD%E4%BA%AB%E7%94%A8-swiftui-%E6%96%B9%E4%BE%BF%E7%9A%84-preview-314a2e2f0c0f" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AE%93-view-controller-%E4%B9%9F%E8%83%BD%E4%BA%AB%E7%94%A8-swiftui-%E6%96%B9%E4%BE%BF%E7%9A%84-preview-314a2e2f0c0f"><strong class="markup--strong markup--mixtapeEmbed-strong">讓 view controller 也能享用 SwiftUI 方便的 preview</strong><br><em class="markup--em markup--mixtapeEmbed-em">SwiftUI 提供方便的 preview 功能，讓我們不用啟動模擬器就能預覽和操作 App 畫面，而且還能在修改程式時立即更新 preview。preview 如此先進的功能，看來我們用 storyboard &amp; view…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%AE%93-view-controller-%E4%B9%9F%E8%83%BD%E4%BA%AB%E7%94%A8-swiftui-%E6%96%B9%E4%BE%BF%E7%9A%84-preview-314a2e2f0c0f" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="3fb4c87325d77dc11c0849014c74ba5d" data-thumbnail-img-id="1*lW74PQF7t8iCuykFMSZCVQ.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*lW74PQF7t8iCuykFMSZCVQ.jpeg);"></a></div><h3 name="660a" id="660a" class="graf graf--h3 graf-after--mixtapeEmbed">複製預設的 Swift file template</h3><p name="8bdf" id="8bdf" class="graf graf--p graf-after--h3">自製的 File Template 必須放在路徑 <code class="markup--code markup--p-code">~/Library/Developer/Xcode/Templates</code> 下，如果資料夾 Templates 不存在，請先輸入以下指令建立。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="bash" name="03dd" id="03dd" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-built_in">mkdir</span> ~/Library/Developer/Xcode/Templates</span></pre><p name="d78b" id="d78b" class="graf graf--p graf-after--pre">為了建立 file template，我們需要建立一些檔案，像是 <code class="markup--code markup--p-code">___FILEBASENAME___.swift &amp; TemplateInfo.plist</code>。與其重頭建立，不如直接複製預設的 Swift file template，然後再將它修改。</p><p name="5eac" id="5eac" class="graf graf--p graf-after--p">輸入以下指令從 Swift file template 複製生成 <code class="markup--code markup--p-code">Controller Preview.xctemplate</code>，xctemplate 的檔名 Controller Preview 將成為樣版選擇視窗裡顯示的名字。</p><pre name="5f49" id="5f49" class="graf graf--pre graf-after--p">cp -R /Applications/Xcode.app/Contents/Developer/Library/Xcode/Templates/File\ Templates/MultiPlatform/Source/Swift\ File.xctemplate  ~/Library/Developer/Xcode/Templates/Controller\ Preview.xctemplate</pre><p name="a9c6" id="a9c6" class="graf graf--p graf-after--pre">完成剛剛的步驟後，打開 new file 的 template 選擇視窗，在區塊 Templates 底下可看到 Controller Preview。</p><figure name="daf2" id="daf2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*t3t1hTBfgCC3XgQGLZ86MQ.png" data-width="1502" data-height="1090" src="https://cdn-images-1.medium.com/max/800/1*t3t1hTBfgCC3XgQGLZ86MQ.png"></figure><p name="8451" id="8451" class="graf graf--p graf-after--figure">不過產生的檔案卻跟選擇 Swift File template 一樣，完全跟 preview 沒關係。這是當然的呀，畢竟我們的 Controller Preview.xctemplate 是從 Swift File.xctemplate 複製而來。</p><figure name="8175" id="8175" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*XPEJt5xmBai2c0QjeORTkA.jpeg" data-width="1736" data-height="594" src="https://cdn-images-1.medium.com/max/800/1*XPEJt5xmBai2c0QjeORTkA.jpeg"></figure><p name="653a" id="653a" class="graf graf--p graf-after--figure">沒關係，接下來我們將一步步修改，讓它逐漸變成我們想要的 preview 模樣。</p><h3 name="1930" id="1930" class="graf graf--h3 graf-after--p">xctemplate 的內容</h3><p name="b18d" id="b18d" class="graf graf--p graf-after--h3">xctemplate 下主要有三種檔案:</p><ul class="postList"><li name="1d93" id="1d93" class="graf graf--li graf-after--p">___FILEBASENAME___.swift<br>樣版的程式內容。</li><li name="fe8f" id="fe8f" class="graf graf--li graf-after--li">TemplateInfo.plist<br>控制樣版選擇時設定的欄位。</li><li name="55fe" id="55fe" class="graf graf--li graf-after--li">TemplateIcon.png<br>樣版選擇時顯示的 icon。</li></ul><figure name="0dac" id="0dac" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*4O62i0jEl822mpZUN1i1gw.jpeg" data-width="948" data-height="384" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*4O62i0jEl822mpZUN1i1gw.jpeg"></figure><h3 name="d1cd" id="d1cd" class="graf graf--h3 graf-after--figure">TemplateInfo.plist: 控制樣版選擇時設定的欄位</h3><p name="0eb7" id="0eb7" class="graf graf--p graf-after--h3">首先讓我們打開 TemplateInfo.plist，編輯樣版選擇時設定的欄位。</p><figure name="91a1" id="91a1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*4O62i0jEl822mpZUN1i1gw.jpeg" data-width="948" data-height="384" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*4O62i0jEl822mpZUN1i1gw.jpeg"></figure><figure name="b10d" id="b10d" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*P9gNCvDABWiYugGHpgDJ0g.jpeg" data-width="1606" data-height="582" src="https://cdn-images-1.medium.com/max/800/1*P9gNCvDABWiYugGHpgDJ0g.jpeg"></figure><ul class="postList"><li name="e7ec" id="e7ec" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">設定 Options 欄位</strong></li></ul><p name="1ec6" id="1ec6" class="graf graf--p graf-after--li">我們想將 storyboard 的 view controller 畫面包裝成 SwiftUI preview，它的程式基本架構如下。其中主要會更動的是 ViewControllerPreviews ，ViewController &amp; Main，也就是 struct 的型別名(檔名)，controller 的型別和 storyboard 的檔名。(假設 controller 的 Storyboard ID 和 controller 的型別同名。)</p><pre name="94d7" id="94d7" class="graf graf--pre graf-after--p">import SwiftUI<br><a href="http://twitter.com/available" data-href="http://twitter.com/available" class="markup--anchor markup--pre-anchor" title="Twitter profile for @available" rel="noopener" target="_blank">@available</a>(iOS 13.0.0, *)<br>struct <strong class="markup--strong markup--pre-strong">ViewControllerPreviews</strong>: PreviewProvider, UIViewControllerRepresentable {<br>    static var previews: some View {<br>        <strong class="markup--strong markup--pre-strong">ViewControllerPreviews</strong>()<br>    }<br>    <br>    func makeUIViewController(context: Context) -&gt; <strong class="markup--strong markup--pre-strong">ViewController</strong> {<br>         UIStoryboard(name: &quot;<strong class="markup--strong markup--pre-strong">Main</strong>&quot;, bundle: nil).instantiateViewController(identifier: &quot;<strong class="markup--strong markup--pre-strong">ViewController</strong>&quot;) as! <strong class="markup--strong markup--pre-strong">ViewController</strong><br>    }<br>    <br>    func updateUIViewController(_ uiViewController: <strong class="markup--strong markup--pre-strong">ViewController</strong>, context: Context) {<br>    }<br>}</pre><p name="5fde" id="5fde" class="graf graf--p graf-after--pre">因此我們在 TemplateInfo.plist 加入讓使用者輸入 controller 型別名 &amp; storyboard 檔名的 Options 欄位。</p><figure name="8c24" id="8c24" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*CJTUKQVYChyxbiwBOishFg.jpeg" data-width="1602" data-height="966" src="https://cdn-images-1.medium.com/max/800/1*CJTUKQVYChyxbiwBOishFg.jpeg"></figure><p name="66cf" id="66cf" class="graf graf--p graf-after--figure">Options 的型別是 array，裡面的 item 是 dictionary，包含了以下欄位。</p><p name="ada1" id="ada1" class="graf graf--p graf-after--p">1 Name: 使用者看到的欄位名稱。</p><p name="03c5" id="03c5" class="graf graf--p graf-after--p">2 Identifier: ___FILEBASENAME___.swift 程式讀取欄位內容時採用的名字。</p><p name="5957" id="5957" class="graf graf--p graf-after--p">3 Required: 是否必填。</p><p name="5e82" id="5e82" class="graf graf--p graf-after--p">4 Description: 欄位的說明。</p><p name="6740" id="6740" class="graf graf--p graf-after--p">5 Type: 欄位的輸入方式，text 表示要以文字輸入，將變成文字輸入框。</p><ul class="postList"><li name="805d" id="805d" class="graf graf--li graf-after--p"><strong class="markup--strong markup--li-strong">將 DefaultCompletionName 改成 Previews</strong></li></ul><p name="3e13" id="3e13" class="graf graf--p graf-after--li">此欄位決定檔案建立後存檔時預設的檔名，我們希望檔名以 Previews結尾，然後使用者再於 Previews 前加上 controller 的型別名，比方 DemoViewController 的 preview 檔將是 DemoViewControllerPreviews.swift。</p><figure name="bf0e" id="bf0e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*RDJtjJLpAv3vPU4O4z4YcA.jpeg" data-width="1596" data-height="940" src="https://cdn-images-1.medium.com/max/800/1*RDJtjJLpAv3vPU4O4z4YcA.jpeg"></figure><p name="a97d" id="a97d" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">測試</strong></p><p name="6d40" id="6d40" class="graf graf--p graf-after--p">選擇 Controller Preview 樣版後，果然出現了 Controller &amp; Storyboard 的輸入欄位。</p><figure name="ec95" id="ec95" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*60vgvIcHJG2Guf4zn3kQiw.jpeg" data-width="1418" data-height="1030" src="https://cdn-images-1.medium.com/max/800/1*60vgvIcHJG2Guf4zn3kQiw.jpeg"></figure><figure name="9a6d" id="9a6d" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*6T53Qumtgkzair-pno1qOw.jpeg" data-width="1428" data-height="1026" src="https://cdn-images-1.medium.com/max/800/1*6T53Qumtgkzair-pno1qOw.jpeg"></figure><p name="0bc4" id="0bc4" class="graf graf--p graf-after--figure">存檔時也出現了我們希望的檔名結尾 Previews。</p><figure name="ee4f" id="ee4f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1IhlxZMkRGZVm6AAe905aQ.jpeg" data-width="1688" data-height="890" src="https://cdn-images-1.medium.com/max/800/1*1IhlxZMkRGZVm6AAe905aQ.jpeg"></figure><h3 name="12ac" id="12ac" class="graf graf--h3 graf-after--figure">___FILEBASENAME___.swift: 樣版的程式內容</h3><p name="739c" id="739c" class="graf graf--p graf-after--h3">來到了最關鍵的一步，將 ___FILEBASENAME___.swift 變成 controller preview 的程式內容。輸入以下指令打開 ___FILEBASENAME___.swift。</p><pre name="8aa7" id="8aa7" class="graf graf--pre graf-after--p">open ~/Library/Developer/Xcode/Templates/File\ Templates/Source/Controller\ Preview.xctemplate/___FILEBASENAME___.swift</pre><figure name="db9b" id="db9b" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*mbNZzmGpoBAeeanjddg3Zg.jpeg" data-width="1598" data-height="1052" src="https://cdn-images-1.medium.com/max/800/1*mbNZzmGpoBAeeanjddg3Zg.jpeg"></figure><p name="ba94" id="ba94" class="graf graf--p graf-after--figure">修改 ___FILEBASENAME___.swift，貼上將 controller 變成 SwiftUI preview 的程式內容。</p><pre name="e4ba" id="e4ba" class="graf graf--pre graf-after--p">//___FILEHEADER___</pre><pre name="edc2" id="edc2" class="graf graf--pre graf-after--pre">import SwiftUI</pre><pre name="654a" id="654a" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/available" data-href="http://twitter.com/available" class="markup--anchor markup--pre-anchor" title="Twitter profile for @available" rel="noopener" target="_blank">@available</a>(iOS 13.0.0, *)<br>struct ViewControllerPreviews: PreviewProvider, UIViewControllerRepresentable {</pre><pre name="70e2" id="70e2" class="graf graf--pre graf-after--pre">    static var previews: some View {<br>        ViewControllerPreviews()<br>    }<br>    <br>    func makeUIViewController(context: Context) -&gt; ViewController {<br>         UIStoryboard(name: &quot;Main&quot;, bundle: nil).instantiateViewController(identifier: &quot;ViewController&quot;) as! ViewController<br>    }<br>    <br>    func updateUIViewController(_ uiViewController: ViewController, context: Context) {<br>    }</pre><pre name="3aed" id="3aed" class="graf graf--pre graf-after--pre">}</pre><p name="4d09" id="4d09" class="graf graf--p graf-after--pre">前面提到會更動的是 ViewControllerPreviews ，ViewController &amp; Main。其中 ViewControllerPreviews 將變成使用者建立的檔案名字，因此可用 <code class="markup--code markup--p-code">___FILEBASENAMEASIDENTIFIER___</code> 替代。ViewController ＆ Main 對應的 controller 型別名 &amp; storyboard 檔名則是使用者輸入的 options 欄位，在此我們可用 ___VARIABLE_xxx___ 表示，將 xxx 換成當初 options 裡設定的 Identifier。</p><pre name="af3b" id="af3b" class="graf graf--pre graf-after--p">//___FILEHEADER___</pre><pre name="6909" id="6909" class="graf graf--pre graf-after--pre">import SwiftUI</pre><pre name="2901" id="2901" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/available" data-href="http://twitter.com/available" class="markup--anchor markup--pre-anchor" title="Twitter profile for @available" rel="noopener" target="_blank">@available</a>(iOS 13.0.0, *)<br>struct <strong class="markup--strong markup--pre-strong">___FILEBASENAMEASIDENTIFIER___</strong>: PreviewProvider, UIViewControllerRepresentable {<br>    <br>    static var previews: some View {<br>        <strong class="markup--strong markup--pre-strong">___FILEBASENAMEASIDENTIFIER___</strong>()<br>    }<br>    <br>    func makeUIViewController(context: Context) -&gt; <strong class="markup--strong markup--pre-strong">___VARIABLE_Controller___</strong> {<br>         UIStoryboard(name: &quot;<strong class="markup--strong markup--pre-strong">___VARIABLE_Storyboard___</strong>&quot;, bundle: nil).instantiateViewController(identifier: &quot;<strong class="markup--strong markup--pre-strong">___VARIABLE_Controller___</strong>&quot;) as! <strong class="markup--strong markup--pre-strong">___VARIABLE_Controller___</strong><br>    }<br>    <br>    func updateUIViewController(_ uiViewController: <strong class="markup--strong markup--pre-strong">___VARIABLE_Controller___</strong>, context: Context) {<br>    }</pre><pre name="4634" id="4634" class="graf graf--pre graf-after--pre">}</pre><h3 name="cc5d" id="cc5d" class="graf graf--h3 graf-after--pre">測試樣版 Controller Preview</h3><p name="8127" id="8127" class="graf graf--p graf-after--h3">現在我們的 Controller Preview template 已經完成了，讓我們找個大型的 storyboard 專案，以 DeluxeAlonso 大大串接 TMDB API 開發的電影 App 試試吧。</p><div name="9c56" id="9c56" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://github.com/DeluxeAlonso/UpcomingMovies" data-href="https://github.com/DeluxeAlonso/UpcomingMovies" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://github.com/DeluxeAlonso/UpcomingMovies"><strong class="markup--strong markup--mixtapeEmbed-strong">DeluxeAlonso/UpcomingMovies</strong><br><em class="markup--em markup--mixtapeEmbed-em">Movies app written in Swift 5 using the TMDb API. Used for downloading and caching images. In the app, it is used to…</em>github.com</a><a href="https://github.com/DeluxeAlonso/UpcomingMovies" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="00cbdca711d5b8660daba9a3a2056a07" data-thumbnail-img-id="0*5w6k6mupse21FUwS" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*5w6k6mupse21FUwS);"></a></div><ul class="postList"><li name="dc02" id="dc02" class="graf graf--li graf-after--mixtapeEmbed"><strong class="markup--strong markup--li-strong">Search 列表</strong></li></ul><p name="07cc" id="07cc" class="graf graf--p graf-after--li">我們先將目標放在比較簡單的 Search 列表。</p><figure name="3195" id="3195" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9NyV4c0yJND5te0huIGYqg.jpeg" data-width="890" data-height="1546" src="https://cdn-images-1.medium.com/max/800/1*9NyV4c0yJND5te0huIGYqg.jpeg"></figure><p name="e6ec" id="e6ec" class="graf graf--p graf-after--figure">我們想將 SearchMoviesViewController 的 storyboard 畫面變成 SwiftUI Preview。</p><figure name="c6c8" id="c6c8" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9JF7CmQ6KC3qMO9SXlFI4A.jpeg" data-width="1790" data-height="1040" src="https://cdn-images-1.medium.com/max/800/1*9JF7CmQ6KC3qMO9SXlFI4A.jpeg"></figure><p name="cf6e" id="cf6e" class="graf graf--p graf-after--figure">建立新檔，選擇 Controller Preview。</p><figure name="529f" id="529f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*3ol4lnLfv3mmTx7czpyGEw.jpeg" data-width="1432" data-height="1032" src="https://cdn-images-1.medium.com/max/800/1*3ol4lnLfv3mmTx7czpyGEw.jpeg"></figure><p name="8442" id="8442" class="graf graf--p graf-after--figure">輸入controller &amp; Storyboard 的名字，SearchMoviesViewController &amp; SearchMovies。</p><figure name="44b4" id="44b4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Ix3cf7CLootvnfC1glauwQ.jpeg" data-width="1438" data-height="1040" src="https://cdn-images-1.medium.com/max/800/1*Ix3cf7CLootvnfC1glauwQ.jpeg"></figure><p name="a9b1" id="a9b1" class="graf graf--p graf-after--figure">將檔名取名為 SearchMoviesViewControllerPreviews。</p><figure name="5465" id="5465" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*w9xUJ7JozD7QV9X4uFF0xA.jpeg" data-width="1700" data-height="892" src="https://cdn-images-1.medium.com/max/800/1*w9xUJ7JozD7QV9X4uFF0xA.jpeg"></figure><p name="44d4" id="44d4" class="graf graf--p graf-after--figure">產生 SearchMoviesViewControllerPreviews.swift。</p><pre name="130d" id="130d" class="graf graf--pre graf-after--p">import SwiftUI</pre><pre name="e502" id="e502" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/available" data-href="http://twitter.com/available" class="markup--anchor markup--pre-anchor" title="Twitter profile for @available" rel="noopener" target="_blank">@available</a>(iOS 13.0.0, *)<br>struct SearchMoviesViewControllerPreviews: PreviewProvider, UIViewControllerRepresentable {</pre><pre name="b6fe" id="b6fe" class="graf graf--pre graf-after--pre">    static var previews: some View {<br>        SearchMoviesViewControllerPreviews()<br>    }</pre><pre name="b0b3" id="b0b3" class="graf graf--pre graf-after--pre">    func makeUIViewController(context: Context) -&gt; SearchMoviesViewController {<br>         UIStoryboard(name: &quot;SearchMovies&quot;, bundle: nil).instantiateViewController(identifier: &quot;SearchMoviesViewController&quot;) as! SearchMoviesViewController<br>    }<br>    <br>    func updateUIViewController(_ uiViewController: SearchMoviesViewController, context: Context) {<br>    }</pre><pre name="82a5" id="82a5" class="graf graf--pre graf-after--pre">}</pre><p name="247c" id="247c" class="graf graf--p graf-after--pre">由於 SearchMoviesViewController 需要 viewModel 才能顯示資料，我們在 function makeUIViewController 裡加入設定 viewModel 的程式。</p><pre name="a804" id="a804" class="graf graf--pre graf-after--p">func makeUIViewController(context: Context) -&gt; SearchMoviesViewController {<br>        <br>         let controller = UIStoryboard(name: &quot;SearchMovies&quot;, bundle: nil).instantiateViewController(identifier: &quot;SearchMoviesViewController&quot;) as! SearchMoviesViewController<br>        <br>        <strong class="markup--strong markup--pre-strong">controller.viewModel = SearchMoviesViewModel(useCaseProvider: InjectionFactory.useCaseProvider())</strong><br>         return controller<br>}</pre><p name="736c" id="736c" class="graf graf--p graf-after--pre">preview 順利地呈現原本要啟動模擬器才能看到的 Search 列表。</p><figure name="015f" id="015f" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*jYouxdhR9nBlqYi9AcDxdg.jpeg" data-width="732" data-height="1194" src="https://cdn-images-1.medium.com/max/800/1*jYouxdhR9nBlqYi9AcDxdg.jpeg"></figure><p name="b4b1" id="b4b1" class="graf graf--p graf-after--figure">我們也可以修改程式，即時地從 preview 看到更新，比方從 DefaultSearchOptionTableViewCell 裡修改文字的大小和顏色。</p><figure name="9feb" id="9feb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*yX3ySvuHp6rIKOuDX_0sxw.jpeg" data-width="2348" data-height="1266" src="https://cdn-images-1.medium.com/max/800/1*yX3ySvuHp6rIKOuDX_0sxw.jpeg"></figure><ul class="postList"><li name="a7cf" id="a7cf" class="graf graf--li graf-after--figure"><strong class="markup--strong markup--li-strong">電影列表</strong></li></ul><figure name="9fcf" id="9fcf" class="graf graf--figure graf-after--li"><img class="graf-image" data-image-id="1*XgQfMPqgu9Vfv9aCt6hHfw.jpeg" data-width="890" data-height="1546" src="https://cdn-images-1.medium.com/max/800/1*XgQfMPqgu9Vfv9aCt6hHfw.jpeg"></figure><p name="5496" id="5496" class="graf graf--p graf-after--figure">我們想將 UpcomingMoviesViewController 的 storyboard 畫面變成 SwiftUI Preview。</p><figure name="5791" id="5791" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*gx98MV3_SKIEMFWKzueBXQ.jpeg" data-width="1484" data-height="1008" src="https://cdn-images-1.medium.com/max/800/1*gx98MV3_SKIEMFWKzueBXQ.jpeg"></figure><p name="c7eb" id="c7eb" class="graf graf--p graf-after--figure">採用跟剛剛一樣的步驟建立 UpcomingMoviesViewControllerPreviews.swift。同樣的，由於 UpcomingMoviesViewController 需要 viewModel 才能顯示資料，我們在 function makeUIViewController 裡加入設定 viewModel 的程式。</p><pre name="2689" id="2689" class="graf graf--pre graf-after--p">import SwiftUI</pre><pre name="36c8" id="36c8" class="graf graf--pre graf-after--pre"><a href="http://twitter.com/available" data-href="http://twitter.com/available" class="markup--anchor markup--pre-anchor" title="Twitter profile for @available" rel="noopener" target="_blank">@available</a>(iOS 13.0.0, *)<br>struct UpcomingMoviesViewControllerPreviews: PreviewProvider, UIViewControllerRepresentable {</pre><pre name="71fc" id="71fc" class="graf graf--pre graf-after--pre">    static var previews: some View {<br>        UpcomingMoviesViewControllerPreviews()<br>    }</pre><pre name="f65b" id="f65b" class="graf graf--pre graf-after--pre">    func makeUIViewController(context: Context) -&gt; UpcomingMoviesViewController {<br>         let controller = UIStoryboard(name: &quot;UpcomingMovies&quot;, bundle: nil).instantiateViewController(identifier: &quot;UpcomingMoviesViewController&quot;) as! UpcomingMoviesViewController<br>        <strong class="markup--strong markup--pre-strong"> controller.viewModel = UpcomingMoviesViewModel(useCaseProvider: InjectionFactory.useCaseProvider())<br>         </strong><br>        return controller<br>   }<br>    <br>    func updateUIViewController(_ uiViewController: UpcomingMoviesViewController, context: Context) {<br>    }</pre><pre name="e95e" id="e95e" class="graf graf--pre graf-after--pre">}</pre><p name="13d5" id="13d5" class="graf graf--p graf-after--pre">不過由於 UpcomingMoviesViewController 將從網路抓資料，所以 preview 不一定能顯示。如下圖所示，它的畫面一片空白。</p><figure name="49b1" id="49b1" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*q82mYim9XAtxOsmz7AxvoQ.jpeg" data-width="2468" data-height="1262" src="https://cdn-images-1.medium.com/max/800/1*q82mYim9XAtxOsmz7AxvoQ.jpeg"></figure><p name="8627" id="8627" class="graf graf--p graf-after--figure">別緊張，點選 live preview 的三角形後，我們一樣可以從 preview 看到網路抓下來的熱門電影。</p><figure name="1e47" id="1e47" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*EWBpGQQpPRJkFzEqfGAXzA.jpeg" data-width="2454" data-height="1270" src="https://cdn-images-1.medium.com/max/800/1*EWBpGQQpPRJkFzEqfGAXzA.jpeg"></figure><p name="cdbf" id="cdbf" class="graf graf--p graf-after--figure">我們也可以跳到 UpcomingMoviesViewController 裡修改程式，比方將背景變黑色，preview 也會立即更新。</p><figure name="aa83" id="aa83" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*sug6XcGJQeg3TZi41_8OyQ.jpeg" data-width="2414" data-height="1282" src="https://cdn-images-1.medium.com/max/800/1*sug6XcGJQeg3TZi41_8OyQ.jpeg"></figure><p name="147d" id="147d" class="graf graf--p graf-after--figure">不過若是修改 xib 或 storyboard，則要再點選右上角的 Resume 才會更新，比方以下從 xib 將電影圖片的 alpha 調成 0.5。</p><figure name="4adb" id="4adb" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*-_ZTIttPLoU4YR5iJrLR0A.jpeg" data-width="2544" data-height="1296" src="https://cdn-images-1.medium.com/max/800/1*-_ZTIttPLoU4YR5iJrLR0A.jpeg"></figure><figure name="9033" id="9033" class="graf graf--figure graf-after--figure graf--trailing"><img class="graf-image" data-image-id="1*Rpc1XmoxnAgRAQhsAXrg7Q.jpeg" data-width="1166" data-height="1208" src="https://cdn-images-1.medium.com/max/800/1*Rpc1XmoxnAgRAQhsAXrg7Q.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/78e5f78d4b72"><time class="dt-published" datetime="2020-01-29T12:40:15.917Z">January 29, 2020</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%BB%BA%E7%AB%8B-xcode-%E7%9A%84-file-template-%E4%BB%A5-swiftui-controller-preview-%E7%82%BA%E4%BE%8B-78e5f78d4b72" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>