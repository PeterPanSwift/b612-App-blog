<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>將 SwiftUI view 變成圖片的 ImageRenderer</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">將 SwiftUI view 變成圖片的 ImageRenderer</h1>
</header>
<section data-field="subtitle" class="p-summary">
從 iOS 16 開始，SwiftUI 推出了 ImageRenderer，利用它我們可以方便地將 SwiftUI view 變成圖片，快速地實現 App 常見的截圖功能。
</section>
<section data-field="body" class="e-content">
<section name="c749" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="1c89" id="1c89" class="graf graf--h3 graf--leading graf--title">將 SwiftUI view 變成圖片的 ImageRenderer</h3><p name="0086" id="0086" class="graf graf--p graf-after--h3">從 iOS 16 開始，SwiftUI 推出了 ImageRenderer，利用它我們可以方便地將 SwiftUI view 變成圖片，快速地實現 App 常見的截圖功能。</p><p name="0cbc" id="0cbc" class="graf graf--p graf-after--p">以下我們以戴佩妮新專輯好聽的歌曲鬧劇為例說明。</p><h3 name="5330" id="5330" class="graf graf--h3 graf-after--p">將 SwiftUI view 變成 UIImage</h3><pre name="8ead" id="8ead" class="graf graf--pre graf-after--h3">struct ContentView: View {<br><strong class="markup--strong markup--pre-strong">    </strong><a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank"><strong class="markup--strong markup--pre-strong">@State</strong></a><strong class="markup--strong markup--pre-strong"> private var songUIImage: UIImage?<br></strong>   <br>    var body: some View {<br>      <strong class="markup--strong markup--pre-strong">  let songView = createSongView(pic: &quot;被動的觀眾&quot;, song: &quot;鬧劇&quot;, lyrics: &quot;&quot;&quot;<br>你說的話都是假的<br>真的假的 真的假的<br>你連擁抱都是冷的<br>都是冷的 都是冷的<br>&quot;&quot;&quot;)</strong><br>        VStack(spacing: 10) {<br>            Text(&quot;原圖&quot;)<br>            songView<br>            Button(&quot;產生歌曲圖片&quot;) {<br>               <strong class="markup--strong markup--pre-strong"> let render = ImageRenderer(content: songView)<br>                render.scale = UIScreen.main.scale<br>                songUIImage = render.uiImage</strong><br>            }<br>          <strong class="markup--strong markup--pre-strong">  if let songUIImage {<br>                Text(&quot;新圖&quot;)<br>                Image(uiImage: songUIImage)<br>            }</strong><br>        }<br>    }<br>    <br><strong class="markup--strong markup--pre-strong">    func createSongView(pic: String, song: String, lyrics: String) -&gt; some View {<br></strong>        VStack {<br>            Image(pic)<br>                .resizable()<br>                .scaledToFill()<br>                .frame(width: 150, height: 150)<br>                .clipShape(Circle())<br>            Text(song)<br>                .font(.title)<br>                .bold()<br>            Text(lyrics)<br>        }<br>        .padding()<br>        .background(.yellow)<br>        .cornerRadius(20)<br>    }<br>}</pre><p name="fa15" id="fa15" class="graf graf--p graf-after--pre">說明</p><pre name="9f72" id="9f72" class="graf graf--pre graf-after--p">let songView = createSongView(pic: &quot;被動的觀眾&quot;, song: &quot;鬧劇&quot;, lyrics: &quot;&quot;&quot;<br>你說的話都是假的<br>真的假的 真的假的<br>你連擁抱都是冷的<br>都是冷的 都是冷的<br>&quot;&quot;&quot;)</pre><p name="5fcb" id="5fcb" class="graf graf--p graf-after--pre">呼叫 function createSongView 產生歌曲鬧劇的圖文畫面，存在 songView。</p><pre name="44e3" id="44e3" class="graf graf--pre graf-after--p">let render = ImageRenderer(content: songView)</pre><p name="4714" id="4714" class="graf graf--p graf-after--pre">利用 <code class="markup--code markup--p-code">ImageRenderer(content: songView)</code> 產生 ImageRender，參數 content 可傳入任何我們想變成圖片的 view。</p><pre name="5120" id="5120" class="graf graf--pre graf-after--p">render.scale = UIScreen.main.scale</pre><p name="7c82" id="7c82" class="graf graf--p graf-after--pre">設定 scale，讓圖片的解析度跟 iPhone 螢幕的解析度一致，如此才不會產生模糊的圖片。比方 songView 在 iPhone 13 的大小是 200 * 200 point，那麼它的 pixel 應該要是 600 * 600 pixel，因為 iPhone 13 的解析度是 3x，UIScreen.main.scale 是 3。若是沒有設定 scale，ImageRender 預設的 scale 是 1，將造成產生的圖片只有 200 * 200 pixel。</p><pre name="3a39" id="3a39" class="graf graf--pre graf-after--p">songUIImage = render.uiImage</pre><p name="265b" id="265b" class="graf graf--p graf-after--pre">從 ImageRender 的 property uiImage 取得型別 UIImage 的圖片，存入 songUIImage。</p><pre name="3830" id="3830" class="graf graf--pre graf-after--p">if let songUIImage {<br>   Text(&quot;新圖&quot;)<br>   Image(uiImage: songUIImage)<br>}</pre><p name="0327" id="0327" class="graf graf--p graf-after--pre">當 songUIImage 有值時，將它變成 Image 顯示在畫面上。</p><p name="0975" id="0975" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">執行 App</strong></p><p name="0647" id="0647" class="graf graf--p graf-after--p">點選 button <code class="markup--code markup--p-code">產生歌曲圖片</code>，將畫面上方的歌曲圖文變成圖片，然後將圖片變成 Image 顯示在畫面下方。</p><figure name="edc0" id="edc0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*mcO0ddATeqZUDzgjN_UCpA.png" data-width="1344" data-height="1222" src="https://cdn-images-1.medium.com/max/800/1*mcO0ddATeqZUDzgjN_UCpA.png"></figure><p name="9036" id="9036" class="graf graf--p graf-after--figure">剛剛的例子我們以 function createSongView 產生歌曲的圖文畫面。除了利用 function 產生，我們也可以寫成 computed property 或另外定義畫面型別，比方以下例子另外定義產生歌曲圖文畫面的 SongView。</p><pre name="42f1" id="42f1" class="graf graf--pre graf-after--p">struct SongView: View {<br>    let pic: String<br>    let song: String<br>    let lyrics: String<br>    <br>    var body: some View {<br>        VStack {<br>            Image(pic)<br>                .resizable()<br>                .scaledToFill()<br>                .frame(width: 150, height: 150)<br>                .clipShape(Circle())<br>            Text(song)<br>                .font(.title)<br>                .bold()<br>            Text(lyrics)<br>        }<br>        .padding()<br>        .background(.yellow)<br>        .cornerRadius(20)<br>    }<br>}</pre><p name="6035" id="6035" class="graf graf--p graf-after--pre">在 ContentView 裡產生 SongView 顯示歌曲的圖文畫面。</p><pre name="70ea" id="70ea" class="graf graf--pre graf-after--p">struct ContentView: View {<br>    <a href="http://twitter.com/State" data-href="http://twitter.com/State" class="markup--anchor markup--pre-anchor" title="Twitter profile for @State" rel="noopener" target="_blank">@State</a> private var songUIImage: UIImage?<br>   <br>    var body: some View {<br>       <strong class="markup--strong markup--pre-strong"> let songView = SongView(pic: &quot;被動的觀眾&quot;, song: &quot;鬧劇&quot;, lyrics: &quot;&quot;&quot;<br>你說的話都是假的<br>真的假的 真的假的<br>你連擁抱都是冷的<br>都是冷的 都是冷的<br>&quot;&quot;&quot;)</strong><br>        VStack(spacing: 10) {<br>            Text(&quot;原圖&quot;)<br>            songView<br>            Button(&quot;產生歌曲圖片&quot;) {<br>                let render = ImageRenderer(content: songView)<br>                render.scale = UIScreen.main.scale<br>                songUIImage = render.uiImage<br>            }<br>            if let songUIImage {<br>                Text(&quot;新圖&quot;)<br>                Image(uiImage: songUIImage)<br>            }<br>        }<br>    }<br>    <br>}</pre><h3 name="87ee" id="87ee" class="graf graf--h3 graf-after--pre">將 ImageRenderer 生成的圖片存入 iPhone 相簿</h3><p name="831e" id="831e" class="graf graf--p graf-after--h3">呼叫 UIImageWriteToSavedPhotosAlbum，傳入 ImageRenderer 的 uiImage 即可將圖片存入 iPhone 的相簿。</p><pre name="84ba" id="84ba" class="graf graf--pre graf-after--p">Button(&quot;產生歌曲圖片&quot;) {<br>   let render = ImageRenderer(content: songView)<br>   render.scale = UIScreen.main.scale<br>   if let uiImage = render.uiImage {<br><strong class="markup--strong markup--pre-strong">      UIImageWriteToSavedPhotosAlbum(uiImage, nil, nil, nil)<br></strong>   }<br>}</pre><p name="c271" id="c271" class="graf graf--p graf-after--pre">ps: 將圖片存入 iPhone 相簿前記得要跟使用者請求權限。</p><div name="5b5d" id="5b5d" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87%E5%9C%96%E7%89%87%E5%84%B2%E5%AD%98%E5%88%B0-ios-11-%E7%9A%84-photo-album-c8761bb21139" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87%E5%9C%96%E7%89%87%E5%84%B2%E5%AD%98%E5%88%B0-ios-11-%E7%9A%84-photo-album-c8761bb21139" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87%E5%9C%96%E7%89%87%E5%84%B2%E5%AD%98%E5%88%B0-ios-11-%E7%9A%84-photo-album-c8761bb21139"><strong class="markup--strong markup--mixtapeEmbed-strong">將圖片儲存到 iOS 11 的 photo album</strong><br><em class="markup--em markup--mixtapeEmbed-em">將圖片儲存到 iPhone 的 photo album 十分容易，只要以下兩行程式碼，</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%B0%87%E5%9C%96%E7%89%87%E5%84%B2%E5%AD%98%E5%88%B0-ios-11-%E7%9A%84-photo-album-c8761bb21139" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="eed22ad1340e3f3e773975eac44a9e33" data-thumbnail-img-id="1*yitHOzP4u2MYipSjd9LTQg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*yitHOzP4u2MYipSjd9LTQg.jpeg);"></a></div><p name="8f09" id="8f09" class="graf graf--p graf-after--mixtapeEmbed">不過如果圖片有一些透明的區塊，我們必須將它變成 png 格式再存入相簿，如此才能保留透明的區塊。以下例子我們利用 <code class="markup--code markup--p-code">pngData()</code> 將圖片變成 png 格式的 Data，然後再以 <code class="markup--code markup--p-code">UIImage(data: pngData)</code> 生成存入相簿的圖片。</p><pre name="fdc6" id="fdc6" class="graf graf--pre graf-after--p">Button(&quot;產生歌曲圖片&quot;) {<br>   let render = ImageRenderer(content: songView)<br>   render.scale = UIScreen.main.scale<br>   <strong class="markup--strong markup--pre-strong">if let pngData = render.uiImage?.pngData(),<br>      let pngImage = UIImage(data: pngData) {<br>         UIImageWriteToSavedPhotosAlbum(pngImage, nil, nil, nil)<br>   }</strong><br>}</pre><h3 name="2a04" id="2a04" class="graf graf--h3 graf-after--pre">利用 ImageRenderer 擷取傾斜的畫面</h3><p name="77b1" id="77b1" class="graf graf--p graf-after--h3">利用 ImageRenderer 擷取傾斜的畫面時，有可能會發現部分的區塊被切到，這是因為畫面的框框無法完整包含傾斜的畫面。</p><p name="78d1" id="78d1" class="graf graf--p graf-after--p">讓我們在剛剛的 createSongView 加入 modifier rotationEffect 試試。</p><pre name="8f7e" id="8f7e" class="graf graf--pre graf-after--p">func createSongView(pic: String, song: String, lyrics: String) -&gt; some View {<br>        VStack {<br>            Image(pic)<br>                .resizable()<br>                .scaledToFill()<br>                .frame(width: 150, height: 150)<br>                .clipShape(Circle())<br>            Text(song)<br>                .font(.title)<br>                .bold()<br>            Text(lyrics)<br>        }<br>        .padding()<br>        .background(.yellow)<br>        .cornerRadius(20)<br><strong class="markup--strong markup--pre-strong">        .rotationEffect(.degrees(5))<br></strong>}</pre><p name="b5e3" id="b5e3" class="graf graf--p graf-after--pre">如下圖所示，只是小小的傾斜 5 度，畫面的框框就無法完整包含整個畫面。</p><figure name="8f11" id="8f11" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*wFMi5Kkpar2wpaqflrr7Ag.png" data-width="858" data-height="1382" src="https://cdn-images-1.medium.com/max/800/1*wFMi5Kkpar2wpaqflrr7Ag.png"></figure><p name="3051" id="3051" class="graf graf--p graf-after--figure">若我們傻傻地用 ImageRenderer 擷取 createSongView 產生的 view，點選<code class="markup--code markup--p-code">產生歌曲圖片</code>的畫面如下，新圖下的畫面果然是場鬧劇，慘不忍睹，邊邊的部分都被切到了。</p><figure name="fd31" id="fd31" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*DXxzBazAXYuYnjKGKEKVzg.png" data-width="1400" data-height="2700" src="https://cdn-images-1.medium.com/max/800/1*DXxzBazAXYuYnjKGKEKVzg.png"></figure><p name="550b" id="550b" class="graf graf--p graf-after--figure">解決的方法很簡單，我們可在 rotationEffect 後加上 padding，讓框框完整包含傾斜的畫面。</p><pre name="bd9f" id="bd9f" class="graf graf--pre graf-after--p">func createSongView(pic: String, song: String, lyrics: String) -&gt; some View {<br>        VStack {<br>            Image(pic)<br>                .resizable()<br>                .scaledToFill()<br>                .frame(width: 150, height: 150)<br>                .clipShape(Circle())<br>            Text(song)<br>                .font(.title)<br>                .bold()<br>            Text(lyrics)<br>        }<br>        .padding()<br>        .background(.yellow)<br>        .cornerRadius(20)<br>        .rotationEffect(.degrees(5))<br><strong class="markup--strong markup--pre-strong">        .padding()        <br></strong>}</pre><figure name="88e9" id="88e9" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*NIppoztYUr64KkUtGX8uyw.png" data-width="868" data-height="1158" src="https://cdn-images-1.medium.com/max/800/1*NIppoztYUr64KkUtGX8uyw.png"></figure><p name="35e8" id="35e8" class="graf graf--p graf-after--figure">加了 padding 後，ImageRenderer 成功擷取完整的傾斜畫面。</p><figure name="d240" id="d240" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*s1cWel6759-WNABOfvBk_w.png" data-width="1400" data-height="2700" src="https://cdn-images-1.medium.com/max/800/1*s1cWel6759-WNABOfvBk_w.png"></figure><p name="6d69" id="6d69" class="graf graf--p graf-after--figure">存入 iPhone 相簿的畫面也是完整的傾斜畫面，不再是場鬧劇。</p><figure name="8efe" id="8efe" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*TG-1JdV6PKasbDy0pvKdlQ.png" data-width="1170" data-height="2532" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*TG-1JdV6PKasbDy0pvKdlQ.png"></figure><h3 name="2a80" id="2a80" class="graf graf--h3 graf-after--figure">參考連結</h3><div name="acf8" id="acf8" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://developer.apple.com/documentation/swiftui/imagerenderer" data-href="https://developer.apple.com/documentation/swiftui/imagerenderer" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swiftui/imagerenderer"><strong class="markup--strong markup--mixtapeEmbed-strong">Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Edit description</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swiftui/imagerenderer" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="2e2ff26843fcc043b3780f7e7f6c3699"></a></div><figure name="bca0" id="bca0" class="graf graf--figure graf--iframe graf-after--mixtapeEmbed graf--trailing"><iframe src="https://www.youtube.com/embed/00d_EHxb8vs?feature=oembed" width="640" height="480" frameborder="0" scrolling="no"></iframe></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/b46921c403d2"><time class="dt-published" datetime="2022-07-06T08:09:04.892Z">July 6, 2022</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%B0%87-swiftui-view-%E8%AE%8A%E6%88%90%E5%9C%96%E7%89%87%E7%9A%84-imagerenderer-b46921c403d2" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>