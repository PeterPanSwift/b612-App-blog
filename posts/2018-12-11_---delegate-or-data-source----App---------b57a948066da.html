<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>透過 delegate or data source 實現 App 功能的步驟說明</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">透過 delegate or data source 實現 App 功能的步驟說明</h1>
</header>
<section data-field="subtitle" class="p-summary">
開發 iOS App 時，我們時常透過 delegate or data source，定義某個  protocol 的相關 function 實現功能。相關的動作可以簡單分為三個步驟:
</section>
<section data-field="body" class="e-content">
<section name="3eba" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="747f" id="747f" class="graf graf--h3 graf--leading graf--title">透過 delegate or data source 實現 App 功能的步驟說明</h3><p name="05d8" id="05d8" class="graf graf--p graf-after--h3">開發 iOS App 時，我們時常透過 delegate or data source，定義某個 protocol 的相關 function 實現功能。相關的動作可以簡單分為三個步驟:</p><ul class="postList"><li name="e301" id="e301" class="graf graf--li graf-after--p">定義型別 A 遵從 protocol。</li><li name="c860" id="c860" class="graf graf--li graf-after--li">在型別 A 裡定義和某個功能有關的 protocol function。</li><li name="c7e9" id="c7e9" class="graf graf--li graf-after--li">指定 data source or delegate 是型別 A 生成的東西。</li></ul><p name="e4bc" id="e4bc" class="graf graf--p graf-after--li">只要熟練以上三個步驟，即可靈活運用 iOS SDK 裡各種 delegate 和 data source，實現我們想要的功能。接下來我們就以 UITextViewDelegate &amp; QLPreviewControllerDataSource 的例子說明吧。</p><blockquote name="034b" id="034b" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">例子 1: 彼得潘因為小時候李白的詩背不出來被老師打，所以不喜歡李白，因此決定讓使用者無法在 App 的 text view 輸入李白。</strong></blockquote><p name="09dc" id="09dc" class="graf graf--p graf-after--blockquote">為了實現此功能，一般我們會聯想是否有 function 能在使用者輸入每個字時觸發，然後在此 function 控制輸入的文字。經由 google 大神的幫忙，我們查到使用者輸入文字時， text view 將找 delegate 幫忙，觸發 protocol UITextViewDelegate 的 function textView(_:shouldChangeTextIn:replacementText:)，因此我們可透過它控制使用者是否能輸入李白。接下來我們就照剛剛提到的三步驟實現吧。</p><p name="7fca" id="7fca" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">1 讓 ViewController 遵從 protocol UITextViewDelegate。</strong></p><p name="bf88" id="bf88" class="graf graf--p graf-after--p">我們時常用 view controller 當 delegate or data source，為了讓以下畫面的 controller 成為 text view 的 delegate，我們讓 class ViewController 遵從 protocol UITextViewDelegate。</p><figure name="8610" id="8610" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9xn_gt2aQlzwe8E6ZUs_-A.jpeg" data-width="1356" data-height="630" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*9xn_gt2aQlzwe8E6ZUs_-A.jpeg"></figure><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="f405" id="f405" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span>, <span class="hljs-title class_">UITextViewDelegate</span></span></pre><p name="16ac" id="16ac" class="graf graf--p graf-after--pre">遵從 protocol 也有另一種寫法，利用 extension 讓 ViewController 遵從 UITextViewDelegate，此方法可讓程式切得比較乾淨，讓 class ViewController { } 裡的程式碼不會太多。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="6049" id="6049" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">extension</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UITextViewDelegate</span> {<br /><br />}</span></pre><p name="1e04" id="1e04" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">2 定義 protocol UITextViewDelegate 的 function textView(_:shouldChangeTextIn:replacementText:)</strong></p><p name="e24d" id="e24d" class="graf graf--p graf-after--p">此 function 在 protocol 的宣告如下。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="b30d" id="b30d" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">optional</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">textView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">textView</span>: <span class="hljs-type">UITextView</span>, <br />    <span class="hljs-params">shouldChangeTextIn</span> <span class="hljs-params">range</span>: <span class="hljs-type">NSRange</span>, <br />       <span class="hljs-params">replacementText</span> <span class="hljs-params">text</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Bool</span></span></pre><p name="0fd0" id="0fd0" class="graf graf--p graf-after--pre">從以下連結的說明文字，我們明白此 function 將在使用者輸入或刪除文字時觸發，回傳 true 或 false 將控制文字是否能順利輸入或刪除。</p><div name="fcbd" id="fcbd" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/uikit/uitextviewdelegate/1618630-textview" data-href="https://developer.apple.com/documentation/uikit/uitextviewdelegate/1618630-textview" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/uikit/uitextviewdelegate/1618630-textview"><strong class="markup--strong markup--mixtapeEmbed-strong">textView(_:shouldChangeTextIn:replacementText:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Asks the delegate whether to replace the specified text in the text view.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/uikit/uitextviewdelegate/1618630-textview" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9ea6ee07a39adb61f126b66cc0c2b375" data-thumbnail-img-id="0*bAL5_ziCjZsNMhal" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*bAL5_ziCjZsNMhal);"></a></div><figure name="6e9a" id="6e9a" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*O5qgj0ugTauMPbSCP7ErGw.jpeg" data-width="1618" data-height="272" src="https://cdn-images-1.medium.com/max/800/1*O5qgj0ugTauMPbSCP7ErGw.jpeg"></figure><figure name="064e" id="064e" class="graf graf--figure graf-after--figure"><img class="graf-image" data-image-id="1*8xeninr1gDnlCRohSN98Ug.jpeg" data-width="1344" data-height="314" src="https://cdn-images-1.medium.com/max/800/1*8xeninr1gDnlCRohSN98Ug.jpeg"></figure><p name="8a2a" id="8a2a" class="graf graf--p graf-after--figure">了解此 function 的用途後，我們在 function 裡判斷加入使用者新輸入的文字 text 後，newText 是否包含可惡的李白，若有則回傳 false，不讓它輸入，其它則回傳 true。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e5a1" id="e5a1" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">textView</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">textView</span>: <span class="hljs-type">UITextView</span>, <span class="hljs-params">shouldChangeTextIn</span> <span class="hljs-params">range</span>: <span class="hljs-type">NSRange</span>, <span class="hljs-params">replacementText</span> <span class="hljs-params">text</span>: <span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Bool</span> {<br />   <span class="hljs-keyword">var</span> result <span class="hljs-operator">=</span> <span class="hljs-literal">true</span><br />   <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> originalText <span class="hljs-operator">=</span> textView.text, <br />      <span class="hljs-keyword">let</span> range <span class="hljs-operator">=</span> <span class="hljs-type">Range</span>(range, in: originalText) {<br />      <span class="hljs-keyword">let</span> newText <span class="hljs-operator">=</span> originalText.replacingCharacters(in: range, with: text)<br />      <span class="hljs-keyword">if</span> newText.contains(<span class="hljs-string">&quot;李白&quot;</span>) {<br />         result <span class="hljs-operator">=</span> <span class="hljs-literal">false</span><br />      }<br />   }<br />   <span class="hljs-keyword">return</span> result<br />}</span></pre><div name="09d8" id="09d8" class="graf graf--mixtapeEmbed graf-after--pre"><a href="https://developer.apple.com/documentation/swift/stringprotocol/replacingcharacters%28in:with:%29" data-href="https://developer.apple.com/documentation/swift/stringprotocol/replacingcharacters(in:with:)" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swift/stringprotocol/replacingcharacters(in:with:)"><strong class="markup--strong markup--mixtapeEmbed-strong">replacingCharacters(in:with:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns a new string in which the characters in a specified range of the are replaced by a given string.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swift/stringprotocol/replacingcharacters%28in:with:%29" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="ef199767b0f68e3ed097d5aa5e46a553" data-thumbnail-img-id="0*br3AdJ9P9Sdb_C0U" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*br3AdJ9P9Sdb_C0U);"></a></div><div name="8453" id="8453" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developer.apple.com/documentation/swift/range/init%28_:in:%29-5cclx" data-href="https://developer.apple.com/documentation/swift/range/init(_:in:)-5cclx" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swift/range/init(_:in:)-5cclx"><strong class="markup--strong markup--mixtapeEmbed-strong">init(_:in:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">There&#39;s never been a better time to develop for Apple platforms.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swift/range/init%28_:in:%29-5cclx" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="c7bf0920b5f0241b47566c2457ca5468" data-thumbnail-img-id="0*dwc7y6ZQsV9p5ym-" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*dwc7y6ZQsV9p5ym-);"></a></div><p name="92d8" id="92d8" class="graf graf--p graf-after--mixtapeEmbed"><strong class="markup--strong markup--p-strong">3 將 controller 指定為 text view 的 delegate。</strong></p><p name="0a79" id="0a79" class="graf graf--p graf-after--p">我們可在 storyboard 從 text view 連到 view controller，然後將 controller 設為 text view 的 delegate。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="cbf0" id="cbf0" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 47.898%;"><img class="graf-image" data-image-id="1*ZB4h4V_4e0bhxLhdI6_G0A.jpeg" data-width="480" data-height="260" src="https://cdn-images-1.medium.com/max/600/1*ZB4h4V_4e0bhxLhdI6_G0A.jpeg"></figure><figure name="cde9" id="cde9" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 52.102%;"><img class="graf-image" data-image-id="1*LGi1gvMEZPIG5vdE4dGHSQ.jpeg" data-width="534" data-height="266" src="https://cdn-images-1.medium.com/max/800/1*LGi1gvMEZPIG5vdE4dGHSQ.jpeg"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="f1c7" id="f1c7" class="graf graf--p graf-after--figure">想從程式指定 delegate 也可以。我們可連結 text view 的 outlet，然後在 class ViewController 的 viewDidLoad 設定。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="e402" id="e402" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">ViewController</span>: <span class="hljs-title class_">UIViewController</span>, <span class="hljs-title class_">UITextViewDelegate</span> {<br />   <span class="hljs-keyword">@IBOutlet</span> <span class="hljs-keyword">var</span> lyricsTextView: <span class="hljs-type">UITextView</span>!<br /><br />   <span class="hljs-keyword">override</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">viewDidLoad</span>() {<br />       <span class="hljs-keyword">super</span>.viewDidLoad()<br />       lyricsTextView.delegate <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span><br />   }</span></pre><p name="8e65" id="8e65" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">結果</strong></p><p name="1ee8" id="1ee8" class="graf graf--p graf-after--p">要輸入白時，因為會跟前面的字合成李白，所以不行 !</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="613f" id="613f" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><img class="graf-image" data-image-id="1*_6cpYHAmPj0mVfACv5Wf_A.jpeg" data-width="858" data-height="1456" src="https://cdn-images-1.medium.com/max/600/1*_6cpYHAmPj0mVfACv5Wf_A.jpeg"></figure><figure name="7618" id="7618" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><img class="graf-image" data-image-id="1*D42nE9PfITw7SwhtFMgvPg.jpeg" data-width="858" data-height="1456" src="https://cdn-images-1.medium.com/max/600/1*D42nE9PfITw7SwhtFMgvPg.jpeg"></figure></div><div class="section-inner sectionLayout--insetColumn"><p name="c3f0" id="c3f0" class="graf graf--p graf-after--figure">想當李壞倒是可以。</p></div><div class="section-inner sectionLayout--outsetRow" data-paragraph-count="2"><figure name="815d" id="815d" class="graf graf--figure graf--layoutOutsetRow is-partialWidth graf-after--p" style="width: 50%;"><img class="graf-image" data-image-id="1*r5mSSH9uLtm83UI6vPPETw.jpeg" data-width="858" data-height="1456" src="https://cdn-images-1.medium.com/max/600/1*r5mSSH9uLtm83UI6vPPETw.jpeg"></figure><figure name="0338" id="0338" class="graf graf--figure graf--layoutOutsetRowContinue is-partialWidth graf-after--figure" style="width: 50%;"><img class="graf-image" data-image-id="1*ESvjJ9ID20RLVvr0XKYLdg.jpeg" data-width="858" data-height="1456" src="https://cdn-images-1.medium.com/max/600/1*ESvjJ9ID20RLVvr0XKYLdg.jpeg"></figure></div><div class="section-inner sectionLayout--insetColumn"><blockquote name="71d3" id="71d3" class="graf graf--blockquote graf-after--figure"><strong class="markup--strong markup--blockquote-strong">例子 2: 利用 QLPreviewController 顯示 PDF。</strong></blockquote><p name="1c2d" id="1c2d" class="graf graf--p graf-after--blockquote">QLPreviewController 可以預覽 pdf，word，圖片等檔案，不過必須找 data source 幫忙，透過protocol QLPreviewControllerDataSource 的 function numberOfPreviewItems(in:) &amp; previewController(_:previewItemAt:) 設定顯示的內容。</p><p name="dfa4" id="dfa4" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">1 加入預覽的檔案。</strong></p><p name="8de4" id="8de4" class="graf graf--p graf-after--p">為了學習 iOS App 開發，我們決定好好閱讀 Stanford 的 iOS 課程投影片，以下我們先將 pdf 檔 Lecture-1-Slides.pdf 加入專案。</p><figure name="edc0" id="edc0" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*N-qgkTGO3DCGyZgxvDpOXA.jpeg" data-width="2524" data-height="1178" src="https://cdn-images-1.medium.com/max/800/1*N-qgkTGO3DCGyZgxvDpOXA.jpeg"></figure><p name="86c0" id="86c0" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">2 讓 ViewController 遵從 protocol QLPreviewControllerDataSource。</strong></p><p name="e02f" id="e02f" class="graf graf--p graf-after--p">protocol QLPreviewControllerDataSource 裡有些一定要定義的 function，沒定義會出現紅色錯誤，does not conform to protocol。</p><figure name="b399" id="b399" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*_FMHlH2lV5LGRLqbjVDQ3A.jpeg" data-width="1872" data-height="470" src="https://cdn-images-1.medium.com/max/800/1*_FMHlH2lV5LGRLqbjVDQ3A.jpeg"></figure><p name="adf2" id="adf2" class="graf graf--p graf-after--figure">此時我們只要點選 Fix，Xcode 即可幫我們輸入。</p><figure name="3169" id="3169" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8IQYocNU--rac9Z5sf07Cw.jpeg" data-width="1860" data-height="484" src="https://cdn-images-1.medium.com/max/800/1*8IQYocNU--rac9Z5sf07Cw.jpeg"></figure><p name="bb88" id="bb88" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">3 定義 protocol QLPreviewControllerDataSource 的 function numberOfPreviewItems(in:) &amp; previewController(_:previewItemAt:)</strong></p><p name="a8e3" id="a8e3" class="graf graf--p graf-after--p">這兩個 function 控制 QLPreviewController 顯示的檔案數量和內容，相關說明可參考以下連結:</p><div name="c369" id="c369" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/numberofpreviewitems%28in:%29" data-href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/numberofpreviewitems(in:)" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/numberofpreviewitems(in:)"><strong class="markup--strong markup--mixtapeEmbed-strong">numberOfPreviewItems(in:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns the number of preview items to include in the preview navigation list.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/numberofpreviewitems%28in:%29" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="be0078753a62157b02ea336b856e0778" data-thumbnail-img-id="0*SU8vuPkI8PpTxg4M" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*SU8vuPkI8PpTxg4M);"></a></div><div name="0f6f" id="0f6f" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/previewcontroller%28_:previewitemat:%29" data-href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/previewcontroller(_:previewitemat:)" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/previewcontroller(_:previewitemat:)"><strong class="markup--strong markup--mixtapeEmbed-strong">previewController(_:previewItemAt:) | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Returns the preview item that the controller displays for the specified index.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quicklook/qlpreviewcontrollerdatasource/previewcontroller%28_:previewitemat:%29" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="10d4feb9ce7d64af25244b6681f3f08b" data-thumbnail-img-id="0*mYMTwBo035S-jiuy" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*mYMTwBo035S-jiuy);"></a></div><p name="6f82" id="6f82" class="graf graf--p graf-after--mixtapeEmbed">(1) 定義 function function numberOfPreviewItems(in:) 設定預覽的檔案數量。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c3d4" id="c3d4" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">numberOfPreviewItems</span>(<span class="hljs-params">in</span> <span class="hljs-params">controller</span>: <span class="hljs-type">QLPreviewController</span>) -&gt; <span class="hljs-type">Int</span> {<br />   <span class="hljs-keyword">return</span> <span class="hljs-number">1</span><br />}</span></pre><p name="e2d5" id="e2d5" class="graf graf--p graf-after--pre">我們只要預覽一份 pdf 檔，所以回傳 1。</p><p name="b767" id="b767" class="graf graf--p graf-after--p">(2) 定義 function previewController(_:previewItemAt:) 設定預覽的檔案。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="c339" id="c339" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">func</span> <span class="hljs-title function_">previewController</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">controller</span>: <span class="hljs-type">QLPreviewController</span>, <span class="hljs-params">previewItemAt</span> <span class="hljs-params">index</span>: <span class="hljs-type">Int</span>) -&gt; <span class="hljs-type">QLPreviewItem</span> {<br />   <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> url <span class="hljs-operator">=</span> <span class="hljs-type">Bundle</span>.main.url(forResource: <span class="hljs-string">&quot;Lecture-1-Slides&quot;</span>, withExtension: <span class="hljs-string">&quot;pdf&quot;</span>) {<br />     <span class="hljs-keyword">return</span> url <span class="hljs-keyword">as</span> <span class="hljs-type">QLPreviewItem</span><br />   } <span class="hljs-keyword">else</span> {<br />     <span class="hljs-built_in">fatalError</span>()<br />}</span></pre><p name="dec1" id="dec1" class="graf graf--p graf-after--pre">將 pdf 檔的 URL 回傳，表示此 pdf 檔為預覽的檔案。因為 URL 型別本來就遵從 protocol QLPreviewItem，所以我們可以利用 as 轉型回傳。(因為轉型一定成功，所以寫 as，而不是 as!)</p><p name="56a6" id="56a6" class="graf graf--p graf-after--p">對於 URL 遵從 protocol QLPreviewItem 有興趣的朋友，可參考以下連結的說明。</p><div name="36f7" id="36f7" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://developer.apple.com/documentation/quicklook/qlpreviewitem" data-href="https://developer.apple.com/documentation/quicklook/qlpreviewitem" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/quicklook/qlpreviewitem"><strong class="markup--strong markup--mixtapeEmbed-strong">QLPreviewItem | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">There&#39;s never been a better time to develop for Apple platforms.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/quicklook/qlpreviewitem" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f1ef7f4616b85ae0e2a426a9112f97b2" data-thumbnail-img-id="0*ehm1Z1Qs4YVCcFkF" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*ehm1Z1Qs4YVCcFkF);"></a></div><figure name="511d" id="511d" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*zsRzc1K_6M5UJ7JRyZNQLg.jpeg" data-width="1566" data-height="436" src="https://cdn-images-1.medium.com/max/800/1*zsRzc1K_6M5UJ7JRyZNQLg.jpeg"></figure><div name="f6a7" id="f6a7" class="graf graf--mixtapeEmbed graf-after--figure"><a href="https://developer.apple.com/documentation/foundation/nsurl" data-href="https://developer.apple.com/documentation/foundation/nsurl" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/nsurl"><strong class="markup--strong markup--mixtapeEmbed-strong">NSURL | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">An object representing the location of a resource that bridges to ; use when you need reference semantics or other…</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/nsurl" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="762b41fd7e4bb7156fc71cb3c673efdd" data-thumbnail-img-id="0*F28QgZNit--Ul5MD" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*F28QgZNit--Ul5MD);"></a></div><figure name="aaf5" id="aaf5" class="graf graf--figure graf-after--mixtapeEmbed"><img class="graf-image" data-image-id="1*HU-RsSf3KyGa3-c53x2zKA.jpeg" data-width="1082" data-height="758" src="https://cdn-images-1.medium.com/max/800/1*HU-RsSf3KyGa3-c53x2zKA.jpeg"></figure><p name="91f1" id="91f1" class="graf graf--p graf-after--figure"><strong class="markup--strong markup--p-strong">4 顯示 QLPreviewController， 將 view controller 指定為 QLPreviewController 的 dataSource。</strong></p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="fc83" id="fc83" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">@IBAction</span> <span class="hljs-keyword">func</span> <span class="hljs-title function_">showPdf</span>(<span class="hljs-keyword">_</span> <span class="hljs-params">sender</span>: <span class="hljs-keyword">Any</span>) {<br />   <span class="hljs-keyword">let</span> controller <span class="hljs-operator">=</span> <span class="hljs-type">QLPreviewController</span>()<br />   controller.dataSource <span class="hljs-operator">=</span> <span class="hljs-keyword">self</span><br />   present(controller, animated: <span class="hljs-literal">true</span>, completion: <span class="hljs-literal">nil</span>)<br />}</span></pre><p name="6055" id="6055" class="graf graf--p graf-after--pre">結果</p><figure name="b425" id="b425" class="graf graf--figure graf-after--p graf--trailing"><img class="graf-image" data-image-id="1*IdfoeDajCRzbq92gvYpyVQ.jpeg" data-width="858" data-height="1456" src="https://cdn-images-1.medium.com/max/800/1*IdfoeDajCRzbq92gvYpyVQ.jpeg"></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/b57a948066da"><time class="dt-published" datetime="2018-12-11T18:41:38.099Z">December 11, 2018</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E9%80%8F%E9%81%8E-delegate-or-data-source-%E5%AF%A6%E7%8F%BE-app-%E5%8A%9F%E8%83%BD%E7%9A%84%E6%AD%A5%E9%A9%9F%E8%AA%AA%E6%98%8E-b57a948066da" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>