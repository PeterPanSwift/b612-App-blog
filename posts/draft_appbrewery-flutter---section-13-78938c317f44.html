<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>appbrewery flutter â€” section 13</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">appbrewery flutter â€” section 13</h1>
</header>
<section data-field="subtitle" class="p-summary">
location
</section>
<section data-field="body" class="e-content">
<section name="239a" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5d92" id="5d92" class="graf graf--h3 graf--leading graf--title">appbrewery flutterâ€Šâ€”â€ŠsectionÂ 13</h3><ul class="postList"><li name="3a27" id="3a27" class="graf graf--li graf-after--h3">location</li><li name="f441" id="f441" class="graf graf--li graf-after--li">asyncã€awaitã€Future</li><li name="9024" id="9024" class="graf graf--li graf-after--li">Stateful Widget Lifecycle Methodsã€initState</li><li name="717c" id="717c" class="graf graf--li graf-after--li">exceptionã€try catch</li><li name="7a5c" id="7a5c" class="graf graf--li graf-after--li">APIã€networkï¼Œopen weather mapÂ </li><li name="70ed" id="70ed" class="graf graf--li graf-after--li">http package</li><li name="7f95" id="7f95" class="graf graf--li graf-after--li">dart:convertã€jsonDecode</li><li name="cd27" id="cd27" class="graf graf--li graf-after--li">Passing Data to a State Objectï¼ŒState object å¯ä»¥å¾ property widget è®€å–å°æ‡‰çš„ StatefulWidgetã€‚</li><li name="5f4f" id="5f4f" class="graf graf--li graf-after--li">TextField</li><li name="fd6d" id="fd6d" class="graf graf--li graf-after--li">å‚³è³‡æ–™å›ä¸Šä¸€é ï¼Œåˆ©ç”¨ push &amp; pop</li></ul><h3 name="ddab" id="ddab" class="graf graf--h3 graf-after--li">get location</h3><div name="1fc3" id="1fc3" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://pub.dev/packages/geolocator" data-href="https://pub.dev/packages/geolocator" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://pub.dev/packages/geolocator"><strong class="markup--strong markup--mixtapeEmbed-strong">geolocator | Flutter Package</strong><br><em class="markup--em markup--mixtapeEmbed-em">Geolocation plugin for Flutter. This plugin provides a cross-platform (iOS, Android) API for generic location (GPSâ€¦</em>pub.dev</a><a href="https://pub.dev/packages/geolocator" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="9fc9925c9e50e52fb74b71bb9486ff94" data-thumbnail-img-id="0*WGxjwAAcUsEG6_Tf" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*WGxjwAAcUsEG6_Tf);"></a></div><p name="039c" id="039c" class="graf graf--p graf-after--mixtapeEmbed">è¦åœ¨ Xcode çš„ info è¨­å®šæ¬Šé™æ–‡å­—ã€‚</p><figure name="de34" id="de34" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*NO4exRnyn0LrYorg5UTsPA.png" data-width="853" data-height="466" src="https://cdn-images-1.medium.com/max/800/1*NO4exRnyn0LrYorg5UTsPA.png"></figure><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="bb94" id="bb94" class="graf graf--pre graf-after--figure graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:geolocator/geolocator.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadingScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  <span class="hljs-meta">@override</span><br />  _LoadingScreenState createState() =&gt; _LoadingScreenState();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LoadingScreen</span>&gt; </span>{<br />  <span class="hljs-meta">@override</span><br />  Widget build(BuildContext context) {<br />    <span class="hljs-keyword">return</span> Scaffold(<br />      body: Center(<br />        child: ElevatedButton(<br />          onPressed: () {<br />            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;getLocation&quot;</span>);<br />            getLocation();<br />          },<br />          child: Text(<span class="hljs-string">&#x27;Get Location&#x27;</span>),<br />        ),<br />      ),<br />    );<br />  }<br /><br />  <span class="hljs-keyword">void</span> getLocation() <span class="hljs-keyword">async</span> {<br />    LocationPermission permission = <span class="hljs-keyword">await</span> Geolocator.requestPermission();<br />    Position position = <span class="hljs-keyword">await</span> Geolocator.getCurrentPosition(<br />        desiredAccuracy: LocationAccuracy.low);<br />    <span class="hljs-built_in">print</span>(position);<br />  }<br />  <br />}</span></pre><h3 name="fae2" id="fae2" class="graf graf--h3 graf-after--pre">asyncã€awaitã€Future</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="1a3a" id="1a3a" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">void</span> performTasks() <span class="hljs-keyword">async</span> {<br />  task1();<br />  <span class="hljs-built_in">String</span> task2Result = <span class="hljs-keyword">await</span> task2();<br />  task3(task2Result);<br />}<br /><br /><span class="hljs-keyword">void</span> task1() {<br />  <span class="hljs-built_in">String</span> result = <span class="hljs-string">&#x27;task 1 data&#x27;</span>;<br />  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Task 1 complete&#x27;</span>);<br />}<br /><br />Future&lt;<span class="hljs-built_in">String</span>&gt; task2() <span class="hljs-keyword">async</span> {<br />  <span class="hljs-built_in">Duration</span> threeSeconds = <span class="hljs-built_in">Duration</span>(seconds: <span class="hljs-number">3</span>);<br />  <span class="hljs-built_in">String</span> result;<br /><br />  <span class="hljs-keyword">await</span> Future.delayed(threeSeconds, () {<br />    result = <span class="hljs-string">&#x27;task 2 data&#x27;</span>;<br />    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Task 2 complete&#x27;</span>);<br />  });<br /><br />  <span class="hljs-keyword">return</span> result;<br />}<br /><br /><span class="hljs-keyword">void</span> task3(<span class="hljs-built_in">String</span> task2Data) {<br />  <span class="hljs-built_in">String</span> result = <span class="hljs-string">&#x27;task 3 data&#x27;</span>;<br />  <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;Task 3 complete with <span class="hljs-subst">$task2Data</span>&#x27;</span>);<br />}</span></pre><h3 name="af77" id="af77" class="graf graf--h3 graf-after--pre">Stateful Widget Lifecycle Methods</h3><p name="d3bc" id="d3bc" class="graf graf--p graf-after--h3">Stateful widget å»ºç«‹æ™‚ï¼Œå‘¼å« initStateã€‚Stateful widget æ­»æ‰æ™‚ï¼Œå‘¼å« deactivateã€‚</p><figure name="2cea" id="2cea" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*oWi8n8jdeSiyRMOJqXYqqQ.png" data-width="1133" data-height="685" src="https://cdn-images-1.medium.com/max/800/1*oWi8n8jdeSiyRMOJqXYqqQ.png"></figure><h3 name="0c74" id="0c74" class="graf graf--h3 graf-after--figure">ç•«é¢å‡ºç¾æ™‚æŠ“ä½ç½®</h3><p name="3d7f" id="3d7f" class="graf graf--p graf-after--h3">åœ¨ initState è£¡å‘¼å« getLocationã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="7af3" id="7af3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">State</span>&lt;<span class="hljs-title class_">LoadingScreen</span>&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">initState</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">initState</span>();<br />    <span class="hljs-title function_">getLocation</span>();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-title class_">Widget</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">BuildContext context</span>) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Scaffold</span>();<br />  }<br /><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">getLocation</span>() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-title class_">LocationPermission</span> permission = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Geolocator</span>.<span class="hljs-title function_">requestPermission</span>();<br />    <span class="hljs-title class_">Position</span> position = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Geolocator</span>.<span class="hljs-title function_">getCurrentPosition</span>(<br />        <span class="hljs-attr">desiredAccuracy</span>: <span class="hljs-title class_">LocationAccuracy</span>.<span class="hljs-property">low</span>);<br />    <span class="hljs-title function_">print</span>(position);<br />  }<br />}</span></pre><h3 name="c0a9" id="c0a9" class="graf graf--h3 graf-after--pre">exceptionã€try catch</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="6741" id="6741" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content">main() {<br />  <span class="hljs-built_in">String</span> myString = <span class="hljs-string">&#x27;abc&#x27;</span>;<br /><br />  <span class="hljs-keyword">try</span> {<br />    <span class="hljs-built_in">double</span> myStringAsADouble = <span class="hljs-built_in">double</span>.parse(myString);<br />    <span class="hljs-built_in">print</span>(myStringAsADouble + <span class="hljs-number">5</span>);<br />  } <span class="hljs-keyword">catch</span> (e) {<br />    <span class="hljs-built_in">print</span>(e);<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="csharp" name="b9b5" id="b9b5" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content">  <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">getLocation</span>() <span class="hljs-keyword">async</span></span> {<br />    LocationPermission permission = <span class="hljs-keyword">await</span> Geolocator.requestPermission();<br />    <span class="hljs-keyword">try</span> {<br />      Position position = <span class="hljs-keyword">await</span> Geolocator.getCurrentPosition(<br />          desiredAccuracy: LocationAccuracy.low);<br />      print(position);<br />    } <span class="hljs-keyword">catch</span> (e) {<br />      print(e);<br />    }<br />  }</span></pre><h3 name="5e71" id="5e71" class="graf graf--h3 graf-after--pre">å¦å¤–å®šç¾© get location çš„Â class</h3><p name="f3a3" id="f3a3" class="graf graf--p graf-after--h3">getCurrentLocation çš„å›å‚³å‹åˆ¥å®£å‘Šç‚º Future&lt;void&gt;ï¼Œä¹‹å¾Œå‘¼å«æ™‚æ‰å¯ä»¥ awaitã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="a88b" id="a88b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:geolocator/geolocator.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Location</span> </span>{<br />  <span class="hljs-keyword">late</span> <span class="hljs-built_in">double</span> latitude;<br />  <span class="hljs-keyword">late</span> <span class="hljs-built_in">double</span> longitude;<br /><br />  Future&lt;<span class="hljs-keyword">void</span>&gt; getCurrentLocation() <span class="hljs-keyword">async</span> {<br />    LocationPermission permission = <span class="hljs-keyword">await</span> Geolocator.requestPermission();<br />    <span class="hljs-keyword">try</span> {<br />      Position position = <span class="hljs-keyword">await</span> Geolocator.getCurrentPosition(<br />          desiredAccuracy: LocationAccuracy.low);<br />      latitude = position.latitude;<br />      longitude = position.longitude;<br />    } <span class="hljs-keyword">catch</span> (e) {<br />      <span class="hljs-built_in">print</span>(e);<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="8002" id="8002" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">State</span>&lt;<span class="hljs-title class_">LoadingScreen</span>&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">initState</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">initState</span>();<br />    <span class="hljs-title function_">getLocation</span>();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-title class_">Widget</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">BuildContext context</span>) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Scaffold</span>();<br />  }<br /><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">getLocation</span>() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-title class_">Location</span> location = <span class="hljs-title class_">Location</span>();<br />    <span class="hljs-keyword">await</span> location.<span class="hljs-title function_">getCurrentLocation</span>();<br />    <span class="hljs-title function_">print</span>(location.<span class="hljs-property">latitude</span>);<br />    <span class="hljs-title function_">print</span>(location.<span class="hljs-property">longitude</span>);<br />  }<br />}</span></pre><h3 name="fc8f" id="fc8f" class="graf graf--h3 graf-after--pre">å¤©æ°£ APIÂ </h3><div name="d7f1" id="d7f1" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://openweathermap.org/" data-href="https://openweathermap.org/" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://openweathermap.org/"><strong class="markup--strong markup--mixtapeEmbed-strong">Ğ¡urrent weather and forecast - OpenWeatherMap</strong><br><em class="markup--em markup--mixtapeEmbed-em">Get current weather, hourly forecast, daily forecast for 16 days, and 3-hourly forecast 5 days for your cityâ€¦</em>openweathermap.org</a><a href="https://openweathermap.org/" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4cb9d0eb060657c639c7804694d400d7" data-thumbnail-img-id="0*GD8b8mYnZEw3_cL3" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*GD8b8mYnZEw3_cL3);"></a></div><h3 name="1cb8" id="1cb8" class="graf graf--h3 graf-after--mixtapeEmbed">http packageï¼Œä¸²æ¥ APIÂ æŠ“è³‡æ–™</h3><div name="6563" id="6563" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://pub.dev/packages/http" data-href="https://pub.dev/packages/http" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://pub.dev/packages/http"><strong class="markup--strong markup--mixtapeEmbed-strong">http | Dart Package</strong><br><em class="markup--em markup--mixtapeEmbed-em">A composable, multi-platform, Future-based API for HTTP requests.</em>pub.dev</a><a href="https://pub.dev/packages/http" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="305f18bc3c977ebbafc14470e084e5b8" data-thumbnail-img-id="0*K_QFWpDPTNG-fOiN" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*K_QFWpDPTNG-fOiN);"></a></div><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="b838" id="b838" class="graf graf--pre graf-after--mixtapeEmbed graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../services/location.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoadingScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  <span class="hljs-meta">@override</span><br />  _LoadingScreenState createState() =&gt; _LoadingScreenState();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LoadingScreen</span>&gt; </span>{<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-keyword">void</span> initState() {<br />    <span class="hljs-keyword">super</span>.initState();<br />    getLocation();<br />    getData();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  Widget build(BuildContext context) {<br />    <span class="hljs-keyword">return</span> Scaffold();<br />  }<br /><br />  <span class="hljs-keyword">void</span> getData() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> url = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&#x27;api.openweathermap.org&#x27;</span>, <span class="hljs-string">&#x27;data/2.5/weather&#x27;</span>, {<br />      <span class="hljs-string">&#x27;lat&#x27;</span>: <span class="hljs-string">&#x27;44.34&#x27;</span>,<br />      <span class="hljs-string">&#x27;lon&#x27;</span>: <span class="hljs-string">&#x27;10.99&#x27;</span>,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: <span class="hljs-string">&#x27;b76971bc655afc6aeb0c6cd99327779c&#x27;</span>,<br />    });<br />    http.Response response = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(url);<br />    <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) {<br />      <span class="hljs-built_in">String</span> data = response.body;<br />      <span class="hljs-built_in">print</span>(data);<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">print</span>(response.statusCode);<br />    }<br />  }<br /><br />  <span class="hljs-keyword">void</span> getLocation() <span class="hljs-keyword">async</span> {<br />    Location location = Location();<br />    <span class="hljs-keyword">await</span> location.getCurrentLocation();<br />    <span class="hljs-built_in">print</span>(location.latitude);<br />    <span class="hljs-built_in">print</span>(location.longitude);<br />  }<br />}</span></pre><p name="9177" id="9177" class="graf graf--p graf-after--pre">import â€˜package:http/http.dartâ€™ as http;</p><p name="933a" id="933a" class="graf graf--p graf-after--p">å¹« package å–åï¼Œä¹‹å¾Œç”¨ http.get å‘¼å« getã€‚</p><p name="1b8e" id="1b8e" class="graf graf--p graf-after--p">API key ç”³è«‹å¾Œè¦éå¹¾å€‹å°æ™‚æ‰èƒ½ä½¿ç”¨ã€‚</p><h3 name="3f54" id="3f54" class="graf graf--h3 graf-after--p">JSON ViewerÂ Pro</h3><p name="c71c" id="c71c" class="graf graf--p graf-after--h3">chrome çš„ JSON extensionã€‚</p><div name="0818" id="0818" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://chrome.google.com/webstore/detail/json-viewer-pro/eifflpmocdbdmepbjaopkkhbfmdgijcc/related" data-href="https://chrome.google.com/webstore/detail/json-viewer-pro/eifflpmocdbdmepbjaopkkhbfmdgijcc/related" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://chrome.google.com/webstore/detail/json-viewer-pro/eifflpmocdbdmepbjaopkkhbfmdgijcc/related"><strong class="markup--strong markup--mixtapeEmbed-strong">JSON Viewer Pro</strong><br><em class="markup--em markup--mixtapeEmbed-em">A completely free extension to visualise JSON response in awesome Tree and Chart view with great user experience andâ€¦</em>chrome.google.com</a><a href="https://chrome.google.com/webstore/detail/json-viewer-pro/eifflpmocdbdmepbjaopkkhbfmdgijcc/related" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f9a23355f53819e93d9b8c4050ddfce4" data-thumbnail-img-id="0*u0WE9FFE3V8FPJRF" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*u0WE9FFE3V8FPJRF);"></a></div><p name="bb6c" id="bb6c" class="graf graf--p graf-after--mixtapeEmbed">ç‰¹åˆ¥åŠŸèƒ½: copy pathã€‚</p><pre data-code-block-mode="0" spellcheck="false" name="bad3" id="bad3" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">culture.cuisine.famousDishes</span></pre><figure name="c760" id="c760" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*iaGqn3gBUPG24X64VQknmg.png" data-width="760" data-height="866" src="https://cdn-images-1.medium.com/max/800/1*iaGqn3gBUPG24X64VQknmg.png"></figure><h3 name="e2e7" id="e2e7" class="graf graf--h3 graf-after--figure">è§£æ JSON</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="go" name="e4e7" id="e4e7" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:convert&#x27;</span>;</span></pre><p name="5eb1" id="5eb1" class="graf graf--p graf-after--pre">å‘¼å« jsonDecode è§£æ JSONã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="9fb9" id="9fb9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">void</span> getData() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> url = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&#x27;api.openweathermap.org&#x27;</span>, <span class="hljs-string">&#x27;data/2.5/weather&#x27;</span>, {<br />      <span class="hljs-string">&#x27;lat&#x27;</span>: <span class="hljs-string">&#x27;44.34&#x27;</span>,<br />      <span class="hljs-string">&#x27;lon&#x27;</span>: <span class="hljs-string">&#x27;10.99&#x27;</span>,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: <span class="hljs-string">&#x27;b76971bc655afc6aeb0c6cd99327779c&#x27;</span>,<br />    });<br />    http.Response response = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(url);<br />    <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) {<br />      <span class="hljs-built_in">String</span> data = response.body;<br />      <span class="hljs-keyword">var</span> decodedData = jsonDecode(data);<br />      <span class="hljs-built_in">double</span> temperature = decodedData[<span class="hljs-string">&#x27;main&#x27;</span>][<span class="hljs-string">&#x27;temp&#x27;</span>];<br />      <span class="hljs-built_in">int</span> condition = decodedData[<span class="hljs-string">&#x27;weather&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>];<br />      <span class="hljs-built_in">String</span> cityName = decodedData[<span class="hljs-string">&#x27;name&#x27;</span>];<br />      <span class="hljs-built_in">print</span>(temperature);<br />      <span class="hljs-built_in">print</span>(condition);<br />      <span class="hljs-built_in">print</span>(cityName);<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">print</span>(response.statusCode);<br />    }<br />  }</span></pre><h3 name="a116" id="a116" class="graf graf--h3 graf-after--pre">å°‡ç¶²è·¯ç¨‹å¼å¯«åœ¨ NetworkHelper</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="a243" id="a243" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:convert&#x27;</span>;<br /><br /><span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">&#x27;b76971bc655afc6aeb0c6cd99327779c&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">NetworkHelper</span> </span>{<br />  NetworkHelper({<span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.latitude, <span class="hljs-keyword">required</span> <span class="hljs-keyword">this</span>.longitude});<br />  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> latitude;<br />  <span class="hljs-keyword">final</span> <span class="hljs-built_in">double</span> longitude;<br /><br />  Future getData() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> url = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&#x27;api.openweathermap.org&#x27;</span>, <span class="hljs-string">&#x27;data/2.5/weather&#x27;</span>, {<br />      <span class="hljs-string">&#x27;lat&#x27;</span>: <span class="hljs-string">&#x27;<span class="hljs-subst">$latitude</span>&#x27;</span>,<br />      <span class="hljs-string">&#x27;lon&#x27;</span>: <span class="hljs-string">&#x27;<span class="hljs-subst">$longitude</span>&#x27;</span>,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: apiKey,<br />    });<br />    http.Response response = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(url);<br />    <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) {<br />      <span class="hljs-built_in">String</span> data = response.body;<br />      <span class="hljs-keyword">return</span> jsonDecode(data);<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">print</span>(response.statusCode);<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="e032" id="e032" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../services/location.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../services/networking.dart&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoadingScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">StatefulWidget</span> {<br />  <span class="hljs-meta">@override</span><br />  _LoadingScreenState <span class="hljs-title function_">createState</span><span class="hljs-params">()</span> =&gt; _LoadingScreenState();<br />}<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&lt;LoadingScreen&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">initState</span><span class="hljs-params">()</span> {<br />    <span class="hljs-built_in">super</span>.initState();<br />    getLocationData();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  Widget <span class="hljs-title function_">build</span><span class="hljs-params">(BuildContext context)</span> {<br />    <span class="hljs-keyword">return</span> Scaffold();<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">getLocationData</span><span class="hljs-params">()</span> async {<br />    <span class="hljs-type">Location</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> Location();<br />    await location.getCurrentLocation();<br />    <span class="hljs-type">NetworkHelper</span> <span class="hljs-variable">networkHelper</span> <span class="hljs-operator">=</span> NetworkHelper(<br />        latitude: location.latitude, longitude: location.longitude);<br />    <span class="hljs-type">var</span> <span class="hljs-variable">weatherData</span> <span class="hljs-operator">=</span> await networkHelper.getData();<br />  }<br />}</span></pre><h3 name="ee03" id="ee03" class="graf graf--h3 graf-after--pre">loading indicator</h3><div name="a4f2" id="a4f2" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://pub.dev/packages/flutter_spinkit" data-href="https://pub.dev/packages/flutter_spinkit" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://pub.dev/packages/flutter_spinkit"><strong class="markup--strong markup--mixtapeEmbed-strong">flutter_spinkit | Flutter Package</strong><br><em class="markup--em markup--mixtapeEmbed-em">A collection of loading indicators animated with flutter. Heavily inspired by @tobiasahlin&#39;s SpinKit.</em>pub.dev</a><a href="https://pub.dev/packages/flutter_spinkit" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a2d68470bfdacfed12c314b5d167b96d" data-thumbnail-img-id="0*xh7iy_oA43OpssWC" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*xh7iy_oA43OpssWC);"></a></div><p name="9620" id="9620" class="graf graf--p graf-after--mixtapeEmbed">ä½¿ç”¨ SpinKitDoubleBounceã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="e257" id="e257" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:clima_flutter2/screens/location_screen.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../services/location.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;../services/networking.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter_spinkit/flutter_spinkit.dart&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoadingScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">StatefulWidget</span> {<br />  <span class="hljs-meta">@override</span><br />  _LoadingScreenState <span class="hljs-title function_">createState</span><span class="hljs-params">()</span> =&gt; _LoadingScreenState();<br />}<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&lt;LoadingScreen&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">initState</span><span class="hljs-params">()</span> {<br />    <span class="hljs-built_in">super</span>.initState();<br />    getLocationData();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  Widget <span class="hljs-title function_">build</span><span class="hljs-params">(BuildContext context)</span> {<br />    <span class="hljs-keyword">return</span> Scaffold(<br />      body: Center(<br />        child: SpinKitDoubleBounce(<br />          color: Colors.white,<br />          size: <span class="hljs-number">100</span>,<br />        ),<br />      ),<br />    );<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">getLocationData</span><span class="hljs-params">()</span> async {<br />    <span class="hljs-type">Location</span> <span class="hljs-variable">location</span> <span class="hljs-operator">=</span> Location();<br />    await location.getCurrentLocation();<br />    <span class="hljs-type">NetworkHelper</span> <span class="hljs-variable">networkHelper</span> <span class="hljs-operator">=</span> NetworkHelper(<br />        latitude: location.latitude, longitude: location.longitude);<br />    <span class="hljs-type">var</span> <span class="hljs-variable">weatherData</span> <span class="hljs-operator">=</span> await networkHelper.getData();<br />    Navigator.push(context, MaterialPageRoute(builder: (context) {<br />      <span class="hljs-keyword">return</span> LocationScreen();<br />    }));<br />  }<br />}</span></pre><h3 name="4472" id="4472" class="graf graf--h3 graf-after--pre">Passing Data to a StateÂ Object</h3><p name="d528" id="d528" class="graf graf--p graf-after--h3">æŠ“å–æ”æ°çš„æº«åº¦ï¼ŒåŠ ä¸Šåƒæ•¸<code class="markup--code markup--p-code"> &#39;units&#39;: &#39;metric&#39;Â </code></p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="2bce" id="2bce" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"> Future getData() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> url = <span class="hljs-built_in">Uri</span>.https(<span class="hljs-string">&#x27;api.openweathermap.org&#x27;</span>, <span class="hljs-string">&#x27;data/2.5/weather&#x27;</span>, {<br />      <span class="hljs-string">&#x27;lat&#x27;</span>: <span class="hljs-string">&#x27;<span class="hljs-subst">$latitude</span>&#x27;</span>,<br />      <span class="hljs-string">&#x27;lon&#x27;</span>: <span class="hljs-string">&#x27;<span class="hljs-subst">$longitude</span>&#x27;</span>,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: apiKey,<br />      <span class="hljs-string">&#x27;units&#x27;</span>: <span class="hljs-string">&#x27;metric&#x27;</span>,<br />    });<br />    http.Response response = <span class="hljs-keyword">await</span> http.<span class="hljs-keyword">get</span>(url);<br />    <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) {<br />      <span class="hljs-built_in">String</span> data = response.body;<br />      <span class="hljs-keyword">return</span> jsonDecode(data);<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-built_in">print</span>(response.statusCode);<br />    }<br />  }</span></pre><p name="f79f" id="f79f" class="graf graf--p graf-after--pre">State object å¯ä»¥å¾ property widget è®€å–å°æ‡‰çš„ StatefulWidgetã€‚LocationScreen åŠ å…¥ property weatherData å­˜å‰ä¸€é å‚³å…¥çš„è³‡æ–™ï¼Œ_LocationScreenState å¾ widget.weatherData è®€å–è³‡æ–™ã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="c838" id="c838" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;../utilities/constants.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LocationScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  <span class="hljs-keyword">final</span> weatherData;<br /><br />  <span class="hljs-title function_ invoke__">LocationScreen</span>({required this.weatherData});<br /><br />  @override<br />  _LocationScreenState <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_LocationScreenState</span>();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LocationScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LocationScreen</span>&gt; </span>{<br />  <span class="hljs-keyword">int</span>? temperature;<br />  <span class="hljs-keyword">int</span>? condition;<br />  String? cityName;<br /><br />  @override<br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">initState</span>() {<br />    super.<span class="hljs-title function_ invoke__">initState</span>();<br /><br />    <span class="hljs-title function_ invoke__">updateUI</span>(widget.weatherData);<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">updateUI</span>(weatherData) {<br />    <span class="hljs-keyword">double</span> temp = weatherData[<span class="hljs-string">&#x27;main&#x27;</span>][<span class="hljs-string">&#x27;temp&#x27;</span>];<br />    temperature = temp.<span class="hljs-title function_ invoke__">toInt</span>();<br />    condition = weatherData[<span class="hljs-string">&#x27;weather&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>];<br />    cityName = weatherData[<span class="hljs-string">&#x27;name&#x27;</span>];<br />  }<br /><br />  @override<br />  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">Container</span>(<br />        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(<br />          <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">DecorationImage</span>(<br />            <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">AssetImage</span>(<span class="hljs-string">&#x27;images/location_background.jpg&#x27;</span>),<br />            <span class="hljs-attr">fit</span>: BoxFit.cover,<br />            <span class="hljs-attr">colorFilter</span>: ColorFilter.<span class="hljs-title function_ invoke__">mode</span>(<br />                Colors.white.<span class="hljs-title function_ invoke__">withOpacity</span>(<span class="hljs-number">0.8</span>), BlendMode.dstATop),<br />          ),<br />        ),<br />        <span class="hljs-attr">constraints</span>: BoxConstraints.<span class="hljs-title function_ invoke__">expand</span>(),<br />        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">SafeArea</span>(<br />          <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Column</span>(<br />            <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />            <span class="hljs-attr">crossAxisAlignment</span>: CrossAxisAlignment.stretch,<br />            <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />              <span class="hljs-title function_ invoke__">Row</span>(<br />                <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />                <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () {},<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.near_me,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () {},<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.location_city,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                ],<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">left</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Row</span>(<br />                  <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      <span class="hljs-string">&#x27;$temperatureÂ°&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kTempTextStyle,<br />                    ),<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      <span class="hljs-string">&#x27;â˜€ï¸&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kConditionTextStyle,<br />                    ),<br />                  ],<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">right</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Text</span>(<br />                  <span class="hljs-string">&quot;It&#x27;s ğŸ¦ time in San Francisco!&quot;</span>,<br />                  <span class="hljs-attr">textAlign</span>: TextAlign.right,<br />                  <span class="hljs-attr">style</span>: kMessageTextStyle,<br />                ),<br />              ),<br />            ],<br />          ),<br />        ),<br />      ),<br />    );<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="typescript" name="dc23" id="dc23" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">State</span>&lt;<span class="hljs-title class_">LoadingScreen</span>&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">initState</span>(<span class="hljs-params"></span>) {<br />    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">initState</span>();<br />    <span class="hljs-title function_">getLocationData</span>();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-title class_">Widget</span> <span class="hljs-title function_">build</span>(<span class="hljs-params">BuildContext context</span>) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title class_">Center</span>(<br />        <span class="hljs-attr">child</span>: <span class="hljs-title class_">SpinKitDoubleBounce</span>(<br />          <span class="hljs-attr">color</span>: <span class="hljs-title class_">Colors</span>.<span class="hljs-property">white</span>,<br />          <span class="hljs-attr">size</span>: <span class="hljs-number">100</span>,<br />        ),<br />      ),<br />    );<br />  }<br /><br />  <span class="hljs-built_in">void</span> <span class="hljs-title function_">getLocationData</span>() <span class="hljs-keyword">async</span> {<br />    <span class="hljs-title class_">Location</span> location = <span class="hljs-title class_">Location</span>();<br />    <span class="hljs-keyword">await</span> location.<span class="hljs-title function_">getCurrentLocation</span>();<br />    <span class="hljs-title class_">NetworkHelper</span> networkHelper = <span class="hljs-title class_">NetworkHelper</span>(<br />        <span class="hljs-attr">latitude</span>: location.<span class="hljs-property">latitude</span>, <span class="hljs-attr">longitude</span>: location.<span class="hljs-property">longitude</span>);<br />    <span class="hljs-keyword">var</span> weatherData = <span class="hljs-keyword">await</span> networkHelper.<span class="hljs-title function_">getData</span>();<br />    <span class="hljs-title class_">Navigator</span>.<span class="hljs-title function_">push</span>(context, <span class="hljs-title class_">MaterialPageRoute</span>(<span class="hljs-attr">builder</span>: (context) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-title class_">LocationScreen</span>(<span class="hljs-attr">weatherData</span>: weatherData);<br />    }));<br />  }<br />}</span></pre><h3 name="3659" id="3659" class="graf graf--h3 graf-after--pre">Updating the Weather with the WeatherModel</h3><p name="56d2" id="56d2" class="graf graf--p graf-after--h3">å¾ WeatherModel å–å¾—ç•«é¢é¡¯ç¤ºçš„ icon &amp; messageã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="kotlin" name="978c" id="978c" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherModel</span> {<br />  String getWeatherIcon(int condition) {<br />    <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">300</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ©&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">400</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ§&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">600</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜”ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">700</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜ƒï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">800</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ«&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition == <span class="hljs-number">800</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜€ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt;= <span class="hljs-number">804</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸ¤·â€&#x27;</span>;<br />    }<br />  }<br /><br />  String getMessage(int temp) {<br />    <span class="hljs-keyword">if</span> (temp &gt; <span class="hljs-number">25</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;It\&#x27;s ğŸ¦ time&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (temp &gt; <span class="hljs-number">20</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Time for shorts and ğŸ‘•&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (temp &lt; <span class="hljs-number">10</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You\&#x27;ll need ğŸ§£ and ğŸ§¤&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Bring a ğŸ§¥ just in case&#x27;</span>;<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="5c69" id="5c69" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:clima_flutter2/services/weather.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;../utilities/constants.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LocationScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  <span class="hljs-keyword">final</span> weatherData;<br /><br />  <span class="hljs-title function_ invoke__">LocationScreen</span>({required this.weatherData});<br /><br />  @override<br />  _LocationScreenState <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_LocationScreenState</span>();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LocationScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LocationScreen</span>&gt; </span>{<br />  <span class="hljs-keyword">int</span>? temperature;<br />  String? weatherIcon;<br />  String? cityName;<br />  String? weatherMessage;<br />  WeatherModel weather = <span class="hljs-title function_ invoke__">WeatherModel</span>();<br /><br />  @override<br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">initState</span>() {<br />    super.<span class="hljs-title function_ invoke__">initState</span>();<br /><br />    <span class="hljs-title function_ invoke__">updateUI</span>(widget.weatherData);<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">updateUI</span>(weatherData) {<br />    <span class="hljs-keyword">double</span> temp = weatherData[<span class="hljs-string">&#x27;main&#x27;</span>][<span class="hljs-string">&#x27;temp&#x27;</span>];<br />    temperature = temp.<span class="hljs-title function_ invoke__">toInt</span>();<br />    <span class="hljs-keyword">var</span> condition = weatherData[<span class="hljs-string">&#x27;weather&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>];<br />    weatherIcon = weather.<span class="hljs-title function_ invoke__">getWeatherIcon</span>(condition);<br />    cityName = weatherData[<span class="hljs-string">&#x27;name&#x27;</span>];<br />    weatherMessage = weather.<span class="hljs-title function_ invoke__">getMessage</span>(temperature!);<br />  }<br /><br />  @override<br />  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">Container</span>(<br />        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(<br />          <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">DecorationImage</span>(<br />            <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">AssetImage</span>(<span class="hljs-string">&#x27;images/location_background.jpg&#x27;</span>),<br />            <span class="hljs-attr">fit</span>: BoxFit.cover,<br />            <span class="hljs-attr">colorFilter</span>: ColorFilter.<span class="hljs-title function_ invoke__">mode</span>(<br />                Colors.white.<span class="hljs-title function_ invoke__">withOpacity</span>(<span class="hljs-number">0.8</span>), BlendMode.dstATop),<br />          ),<br />        ),<br />        <span class="hljs-attr">constraints</span>: BoxConstraints.<span class="hljs-title function_ invoke__">expand</span>(),<br />        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">SafeArea</span>(<br />          <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Column</span>(<br />            <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />            <span class="hljs-attr">crossAxisAlignment</span>: CrossAxisAlignment.stretch,<br />            <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />              <span class="hljs-title function_ invoke__">Row</span>(<br />                <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />                <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () {},<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.near_me,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () {},<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.location_city,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                ],<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">left</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Row</span>(<br />                  <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      <span class="hljs-string">&#x27;$temperatureÂ°&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kTempTextStyle,<br />                    ),<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      weatherIcon ?? <span class="hljs-string">&#x27;&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kConditionTextStyle,<br />                    ),<br />                  ],<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">right</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Text</span>(<br />                  <span class="hljs-string">&#x27;$weatherMessage in $cityName&#x27;</span>,<br />                  <span class="hljs-attr">textAlign</span>: TextAlign.right,<br />                  <span class="hljs-attr">style</span>: kMessageTextStyle,<br />                ),<br />              ),<br />            ],<br />          ),<br />        ),<br />      ),<br />    );<br />  }<br />}</span></pre><figure name="af54" id="af54" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*54oVnVJSCw6rqQ4limeR1g.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*54oVnVJSCw6rqQ4limeR1g.png"></figure><h3 name="0f8f" id="0f8f" class="graf graf--h3 graf-after--figure">Refactoring</h3><p name="82d0" id="82d0" class="graf graf--p graf-after--h3">TextButton çš„ onPressed è¦åŠ  asyncï¼Œæ‰èƒ½åœ¨è£¡é¢ä½¿ç”¨ awaitã€‚</p><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="csharp" name="abab" id="abab" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content">TextButton(<br />  onPressed: () <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> weatherData = <span class="hljs-keyword">await</span> weather.getLocationWeather();<br />    updateUI(weatherData);<br />  },<br />  child: Icon(<br />    Icons.near_me,<br />    size: <span class="hljs-number">50.0</span>,<br />  ),<br />),</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="csharp" name="b935" id="b935" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:geolocator/geolocator.dart&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title">Location</span> {<br />  <span class="hljs-built_in">double</span>? latitude;<br />  <span class="hljs-built_in">double</span>? longitude;<br /><br />  <span class="hljs-function">Future&lt;<span class="hljs-keyword">void</span>&gt; <span class="hljs-title">getCurrentLocation</span>() <span class="hljs-keyword">async</span></span> {<br />    LocationPermission permission = <span class="hljs-keyword">await</span> Geolocator.requestPermission();<br />    <span class="hljs-keyword">try</span> {<br />      Position position = <span class="hljs-keyword">await</span> Geolocator.getCurrentPosition(<br />          desiredAccuracy: LocationAccuracy.low);<br />      latitude = position.latitude;<br />      longitude = position.longitude;<br />    } <span class="hljs-keyword">catch</span> (e) {<br />      print(e);<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="kotlin" name="b3a6" id="b3a6" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:http/http.dart&#x27;</span> <span class="hljs-keyword">as</span> http;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;dart:convert&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">NetworkHelper</span> {<br />  NetworkHelper(<span class="hljs-keyword">this</span>.url);<br />  <span class="hljs-keyword">final</span> Uri url;<br /><br />  Future getData() async {<br />    http.Response response = await http.<span class="hljs-keyword">get</span>(url);<br />    <span class="hljs-keyword">if</span> (response.statusCode == <span class="hljs-number">200</span>) {<br />      String <span class="hljs-keyword">data</span> = response.body;<br />      <span class="hljs-keyword">return</span> jsonDecode(<span class="hljs-keyword">data</span>);<br />    } <span class="hljs-keyword">else</span> {<br />      print(response.statusCode);<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="kotlin" name="473b" id="473b" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;location.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;networking.dart&#x27;</span>;<br /><br /><span class="hljs-keyword">const</span> apiKey = <span class="hljs-string">&#x27;b76971bc655afc6aeb0c6cd99327779c&#x27;</span>;<br /><span class="hljs-keyword">const</span> openWeatherMapHost = <span class="hljs-string">&#x27;api.openweathermap.org&#x27;</span>;<br /><span class="hljs-keyword">const</span> openWeatherMapPath = <span class="hljs-string">&#x27;data/2.5/weather&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">WeatherModel</span> {<br />  Future&lt;<span class="hljs-keyword">dynamic</span>&gt; getLocationWeather() async {<br />    Location location = Location();<br />    await location.getCurrentLocation();<br />    <span class="hljs-keyword">var</span> url = Uri.https(openWeatherMapHost, openWeatherMapPath, {<br />      <span class="hljs-string">&#x27;lat&#x27;</span>: <span class="hljs-string">&#x27;${location.latitude ?? 1000}&#x27;</span>,<br />      <span class="hljs-string">&#x27;lon&#x27;</span>: <span class="hljs-string">&#x27;${location.longitude ?? 1000}&#x27;</span>,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: apiKey,<br />      <span class="hljs-string">&#x27;units&#x27;</span>: <span class="hljs-string">&#x27;metric&#x27;</span>,<br />    });<br />    NetworkHelper networkHelper = NetworkHelper(url);<br />    <span class="hljs-keyword">var</span> weatherData = await networkHelper.getData();<br />    <span class="hljs-keyword">return</span> weatherData;<br />  }<br /><br />  String getWeatherIcon(int condition) {<br />    <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">300</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ©&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">400</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ§&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">600</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜”ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">700</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜ƒï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt; <span class="hljs-number">800</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸŒ«&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition == <span class="hljs-number">800</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜€ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (condition &lt;= <span class="hljs-number">804</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;â˜ï¸&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;ğŸ¤·â€&#x27;</span>;<br />    }<br />  }<br /><br />  String getMessage(int temp) {<br />    <span class="hljs-keyword">if</span> (temp &gt; <span class="hljs-number">25</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;It\&#x27;s ğŸ¦ time&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (temp &gt; <span class="hljs-number">20</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Time for shorts and ğŸ‘•&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (temp &lt; <span class="hljs-number">10</span>) {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;You\&#x27;ll need ğŸ§£ and ğŸ§¤&#x27;</span>;<br />    } <span class="hljs-keyword">else</span> {<br />      <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Bring a ğŸ§¥ just in case&#x27;</span>;<br />    }<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="java" name="520e" id="520e" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:clima_flutter2/screens/location_screen.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:clima_flutter2/services/weather.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br /><span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;package:flutter_spinkit/flutter_spinkit.dart&#x27;</span>;<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">LoadingScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">StatefulWidget</span> {<br />  <span class="hljs-meta">@override</span><br />  _LoadingScreenState <span class="hljs-title function_">createState</span><span class="hljs-params">()</span> =&gt; _LoadingScreenState();<br />}<br /><br /><span class="hljs-keyword">class</span> <span class="hljs-title class_">_LoadingScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">State</span>&lt;LoadingScreen&gt; {<br />  <span class="hljs-meta">@override</span><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">initState</span><span class="hljs-params">()</span> {<br />    <span class="hljs-built_in">super</span>.initState();<br />    getLocationData();<br />  }<br /><br />  <span class="hljs-meta">@override</span><br />  Widget <span class="hljs-title function_">build</span><span class="hljs-params">(BuildContext context)</span> {<br />    <span class="hljs-keyword">return</span> Scaffold(<br />      body: Center(<br />        child: SpinKitDoubleBounce(<br />          color: Colors.white,<br />          size: <span class="hljs-number">100</span>,<br />        ),<br />      ),<br />    );<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_">getLocationData</span><span class="hljs-params">()</span> async {<br />    <span class="hljs-type">var</span> <span class="hljs-variable">weatherData</span> <span class="hljs-operator">=</span> await <span class="hljs-title function_">WeatherModel</span><span class="hljs-params">()</span>.getLocationWeather();<br />    Navigator.push(context, MaterialPageRoute(builder: (context) {<br />      <span class="hljs-keyword">return</span> LocationScreen(weatherData: weatherData);<br />    }));<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="9ad5" id="9ad5" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:clima_flutter2/services/weather.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;../utilities/constants.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LocationScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  <span class="hljs-keyword">final</span> weatherData;<br /><br />  <span class="hljs-title function_ invoke__">LocationScreen</span>({required this.weatherData});<br /><br />  @override<br />  _LocationScreenState <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_LocationScreenState</span>();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_LocationScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">LocationScreen</span>&gt; </span>{<br />  <span class="hljs-keyword">int</span>? temperature;<br />  String? weatherIcon;<br />  String? cityName;<br />  String? weatherMessage;<br />  WeatherModel weather = <span class="hljs-title function_ invoke__">WeatherModel</span>();<br /><br />  @override<br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">initState</span>() {<br />    super.<span class="hljs-title function_ invoke__">initState</span>();<br /><br />    <span class="hljs-title function_ invoke__">updateUI</span>(widget.weatherData);<br />  }<br /><br />  <span class="hljs-keyword">void</span> <span class="hljs-title function_ invoke__">updateUI</span>(weatherData) {<br />    <span class="hljs-title function_ invoke__">setState</span>(() {<br />      <span class="hljs-keyword">if</span> (weatherData == <span class="hljs-literal">null</span>) {<br />        temperature = <span class="hljs-number">0</span>;<br />        weatherIcon = <span class="hljs-string">&#x27;âŒ&#x27;</span>;<br />        weatherMessage = <span class="hljs-string">&#x27;Unable to get weather data&#x27;</span>;<br />        cityName = <span class="hljs-string">&#x27;&#x27;</span>;<br />        <span class="hljs-keyword">return</span>;<br />      } <span class="hljs-keyword">else</span> {<br />        <span class="hljs-keyword">double</span> temp = weatherData[<span class="hljs-string">&#x27;main&#x27;</span>][<span class="hljs-string">&#x27;temp&#x27;</span>];<br />        temperature = temp.<span class="hljs-title function_ invoke__">toInt</span>();<br />        <span class="hljs-keyword">var</span> condition = weatherData[<span class="hljs-string">&#x27;weather&#x27;</span>][<span class="hljs-number">0</span>][<span class="hljs-string">&#x27;id&#x27;</span>];<br />        weatherIcon = weather.<span class="hljs-title function_ invoke__">getWeatherIcon</span>(condition);<br />        cityName = weatherData[<span class="hljs-string">&#x27;name&#x27;</span>];<br />        weatherMessage = weather.<span class="hljs-title function_ invoke__">getMessage</span>(temperature!);<br />      }<br />    });<br />  }<br /><br />  @override<br />  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">Container</span>(<br />        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(<br />          <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">DecorationImage</span>(<br />            <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">AssetImage</span>(<span class="hljs-string">&#x27;images/location_background.jpg&#x27;</span>),<br />            <span class="hljs-attr">fit</span>: BoxFit.cover,<br />            <span class="hljs-attr">colorFilter</span>: ColorFilter.<span class="hljs-title function_ invoke__">mode</span>(<br />                Colors.white.<span class="hljs-title function_ invoke__">withOpacity</span>(<span class="hljs-number">0.8</span>), BlendMode.dstATop),<br />          ),<br />        ),<br />        <span class="hljs-attr">constraints</span>: BoxConstraints.<span class="hljs-title function_ invoke__">expand</span>(),<br />        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">SafeArea</span>(<br />          <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Column</span>(<br />            <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />            <span class="hljs-attr">crossAxisAlignment</span>: CrossAxisAlignment.stretch,<br />            <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />              <span class="hljs-title function_ invoke__">Row</span>(<br />                <span class="hljs-attr">mainAxisAlignment</span>: MainAxisAlignment.spaceBetween,<br />                <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () async {<br />                      <span class="hljs-keyword">var</span> weatherData = await weather.<span class="hljs-title function_ invoke__">getLocationWeather</span>();<br />                      <span class="hljs-title function_ invoke__">updateUI</span>(weatherData);<br />                    },<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.near_me,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                  <span class="hljs-title function_ invoke__">TextButton</span>(<br />                    <span class="hljs-attr">onPressed</span>: () {},<br />                    <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                      Icons.location_city,<br />                      <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                    ),<br />                  ),<br />                ],<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">left</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Row</span>(<br />                  <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      <span class="hljs-string">&#x27;$temperatureÂ°&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kTempTextStyle,<br />                    ),<br />                    <span class="hljs-title function_ invoke__">Text</span>(<br />                      weatherIcon ?? <span class="hljs-string">&#x27;&#x27;</span>,<br />                      <span class="hljs-attr">style</span>: kConditionTextStyle,<br />                    ),<br />                  ],<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">Padding</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">only</span>(<span class="hljs-attr">right</span>: <span class="hljs-number">15.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Text</span>(<br />                  <span class="hljs-string">&#x27;$weatherMessage in $cityName&#x27;</span>,<br />                  <span class="hljs-attr">textAlign</span>: TextAlign.right,<br />                  <span class="hljs-attr">style</span>: kMessageTextStyle,<br />                ),<br />              ),<br />            ],<br />          ),<br />        ),<br />      ),<br />    );<br />  }<br />}</span></pre><h3 name="9831" id="9831" class="graf graf--h3 graf-after--pre">TextField</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="26c1" id="26c1" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content"><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">kTextFieldInputDecoration</span> = <span class="hljs-title function_ invoke__">InputDecoration</span>(<br />  <span class="hljs-attr">filled</span>: <span class="hljs-literal">true</span>,<br />  <span class="hljs-attr">fillColor</span>: Colors.white,<br />  <span class="hljs-attr">icon</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />    Icons.location_city,<br />    <span class="hljs-attr">color</span>: Colors.white,<br />  ),<br />  <span class="hljs-attr">hintText</span>: <span class="hljs-string">&#x27;Enter City Name&#x27;</span>,<br />  <span class="hljs-attr">hintStyle</span>: <span class="hljs-title function_ invoke__">TextStyle</span>(<br />    <span class="hljs-attr">color</span>: Colors.grey,<br />  ),<br />  <span class="hljs-attr">border</span>: <span class="hljs-title function_ invoke__">OutlineInputBorder</span>(<br />    <span class="hljs-attr">borderRadius</span>: BorderRadius.<span class="hljs-title function_ invoke__">all</span>(<br />      Radius.<span class="hljs-title function_ invoke__">circular</span>(<span class="hljs-number">10.0</span>),<br />    ),<br />    <span class="hljs-attr">borderSide</span>: BorderSide.none,<br />  ),<br />);</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="1b18" id="1b18" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;../utilities/constants.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  @override<br />  _CityScreenState <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_CityScreenState</span>();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CityScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">CityScreen</span>&gt; </span>{<br />  @override<br />  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">Container</span>(<br />        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(<br />          <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">DecorationImage</span>(<br />            <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">AssetImage</span>(<span class="hljs-string">&#x27;images/city_background.jpg&#x27;</span>),<br />            <span class="hljs-attr">fit</span>: BoxFit.cover,<br />          ),<br />        ),<br />        <span class="hljs-attr">constraints</span>: BoxConstraints.<span class="hljs-title function_ invoke__">expand</span>(),<br />        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">SafeArea</span>(<br />          <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Column</span>(<br />            <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />              <span class="hljs-title function_ invoke__">Align</span>(<br />                <span class="hljs-attr">alignment</span>: Alignment.topLeft,<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">TextButton</span>(<br />                  <span class="hljs-attr">onPressed</span>: () {},<br />                  <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                    Icons.arrow_back_ios,<br />                    <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                  ),<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">Container</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">all</span>(<span class="hljs-number">20.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">TextField</span>(<br />                  <span class="hljs-attr">style</span>: <span class="hljs-title function_ invoke__">TextStyle</span>(<br />                    <span class="hljs-attr">color</span>: Colors.black,<br />                  ),<br />                  <span class="hljs-attr">decoration</span>: kTextFieldInputDecoration,<br />                  <span class="hljs-attr">onChanged</span>: (value) {<br />                    <span class="hljs-keyword">print</span>(value);<br />                  },<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">TextButton</span>(<br />                <span class="hljs-attr">onPressed</span>: () {},<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Text</span>(<br />                  <span class="hljs-string">&#x27;Get Weather&#x27;</span>,<br />                  <span class="hljs-attr">style</span>: kButtonTextStyle,<br />                ),<br />              ),<br />            ],<br />          ),<br />        ),<br />      ),<br />    );<br />  }<br />}</span></pre><figure name="afe4" id="afe4" class="graf graf--figure graf-after--pre"><img class="graf-image" data-image-id="1*NzcQCHqx5hS6lhSlIvb-lQ.png" data-width="1179" data-height="2556" src="https://cdn-images-1.medium.com/max/800/1*NzcQCHqx5hS6lhSlIvb-lQ.png"></figure><h3 name="a2d5" id="a2d5" class="graf graf--h3 graf-after--figure">å‚³è³‡æ–™å›ä¸Šä¸€é ï¼Œåˆ©ç”¨ push &amp;Â pop</h3><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="php" name="bc71" id="bc71" class="graf graf--pre graf-after--h3 graf--preV2"><span class="pre--content">import <span class="hljs-string">&#x27;package:flutter/material.dart&#x27;</span>;<br />import <span class="hljs-string">&#x27;../utilities/constants.dart&#x27;</span>;<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CityScreen</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">StatefulWidget</span> </span>{<br />  @override<br />  _CityScreenState <span class="hljs-title function_ invoke__">createState</span>() =&gt; <span class="hljs-title function_ invoke__">_CityScreenState</span>();<br />}<br /><br /><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">_CityScreenState</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">State</span>&lt;<span class="hljs-title">CityScreen</span>&gt; </span>{<br />  String? cityName;<br /><br />  @override<br />  Widget <span class="hljs-title function_ invoke__">build</span>(BuildContext context) {<br />    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">Scaffold</span>(<br />      <span class="hljs-attr">body</span>: <span class="hljs-title function_ invoke__">Container</span>(<br />        <span class="hljs-attr">decoration</span>: <span class="hljs-title function_ invoke__">BoxDecoration</span>(<br />          <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">DecorationImage</span>(<br />            <span class="hljs-attr">image</span>: <span class="hljs-title function_ invoke__">AssetImage</span>(<span class="hljs-string">&#x27;images/city_background.jpg&#x27;</span>),<br />            <span class="hljs-attr">fit</span>: BoxFit.cover,<br />          ),<br />        ),<br />        <span class="hljs-attr">constraints</span>: BoxConstraints.<span class="hljs-title function_ invoke__">expand</span>(),<br />        <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">SafeArea</span>(<br />          <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Column</span>(<br />            <span class="hljs-attr">children</span>: &lt;Widget&gt;[<br />              <span class="hljs-title function_ invoke__">Align</span>(<br />                <span class="hljs-attr">alignment</span>: Alignment.topLeft,<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">TextButton</span>(<br />                  <span class="hljs-attr">onPressed</span>: () {<br />                    Navigator.<span class="hljs-title function_ invoke__">pop</span>(context);<br />                  },<br />                  <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Icon</span>(<br />                    Icons.arrow_back_ios,<br />                    <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />                  ),<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">Container</span>(<br />                <span class="hljs-attr">padding</span>: EdgeInsets.<span class="hljs-title function_ invoke__">all</span>(<span class="hljs-number">20.0</span>),<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">TextField</span>(<br />                  <span class="hljs-attr">style</span>: <span class="hljs-title function_ invoke__">TextStyle</span>(<br />                    <span class="hljs-attr">color</span>: Colors.black,<br />                  ),<br />                  <span class="hljs-attr">decoration</span>: kTextFieldInputDecoration,<br />                  <span class="hljs-attr">onChanged</span>: (value) {<br />                    cityName = value;<br />                  },<br />                ),<br />              ),<br />              <span class="hljs-title function_ invoke__">TextButton</span>(<br />                <span class="hljs-attr">onPressed</span>: () {<br />                  Navigator.<span class="hljs-title function_ invoke__">pop</span>(context, cityName);<br />                },<br />                <span class="hljs-attr">child</span>: <span class="hljs-title function_ invoke__">Text</span>(<br />                  <span class="hljs-string">&#x27;Get Weather&#x27;</span>,<br />                  <span class="hljs-attr">style</span>: kButtonTextStyle,<br />                ),<br />              ),<br />            ],<br />          ),<br />        ),<br />      ),<br />    );<br />  }<br />}</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="dart" name="ef46" id="ef46" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">WeatherModel</span> </span>{<br />  Future&lt;<span class="hljs-built_in">dynamic</span>&gt; getCityWeather(<span class="hljs-built_in">String</span> cityName) <span class="hljs-keyword">async</span> {<br />    <span class="hljs-keyword">var</span> url = <span class="hljs-built_in">Uri</span>.https(openWeatherMapHost, openWeatherMapPath, {<br />      <span class="hljs-string">&#x27;q&#x27;</span>: cityName,<br />      <span class="hljs-string">&#x27;appid&#x27;</span>: apiKey,<br />      <span class="hljs-string">&#x27;units&#x27;</span>: <span class="hljs-string">&#x27;metric&#x27;</span>,<br />    });<br />    NetworkHelper networkHelper = NetworkHelper(url);<br />    <span class="hljs-keyword">var</span> weatherData = <span class="hljs-keyword">await</span> networkHelper.getData();<br />    <span class="hljs-keyword">return</span> weatherData;<br />  }</span></pre><pre data-code-block-mode="1" spellcheck="false" data-code-block-lang="javascript" name="182d" id="182d" class="graf graf--pre graf-after--pre graf--preV2"><span class="pre--content"><span class="hljs-title class_">TextButton</span>(<br />  <span class="hljs-attr">onPressed</span>: () <span class="hljs-keyword">async</span> {<br />    <span class="hljs-title class_">String</span> cityName = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Navigator</span>.<span class="hljs-title function_">push</span>(<br />      context,<br />      <span class="hljs-title class_">MaterialPageRoute</span>(<span class="hljs-attr">builder</span>: (context) {<br />        <span class="hljs-keyword">return</span> <span class="hljs-title class_">CityScreen</span>();<br />      }),<br />    );<br />    <span class="hljs-keyword">if</span> (cityName != <span class="hljs-literal">null</span>) {<br />      <span class="hljs-keyword">var</span> weatherData = <span class="hljs-keyword">await</span> weather.<span class="hljs-title function_">getCityWeather</span>(cityName);<br />      <span class="hljs-title function_">updateUI</span>(weatherData);<br />    }<br />  },<br />  <span class="hljs-attr">child</span>: <span class="hljs-title class_">Icon</span>(<br />    <span class="hljs-title class_">Icons</span>.<span class="hljs-property">location_city</span>,<br />    <span class="hljs-attr">size</span>: <span class="hljs-number">50.0</span>,<br />  ),<br />),</span></pre><p name="02c4" id="02c4" class="graf graf--p graf--empty graf-after--pre graf--trailing"><br></p></div></div></section>
</section>
<footer><p><a href="https://medium.com/p/78938c317f44">View original.</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>