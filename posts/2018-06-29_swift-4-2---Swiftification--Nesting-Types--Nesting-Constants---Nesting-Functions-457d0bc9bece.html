<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>swift 4.2 的 Swiftification: Nesting Types, Nesting Constants &amp; Nesting Functions</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">swift 4.2 的 Swiftification: Nesting Types, Nesting Constants &amp; Nesting Functions</h1>
</header>
<section data-field="subtitle" class="p-summary">
在 swift 4.2，許多 iOS SDK 的 type, function 和 constant 都被改寫，變成 nesting type, function 和 constant。
</section>
<section data-field="body" class="e-content">
<section name="bacf" class="section section--body section--first"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="c4c6" id="c4c6" class="graf graf--h3 graf--leading graf--title">swift 4.2 的 Swiftification: Nesting Types, Nesting Constants &amp; Nesting Functions</h3><p name="d26f" id="d26f" class="graf graf--p graf-after--h3">在 swift 4.2，許多 iOS SDK 的 type, function 和 constant 都被改寫，變成 nesting type, function 和 constant。</p><p name="9ef2" id="9ef2" class="graf graf--p graf-after--p">比方從前我們拍照時，需透過超長的常數 UIImagePickerControllerOriginalImage 取得照片。</p><pre name="f33d" id="f33d" class="graf graf--pre graf-after--p">func imagePickerController(_ picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [String : Any]) {</pre><pre name="049f" id="049f" class="graf graf--pre graf-after--pre">   let image = info[UIImagePickerControllerOriginalImage]</pre><pre name="50b6" id="50b6" class="graf graf--pre graf-after--pre">}</pre><p name="962c" id="962c" class="graf graf--p graf-after--pre">但在 Swift 4.2，現在只要打 .originalImage。</p><pre name="d370" id="d370" class="graf graf--pre graf-after--p">func imagePickerController(_ picker: UIImagePickerController, didFinishPickingMediaWithInfo info: [UIImagePickerController.InfoKey : Any]) {</pre><pre name="b9ed" id="b9ed" class="graf graf--pre graf-after--pre">   let image = info[<strong class="markup--strong markup--pre-strong">.originalImage</strong>]</pre><pre name="c834" id="c834" class="graf graf--pre graf-after--pre">}</pre><p name="c59f" id="c59f" class="graf graf--p graf-after--pre">這是因為 originalImage 現在變成 nested constant，型別 UIImagePickerController.InfoKey 下的 static 常數。</p><pre name="0e15" id="0e15" class="graf graf--pre graf-after--p">extension UIImagePickerController.InfoKey {</pre><pre name="d5c8" id="d5c8" class="graf graf--pre graf-after--pre">   public static let originalImage:   <br>        UIImagePickerController.InfoKey </pre><p name="5dbd" id="5dbd" class="graf graf--p graf-after--pre">新版的寫法帶給我們以下幾個好處:</p><ol class="postList"><li name="7c46" id="7c46" class="graf graf--li graf-after--p">意思更清楚。</li><li name="ca69" id="ca69" class="graf graf--li graf-after--li">程式更簡潔，更容易記憶，只要記 originalImage，不用記 UIImagePickerControllerOriginalImage。</li><li name="03ef" id="03ef" class="graf graf--li graf-after--li">更像 Swift 程式該長的樣子。</li><li name="1f9a" id="1f9a" class="graf graf--li graf-after--li">輸入程式時可以打更少的字，更不容易打錯。</li></ol><p name="b52d" id="b52d" class="graf graf--p graf-after--li graf--trailing">接下來就讓我們看看更多實際的例子吧。</p></div></div></section><section name="c342" class="section section--body section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><blockquote name="aaa2" id="aaa2" class="graf graf--blockquote graf--leading"><strong class="markup--strong markup--blockquote-strong">Nesting constant</strong></blockquote><p name="28ca" id="28ca" class="graf graf--p graf-after--blockquote">通知的名字，比方 UIResponder.keyboardDidShowNotification</p><pre name="268d" id="268d" class="graf graf--pre graf-after--p">NotificationCenter.default.addObserver(forName: <strong class="markup--strong markup--pre-strong">UIResponder.keyboardDidShowNotification</strong>, object: nil, queue: OperationQueue.main) { (noti) in</pre><pre name="b579" id="b579" class="graf graf--pre graf-after--pre">}</pre><p name="8c6c" id="8c6c" class="graf graf--p graf-after--pre">舊版是 Notification.Name.UIKeyboardDidShow，新版是 UIResponder.keyboardDidShowNotification，常數 keyboardDidShowNotification 定義在 class UIResponder 下。</p><pre name="4170" id="4170" class="graf graf--pre graf-after--p">extension UIResponder {</pre><pre name="c94c" id="c94c" class="graf graf--pre graf-after--pre">   public class let keyboardDidShowNotification: NSNotification.Name</pre><blockquote name="2408" id="2408" class="graf graf--blockquote graf-after--pre"><strong class="markup--strong markup--blockquote-strong">Nesting type</strong></blockquote><p name="20b2" id="20b2" class="graf graf--p graf-after--blockquote">UIApplication.LaunchOptionsKey</p><pre name="6a0c" id="6a0c" class="graf graf--pre graf-after--p">func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [<strong class="markup--strong markup--pre-strong">UIApplication.LaunchOptionsKey</strong>: Any]?) -&gt; Bool {</pre><pre name="37cf" id="37cf" class="graf graf--pre graf-after--pre">   return true</pre><pre name="adff" id="adff" class="graf graf--pre graf-after--pre">}</pre><p name="391a" id="391a" class="graf graf--p graf-after--pre">舊版是 UIApplicationLaunchOptionsKey，新版是 UIApplication.LaunchOptionsKey，struct LaunchOptionsKey 定義在 class UIApplication 下。</p><pre name="2718" id="2718" class="graf graf--pre graf-after--p">extension UIApplication {</pre><pre name="92e8" id="92e8" class="graf graf--pre graf-after--pre">   public struct LaunchOptionsKey : Hashable, Equatable, RawRepresentable {</pre><pre name="8b5f" id="8b5f" class="graf graf--pre graf-after--pre">      public init(rawValue: String)</pre><pre name="40a6" id="40a6" class="graf graf--pre graf-after--pre">   }</pre><p name="dce2" id="dce2" class="graf graf--p graf-after--pre">元件的狀態，比方 UIControl.State.normal</p><pre name="79f4" id="79f4" class="graf graf--pre graf-after--p">button.setTitle(&quot;跟著IKEA衣櫥去旅行&quot;, for: .normal)</pre><p name="2a4c" id="2a4c" class="graf graf--p graf-after--pre">舊版是 UIControlState.normal，新版是 UIControl.State.normal，struct State 定義在 class UIControl 下。</p><pre name="5b24" id="5b24" class="graf graf--pre graf-after--p">extension UIControl {</pre><pre name="e113" id="e113" class="graf graf--pre graf-after--pre">   public struct State : OptionSet {</pre><pre name="279d" id="279d" class="graf graf--pre graf-after--pre">      public init(rawValue: UInt)</pre><pre name="e275" id="e275" class="graf graf--pre graf-after--pre">      public static var normal: UIControl.State { get }</pre><p name="639b" id="639b" class="graf graf--p graf-after--pre">元件的事件，比方 UIControl.Event.touchUpInside</p><pre name="d58a" id="d58a" class="graf graf--pre graf-after--p">button.addTarget(self, action: #selector(buttonPressed(_:)), for: .touchUpInside)</pre><p name="ef01" id="ef01" class="graf graf--p graf-after--pre">舊版是 UIControlEvents.touchUpInside，新版是 UIControl.Event.touchUpInside，struct Event 定義在 class UIControl 下。</p><pre name="10cf" id="10cf" class="graf graf--pre graf-after--p">extension UIControl {</pre><pre name="ebea" id="ebea" class="graf graf--pre graf-after--pre">   public struct Event : OptionSet {</pre><pre name="d93c" id="d93c" class="graf graf--pre graf-after--pre">      public init(rawValue: UInt)</pre><pre name="312b" id="312b" class="graf graf--pre graf-after--pre">      public static var touchUpInside: UIControl.Event {get}</pre><p name="847f" id="847f" class="graf graf--p graf-after--pre">UIApplication.State.active</p><pre name="c8ec" id="c8ec" class="graf graf--pre graf-after--p">if UIApplication.shared.applicationState == .active {</pre><pre name="40d4" id="40d4" class="graf graf--pre graf-after--pre">}</pre><p name="504e" id="504e" class="graf graf--p graf-after--pre">舊版是 UIApplicationState.active，新版是 UIApplication.State.active， enum State 定義在 class UIApplication 下。</p><pre name="5baf" id="5baf" class="graf graf--pre graf-after--p">open class UIApplication: UIResponser {<br> <br>     public enum State : Int {</pre><pre name="9665" id="9665" class="graf graf--pre graf-after--pre">         case active</pre><pre name="ceeb" id="ceeb" class="graf graf--pre graf-after--pre">         case inactive</pre><pre name="c6c8" id="c6c8" class="graf graf--pre graf-after--pre">         case background</pre><pre name="9c16" id="9c16" class="graf graf--pre graf-after--pre">     }</pre><pre name="2978" id="2978" class="graf graf--pre graf-after--pre">}</pre><p name="f1a0" id="f1a0" class="graf graf--p graf-after--pre">NSLayoutConstraint.Attribute</p><p name="3abb" id="3abb" class="graf graf--p graf-after--p">舊版是 NSLayoutAttribute</p><p name="70c0" id="70c0" class="graf graf--p graf-after--p">NSLayoutConstraint.Relation</p><p name="e222" id="e222" class="graf graf--p graf-after--p">舊版是 NSLayoutRelation</p><p name="dabb" id="dabb" class="graf graf--p graf-after--p">NSAttributedString.Key</p><p name="ae65" id="ae65" class="graf graf--p graf-after--p">舊版是 NSAttributedStringKey</p><blockquote name="5793" id="5793" class="graf graf--blockquote graf-after--p"><strong class="markup--strong markup--blockquote-strong">Nesting function</strong></blockquote><p name="9284" id="9284" class="graf graf--p graf-after--blockquote">將 UIImage 變成 Data，比方 function pngData()</p><pre name="ccde" id="ccde" class="graf graf--pre graf-after--p">let image = UIImage(named: &quot;apple&quot;)</pre><pre name="27a9" id="27a9" class="graf graf--pre graf-after--pre">let data = image?.pngData()</pre><p name="a73e" id="a73e" class="graf graf--p graf-after--pre">舊版是 UIImagePNGRepresentation(_:)，新版是 class UIImage 的 function pngData()。</p><pre name="5190" id="5190" class="graf graf--pre graf-after--p">extension UIImage {</pre><pre name="56ea" id="56ea" class="graf graf--pre graf-after--pre">   public func pngData() -&gt; Data?</pre><p name="0ca8" id="0ca8" class="graf graf--p graf-after--pre">inset(by:)</p><pre name="f0a8" id="f0a8" class="graf graf--pre graf-after--p">let frame = CGRect(x: 10, y: 10, width: 100, height: 100)</pre><pre name="8fdf" id="8fdf" class="graf graf--pre graf-after--pre">let insets = UIEdgeInsets(top: 10, left: 10, bottom: 10, right: 10)</pre><pre name="bb4d" id="bb4d" class="graf graf--pre graf-after--pre">let newFrame = frame.inset(by: insets)</pre><p name="79d3" id="79d3" class="graf graf--p graf-after--pre">舊版是 UIEdgeInsetsInsetRect(_:_:)，新版是 CGRect 下的 function inset(by:)。</p><pre name="9eb0" id="9eb0" class="graf graf--pre graf-after--p">extension CGRect {</pre><pre name="079e" id="079e" class="graf graf--pre graf-after--pre">   public func inset(by insets: UIEdgeInsets) -&gt; CGRect</pre><pre name="e8c6" id="e8c6" class="graf graf--pre graf-after--pre graf--trailing">}</pre></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/457d0bc9bece"><time class="dt-published" datetime="2018-06-29T13:35:07.432Z">June 29, 2018</time></a>.</p><p><a href="https://medium.com/@apppeterpan/swift-4-2-%E7%9A%84-swiftification-nesting-types-nesting-constants-nesting-functions-457d0bc9bece" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>