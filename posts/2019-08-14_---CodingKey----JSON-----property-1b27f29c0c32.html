<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>利用 CodingKey 客製 JSON 對應的 property</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">利用 CodingKey 客製 JSON 對應的 property</h1>
</header>
<section data-field="subtitle" class="p-summary">
利用 JSONDecoder 我們可以方便地串接 API，將網路上的 JSON 資料轉換成方便 App 使用的自訂型別。
</section>
<section data-field="body" class="e-content">
<section name="c88e" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="5f0b" id="5f0b" class="graf graf--h3 graf--leading graf--title">利用 CodingKey 客製 JSON 對應的 property</h3><p name="d50f" id="d50f" class="graf graf--p graf-after--h3">利用 JSONDecoder 我們可以方便地串接 API，將網路上的 JSON 資料轉換成方便 App 使用的自訂型別。</p><div name="f76c" id="f76c" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 JSONDecoder 和 Codable 解析 JSON 和生成自訂型別資料</strong><br><em class="markup--em markup--mixtapeEmbed-em">抓取網路上的 JSON 資料並不是太困難的事，但是如果想要解析它，甚至是把它變成方便 App 使用的自訂型別，卻需要寫許多程式碼才能實現。因此從前一些解析 JSON 和將 JSON 變成自訂型別的第三方套件大受歡迎，不過在 Swift…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-swift-4-%E7%9A%84-jsondecoder-%E5%92%8C-codable-%E8%A7%A3%E6%9E%90-json-%E5%92%8C%E7%94%9F%E6%88%90%E8%87%AA%E8%A8%82%E5%9E%8B%E5%88%A5%E8%B3%87%E6%96%99-ee793622629e" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="a1068ad2918bf3673e0459e185327c1a" data-thumbnail-img-id="1*l-tGFvpI-VyDff3rAGlYUQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*l-tGFvpI-VyDff3rAGlYUQ.png);"></a></div><p name="f15e" id="f15e" class="graf graf--p graf-after--mixtapeEmbed">定義 JSON 資料對應的自訂型別時，考驗的是抄襲的功力，型別的 property 須一字不漏地對應 JSON object 的 key，但以下兩種情況我們會想要 property 和 object 的 key 名字不一樣。</p><ul class="postList"><li name="0061" id="0061" class="graf graf--li graf-after--p">想將 key 改名成更適合的名字。</li></ul><p name="0a9f" id="0a9f" class="graf graf--p graf-after--li">比方 iTunes API 的歌曲名是 track_name，我們想改名為 trackName。</p><ul class="postList"><li name="4b5f" id="4b5f" class="graf graf--li graf-after--p">key 的名字包含特別字元，無法在宣告 property 時使用。</li></ul><p name="dcce" id="dcce" class="graf graf--p graf-after--li">比方 Google Custom Search JSON API 的 key 是 og:title，但是 property name 不能包含冒號呀，因此我們想將它改名為 title。</p><div name="d576" id="d576" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/81-%E8%A3%BD%E4%BD%9C-google-%E6%90%9C%E5%B0%8B-app-%E6%90%AD%E9%85%8D-google-custom-search-json-api-36e5298086e4" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/81-%E8%A3%BD%E4%BD%9C-google-%E6%90%9C%E5%B0%8B-app-%E6%90%AD%E9%85%8D-google-custom-search-json-api-36e5298086e4" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/81-%E8%A3%BD%E4%BD%9C-google-%E6%90%9C%E5%B0%8B-app-%E6%90%AD%E9%85%8D-google-custom-search-json-api-36e5298086e4"><strong class="markup--strong markup--mixtapeEmbed-strong">#81 製作 Google 搜尋 App — 搭配 Google Custom Search JSON API</strong><br><em class="markup--em markup--mixtapeEmbed-em">搭配 Google Custom Search JSON API 製作 Google App。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84%E8%A9%A6%E7%85%89-%E5%8B%87%E8%80%85%E7%9A%84-100-%E9%81%93-swift-ios-app-%E8%AC%8E%E9%A1%8C/81-%E8%A3%BD%E4%BD%9C-google-%E6%90%9C%E5%B0%8B-app-%E6%90%AD%E9%85%8D-google-custom-search-json-api-36e5298086e4" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="4ac86d94477c9318b65c60c0a7d9c647" data-thumbnail-img-id="1*W60Ajmsxa75cmcIl6xKYTA.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*W60Ajmsxa75cmcIl6xKYTA.png);"></a></div><h3 name="db43" id="db43" class="graf graf--h3 graf-after--mixtapeEmbed">將 snake case 的名字轉換成 camel case</h3><p name="2a16" id="2a16" class="graf graf--p graf-after--h3">將 snake case 的名字轉換成 camel case 比較簡單，利用 keyDecodingStrategy 的 convertFromSnakeCase 即可自動轉換。</p><div name="1252" id="1252" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565"><strong class="markup--strong markup--mixtapeEmbed-strong">利用 keyDecodingStrategy 的 convertFromSnakeCase 自動轉換 JSON 欄位名稱 — Swift 4.1</strong><br><em class="markup--em markup--mixtapeEmbed-em">利用 JSONDecoder，現在我們不再需要第三方套件，很方便就能將 JSON 資料轉換成自訂型別。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%88%A9%E7%94%A8-keydecodingstrategy-%E7%9A%84-convertfromsnakecase-%E8%87%AA%E5%8B%95%E8%BD%89%E6%8F%9B-json-%E6%AC%84%E4%BD%8D%E5%90%8D%E7%A8%B1-swift-4-1-a0164dde3565" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="19556f2f269fafd988fd8fdf2f4d72ba" data-thumbnail-img-id="1*lO3GaREhhQfoKBqXgN8-Gg.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*lO3GaREhhQfoKBqXgN8-Gg.jpeg);"></a></div><p name="615d" id="615d" class="graf graf--p graf-after--mixtapeEmbed">不過若是其它名字的轉換，則需要透過 CodingKey，方法如下。</p><h3 name="9998" id="9998" class="graf graf--h3 graf-after--p">讓 property 名稱和 object 的 key 名字不一樣</h3><p name="2516" id="2516" class="graf graf--p graf-after--h3">利用 enum CodingKeys 將可客製 JSON 對應的 property。</p><p name="5e25" id="5e25" class="graf graf--p graf-after--p">假設 JSON 資料如下</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="json" name="5c35" id="5c35" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-punctuation">[</span><br />   <span class="hljs-punctuation">{</span><br />      <span class="hljs-attr">&quot;og:title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;我的少女時代&quot;</span><span class="hljs-punctuation">,</span><br />      <span class="hljs-attr">&quot;song&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;小幸運&quot;</span><span class="hljs-punctuation">,</span><br />      <span class="hljs-attr">&quot;rate&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-number">5</span><br />   <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span><br />   <span class="hljs-punctuation">{</span><br />      <span class="hljs-attr">&quot;og:title&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;擺渡人&quot;</span><span class="hljs-punctuation">,</span><br />      <span class="hljs-attr">&quot;song&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;重出江湖&quot;</span><br />   <span class="hljs-punctuation">}</span><br /><span class="hljs-punctuation">]</span></span></pre><p name="be85" id="be85" class="graf graf--p graf-after--pre">我們在自訂的型別裡加入 enum CodingKeys，描述 JSON 的 key 如何對應 property。</p><p name="8d02" id="8d02" class="graf graf--p graf-after--p">假設 JSON 對應的型別是 Movie。以下的 property title 待會將透過 CodingKeys 對應到 JSON 的 og:title。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="dc41" id="dc41" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Movie</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> song: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> rate: <span class="hljs-type">Int</span>?<br />}</span></pre><p name="c458" id="c458" class="graf graf--p graf-after--pre">輸入 cod 後出現 CodingKeys，按下 enter。</p><figure name="77a2" id="77a2" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*KpYiDqcQr7pkgy_8I1QLgQ.png" data-width="1026" data-height="608" src="https://cdn-images-1.medium.com/max/800/1*KpYiDqcQr7pkgy_8I1QLgQ.png"></figure><p name="f28c" id="f28c" class="graf graf--p graf-after--figure">此時 Xcode 將幫我們輸入 enum CodingKeys 的定義，它遵從 protocol CodingKey，case 名稱對應 property 的名字。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="0a22" id="0a22" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Movie</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> song: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> rate: <span class="hljs-type">Int</span>?<br />    <br />    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CodingKeys</span>: <span class="hljs-title class_">CodingKey</span> {<br />        <span class="hljs-keyword">case</span> song<br />        <span class="hljs-keyword">case</span> title<br />        <span class="hljs-keyword">case</span> rate<br />    }<br />}</span></pre><p name="2385" id="2385" class="graf graf--p graf-after--pre">我們例子裡 title 對應的 JSON 是 og:title，因此 property 的名稱和 JSON key 的名字不一樣。為了讓 Swift 知道 title 要對應到 JSON 的 og:title，我們必須宣告 enum 的 raw value 型別為 String，然後設定 <code class="markup--code markup--p-code">case title = &quot;og:title&quot;</code>，它將讓 JSON key <code class="markup--code markup--p-code">og:title</code> 的內容順利存入 property title。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="ca49" id="ca49" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Movie</span>: <span class="hljs-title class_">Codable</span> {<br />   <span class="hljs-keyword">let</span> song: <span class="hljs-type">String</span><br />   <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />   <span class="hljs-keyword">let</span> rate: <span class="hljs-type">Int</span>?<br /><br />   <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CodingKeys</span>: <span class="hljs-title class_">String</span>, <span class="hljs-title class_">CodingKey</span> {<br />      <span class="hljs-keyword">case</span> song<br />      <span class="hljs-keyword">case</span> title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;og:title&quot;</span><br />      <span class="hljs-keyword">case</span> rate<br />   }<br />}</span></pre><p name="7a28" id="7a28" class="graf graf--p graf-after--pre">因此定義 enum CodingKeys 的基本規則如下:</p><ul class="postList"><li name="9946" id="9946" class="graf graf--li graf-after--p">名字叫 CodingKeys。(ps: 若要取其它的名字，須另外定義解析 JSON 的 init(from:) )</li><li name="c46f" id="c46f" class="graf graf--li graf-after--li">遵從 protocol CodingKey。</li><li name="a753" id="a753" class="graf graf--li graf-after--li">將每個 property 寫成 case，case 名稱等於 property。若 property 名稱和 JSON key 的名字不一樣，再將 key 的字串設為 case 的 raw value。</li><li name="36fc" id="36fc" class="graf graf--li graf-after--li">raw value 型別為 String。(ps: 為了設定對應的 JSON key，我們必須使用字串型別的 raw value，不然是可以不使用 raw value )</li></ul><p name="bcd9" id="bcd9" class="graf graf--p graf-after--li">值得注意的，每個 property 的 case 都要寫，少寫將造成錯誤。</p><figure name="f928" id="f928" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*tBrSsZX1Lfx1CJe-s4g2ZA.png" data-width="1788" data-height="606" src="https://cdn-images-1.medium.com/max/800/1*tBrSsZX1Lfx1CJe-s4g2ZA.png"></figure><pre name="bc8e" id="bc8e" class="graf graf--pre graf-after--figure">error: MyPlayground.playground:3:8: error: type &#39;Movie&#39; does not conform to protocol &#39;Decodable&#39;<br>struct Movie: Codable {<br>       ^</pre><pre name="a86b" id="a86b" class="graf graf--pre graf-after--pre">MyPlayground.playground:6:8: note: cannot automatically synthesize &#39;Decodable&#39; because &#39;rate&#39; does not have a matching CodingKey and does not have a default value<br>   let rate: Int?</pre><p name="5113" id="5113" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">完整程式範例</strong></p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="13df" id="13df" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">import</span> Foundation<br /><br /><span class="hljs-keyword">let</span> data <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&quot;&quot;<br />[<br />{<br />&quot;og:title&quot;: &quot;我的少女時代&quot;,<br />&quot;song&quot;: &quot;小幸運&quot;,<br />&quot;rate&quot;: 5<br />},<br />{<br />&quot;og:title&quot;: &quot;擺渡人&quot;,<br />&quot;song&quot;: &quot;重出江湖&quot;<br />}<br />]<br />&quot;&quot;&quot;</span>.data(using: .utf8)<span class="hljs-operator">!</span><br /><br /><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Movie</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> song: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> rate: <span class="hljs-type">Int</span>?<br />    <br />    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CodingKeys</span>: <span class="hljs-title class_">String</span>, <span class="hljs-title class_">CodingKey</span> {<br />        <span class="hljs-keyword">case</span> song<br />        <span class="hljs-keyword">case</span> title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;og:title&quot;</span><br />        <span class="hljs-keyword">case</span> rate<br />    }<br />}<br /><br /><span class="hljs-keyword">let</span> decoder <span class="hljs-operator">=</span> <span class="hljs-type">JSONDecoder</span>()<br /><span class="hljs-keyword">do</span> {<br />    <span class="hljs-keyword">let</span> movies <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.decode([<span class="hljs-type">Movie</span>].<span class="hljs-keyword">self</span>, from: data)<br />    <span class="hljs-built_in">print</span>(movies)<br />} <span class="hljs-keyword">catch</span> {<br />    <span class="hljs-built_in">print</span>(error)<br />}</span></pre><p name="c0e0" id="c0e0" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">解析結果</strong></p><figure name="73f9" id="73f9" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*BEnqHultUN2yBm6iZwfeAw.jpeg" data-width="2122" data-height="248" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*BEnqHultUN2yBm6iZwfeAw.jpeg"></figure><h3 name="8539" id="8539" class="graf graf--h3 graf-after--figure">利用 extension 遵從 Codable</h3><p name="0aaf" id="0aaf" class="graf graf--p graf-after--h3">想要分離程式的話，也可改用 extension 遵從 Codable。</p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="62a9" id="62a9" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Movie</span> {<br />    <span class="hljs-keyword">let</span> song: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> title: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> rate: <span class="hljs-type">Int</span>?<br />}<br /><span class="hljs-keyword">extension</span> <span class="hljs-title class_">Movie</span>: <span class="hljs-title class_">Codable</span> {    <br />    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">CodingKeys</span>: <span class="hljs-title class_">String</span>, <span class="hljs-title class_">CodingKey</span> {<br />        <span class="hljs-keyword">case</span> song<br />        <span class="hljs-keyword">case</span> title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;og:title&quot;</span><br />        <span class="hljs-keyword">case</span> rate<br />    }<br />}</span></pre><h3 name="d29e" id="d29e" class="graf graf--h3 graf-after--pre">搭配控制 JSON 解碼的 init(from:)</h3><p name="1fff" id="1fff" class="graf graf--p graf-after--h3">若我們解碼透過自己定義的 init(from:)，則有方法不用將 property 的每個 case 都寫出來。</p><div name="c31c" id="c31c" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-init-from-decoder-%E8%A7%A3%E6%9E%90-json-f9c8d420cda4" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-init-from-decoder-%E8%A7%A3%E6%9E%90-json-f9c8d420cda4" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-init-from-decoder-%E8%A7%A3%E6%9E%90-json-f9c8d420cda4"><strong class="markup--strong markup--mixtapeEmbed-strong">定義 Decodable 的 init(from:) 解析 JSON</strong><br><em class="markup--em markup--mixtapeEmbed-em">透過 JSONDecoder，我們可以方便地將 JSON 資料變成遵從 protocol Decodable 的自訂型別，而且大部分的時候我們只要宣告型別裡的 property，不用自己撰寫解析 JSON 的 init(from…</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-init-from-decoder-%E8%A7%A3%E6%9E%90-json-f9c8d420cda4" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="f2f0a35aa460b7489fcc5705881cd7d1" data-thumbnail-img-id="1*8bdlwtE_6dUJIbgSi6JIlw.jpeg" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*8bdlwtE_6dUJIbgSi6JIlw.jpeg);"></a></div><p name="0437" id="0437" class="graf graf--p graf-after--mixtapeEmbed"><strong class="markup--strong markup--p-strong">範例</strong></p><pre data-code-block-mode="2" spellcheck="false" data-code-block-lang="swift" name="0b1b" id="0b1b" class="graf graf--pre graf-after--p graf--preV2"><span class="pre--content"><span class="hljs-keyword">struct</span> <span class="hljs-title class_">StoreItem</span>: <span class="hljs-title class_">Codable</span> {<br />    <span class="hljs-keyword">let</span> name: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> artistName: <span class="hljs-type">String</span><br />    <span class="hljs-keyword">let</span> kind: <span class="hljs-type">String</span><br />    <br />    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">StoreItemKeys</span>: <span class="hljs-title class_">String</span>, <span class="hljs-title class_">CodingKey</span> {<br />        <span class="hljs-keyword">case</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;trackName&quot;</span><br />    }<br />    <br />    <span class="hljs-keyword">init</span>(<span class="hljs-params">from</span> <span class="hljs-params">decoder</span>: <span class="hljs-type">Decoder</span>) <span class="hljs-keyword">throws</span> {<br />        <span class="hljs-keyword">let</span> container <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.container(keyedBy: <span class="hljs-type">CodingKeys</span>.<span class="hljs-keyword">self</span>)<br />        artistName <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> container.decode(<span class="hljs-type">String</span>.<span class="hljs-keyword">self</span>, forKey: .artistName)<br />        kind <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> container.decode(<span class="hljs-type">String</span>.<span class="hljs-keyword">self</span>, forKey: .kind)<br />        <span class="hljs-keyword">let</span> additionalContainer <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> decoder.container(keyedBy: <span class="hljs-type">StoreItemKeys</span>.<span class="hljs-keyword">self</span>)<br />        name <span class="hljs-operator">=</span> <span class="hljs-keyword">try</span> additionalContainer.decode(<span class="hljs-type">String</span>.<span class="hljs-keyword">self</span>, forKey: .name)<br />    }<br />}</span></pre><p name="2913" id="2913" class="graf graf--p graf-after--pre">將想改名的 case 寫在 enum StoreItemKeys(名字可自訂)裡，而非 enum CodingKeys，如此即可繼續使用原本自動生成的 CodingKeys，不需將 property 的每個 case 寫出來。</p><p name="e89b" id="e89b" class="graf graf--p graf-after--p">剛剛的例子我們讓 Swift 自動產生 CodingKeys，不過它有個小小的限制。只有遵從 Codable 會自動產生 CodingKeys，只遵從 Decodable 並不會產生 CodingKeys，因此以下例子將產生錯誤。</p><figure name="77d3" id="77d3" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*dwCrPEUCxNhQEALQPqJaiA.png" data-width="2010" data-height="900" src="https://cdn-images-1.medium.com/max/800/1*dwCrPEUCxNhQEALQPqJaiA.png"></figure><h3 name="7c91" id="7c91" class="graf graf--h3 graf-after--figure">宣告跟 JSON 資料無關的 property</h3><p name="0e06" id="0e06" class="graf graf--p graf-after--h3">有時我們會想在型別裡宣告跟 JSON 資料無關的 property，此時可透過 CodingKeys 實現。</p><div name="85ab" id="85ab" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122"><strong class="markup--strong markup--mixtapeEmbed-strong">在 Codable 型別裡宣告跟 JSON 資料無關的 property</strong><br><em class="markup--em markup--mixtapeEmbed-em">有時我們會想在遵從 Codable 的型別裡宣告跟 JSON 資料無關的 property。接下來讓我們以 Meme API 的 JSON 為例，介紹三種不同的方法。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E5%9C%A8-codable-%E5%9E%8B%E5%88%A5%E8%A3%A1%E5%AE%A3%E5%91%8A%E8%B7%9F-json-%E8%B3%87%E6%96%99%E7%84%A1%E9%97%9C%E7%9A%84-property-f8b5e49b0122" class="js-mixtapeImage mixtapeImage mixtapeImage--empty u-ignoreBlock" data-media-id="f504dc0d88688d4826c417d68d81a020"></a></div><h3 name="da6a" id="da6a" class="graf graf--h3 graf-after--mixtapeEmbed">自訂 custom 的 keyDecodingStrategy，將 JSON 的大寫 key 變小寫</h3><div name="0f01" id="0f01" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-custom-%E7%9A%84-keydecodingstrategy-%E5%B0%87-json-%E7%9A%84%E5%A4%A7%E5%AF%AB-key-%E8%AE%8A%E5%B0%8F%E5%AF%AB-958ec9cda3ed" data-href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-custom-%E7%9A%84-keydecodingstrategy-%E5%B0%87-json-%E7%9A%84%E5%A4%A7%E5%AF%AB-key-%E8%AE%8A%E5%B0%8F%E5%AF%AB-958ec9cda3ed" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-custom-%E7%9A%84-keydecodingstrategy-%E5%B0%87-json-%E7%9A%84%E5%A4%A7%E5%AF%AB-key-%E8%AE%8A%E5%B0%8F%E5%AF%AB-958ec9cda3ed"><strong class="markup--strong markup--mixtapeEmbed-strong">自訂 custom 的 keyDecodingStrategy，將 JSON 的大寫 key 變小寫</strong><br><em class="markup--em markup--mixtapeEmbed-em">使用 JSONDecoder 解碼 JSON 資料時，有時我們會遇到 JSON 裡的 key 跟 Swift 變數命名習慣不同，比方彼得潘最近串接公車 API，發現它的 key 都是大寫開頭，跟 Swift 習慣小寫開頭的變數名稱不合。</em>medium.com</a><a href="https://medium.com/%E5%BD%BC%E5%BE%97%E6%BD%98%E7%9A%84-swift-ios-app-%E9%96%8B%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E7%AD%94%E9%9B%86/%E8%87%AA%E8%A8%82-custom-%E7%9A%84-keydecodingstrategy-%E5%B0%87-json-%E7%9A%84%E5%A4%A7%E5%AF%AB-key-%E8%AE%8A%E5%B0%8F%E5%AF%AB-958ec9cda3ed" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0d301f8b828bcdcace6f5a4ac69012cd" data-thumbnail-img-id="1*Z4Z9Qb098BCa4Hr-48smwQ.png" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/1*Z4Z9Qb098BCa4Hr-48smwQ.png);"></a></div><h3 name="b507" id="b507" class="graf graf--h3 graf-after--mixtapeEmbed"><strong class="markup--strong markup--h3-strong">參考連結</strong></h3><div name="2583" id="2583" class="graf graf--mixtapeEmbed graf-after--h3"><a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types" data-href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types"><strong class="markup--strong markup--mixtapeEmbed-strong">Encoding and Decoding Custom Types | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">Make your data types encodable and decodable for compatibility with external representations such as JSON.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/foundation/archives_and_serialization/encoding_and_decoding_custom_types" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="0206825b459c1e53c8afc9bea183ff09" data-thumbnail-img-id="0*WREtYlrlLbyH5zSi" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*WREtYlrlLbyH5zSi);"></a></div><div name="6f29" id="6f29" class="graf graf--mixtapeEmbed graf-after--mixtapeEmbed"><a href="https://developer.apple.com/documentation/swift/codingkey" data-href="https://developer.apple.com/documentation/swift/codingkey" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://developer.apple.com/documentation/swift/codingkey"><strong class="markup--strong markup--mixtapeEmbed-strong">CodingKey | Apple Developer Documentation</strong><br><em class="markup--em markup--mixtapeEmbed-em">A type that can be used as a key for encoding and decoding.</em>developer.apple.com</a><a href="https://developer.apple.com/documentation/swift/codingkey" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="367062e95dca8c3aa3163796253e3452" data-thumbnail-img-id="0*68lip9OyGwph1UcX" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*68lip9OyGwph1UcX);"></a></div><figure name="5200" id="5200" class="graf graf--figure graf--iframe graf-after--mixtapeEmbed graf--trailing"><iframe src="https://www.youtube.com/embed/CBJcmz-b4K4?feature=oembed" width="700" height="393" frameborder="0" scrolling="no"></iframe></figure></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@apppeterpan" class="p-author h-card">彼得潘的 iOS App Neverland</a> on <a href="https://medium.com/p/1b27f29c0c32"><time class="dt-published" datetime="2019-08-14T04:21:53.996Z">August 14, 2019</time></a>.</p><p><a href="https://medium.com/@apppeterpan/%E5%88%A9%E7%94%A8-enum-codingkeys-%E5%AE%A2%E8%A3%BD-json-%E5%B0%8D%E6%87%89%E7%9A%84-property-1b27f29c0c32" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on September 17, 2025.</p></footer></article></body></html>